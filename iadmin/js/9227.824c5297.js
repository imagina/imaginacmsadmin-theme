"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[9227],{9227:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var i=a(61758),s=a(58790);const l={class:"box"};function o(e,t,a,o,r,n){const d=(0,i.g2)("q-item-label"),m=(0,i.g2)("file-list"),u=(0,i.g2)("q-item-section"),c=(0,i.g2)("q-item"),p=(0,i.g2)("q-list"),f=(0,i.g2)("master-modal");return(0,i.uX)(),(0,i.Wv)(f,{modelValue:r.modal.show,"onUpdate:modelValue":t[0]||(t[0]=e=>r.modal.show=e),onHide:t[1]||(t[1]=e=>n.resetModal()),loading:r.modal.loading,title:r.modal.title,"custom-position":""},{default:(0,i.k6)((()=>[(0,i.Lk)("div",l,[(0,i.bF)(p,{separator:"",dense:""},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.modal.requestData,((e,t)=>((0,i.uX)(),(0,i.Wv)(c,{key:t,style:{padding:"8px 0"}},{default:(0,i.k6)((()=>[(0,i.bF)(u,null,{default:(0,i.k6)((()=>["media"!=e.fieldType?((0,i.uX)(),(0,i.Wv)(d,{key:0},{default:(0,i.k6)((()=>[(0,i.eW)((0,s.v_)(e.label),1)])),_:2},1024)):(0,i.Q3)("",!0),"media"==e.fieldType?((0,i.uX)(),(0,i.Wv)(d,{key:1},{default:(0,i.k6)((()=>[(0,i.bF)(m,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,"grid-col-class":"col-12","hide-header":""},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):((0,i.uX)(),(0,i.Wv)(d,{key:2,caption:""},{default:(0,i.k6)((()=>[(0,i.eW)((0,s.v_)(e.value),1)])),_:2},1024))])),_:2},1024)])),_:2},1024)))),128))])),_:1})])])),_:1},8,["modelValue","loading","title"])}a(10239);var r=a(15409),n=a(99526)["A"];const d={components:{fileList:r.A},data(){return{crudId:this.$uid(),modal:{title:null,show:!1,loading:!1,requestData:[]}}},computed:{crudData(){return{crudId:this.crudId,entityName:n("main.qbooking.entityNames.reservation"),apiRoute:"apiRoutes.qbooking.reservationItems",permission:"ibooking.reservations",extraFormFields:"ibooking.crud-fields.reservations",create:{to:{name:"qbooking.panel.reservations.create"}},read:{hideHeader:!0,columns:[{name:"id",label:this.$tr("isite.cms.form.id"),field:"id",style:"width: 50px"},{name:"resourceTitle",label:this.$tr("isite.cms.label.resource"),field:"resourceTitle",align:"left"},{name:"service",label:this.$tr("isite.cms.label.service"),align:"left",format:(e,t)=>`${t.categoryTitle}, ${t.serviceTitle}`},{name:"statusName",label:this.$tr("isite.cms.form.status"),field:"statusName",align:"left"},{name:"startDate",label:this.$tr("isite.cms.form.startDate"),field:"startDate",align:"left",format:e=>e?this.$trd(e,{type:"shortHuman"}):"-"},{name:"customer",label:this.$tr("isite.cms.label.customer"),align:"left",format:(e,t)=>t.reservation&&t.reservation.customer?`${t.reservation.customer.firstName} ${t.reservation.customer.lastName}`:"-"},{name:"created_at",label:this.$tr("isite.cms.form.createdAt"),field:"createdAt",align:"left",format:e=>e?this.$trd(e):"-"},{name:"updated_at",label:this.$tr("isite.cms.form.updatedAt"),field:"updatedAt",align:"left",format:e=>e?this.$trd(e):"-"},{name:"actions",label:this.$tr("isite.cms.form.actions"),align:"left"}],requestParams:{include:"reservation.customer,meetings,service,fields"},grid:{component:()=>a.e(5655).then(a.bind(a,75655))},filters:{userId:{value:null,type:"select",props:{label:this.$tr("isite.cms.label.user")},loadOptions:{apiRoute:"apiRoutes.quser.users",select:{label:"fullName",id:"id"}}}},actions:[{name:"viewLead",icon:"fas fa-info-circle",color:"info",tooltip:this.$tr("isite.cms.label.information"),format:e=>e.service&&e.service.form?{}:{vIf:!1},action:e=>{this.showRequestData(e)}}]},update:{title:this.$tr("ibooking.cms.updateReservation")},delete:!0,formLeft:{id:{value:""},categoryId:{value:null,type:"select",props:{label:this.$tr("isite.cms.label.category"),readonly:!0},loadOptions:{apiRoute:"apiRoutes.qbooking.categories"}},serviceId:{value:null,type:"select",props:{label:this.$tr("isite.cms.label.service"),readonly:!0},loadOptions:{apiRoute:"apiRoutes.qbooking.services"}},resourceId:{value:null,type:"select",props:{label:this.$tr("isite.cms.label.resource"),readonly:!0},loadOptions:{apiRoute:"apiRoutes.qbooking.resources"}},status:{type:"select",isTranslatable:!1,props:{label:`${this.$tr("isite.cms.form.status")}*`,options:[{label:this.$tr("isite.cms.label.pending"),value:"0"},{label:this.$tr("isite.cms.label.approved"),value:"1"},{label:this.$tr("isite.cms.label.cancelled"),value:"2"}],rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}},startDate:{type:"fullDate",props:{label:this.$tr("isite.cms.form.startDate")}}}}},crudInfo(){return this.$store.state.qcrudComponent.component[this.crudId]||{}}},methods:{async showRequestData(e){this.modal={title:e.service.title,show:!0,loading:!0,requestData:[]};let t=e.service?.form||!1;if(t){let a={};e.fields.forEach((e=>a[e.name]=e.value));let i=this.$clone(e.files||[]),s={refresh:!0,params:{include:"fields"}};this.$crud.show("apiRoutes.qform.forms",t.id,s).then((e=>{this.$clone(e.data.fields).forEach((e=>{let t=e.dynamicField?.type||"input",s=a[this.$helper.convertStringToSnakeCase(e.name)]||"-",l="media"!=t?null:i.find((t=>t.zone==(e.dynamicField.props.zone||"mainimage")));this.modal.requestData.push({...e,label:e.label.replace("*",""),value:"media"!=t?s:[{id:this.$uid(),...l,filename:e.label}],fieldType:t})})),this.modal.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.modal.loading=!1}))}))}},resetModal(){this.modal={show:!1,request:!1}}}};var m=a(12807),u=a(54514),c=a(75329),p=a(63418),f=a(35779),h=a(98582),b=a.n(h);const v=(0,m.A)(d,[["render",o]]),g=v;b()(d,"components",{QList:u.A,QItem:c.A,QItemSection:p.A,QItemLabel:f.A})}}]);