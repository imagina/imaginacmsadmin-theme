"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[8060],{38060:(e,l,a)=>{a.r(l),a.d(l,{default:()=>C});var i=a(92444),t=a(74044);const s={id:"directoryCorporativePage"},o={id:"pageContent",class:"box relative-position"},r={class:"full-width row"},n={id:"usersContent",class:"q-py-lg row q-col-gutter-lg"},c={key:0},u={class:"row items-center user-card"},d={class:"col-12"},p={class:"text-capitalize ellipsis text-weight-bold"},h={class:"col-12 col-lg-5"},m={class:"img-content"},g={class:"col-12 col-lg-7"},f={class:"row justify-end full-width"};function v(e,l,a,v,b,y){const Q=(0,i.E1)("dynamic-field"),k=(0,i.E1)("not-result"),D=(0,i.E1)("q-separator"),q=(0,i.E1)("avatar-image"),P=(0,i.E1)("q-icon"),$=(0,i.E1)("q-item-label"),w=(0,i.E1)("q-item-section"),E=(0,i.E1)("q-item"),K=(0,i.E1)("q-list"),x=(0,i.E1)("q-pagination"),A=(0,i.E1)("inner-loading");return(0,i.Wz)(),(0,i.An)("div",s,[(0,i.QD)("div",o,[(0,i.QD)("div",r,[(0,i.K2)(Q,{modelValue:b.search,"onUpdate:modelValue":[l[0]||(l[0]=e=>b.search=e),l[1]||(l[1]=e=>y.getData())],field:y.searchField,class:"col-12 col-md-4 col-xl-3"},null,8,["modelValue","field"])]),(0,i.QD)("div",n,[b.loading||!b.users||b.users.length?((0,i.Wz)(!0),(0,i.An)(i.ae,{key:1},(0,i.mi)(y.userList,((l,a)=>((0,i.Wz)(),(0,i.An)("div",{key:a,class:"col-12 col-lg-6"},[(0,i.QD)("div",u,[(0,i.QD)("div",d,[(0,i.QD)("div",p,(0,t.WA)(l.fullName),1),(0,i.K2)(D,{class:"q-my-sm"})]),(0,i.QD)("div",h,[(0,i.QD)("div",m,[(0,i.K2)(q,{src:l?.mainImage,width:"1160px",height:"116px"},null,8,["src"])])]),(0,i.QD)("div",g,[(0,i.K2)(K,null,{default:(0,i.Ql)((()=>[((0,i.Wz)(!0),(0,i.An)(i.ae,null,(0,i.mi)(l.informationBlocks,((l,a)=>((0,i.Wz)(),(0,i.Az)(E,{key:a,style:{padding:"0"},clickable:!!l.copy,onClick:a=>l.copy?e.$helper.copyToClipboard(l.copy):null},{default:(0,i.Ql)((()=>[(0,i.K2)(w,null,{default:(0,i.Ql)((()=>[(0,i.K2)($,{overline:""},{default:(0,i.Ql)((()=>[(0,i.K2)(P,{name:l.icon,color:"primary"},null,8,["name"]),(0,i.mY)(" "+(0,t.WA)(l.label),1)])),_:2},1024),(0,i.K2)($,{class:"q-pl-sm ellipsis"},{default:(0,i.Ql)((()=>[(0,i.mY)((0,t.WA)(l.value),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["clickable","onClick"])))),128))])),_:2},1024)])])])))),128)):((0,i.Wz)(),(0,i.An)("div",c,[(0,i.K2)(k)]))]),(0,i.QD)("div",f,[(0,i.K2)(x,{modelValue:b.pagination.page,"onUpdate:modelValue":[l[2]||(l[2]=e=>b.pagination.page=e),l[3]||(l[3]=e=>{b.pagination.page=e,y.getData()})],max:b.pagination.lastPage,input:"",color:"grey-9"},null,8,["modelValue","max"])]),(0,i.K2)(A,{visible:b.loading},null,8,["visible"])])])}var b=a(8932);const y={props:{},components:{},watch:{},beforeUnmount(){b.kN.off("page.data.refresh")},mounted(){this.$nextTick((function(){this.init()}))},data(){return{loading:!1,search:null,rolesToDirectory:this.$getSetting("iprofile::rolesToDirectory"),pagination:{perPage:20,page:1,lastPage:1},users:[]}},computed:{searchField(){return{value:null,type:"search"}},userList(){let e=this.users||[];return e.forEach((e=>{let l=this.$helper.convertToFrontField(e.fields);e.fullName=e.fullName.toLowerCase(),e.informationBlocks=[{label:this.$tr("isite.cms.label.role"),icon:"fas fa-user",value:e.roles?e.roles.map((e=>e.name)).join(", "):""},{label:this.$tr("isite.cms.label.email"),icon:"fas fa-envelope",copy:e.email,value:e.email},{label:this.$tr("isite.cms.label.phone"),icon:"fas fa-phone",copy:!!l.cellularPhone&&l.cellularPhone.value,value:l.cellularPhone?this.$helper.maskPhone(l.cellularPhone.value):"-"}]})),e}},methods:{init(){this.setFilters(),this.getData(),b.kN.on("page.data.refresh",(()=>this.getData(!0)))},setFilters(){this.$filter.setFilter({name:this.$route.name,fields:{roleId:{value:null,type:"select",props:{label:this.$tr("isite.cms.label.role"),clearable:!0},loadOptions:{apiRoute:"apiRoutes.quser.roles",select:{label:"name",id:"id"},requestParams:{filter:{id:this.rolesToDirectory}}}}},callBack:()=>this.getData(!0)})},getData(e=!1){return new Promise(((l,a)=>{this.loading=!0;let i={refresh:e,params:{page:this.pagination.page,take:this.pagination.perPage,include:"roles",filter:{search:this.search,...this.$filter.values}}};i.params.filter.roleId||(i.params.filter.roleId=this.rolesToDirectory),this.$crud.index("apiRoutes.quser.users",i).then((e=>{this.users=e.data,this.pagination.lastPage=e.meta.page.lastPage,this.loading=!1,l(e.data)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.loading=!1,a(e)}))}))}))}}};var Q=a(68716),k=a(70880),D=a(99588),q=a(84884),P=a(11032),$=a(2992),w=a(58120),E=a(15496),K=a(95252),x=a.n(K);const A=(0,Q.c)(y,[["render",v]]),C=A;x()(y,"components",{QSeparator:k.c,QList:D.c,QItem:q.c,QItemSection:P.c,QItemLabel:$.c,QIcon:w.c,QPagination:E.c})}}]);