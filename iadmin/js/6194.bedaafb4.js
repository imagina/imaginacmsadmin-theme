"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[6194],{80956:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ce});var i=s(92444);const o={id:"pageId",class:"q-layout-page layout-padding"},r={class:"q-mb-lg backend-page"},a={class:"row q-col-gutter-md"},n={class:"col-xs-12 col-md-5"},l={class:"box"},d={class:"row gutter-y-sm"},c={class:"col-12 relative-position"},m={class:"col-xs-12 col-md-7"},u={class:"box"},h={class:"row gutter-y-sm"},p={class:"col-12 relative-position"};function g(e,t,s,g,f,b){const v=(0,i.E1)("positionForm"),$=(0,i.E1)("inner-loading"),y=(0,i.E1)("positionBanners");return(0,i.Wz)(),(0,i.An)("div",o,[(0,i.QD)("div",r,[(0,i.QD)("div",a,[(0,i.QD)("div",n,[(0,i.QD)("div",l,[(0,i.QD)("div",d,[(0,i.QD)("div",c,[(0,i.K2)(v,{"form-data":f.position},null,8,["form-data"]),(0,i.K2)($,{visible:f.loading},null,8,["visible"])])])])]),(0,i.QD)("div",m,[(0,i.QD)("div",u,[(0,i.QD)("div",h,[(0,i.QD)("div",p,[f.loading?(0,i.g1)("",!0):((0,i.Wz)(),(0,i.Az)(y,{key:0,position:f.position,onRefresh:t[0]||(t[0]=e=>b.getPosition(!0))},null,8,["position"])),(0,i.K2)($,{visible:f.loading},null,8,["visible"])])])])])])])])}const f={class:"row"},b={class:"col-12",style:{width:"100%"}},v={class:"text-right"};function $(e,t,s,o,r,a){const n=(0,i.E1)("q-input"),l=(0,i.E1)("q-select"),d=(0,i.E1)("q-checkbox"),c=(0,i.E1)("q-form"),m=(0,i.E1)("q-btn"),u=(0,i.E1)("inner-loading");return(0,i.Wz)(),(0,i.An)("div",f,[(0,i.QD)("div",b,[(0,i.K2)(c,{class:"q-mt-lg",onSubmit:t[4]||(t[4]=e=>a.updateOrCreateSlider(r.form)),ref:"formContent",onValidationError:t[5]||(t[5]=t=>e.$alert.error(e.$tr("isite.cms.message.formInvalid"))),autocomplete:"off"},{default:(0,i.Ql)((()=>[(0,i.K2)(n,{label:`${e.$tr("isite.cms.form.name")} *`,type:"text",outlined:"",dense:"",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],modelValue:r.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>r.form.name=e)},null,8,["label","rules","modelValue"]),(0,i.K2)(n,{label:`${e.$tr("isite.cms.form.slug")} *`,type:"text",outlined:"",dense:"",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],modelValue:r.form.systemName,"onUpdate:modelValue":t[1]||(t[1]=e=>r.form.systemName=e)},null,8,["label","rules","modelValue"]),(0,i.K2)(l,{label:e.$tr("isite.cms.form.status"),modelValue:r.form.active,"onUpdate:modelValue":t[2]||(t[2]=e=>r.form.active=e),"emit-value":"","map-options":"",options:[{label:e.$tr("isite.cms.label.enabled"),value:!0},{label:e.$tr("isite.cms.label.disabled"),value:!1}],outlined:"",dense:""},null,8,["label","modelValue","options"]),(0,i.K2)(d,{modelValue:r.form.showAsPopup,"onUpdate:modelValue":t[3]||(t[3]=e=>r.form.showAsPopup=e),label:e.$tr("ibanners.cms.label.showAsPopup"),"true-value":!0,"false-value":!1},null,8,["modelValue","label"])])),_:1},512),(0,i.QD)("div",v,[(0,i.K2)(m,{onClick:t[6]||(t[6]=t=>e.$refs.formContent.submit()),icon:"fas fa-save",class:"btn-small",color:"green",label:e.$tr("isite.cms.label.save"),unelevated:"",rounded:"",loading:r.loading},null,8,["label","loading"])])]),(0,i.K2)(u,{visible:r.loading},null,8,["visible"])])}const y={name:"positionsForm",props:{formData:{type:Object}},watch:{formData:{deep:!0,handler:function(){this.setFormData()}}},mounted(){this.$nextTick((function(){this.setFormData()}))},data(){return{loading:!1,form:{options:{}}}},methods:{setFormData(){this.form=this.$clone(this.formData)},updateOrCreateSlider(e){this.loading=!0,this.form.id&&this.$crud.update("apiRoutes.qbanner.positions",e.id,e).then((e=>{this.$alert.info({message:this.$tr("isite.cms.message.recordUpdated")}),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated")}),this.loading=!1}))},hasPermissionRecordMAster(e){let t=e.options||!1,s={create:!0,edit:!0,index:!0,destroy:!0};return t&&parseInt(t.masterRecord)&&(s={create:this.$hasAccess("isite.master.records.create"),edit:this.$hasAccess("isite.master.records.edit"),index:this.$hasAccess("isite.master.records.index"),destroy:this.$hasAccess("isite.master.records.destroy")}),s}}};var k=s(68716),q=s(14288),D=s(20540),Q=s(36008),w=s(78488),x=s(99140),A=s(95252),C=s.n(A);const B=(0,k.c)(y,[["render",$]]),E=B;C()(y,"components",{QForm:q.c,QInput:D.c,QSelect:Q.c,QCheckbox:w.c,QBtn:x.c});var z=s(74044);const K={class:"row relative-position"},U={class:"col-12"},V={class:"text-right q-mb-md"},R={class:"row items-center q-pa-sm"},W={class:"col-6"},N={class:"col-6 text-right"},O={key:0,class:"full-width"},P=["src"],S={key:1,width:"100%",height:"300",class:"img-responsive center-block",loop:"",controls:"false"},F=["src"],I={key:1,class:"full-width"},_=["src"],M={key:1,width:"100%",height:"300",class:"img-responsive center-block",loop:"",controls:"false"},T=["src"];function j(e,t,o,r,a,n){const l=(0,i.E1)("crud"),d=(0,i.E1)("q-chip"),c=(0,i.E1)("q-btn"),m=(0,i.E1)("q-separator"),u=(0,i.E1)("q-card"),h=(0,i.E1)("draggable"),p=(0,i.E1)("inner-loading");return(0,i.Wz)(),(0,i.An)("div",K,[(0,i.QD)("div",U,[(0,i.QD)("div",V,[(0,i.K2)(l,{"crud-data":s.e(4184).then(s.bind(s,84184)),ref:"crudBanner",type:"button-create","crud-props":{unelevated:!0,rounded:!0},onUpdated:t[0]||(t[0]=t=>e.$emit("refresh")),onCreated:t[1]||(t[1]=t=>e.$emit("refresh")),"custom-data":{formLeft:{positionId:{value:e.$route.params.id}}}},null,8,["crud-data","custom-data"])]),(0,i.K2)(h,{onChange:n.updateOrderBanners,modelValue:o.position.banners,"onUpdate:modelValue":t[2]||(t[2]=e=>o.position.banners=e),group:"banners","item-key":"id"},{item:(0,i.Ql)((({element:t,index:s})=>[((0,i.Wz)(),(0,i.Az)(u,{class:"my-card q-mb-md",key:"banner"+s},{default:(0,i.Ql)((()=>[(0,i.QD)("div",R,[(0,i.QD)("div",W,[(0,i.K2)(d,{square:"",icon:"fas fa-images","text-color":"white",color:t.active?"green":"grey"},{default:(0,i.Ql)((()=>[(0,i.mY)((0,z.WA)(t.title),1)])),_:2},1032,["color"])]),(0,i.QD)("div",N,[(0,i.K2)(c,{color:"blue-4",size:"sm",round:"",icon:"fas fa-pen",unelevated:"",class:"q-mr-sm",onClick:s=>e.$refs.crudBanner.update(t)},null,8,["onClick"]),(0,i.K2)(c,{onClick:e=>n.deleteBannerDialog(t.id,s),color:"red",unelevated:"",size:"sm",round:"",icon:"far fa-trash-alt"},null,8,["onClick"])])]),(0,i.K2)(m),t.imageUrl?((0,i.Wz)(),(0,i.An)("div",O,[t.imageUrl.indexOf("youtube.com")?((0,i.Wz)(),(0,i.An)("iframe",{key:0,width:"100%",height:"300",src:t.imageUrl,class:"tw-border-none",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,P)):t.imageUrl.indexOf(".mp4")?((0,i.Wz)(),(0,i.An)("video",S,[(0,i.QD)("source",{src:t.imageUrl,type:"video/mp4"},null,8,F)])):((0,i.Wz)(),(0,i.An)("div",{key:2,style:(0,z.MN)(`\n        background: url('${t.imageUrl}');\n        background-size: cover;\n        background-position: center;\n        height: 300px;\n        display: block;\n        max-width: 100%;`)},null,4))])):t.url?((0,i.Wz)(),(0,i.An)("div",I,[t.url.indexOf("youtube.com")?((0,i.Wz)(),(0,i.An)("iframe",{key:0,width:"100%",height:"300",src:t.url,class:"tw-border-none",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,_)):t.url.indexOf(".mp4")?((0,i.Wz)(),(0,i.An)("video",M,[(0,i.QD)("source",{src:t.url,type:"video/mp4"},null,8,T)])):(0,i.g1)("",!0)])):(0,i.g1)("",!0)])),_:2},1024))])),_:1},8,["onChange","modelValue"])]),(0,i.K2)(p,{visible:a.loading},null,8,["visible"])])}const Y={class:"q-mt-md"};function L(e,t,s,o,r,a){return(0,i.Wz)(),(0,i.An)("div",Y)}var G=s(8932);const H={props:{banner:{type:Object,default:()=>({imageUrl:""}),required:!0},index:{type:Number,required:!0}},methods:{deleteBannerDialog(e,t){this.$q.dialog({title:"Confirm",ok:"Delete",message:"You are sure to eliminate this slide?",cancel:!0,persistent:!0}).onOk((()=>{this.$crud.delete("apiRoutes.qbanner.banners",e).then((e=>{this.$alert.info({message:this.$tr("isite.cms.message.recordDeleted")}),G.kN.emit("deleteBanner","deleteBanner")})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoDeleted"),pos:"bottom"})}))})).onCancel((()=>{}))},deleteBanner(e,t){}}},J=(0,k.c)(H,[["render",L]]),X=J;var Z=s(10328),ee=s.n(Z);const te={name:"positionBanners",emits:["refresh"],components:{draggable:ee(),renderMedia:X},mounted(){this.init()},data(){return{loading:!1}},props:{position:{type:Object,default:()=>({id:0})}},watch:{},methods:{init(){this.openEditSlide()},openEditSlide(){setTimeout((()=>{if(this.$route.query.edit){let e=(this.position.banners||[]).find((e=>e.id==this.$route.query.edit));e&&this.$refs.crudBanner.update(e)}}),500)},hasPermissionRecordMAster(e){let t=e.options||!1,s={create:!0,edit:!0,index:!0,destroy:!0};return t&&parseInt(t.masterRecord)&&(s={create:this.$hasAccess("isite.master.records.create"),edit:this.$hasAccess("isite.master.records.edit"),index:this.$hasAccess("isite.master.records.index"),destroy:this.$hasAccess("isite.master.records.destroy")}),s},log(){let e=this.position.banners.map((e=>({id:e.id})));console.error(e)},updateOrderBanners(){let e=this.position.banners.map((e=>({id:e.id}))),t={banners:e};this.loading=!0,this.$crud.create("apiRoutes.qbanner.orderBanners",t).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordUpdated")}`}),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),console.warn(e),this.loading=!1}))},deleteBannerDialog(e,t){this.$q.dialog({title:"Confirm",ok:"Delete",message:"You are sure to eliminate this banner?",cancel:!0,persistent:!0}).onOk((()=>{this.$crud.delete("apiRoutes.qbanner.banners",e).then((e=>{this.$alert.info({message:this.$tr("isite.cms.message.recordDeleted")}),G.kN.emit("deleteBanner","deleteBanner")})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoDeleted"),pos:"bottom"})}))})).onCancel((()=>{}))}}};var se=s(70608),ie=s(84256),oe=s(70880);const re=(0,k.c)(te,[["render",j]]),ae=re;C()(te,"components",{QCard:se.c,QChip:ie.c,QBtn:x.c,QSeparator:oe.c});const ne={components:{positionForm:E,positionBanners:ae},beforeUnmount(){G.kN.off("deleteBanner",this.getPosition),G.kN.off("page.data.refresh")},mounted(){this.init()},data(){return{loading:!1,position:{}}},methods:{init(){G.kN.on("page.data.refresh",(()=>this.getPosition(!0))),this.getPosition(!0),G.kN.on("deleteSlide",this.getPosition)},getPosition(e=!1){let t=this.$route.params.id,s={refresh:e,params:{}};this.loading=!0,this.$crud.show("apiRoutes.qbanner.positions",t,s).then((e=>{this.position=e.data,this.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{console.warn(e),this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"})}))}))}}};var le=s(41628);const de=(0,k.c)(ne,[["render",g]]),ce=de;C()(ne,"components",{QLayout:le.c})}}]);