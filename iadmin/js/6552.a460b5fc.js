"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[6552],{36552:(e,s,t)=>{t.r(s),t.d(s,{default:()=>ne});var i=t(61758);const r={id:"pageId",class:"q-layout-page layout-padding"},l={class:"q-mb-lg backend-page"},a={class:"row q-col-gutter-md"},o={class:"col-xs-12 col-md-5"},d={class:"box"},n={class:"row gutter-y-sm"},c={class:"col-12 relative-position"},m={class:"col-xs-12 col-md-7"},u={class:"box"},h={class:"row gutter-y-sm"},p={class:"col-12 relative-position"};function g(e,s,t,g,f,b){const v=(0,i.g2)("sliderForm"),$=(0,i.g2)("inner-loading"),y=(0,i.g2)("sliderSlides");return(0,i.uX)(),(0,i.CE)("div",r,[(0,i.Lk)("div",l,[(0,i.Lk)("div",a,[(0,i.Lk)("div",o,[(0,i.Lk)("div",d,[(0,i.Lk)("div",n,[(0,i.Lk)("div",c,[(0,i.bF)(v,{"form-data":f.slider},null,8,["form-data"]),(0,i.bF)($,{visible:f.loading},null,8,["visible"])])])])]),(0,i.Lk)("div",m,[(0,i.Lk)("div",u,[(0,i.Lk)("div",h,[(0,i.Lk)("div",p,[f.loading?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(y,{key:0,slider:f.slider,onRefresh:s[0]||(s[0]=e=>b.getSlider(!0))},null,8,["slider"])),(0,i.bF)($,{visible:f.loading},null,8,["visible"])])])])])])])])}const f={class:"row"},b={class:"col-12",style:{width:"100%"}},v={class:"text-right"};function $(e,s,t,r,l,a){const o=(0,i.g2)("q-input"),d=(0,i.g2)("q-select"),n=(0,i.g2)("q-form"),c=(0,i.g2)("q-btn"),m=(0,i.g2)("inner-loading");return(0,i.uX)(),(0,i.CE)("div",f,[(0,i.Lk)("div",b,[(0,i.bF)(n,{class:"q-mt-lg",onSubmit:s[4]||(s[4]=e=>a.updateOrCreateSlider(l.form)),ref:"formContent",onValidationError:s[5]||(s[5]=s=>e.$alert.error(e.$tr("isite.cms.message.formInvalid"))),autocomplete:"off"},{default:(0,i.k6)((()=>[(0,i.bF)(o,{label:`${e.$tr("isite.cms.form.name")} *`,type:"text",outlined:"",dense:"",rules:[s=>!!s||e.$tr("isite.cms.message.fieldRequired")],modelValue:l.form.name,"onUpdate:modelValue":s[0]||(s[0]=e=>l.form.name=e)},null,8,["label","rules","modelValue"]),(0,i.bF)(o,{label:`${e.$tr("isite.cms.form.slug")} *`,type:"text",outlined:"",dense:"",readonly:"",rules:[s=>!!s||e.$tr("isite.cms.message.fieldRequired")],modelValue:l.form.systemName,"onUpdate:modelValue":s[1]||(s[1]=e=>l.form.systemName=e)},null,8,["label","rules","modelValue"]),(0,i.bF)(d,{label:e.$tr("isite.cms.form.status"),modelValue:l.form.active,"onUpdate:modelValue":s[2]||(s[2]=e=>l.form.active=e),"emit-value":"","map-options":"",options:[{label:e.$tr("isite.cms.label.enabled"),value:1},{label:e.$tr("isite.cms.label.disabled"),value:0}],outlined:"",dense:""},null,8,["label","modelValue","options"]),(0,i.bF)(d,{label:e.$tr("isite.cms.form.type"),modelValue:l.form.type,"onUpdate:modelValue":s[3]||(s[3]=e=>l.form.type=e),"emit-value":"","map-options":"",options:[{label:e.$tr("slider.cms.form.slider"),value:"slider"},{label:e.$tr("slider.cms.form.banner"),value:"banner"}],outlined:"",dense:""},null,8,["label","modelValue","options"])])),_:1},512),(0,i.Lk)("div",v,[(0,i.bF)(c,{onClick:s[6]||(s[6]=s=>e.$refs.formContent.submit()),icon:"fas fa-save",class:"btn-small",color:"positive",label:e.$tr("isite.cms.label.save"),unelevated:"",rounded:"",loading:l.loading},null,8,["label","loading"])])]),(0,i.bF)(m,{visible:l.loading},null,8,["visible"])])}const y={props:{formData:{type:Object}},watch:{formData:{deep:!0,handler:function(){this.setFormData()}}},mounted(){this.$nextTick((function(){this.setFormData()}))},data(){return{loading:!1,form:{options:{}}}},computed:{canManageRecordMaster(){let e=!0;return this.form.id&&!this.$hasAccess("isite.master.records.edit")&&(e=!1),this.form.id||this.$hasAccess("isite.master.records.create")||(e=!1),e}},methods:{setFormData(){let e=this.formData.options||{};this.form=this.$clone(this.formData),this.form.options=this.$clone(e)},updateOrCreateSlider(e){this.loading=!0,this.form.id&&this.$crud.update("apiRoutes.qslider.sliders",e.id,e).then((e=>{this.$alert.info({message:this.$tr("isite.cms.message.recordUpdated")}),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated")}),this.loading=!1}))},hasPermissionRecordMAster(e){let s=e.options||!1,t={create:!0,edit:!0,index:!0,destroy:!0};return s&&parseInt(s.masterRecord)&&(t={create:this.$hasAccess("isite.master.records.create"),edit:this.$hasAccess("isite.master.records.edit"),index:this.$hasAccess("isite.master.records.index"),destroy:this.$hasAccess("isite.master.records.destroy")}),t}}};var k=t(12807),q=t(21565),C=t(78020),S=t(833),A=t(69001),w=t(98582),F=t.n(w);const x=(0,k.A)(y,[["render",$]]),L=x;F()(y,"components",{QForm:q.A,QInput:C.A,QSelect:S.A,QBtn:A.A});var U=t(58790);const R={class:"row relative-position"},D={class:"col-12"},V={class:"text-right q-mb-md"},E={class:"row items-center q-pa-sm"},X={class:"col-6"},Q={class:"col-6 text-right"},O={key:0,class:"full-width"},B=["src"],T={key:1,width:"100%",height:"300",class:"img-responsive center-block",loop:"",controls:!1},_=["src"],I={key:1,class:"full-width"},N=["src"],M={key:1,width:"100%",height:"300",class:"img-responsive center-block",loop:"",controls:!1},j=["src"];function z(e,s,r,l,a,o){const d=(0,i.g2)("crud"),n=(0,i.g2)("q-chip"),c=(0,i.g2)("q-btn"),m=(0,i.g2)("q-separator"),u=(0,i.g2)("q-card"),h=(0,i.g2)("draggable"),p=(0,i.g2)("inner-loading");return(0,i.uX)(),(0,i.CE)("div",R,[(0,i.Lk)("div",D,[(0,i.Lk)("div",V,[(0,i.bF)(d,{"crud-data":t.e(1114).then(t.bind(t,61114)),ref:"crudSlide",type:"button-create","crud-props":{unelevated:!0,rounded:!0},onUpdated:s[0]||(s[0]=s=>e.$emit("refresh")),onCreated:s[1]||(s[1]=s=>e.$emit("refresh")),"custom-data":{formLeft:{sliderId:{value:e.$route.params.id}},formRight:{codeAds:o.codeAds}}},null,8,["crud-data","custom-data"])]),(0,i.bF)(h,{onChange:o.updateOrderSlides,modelValue:r.slider.slides,"onUpdate:modelValue":s[2]||(s[2]=e=>r.slider.slides=e),group:"slides","item-key":"id"},{item:(0,i.k6)((({element:s,index:t})=>[((0,i.uX)(),(0,i.Wv)(u,{class:"my-card q-mb-md",key:"slide"+t},{default:(0,i.k6)((()=>[(0,i.Lk)("div",E,[(0,i.Lk)("div",X,[(0,i.bF)(n,{square:"",icon:"fas fa-images","text-color":"white",color:s.active?"positive":"grey"},{default:(0,i.k6)((()=>[(0,i.eW)((0,U.v_)(s.title),1)])),_:2},1032,["color"])]),(0,i.Lk)("div",Q,[(0,i.bF)(c,{color:"blue-4",size:"sm",round:"",icon:"fas fa-pen",unelevated:"",class:"q-mr-sm",onClick:t=>e.$refs.crudSlide.update(s)},null,8,["onClick"]),(0,i.bF)(c,{onClick:e=>o.deleteSlideDialog(s.id,t),color:"red",unelevated:"",size:"sm",round:"",icon:"far fa-trash-alt"},null,8,["onClick"])])]),(0,i.bF)(m),s.imageUrl?((0,i.uX)(),(0,i.CE)("div",O,["string"==typeof s.imageUrl&&s.imageUrl.includes("youtube.com")?((0,i.uX)(),(0,i.CE)("iframe",{key:0,width:"100%",height:"300",src:s.imageUrl,frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,B)):"mp4"==typeof s.imageUrl&&s.imageUrl.includes("mp4")?((0,i.uX)(),(0,i.CE)("video",T,[(0,i.Lk)("source",{src:s.imageUrl,type:"video/mp4"},null,8,_)])):((0,i.uX)(),(0,i.CE)("div",{key:2,style:(0,U.Tr)(`\n        background: url('${s.mediaFiles.slideimage?s.mediaFiles.slideimage.mediumThumb:""}');\n        background-size: cover;\n        background-position: center;\n        height: 300px;\n        display: block;\n        max-width: 100%;`)},null,4))])):s.url?((0,i.uX)(),(0,i.CE)("div",I,["string"==typeof s.url&&s.url.includes("youtube.com")?((0,i.uX)(),(0,i.CE)("iframe",{key:0,width:"100%",height:"300",src:s.url,frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,N)):"mp4"==typeof s.url&&s.url.includes("mp4")?((0,i.uX)(),(0,i.CE)("video",M,[(0,i.Lk)("source",{src:s.url,type:"video/mp4"},null,8,j)])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])),_:2},1024))])),_:1},8,["onChange","modelValue"])]),(0,i.bF)(p,{visible:a.loading},null,8,["visible"])])}const W={class:"q-mt-md"};function P(e,s,t,r,l,a){return(0,i.uX)(),(0,i.CE)("div",W)}var Y=t(71915);const G={props:{slide:{type:Object,default:()=>({imageUrl:""}),required:!0},index:{type:Number,required:!0}},methods:{deleteSlideDialog(e,s){this.$q.dialog({title:"Confirm",ok:"Delete",message:"You are sure to eliminate this slide?",cancel:!0,persistent:!0}).onOk((()=>{this.$crud.delete("apiRoutes.qslider.slides",e).then((e=>{this.$alert.info({message:this.$tr("isite.cms.message.recordDeleted")}),Y.Bt.emit("deleteSlide","deleteSlide")})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoDeleted"),pos:"bottom"})}))})).onCancel((()=>{}))},deleteSlide(e,s){}}},H=(0,k.A)(G,[["render",P]]),J=H;var K=t(10057),Z=t.n(K);const ee={components:{draggable:Z(),renderMedia:J},mounted(){this.init()},data(){return{loading:!1}},props:{slider:{type:Object,default:()=>({id:0})}},emits:["refresh"],watch:{},computed:{codeAds(){return"banner"==this.slider.type?{value:"",type:"input",isTranslatable:!0,props:{type:"textarea",label:`${this.$tr("slider.cms.label.codeAds")}`}}:{}}},methods:{init(){this.openEditSlide()},openEditSlide(){setTimeout((()=>{if(this.$route.query.edit){let e=(this.slider.slides||[]).find((e=>e.id==this.$route.query.edit));e&&this.$refs.crudSlide.update(e)}}),500)},hasPermissionRecordMAster(e){let s=e.options||!1,t={create:!0,edit:!0,index:!0,destroy:!0};return s&&parseInt(s.masterRecord)&&(t={create:this.$hasAccess("isite.master.records.create"),edit:this.$hasAccess("isite.master.records.edit"),index:this.$hasAccess("isite.master.records.index"),destroy:this.$hasAccess("isite.master.records.destroy")}),t},log(){let e=this.slider.slides.map((e=>({id:e.id})));console.error(e)},updateOrderSlides(){let e=this.slider.slides.map((e=>({id:e.id}))),s={slider:e};this.loading=!0,this.$crud.create("apiRoutes.qslider.orderSlides",s).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordUpdated")}`}),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),console.warn(e),this.loading=!1}))},deleteSlideDialog(e,s){this.$q.dialog({title:"Confirm",ok:"Delete",message:"You are sure to eliminate this slide?",cancel:!0,persistent:!0}).onOk((()=>{this.$crud.delete("apiRoutes.qslider.slides",e).then((e=>{this.$alert.info({message:this.$tr("isite.cms.message.recordDeleted")}),Y.Bt.emit("deleteSlide","deleteSlide")})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoDeleted"),pos:"bottom"})}))})).onCancel((()=>{}))}}};var se=t(97569),te=t(88141),ie=t(37015);const re=(0,k.A)(ee,[["render",z]]),le=re;F()(ee,"components",{QCard:se.A,QChip:te.A,QBtn:A.A,QSeparator:ie.A});const ae={components:{sliderForm:L,sliderSlides:le},beforeUnmount(){Y.Bt.off("deleteSlide",this.getSlider),Y.Bt.off("page.data.refresh")},mounted(){this.init()},data(){return{loading:!1,slider:{}}},methods:{init(){Y.Bt.on("page.data.refresh",(()=>this.getSlider(!0))),this.getSlider(!0),Y.Bt.on("deleteSlide",this.getSlider)},getSlider(e=!1){let s=this.$route.params.id,t={refresh:e,params:{}};this.loading=!0,this.$crud.show("apiRoutes.qslider.sliders",s,t).then((e=>{this.slider=e.data,this.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{console.warn(e),this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"})}))}))}}};var oe=t(83333);const de=(0,k.A)(ae,[["render",g]]),ne=de;F()(ae,"components",{QLayout:oe.A})}}]);