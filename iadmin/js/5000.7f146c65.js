"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[5e3],{95e3:(e,t,i)=>{i.r(t),i.d(t,{default:()=>gi});var n=i(92444),a=i(74044);const o={class:"row"},l={class:"col-xs-12 col-sm-12 col-md-6 q-mb-sm"},r={class:"q-px-md"},s={class:"tw-w-full tw-flex q-my-md items-center"},c={class:"tw-w-full row justify-center"},d={class:"text-primary q-pa-md",style:{"font-size":"16px"}},u={class:"cursor-pointer"},m={style:{width:"240px",height:"90px"}};function f(e,t,f,p,v,g){const h=(0,n.E1)("q-tab"),w=(0,n.E1)("q-tabs"),y=(0,n.E1)("q-tooltip"),b=(0,n.E1)("q-btn"),D=(0,n.E1)("dynamic-field"),k=(0,n.E1)("q-popup-edit"),Q=(0,n.E1)("dynamicList"),x=(0,n.E1)("taskComponent"),q=(0,n.E1)("master-modal"),$=(0,n.E1)("crud"),P=(0,n.E1)("timeLogsComponent"),A=(0,n.E1)("inner-loading");return(0,n.Wz)(),(0,n.An)("div",null,[(0,n.QD)("div",o,[(0,n.QD)("div",l,[(0,n.K2)(w,{modelValue:v.tabModel,"onUpdate:modelValue":t[0]||(t[0]=e=>v.tabModel=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left","no-caps":"","narrow-indicator":"",style:{"align-items":"center"}},{default:(0,n.Ql)((()=>[((0,n.Wz)(!0),(0,n.An)(n.ae,null,(0,n.mi)(v.tabs,((e,t)=>((0,n.Wz)(),(0,n.Az)(h,{key:t,name:e.value,label:e.label},null,8,["name","label"])))),128))])),_:1},8,["modelValue"])])]),(0,n.QD)("div",r,[v.tabModel==v.tabs[0].value?((0,n.Wz)(),(0,n.Az)(Q,{key:0,ref:"dynamicList",listData:v.listData,onNew:t[6]||(t[6]=()=>e.$refs.crudComponent.create())},{"top-table":(0,n.Ql)((()=>[(0,n.QD)("div",s,[(0,n.QD)("div",null,[(0,n.K2)(b,{"text-color":"primary",class:"q-mr-sm",size:"sm",unelevated:"",round:"",icon:"fa-regular fa-chevron-left",onClick:t[1]||(t[1]=e=>g.goToPrevious())},{default:(0,n.Ql)((()=>[(0,n.K2)(y,{anchor:"bottom middle",self:"top middle"},{default:(0,n.Ql)((()=>[(0,n.mY)((0,a.WA)(e.$tr("itask.cms.previousWeek")),1)])),_:1})])),_:1})]),(0,n.QD)("div",c,[(0,n.QD)("div",d,[(0,n.QD)("div",u,(0,a.WA)(g.dynamicListTitle),1),(0,n.K2)(k,{ref:"titleModal",modelValue:v.dateRangeFilter.value,"onUpdate:modelValue":t[4]||(t[4]=e=>v.dateRangeFilter.value=e),"transition-show":"fade-in","transition-hide":"fade-out",cover:!1,anchor:"bottom start"},{default:(0,n.Ql)((()=>[(0,n.QD)("div",m,[(0,n.K2)(D,{modelValue:v.dateRangeFilter.value,"onUpdate:modelValue":[t[2]||(t[2]=e=>v.dateRangeFilter.value=e),t[3]||(t[3]=e=>g.setDateRange(e))],field:v.dateRangeFilter},null,8,["modelValue","field"])])])),_:1},8,["modelValue"])])]),(0,n.QD)("div",null,[(0,n.K2)(b,{"text-color":"primary",class:"q-mr-sm",size:"sm",unelevated:"",round:"",icon:"fa-regular fa-chevron-right",onClick:t[5]||(t[5]=e=>g.goToNext())},{default:(0,n.Ql)((()=>[(0,n.K2)(y,{anchor:"bottom middle",self:"top middle"},{default:(0,n.Ql)((()=>[(0,n.mY)((0,a.WA)(e.$tr("itask.cms.nextWeek")),1)])),_:1})])),_:1})])])])),_:1},8,["listData"])):(0,n.g1)("",!0)]),(0,n.K2)(q,{modelValue:v.selectedRow.showModal,"onUpdate:modelValue":t[11]||(t[11]=e=>v.selectedRow.showModal=e),title:`Task : ${v.selectedRow.row?.id}`,"custom-position":"",onHide:t[12]||(t[12]=e=>v.selectedRow.showModal=!1)},{default:(0,n.Ql)((()=>[(0,n.K2)(x,{row:v.selectedRow.row,onOnClose:t[7]||(t[7]=e=>v.selectedRow.showModal=!1),onOnUpdate:t[8]||(t[8]=e=>g.onUpdate(e)),onOnDelete:t[9]||(t[9]=e=>g.onDelete(e)),onOpenTimeLogsModal:t[10]||(t[10]=e=>g.openTimeLogsModal(e))},null,8,["row"])])),_:1},8,["modelValue","title"]),(0,n.K2)($,{ref:"crudComponent",type:null,"crud-data":i.e(5684).then(i.bind(i,95684)),onCreated:t[13]||(t[13]=e=>g.refreshDynamicList()),onUpdated:t[14]||(t[14]=e=>g.refreshDynamicList()),onDeleted:t[15]||(t[15]=e=>g.refreshDynamicList())},null,8,["crud-data"]),(0,n.K2)(q,{modelValue:v.selectedRow.timeLogsModal,"onUpdate:modelValue":t[18]||(t[18]=e=>v.selectedRow.timeLogsModal=e),title:e.$tr("itask.cms.timeLogs.title"),width:"460px",onHide:t[19]||(t[19]=e=>v.selectedRow.timeLogsModal=!1)},{default:(0,n.Ql)((()=>[(0,n.K2)(P,{row:v.selectedRow.row,onCloseModal:t[16]||(t[16]=e=>v.selectedRow.timeLogsModal=!1),onReloadRow:t[17]||(t[17]=e=>g.reloadRow(e))},null,8,["row"])])),_:1},8,["modelValue","title"]),(0,n.K2)(A,{visible:v.loading},null,8,["visible"])])}var p={id:"componentDynamicList"},v={id:"backend-page"},g={class:"q-my-md"},h={key:2,class:(0,a.WN)("row text-primary text-weight-bold ellipsis title-content items-center")},w={key:0,id:"titleCrudTable"};function y(e,t,i,o,l,r){var s=(0,n.E1)("page-actions"),c=(0,n.E1)("dynamicFilter"),d=(0,n.E1)("dynamicTable");return(0,n.Wz)(),(0,n.An)("div",p,[(0,n.QD)("div",v,[(0,n.QD)("div",g,[e.loadPageActions?((0,n.Wz)(),(0,n.Az)(s,{key:0,"extra-actions":e.tableActions,title:e.title,help:e.help,"expires-in":e.expiresIn,dynamicFilter:e.dynamicFilter,dynamicFilterValues:e.dynamicFilterValues,dynamicFilterSummary:e.dynamicFilterSummary,onToggleDynamicFilterModal:e.toggleDynamicFilterModal,onNew:t[0]||(t[0]=function(t){return e.$emit("new")}),onSearch:t[1]||(t[1]=function(t){return e.search(t)}),onRefresh:t[2]||(t[2]=function(t){return e.getData({pagination:{page:1}},!0)})},null,8,["extra-actions","title","help","expires-in","dynamicFilter","dynamicFilterValues","dynamicFilterSummary","onToggleDynamicFilterModal"])):(0,n.g1)("",!0),e.dynamicFilter?((0,n.Wz)(),(0,n.Az)(c,{key:1,systemName:e.systemName,modelValue:e.showDynamicFilterModal,filters:e.dynamicFilter,onShowModal:t[3]||(t[3]=function(t){return e.showDynamicFilterModal=!0}),onHideModal:t[4]||(t[4]=function(t){return e.showDynamicFilterModal=!1}),"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.updateDynamicFilterValues(t)}),"onUpdate:summary":t[6]||(t[6]=function(t){return e.dynamicFilterSummary=t})},null,8,["systemName","modelValue","filters"])):(0,n.g1)("",!0),e.loadPageActions?(0,n.g1)("",!0):((0,n.Wz)(),(0,n.An)("div",h,[e.title?((0,n.Wz)(),(0,n.An)("label",w,(0,a.WA)(e.title),1)):(0,n.g1)("",!0)])),(0,n.oF)(e.$slots,"top-table"),(0,n.K2)(d,{tableProps:e.tableProps,columns:e.columns,rows:e.rows,actions:e.actions,initialPagination:e.pagination,loading:e.loading,beforeUpdate:e.beforeUpdate,onOnPagination:t[7]||(t[7]=function(t){return e.setPagination(t)}),onUpdateRow:t[8]||(t[8]=function(t){return e.updateRow(t)})},null,8,["tableProps","columns","rows","actions","initialPagination","loading","beforeUpdate"])])])])}var b=i(75836),D=i(20584);const k={getData:function(e,t,i){return void 0===t&&(t=!1),void 0===i&&(i={}),new Promise((function(n,a){var o={refresh:t,params:i};D.c.index(e,o).then((function(e){n(e)})).catch((function(e){return a(e)}))}))},updateItem:function(e,t,i,n){return void 0===n&&(n={params:{}}),new Promise((function(a,o){D.c.update(e,t,i,n).then((function(e){a(e)})).catch((function(e){return o(e)}))}))},showItem:function(e,t,i){return void 0===i&&(i={}),new Promise((function(n,a){D.c.show(e,t,i).then((function(e){n(e)})).catch((function(e){return a(e)}))}))}};var Q=i(8932),x=function(){return x=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var a in t=arguments[i],t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},x.apply(this,arguments)},q=function(e,t,i,n){function a(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function l(e){try{s(n.next(e))}catch(t){o(t)}}function r(e){try{s(n["throw"](e))}catch(t){o(t)}}function s(e){e.done?i(e.value):a(e.value).then(l,r)}s((n=n.apply(e,t||[])).next())}))},$=function(e,t){var i,n,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(e){return function(t){return s([e,t])}}function s(r){if(i)throw new TypeError("Generator is already executing.");while(o&&(o=0,r[0]&&(l=0)),l)try{if(i=1,n&&(a=2&r[0]?n["return"]:r[0]?n["throw"]||((a=n["return"])&&a.call(n),0):n.next)&&!(a=a.call(n,r[1])).done)return a;switch(n=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,n=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){l.label=r[1];break}if(6===r[0]&&l.label<a[1]){l.label=a[1],a=r;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(r);break}a[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(s){r=[6,s],n=0}finally{i=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};function P(e,t){(0,n._S)().appContext.config.globalProperties;var i={},a=(0,b.cB)({loading:!1,columns:[],rows:[],loadPageActions:!1,requestParams:{},showModal:!1,expiresIn:null,showDynamicFilterModal:!1,dynamicFilterValues:{},dynamicFilterSummary:{},pagination:{page:1,rowsNumber:"",rowsPerPage:10,descending:!0}}),o={hasPermission:(0,n.S6)((function(){var t,i,n,a,o,l,r,s;return{create:!(null===(t=e.listData)||void 0===t?void 0:t.permission)||Q.is.hasAccess("".concat(null===(i=e.listData)||void 0===i?void 0:i.permission,".create")),index:!(null===(n=e.listData)||void 0===n?void 0:n.permission)||Q.is.hasAccess("".concat(null===(a=e.listData)||void 0===a?void 0:a.permission,".index")),edit:!(null===(o=e.listData)||void 0===o?void 0:o.permission)||Q.is.hasAccess("".concat(null===(l=e.listData)||void 0===l?void 0:l.permission,".edit")),destroy:!(null===(r=e.listData)||void 0===r?void 0:r.permission)||Q.is.hasAccess("".concat(null===(s=e.listData)||void 0===s?void 0:s.permission,".destroy"))}})),beforeUpdate:(0,n.S6)((function(){var t;return(null===(t=e.listData)||void 0===t?void 0:t.beforeUpdate)||!1})),title:(0,n.S6)((function(){var t;return(null===(t=null===e||void 0===e?void 0:e.listData)||void 0===t?void 0:t.read.title)||!1})),help:(0,n.S6)((function(){var t;return(null===(t=null===e||void 0===e?void 0:e.listData)||void 0===t?void 0:t.read.help)||!1})),actions:(0,n.S6)((function(){var t;return(null===(t=null===e||void 0===e?void 0:e.listData)||void 0===t?void 0:t.actions)||!1})),tableProps:(0,n.S6)((function(){var t,i;return(null===(i=null===(t=null===e||void 0===e?void 0:e.listData)||void 0===t?void 0:t.read)||void 0===i?void 0:i.tableProps)||null})),tableActions:(0,n.S6)((function(){var t,i,n=[];return!1!==e.listData.read.search&&n.push("search"),e.listData.create&&o.hasPermission.value["create"]&&n.push("new"),(null===(i=null===(t=e.listData)||void 0===t?void 0:t.extraActions)||void 0===i?void 0:i.length)>0&&n.push.apply(n,e.listData.extraActions),n.filter((function(e){return!e.vIfAction}))})),dynamicFilter:(0,n.S6)((function(){var t,i,n;return(null===(t=e.listData.read)||void 0===t?void 0:t.filters)&&Object.keys(null===(i=e.listData.read)||void 0===i?void 0:i.filters).length>0?null===(n=e.listData.read)||void 0===n?void 0:n.filters:{}})),systemName:(0,n.S6)((function(){var t,i,n;return(null===(t=e.listData.read)||void 0===t?void 0:t.systemName)||(null===(i=e.listData)||void 0===i?void 0:i.permission)||(null===(n=e.listData)||void 0===n?void 0:n.entityName)}))},l={init:function(){return q(this,void 0,void 0,(function(){return $(this,(function(e){switch(e.label){case 0:return[4,l.setPageActions()];case 1:return e.sent(),[4,l.setColumns()];case 2:return e.sent(),dynamicFilter||l.getData({pagination:{page:1}},!0),[2]}}))}))},setPageActions:function(){var t;(null===(t=e.listData)||void 0===t?void 0:t.read.filters)&&(a.loadPageActions=!0)},search:function(t){t?a.requestParams.filter={search:t}:a.requestParams=x({},e.listData.read.requestParams),a.requestParams["filter"]=x(x({},a.requestParams["filter"]),a.dynamicFilterValues),a.pagination.page=1,a.pagination.take=10,l.getData()},setColumns:function(){a.columns=e.listData.read.columns,a.columns.forEach((function(e){e["isEditable"]=o.hasPermission.value["edit"]&&e.hasOwnProperty("dynamicField")}))},setPagination:function(e){var t=e.rowsPerPage>a.pagination.rowsNumber;a.pagination=x(x({},a.pagination),e),t&&l.getData()},getData:function(i,n){var o,l,r,s,c,d;return void 0===i&&(i=!1),void 0===n&&(n=!1),q(this,void 0,void 0,(function(){var u;return $(this,(function(m){return(null===(l=null===(o=e.listData.read)||void 0===o?void 0:o.requestParams)||void 0===l?void 0:l.include)&&(a.requestParams.include=e.listData.read.requestParams.include),a.requestParams.filter=x(x(x({},(null===(r=a.requestParams)||void 0===r?void 0:r.filter)||{}),(null===(c=null===(s=e.listData.read)||void 0===s?void 0:s.requestParams)||void 0===c?void 0:c.filter)||{}),a.dynamicFilterValues),a.requestParams["page"]=(null===i||void 0===i?void 0:i.page)||a.pagination.page,a.requestParams["take"]=a.pagination.rowsPerPage,u=(null===(d=a.pagination)||void 0===d?void 0:d.sortBy)||"id",a.requestParams.filter.order={field:u,way:void 0!=a.pagination.descending?a.pagination.descending?"desc":"asc":"desc"},a.loading=!0,k.getData(e.listData.apiRoute,n,a.requestParams).then((function(e){a.expiresIn=null===e||void 0===e?void 0:e.expiresIn,(null===e||void 0===e?void 0:e.data)&&(a.rows=e.data,a.loading=!1,a.pagination.page=(0,Q.ct)(null===e||void 0===e?void 0:e.meta.page.currentPage),a.pagination.rowsNumber=(0,Q.ct)(null===e||void 0===e?void 0:e.meta.page.total),a.pagination.rowsPerPage=(0,Q.ct)(a.pagination.rowsPerPage),a.pagination.descending=(0,Q.ct)(a.pagination.descending),t("dataLoaded",e.data))})).catch((function(e){a.loading=!1,Q.Qb.error({message:Q._s.tr("isite.cms.message.errorRequest"),pos:"bottom"})})),[2]}))}))},updateRow:function(i){var n=a.rows.findIndex((function(e){return e.id==i.id}));a.rows[n]["isLoading"]=!0,k.updateItem(e.listData.apiRoute,i.id,i).then((function(o){var l;if(null===o||void 0===o?void 0:o.data){var r=(null===(l=e.listData.read)||void 0===l?void 0:l.requestParams)?x({},e.listData.read.requestParams):{};k.showItem(e.listData.apiRoute,i.id,{params:r,refresh:!0}).then((function(e){a.rows[n]=e.data,a.rows[n]["isLoading"]=!1,t("updatedRow",e.data)}))}}))},reloadRow:function(t){var i;return q(this,void 0,void 0,(function(){var n,o;return $(this,(function(l){switch(l.label){case 0:return n=a.rows.findIndex((function(e){return e.id==t.id})),a.rows[n]["isLoading"]=!0,o=(null===(i=e.listData.read)||void 0===i?void 0:i.requestParams)?x({},e.listData.read.requestParams):{},[4,k.showItem(e.listData.apiRoute,t.id,{params:o,refresh:!0}).then((function(e){a.rows[n]=e.data,a.rows[n]["isLoading"]=!1}))];case 1:return l.sent(),[2,a.rows[n]]}}))}))},toggleDynamicFilterModal:function(){a.showDynamicFilterModal=!a.showDynamicFilterModal},updateFilter:function(e,t){a.dynamicFilterValues[e]=t},updateDynamicFilterValues:function(e){a.dynamicFilterValues=e,a.requestParams.filter=a.dynamicFilterValues,a.pagination.page=1,l.getData()}};return(0,n.u2)((function(){l.init()})),x(x(x(x({},i),(0,b.kx)(a)),o),l)}var A=i(264),M={id:"dynamic-table"},W={key:1},R={class:"col-12 q-ml-sm q-mr-lg flex flex-center"},F={class:"flex items-center"},S={class:"flex items-center tw-mr-4 text-blue-grey"},T={class:"sm:tw-text-sm"},L={class:"sm:tw-text-sm"},E={class:"actionsBtnPag"},C=(0,n.QD)("i",{class:"fa-solid fa-chevron-left"},null,-1),z=(0,n.QD)("i",{class:"fa-solid fa-chevron-right"},null,-1);function V(e,t,i,o,l,r){var s=(0,n.E1)("q-inner-loading"),c=(0,n.E1)("contextMenu"),d=(0,n.E1)("editablePopup"),u=(0,n.E1)("btn-menu"),m=(0,n.E1)("contentType"),f=(0,n.E1)("q-td"),p=(0,n.E1)("q-tr"),v=(0,n.E1)("q-pagination"),g=(0,n.E1)("q-select"),h=(0,n.E1)("q-btn"),w=(0,n.E1)("q-table");return(0,n.Wz)(),(0,n.An)("div",M,[(0,n.K2)(w,(0,n.Gu)(e.tableProps,{title:e.title,loading:e.loading,rows:e.rows,columns:e.columns,"row-key":"name",pagination:e.pagination,"onUpdate:pagination":t[5]||(t[5]=function(t){return e.pagination=t}),"hide-pagination":"",onRequest:t[6]||(t[6]=function(){console.log("request")})}),{loading:(0,n.Ql)((function(){return[(0,n.K2)(s,{showing:"",color:"primary"})]})),body:(0,n.Ql)((function(i){return[(0,n.K2)(p,{props:i},{default:(0,n.Ql)((function(){return[(0,n.K2)(c,{actions:e.actions,"action-data":i.row},null,8,["actions","action-data"]),((0,n.Wz)(!0),(0,n.An)(n.ae,null,(0,n.mi)(i.cols,(function(o){var l;return(0,n.Wz)(),(0,n.Az)(f,{key:o.name,props:i,class:(0,a.WN)("".concat(!(null===o||void 0===o?void 0:o.dynamicField)&&!(null===o||void 0===o?void 0:o.onClick)||(null===(l=i.row)||void 0===l?void 0:l.isLoading)?"":"cursor-pointer"))},{default:(0,n.Ql)((function(){var a;return["actions"!=o.name&&(null===o||void 0===o?void 0:o.dynamicField)&&!(null===(a=i.row)||void 0===a?void 0:a.isLoading)?((0,n.Wz)(),(0,n.Az)(d,{key:0,row:i.row,col:o,beforeUpdate:e.beforeUpdate,onUpdateRow:t[0]||(t[0]=function(t){return e.$emit("updateRow",t)})},null,8,["row","col","beforeUpdate"])):(0,n.g1)("",!0),"actions"==o.name?((0,n.Wz)(),(0,n.An)("div",W,[(0,n.K2)(u,{actions:e.actions,"action-data":i.row},null,8,["actions","action-data"])])):(0,n.g1)("",!0),"actions"!=o.name?((0,n.Wz)(),(0,n.Az)(m,{key:2,col:o,row:i.row},null,8,["col","row"])):(0,n.g1)("",!0)]})),_:2},1032,["props","class"])})),128))]})),_:2},1032,["props"])]})),bottom:(0,n.Ql)((function(i){return[(0,n.QD)("div",{class:(0,a.WN)("bottonCrud full-width flex items-center ".concat("mobile"==e.windowSize?"justify-center":"justify-between"))},[(0,n.QD)("div",{class:(0,a.WN)(["sm:tw-text-sm","text-blue-grey ".concat("mobile"==e.windowSize?"q-mb-sm":""," ")])},[(0,n.mY)((0,a.WA)(e.$tr("isite.cms.label.showing"))+" ",1),(0,n.QD)("b",null,(0,a.WA)(e.countPage(i)),1),(0,n.mY)(" "+(0,a.WA)(e.$trp("isite.cms.label.entry")),1)],2),(0,n.QD)("div",R,[e.showPagination(i)?((0,n.Wz)(),(0,n.Az)(v,{key:0,id:"crudPaginationComponent",modelValue:e.pagination.page,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.pagination.page=t}),value:i.pagination,onClick:t[2]||(t[2]=(0,A.Y7)((function(){return e.$emit("onPagination",e.pagination)}),["prevent"])),round:"","input-class":"no-shadow",color:"while","text-color":"primary","active-color":"primary","active-text-color":"white",max:i.pagesNumber,"max-pages":6,ellipses:!1,"boundary-numbers":!1,unelevated:""},null,8,["modelValue","value","max"])):(0,n.g1)("",!0)]),(0,n.QD)("div",F,[(0,n.QD)("div",S,[(0,n.QD)("span",T,(0,a.WA)(e.$tr("isite.cms.label.show")),1),(0,n.K2)(g,{modelValue:e.pagination.rowsPerPage,"onUpdate:modelValue":[t[3]||(t[3]=function(t){return e.pagination.rowsPerPage=t}),t[4]||(t[4]=function(t){return e.$emit("onPagination",e.pagination)})],options:e.rowsPerPageOption,"options-cover":"",dense:"",class:"q-mx-sm text-caption",outlined:""},null,8,["modelValue","options"]),(0,n.QD)("span",L,(0,a.WA)(e.$trp("isite.cms.label.entry")),1)]),(0,n.QD)("div",E,[(0,n.K2)(h,{color:"primary",class:"tw-mr-2",dense:"",size:"14px",round:"",flat:"",disable:i.isFirstPage,onClick:i.prevPage},{default:(0,n.Ql)((function(){return[C]})),_:2},1032,["disable","onClick"]),(0,n.K2)(h,{color:"primary",dense:"",size:"14px",round:"",flat:"",disable:i.isLastPage,onClick:i.nextPage},{default:(0,n.Ql)((function(){return[z]})),_:2},1032,["disable","onClick"])])])],2)]})),_:1},16,["title","loading","rows","columns","pagination"])])}var _=function(){return _=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var a in t=arguments[i],t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},_.apply(this,arguments)};function K(e,t){(0,n._S)().appContext.config.globalProperties;var i={pagination:(0,b.IL)({page:1,rowsPerPage:10,descending:!0})},a=(0,b.cB)({}),o={rowsPerPageOption:(0,n.S6)((function(){return[5,10,20,50,100,300,500]}))},l={countPage:function(t){var i=t.pagination.page,n=t.pagination.rowsPerPage,a=e.initialPagination.rowsNumber,o=e.initialPagination.rowsNumber,l=1==i?1:i*n-(n-(i-1)<=0?1:n-(i-1)),r=a<n?o:i*n;return"".concat(l," - ").concat(r," ").concat(Q._s.tr("isite.cms.label.of")," ").concat(o)}};return(0,n.u2)((function(){})),_(_(_(_({},i),(0,b.kx)(a)),o),l)}var O={class:"q-py-sm"},U={class:"row justify-center q-gutter-sm"};function I(e,t,i,o,l,r){var s,c,d=(0,n.E1)("dynamic-field"),u=(0,n.E1)("q-btn"),m=(0,n.E1)("q-form"),f=(0,n.E1)("q-popup-edit");return(null===(s=e.col)||void 0===s?void 0:s.isEditable)&&(null===(c=e.col)||void 0===c?void 0:c.dynamicField)?((0,n.Wz)(),(0,n.Az)(f,{key:0,ref:"popupEditRef",modelValue:e.row[e.col.name],"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.row[e.col.name]=t}),"no-caps":"",cover:!1,anchor:"bottom start","transition-show":"fade-in","transition-hide":"fade-out","max-width":e.maxWidth},{default:(0,n.Ql)((function(i){return[(0,n.K2)(m,{autocorrect:"off",autocomplete:"off",ref:"formContent",onSubmit:function(t){return e.runBeforeUpdate(i)},onValidationError:t[1]||(t[1]=function(t){return e.$alert.error(e.$tr("isite.cms.message.formInvalid"))})},{default:(0,n.Ql)((function(){return[(0,n.QD)("p",null,"Update "+(0,a.WA)(e.col.label)+" Id: "+(0,a.WA)(e.row.id),1),(0,n.QD)("div",O,[e.isSelectField?((0,n.Wz)(),(0,n.Az)(d,{key:0,modelValue:i.value.id,"onUpdate:modelValue":function(e){return i.value.id=e},field:e.col["dynamicField"],enableCache:!0},null,8,["modelValue","onUpdate:modelValue","field"])):((0,n.Wz)(),(0,n.Az)(d,{key:1,modelValue:i.value,"onUpdate:modelValue":function(e){return i.value=e},field:e.col["dynamicField"],enableCache:!0},null,8,["modelValue","onUpdate:modelValue","field"])),(0,n.QD)("div",U,[(0,n.K2)(u,{label:"Close","no-caps":"",unelevated:"",rounded:"",onClick:(0,A.Y7)(i.cancel,["stop","prevent"])},null,8,["onClick"]),(0,n.K2)(u,{label:"Update","no-caps":"",unelevated:"",rounded:"",onClick:t[0]||(t[0]=function(t){return e.$refs.formContent.submit()}),disable:!1===i.validate(i.value)||i.initialValue===i.value},null,8,["disable"])])])]})),_:2},1032,["onSubmit"])]})),_:1},8,["modelValue","max-width"])):(0,n.g1)("",!0)}var N=function(){return N=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var a in t=arguments[i],t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},N.apply(this,arguments)},Y=function(e,t,i,n){function a(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function l(e){try{s(n.next(e))}catch(t){o(t)}}function r(e){try{s(n["throw"](e))}catch(t){o(t)}}function s(e){e.done?i(e.value):a(e.value).then(l,r)}s((n=n.apply(e,t||[])).next())}))},B=function(e,t){var i,n,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(e){return function(t){return s([e,t])}}function s(r){if(i)throw new TypeError("Generator is already executing.");while(o&&(o=0,r[0]&&(l=0)),l)try{if(i=1,n&&(a=2&r[0]?n["return"]:r[0]?n["throw"]||((a=n["return"])&&a.call(n),0):n.next)&&!(a=a.call(n,r[1])).done)return a;switch(n=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,n=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){l.label=r[1];break}if(6===r[0]&&l.label<a[1]){l.label=a[1],a=r;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(r);break}a[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(s){r=[6,s],n=0}finally{i=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};function j(e,t){var i={},a=(0,b.cB)({dynamicModel:null}),o={maxWidth:(0,n.S6)((function(){var t;return(null===(t=e.col.dynamicField)||void 0===t?void 0:t.maxWidth)?e.col.dynamicField.maxWidth:"300px"})),isSelectField:(0,n.S6)((function(){return"select"==e.col.dynamicField.type})),fieldName:(0,n.S6)((function(){var t;return(null===(t=e.col.dynamicField)||void 0===t?void 0:t.name)?e.col.dynamicField.name:e.col.name}))},l={runBeforeUpdate:function(i){return Y(this,void 0,void 0,(function(){var n,a,l;return B(this,(function(r){switch(r.label){case 0:return n=!0,a=o.isSelectField.value?i.value.id:i.value,l=N({},e.row),l[o.fieldName.value]=a,e.beforeUpdate?[4,e.beforeUpdate({val:a,row:l,col:e.col}).then((function(e){i.set(),t("updateRow",l)})).catch((function(e){i.value=i.initialValue,n=!1}))]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2,n]}}))}))}};return(0,n.u2)((function(){})),N(N(N(N({},i),(0,b.kx)(a)),o),l)}const H=(0,n._M)({props:{row:{type:Object,default:null},col:{type:Object,default:null},beforeUpdate:{type:Function,default:function(){}}},setup:function(e,t){var i=t.emit;return j(e,i)},components:{}});var G=i(68716),J=i(86742),X=i(14288),Z=i(99140),ee=i(95252),te=i.n(ee);const ie=(0,G.c)(H,[["render",I]]),ne=ie;te()(H,"components",{QPopupEdit:J.c,QForm:X.c,QBtn:Z.c});var ae=["innerHTML"];function oe(e,t,i,o,l,r){var s,c=(0,n.E1)("q-skeleton");return(0,n.Wz)(),(0,n.An)("div",{style:(0,a.MN)(null===(s=e.col)||void 0===s?void 0:s.style)},[e.component?(0,n.wt)(((0,n.Wz)(),(0,n.Az)((0,n.mk)(e.component),{key:0,col:e.col,row:e.row,val:e.val},null,8,["col","row","val"])),[[A.Ub,!e.isLoading]]):(0,n.g1)("",!0),e.isComponent?(0,n.g1)("",!0):(0,n.wt)(((0,n.Wz)(),(0,n.An)("div",{key:1,class:(0,a.WN)(["ellipsis tw-flex-1 tw-min-w-1",{"content-type-onclick":e.isClickeable}]),innerHTML:e.val,onClick:t[0]||(t[0]=function(t){return e.onClick({val:e.val,col:e.col,row:e.row})})},null,10,ae)),[[A.Ub,!e.isLoading]]),e.isLoading?((0,n.Wz)(),(0,n.Az)(c,{key:2,animated:"",type:"text"})):(0,n.g1)("",!0)],4)}var le=function(){return le=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var a in t=arguments[i],t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},le.apply(this,arguments)};function re(e,t){var i={},a=(0,b.cB)({component:(0,b.kl)()}),o={val:(0,n.S6)((function(){var t,i,n=(null===(t=e.col)||void 0===t?void 0:t.deleteHtml)?l.deleteHtml(e.row[e.col.name]):e.row[e.col.name];return(null===(i=e.col)||void 0===i?void 0:i.format)?e.col.format({val:n,col:e.col,row:e.row}):n})),onClick:(0,n.S6)((function(){var t;return(null===(t=e.col)||void 0===t?void 0:t.onClick)?e.col.onClick:function(){}})),isClickeable:(0,n.S6)((function(){var t;return!!(null===(t=e.col)||void 0===t?void 0:t.onClick)})),isComponent:(0,n.S6)((function(){var t;return(null===(t=e.col)||void 0===t?void 0:t.component)||!1})),isLoading:(0,n.S6)((function(){var t;return(null===(t=e.row)||void 0===t?void 0:t.isLoading)||!1})),showOnLoading:(0,n.S6)((function(){return o.isLoading.value&&"id"!=e.col.name}))},l={init:function(){l.loadComponent()},loadComponent:function(){o.isComponent.value&&(a.component=(0,b.Md)(e.col.component))},deleteHtml:function(e){return e?"string"===typeof e?e.replace(/<[^>]+>/g,""):e:""}};return(0,n.u2)((function(){l.init()})),le(le(le(le({},i),(0,b.kx)(a)),o),l)}const se=(0,n._M)({props:{col:{default:[]},row:{default:[]}},setup:function(e,t){var i=t.emit;return re(e,i)}});var ce=i(39692);const de=(0,G.c)(se,[["render",oe]]),ue=de;te()(se,"components",{QSkeleton:ce.cp});var me={class:"row items-center text-blue-grey"};function fe(e,t,i,o,l,r){var s=(0,n.E1)("q-icon"),c=(0,n.E1)("q-item-section"),d=(0,n.E1)("q-item"),u=(0,n.E1)("q-list"),m=(0,n.E1)("q-menu"),f=(0,n.iS)("close-popup");return(0,n.Wz)(),(0,n.Az)(m,{"touch-position":"","context-menu":"","max-width":"200px",class:"btn-menu-component__menu",anchor:"bottom right",self:"top right"},{default:(0,n.Ql)((function(){return[(0,n.K2)(u,{dense:"",separator:""},{default:(0,n.Ql)((function(){return[((0,n.Wz)(!0),(0,n.An)(n.ae,null,(0,n.mi)(e.actions,(function(t,i){return(0,n.wt)(((0,n.Wz)(),(0,n.Az)(d,(0,n.Gu)(t.props,{onClick:function(i){return e.runAction(t)}}),{default:(0,n.Ql)((function(){return[(0,n.K2)(c,null,{default:(0,n.Ql)((function(){return[(0,n.QD)("div",me,[(0,n.K2)(s,{name:t.icon,color:"blue-grey",size:"16px"},null,8,["name"]),(0,n.mY)("   "+(0,a.WA)(t.label||t.tooltip),1)])]})),_:2},1024)]})),_:2},1040,["onClick"])),[[f]])})),256))]})),_:1})]})),_:1})}var pe=function(e,t,i,n){function a(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function l(e){try{s(n.next(e))}catch(t){o(t)}}function r(e){try{s(n["throw"](e))}catch(t){o(t)}}function s(e){e.done?i(e.value):a(e.value).then(l,r)}s((n=n.apply(e,t||[])).next())}))},ve=function(e,t){var i,n,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(e){return function(t){return s([e,t])}}function s(r){if(i)throw new TypeError("Generator is already executing.");while(o&&(o=0,r[0]&&(l=0)),l)try{if(i=1,n&&(a=2&r[0]?n["return"]:r[0]?n["throw"]||((a=n["return"])&&a.call(n),0):n.next)&&!(a=a.call(n,r[1])).done)return a;switch(n=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,n=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){l.label=r[1];break}if(6===r[0]&&l.label<a[1]){l.label=a[1],a=r;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(r);break}a[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(s){r=[6,s],n=0}finally{i=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};const ge=(0,n._M)({props:{actions:{default:[]},actionData:{default:[]}},methods:{runAction:function(e){return pe(this,void 0,void 0,(function(){var t;return ve(this,(function(i){switch(i.label){case 0:return t=this.$clone(this.actionData||{}),e.action?[4,e.action(t)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}}});var he=i(93832),we=i(99588),ye=i(84884),be=i(11032),De=i(58120),ke=i(81020);const Qe=(0,G.c)(ge,[["render",fe]]),xe=Qe;te()(ge,"components",{QMenu:he.c,QList:we.c,QItem:ye.c,QItemSection:be.c,QIcon:De.c}),te()(ge,"directives",{ClosePopup:ke.c});const qe=(0,n._M)({props:{tableProps:{default:null},loading:{default:!1},title:{default:""},columns:{default:[]},rows:{default:[]},actions:{default:[]},initialPagination:{default:[]},beforeUpdate:{type:Function,default:function(){}}},components:{editablePopup:ne,contextMenu:xe,contentType:ue},setup:function(e,t){var i=t.emit;return K(e,i)},computed:{windowSize:function(){return window.innerWidth>="500"?"desktop":"mobile"}},methods:{showPagination:function(e){return"desktop"==this.windowSize&&e.pagesNumber>1}}});var $e=i(40792),Pe=i(23372),Ae=i(45144),Me=i(50213),We=i(15496),Re=i(36008);const Fe=(0,G.c)(qe,[["render",V]]),Se=Fe;te()(qe,"components",{QTable:$e.c,QInnerLoading:Pe.c,QTr:Ae.c,QTd:Me.c,QPagination:We.c,QSelect:Re.c,QBtn:Z.c});var Te=i(1436);const Le=(0,n._M)({props:{listData:{apiRoute:{default:""},title:{default:""},columns:{default:[]},actions:{default:[]},permission:{default:""},requestParams:{default:{}},filters:{default:{}},help:{default:{}},pageActions:{default:!0},beforeUpdate:{type:Function,default:function(){}}}},components:{dynamicTable:Se,dynamicFilter:Te.c},setup:function(e,t){var i=t.emit;return P(e,i)}}),Ee=(0,G.c)(Le,[["render",y]]),Ce=Ee;te()(Le,"components",{QTable:$e.c,QBtn:Z.c});var ze={class:"flex justify-center items-center",style:{width:"140px",height:"36px",padding:"8px"}},Ve={class:"ellipsis"};function _e(e,t,i,o,l,r){var s,c,d=(0,n.iS)("ripple");return e.val?(0,n.wt)(((0,n.Wz)(),(0,n.An)("div",{key:0,style:(0,a.MN)({"background-color":e.background,color:e.color})},[(0,n.QD)("div",ze,[(0,n.QD)("div",Ve,[(null===(s=e.val)||void 0===s?void 0:s.icon)?((0,n.Wz)(),(0,n.An)("i",{key:0,class:(0,a.WN)(null===(c=e.val)||void 0===c?void 0:c.icon)},null,2)):(0,n.g1)("",!0),(0,n.mY)("  "+(0,a.WA)(e.val.title),1)])])],4)),[[d]]):(0,n.g1)("",!0)}const Ke=(0,n._M)({props:{row:{default:{}},col:{default:{}},val:{default:{}}},computed:{background:function(){var e;return(null===(e=this.val)||void 0===e?void 0:e.color)?this.val.color:"#000000"},color:function(){var e;return(null===(e=this.val)||void 0===e?void 0:e.color)?"#ffffff":"#000000"}}});var Oe=i(85220);const Ue=(0,G.c)(Ke,[["render",_e]]),Ie=Ue;te()(Ke,"directives",{Ripple:Oe.c});var Ne={key:0,style:{width:"90px"}},Ye={class:"full-width"};function Be(e,t,i,o,l,r){var s=(0,n.E1)("q-tooltip"),c=(0,n.E1)("q-chip");return e.val?((0,n.Wz)(),(0,n.An)("div",Ne,[(0,n.K2)(c,{outline:"","text-color":"white",color:e.state.color,class:"q-py-none full-width"},{default:(0,n.Ql)((function(){var t;return[(0,n.QD)("div",Ye,[(null===(t=e.state)||void 0===t?void 0:t.icon)?((0,n.Wz)(),(0,n.An)("i",{key:0,class:(0,a.WN)(e.state.icon)},null,2)):(0,n.g1)("",!0),(0,n.mY)("  "+(0,a.WA)(e.date)+" ",1),(0,n.K2)(s,null,{default:(0,n.Ql)((function(){return[(0,n.mY)((0,a.WA)(e.val),1)]})),_:1})])]})),_:1},8,["color"])])):(0,n.g1)("",!0)}var je=i(49456),He=i.n(je),Ge="YYYY/MM/DD",Je={notExpired:{color:"gray",icon:""},expired:{color:"red",icon:"fa-regular fa-calendar-circle-exclamation"}};const Xe=(0,n._M)({props:{row:{default:{}},col:{default:{}},val:{default:{}}},computed:{state:function(){return He()().format(Ge)>He()(this.val).format(Ge)?Je.expired:Je.notExpired},date:function(){return He()(this.val).format("MMM D")}}});var Ze=i(84256),et=i(90111);const tt=(0,G.c)(Xe,[["render",Be]]),it=tt;te()(Xe,"components",{QChip:Ze.c,QTooltip:et.c});var nt={class:"q-mb-md"},at={class:"row q-gutter-x-md items-center"},ot={class:"q-gutter-y-xs"},lt={class:"q-gutter-y-xs"},rt={class:"q-gutter-y-xs"},st={class:"q-py-md"},ct={class:"time-logs-format"},dt={key:0,class:"q-mt-sm"},ut={class:"text-weight-medium"};function mt(e,t,i,o,l,r){var s,c=(0,n.E1)("dynamic-field"),d=(0,n.E1)("q-btn"),u=(0,n.E1)("q-separator"),m=(0,n.E1)("q-item-label"),f=(0,n.E1)("q-item-section"),p=(0,n.E1)("q-item"),v=(0,n.E1)("q-list"),g=(0,n.E1)("q-scroll-area"),h=(0,n.E1)("inner-loading");return(0,n.Wz)(),(0,n.An)("div",null,[(0,n.QD)("div",nt,[(0,n.QD)("p",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.total"))+" : "+(0,a.WA)(e.row.totalFormatedTimelogsDuration),1)]),(0,n.QD)("div",at,[(0,n.QD)("div",ot,[(0,n.QD)("p",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.startDate")),1),(0,n.K2)(c,{modelValue:e.dateModel,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.dateModel=t}),field:e.dateField,style:{width:"160px"}},null,8,["modelValue","field"])]),(0,n.QD)("div",lt,[(0,n.QD)("p",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.timeSpent")),1),(0,n.K2)(c,{modelValue:e.timeSpentModel,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.timeSpentModel=t}),field:e.timeSpentField,style:{width:"160px"}},null,8,["modelValue","field"])]),(0,n.QD)("div",rt,[(0,n.K2)(d,{label:e.$tr("isite.cms.label.save"),rounded:"","no-caps":"",unelevated:"",color:"primary",onClick:t[2]||(t[2]=function(){return e.createTimeLog()}),disable:e.disableButton},null,8,["label","disable"])])]),(0,n.QD)("div",st,[(0,n.QD)("p",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.format.title")),1),(0,n.QD)("ul",ct,[(0,n.QD)("li",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.format.weeks")),1),(0,n.QD)("li",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.format.days")),1),(0,n.QD)("li",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.format.hours")),1),(0,n.QD)("li",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.format.minutes")),1)])]),(null===(s=e.row.timelogs)||void 0===s?void 0:s.length)?((0,n.Wz)(),(0,n.An)("div",dt,[(0,n.K2)(u,{class:"q-my-sm"}),(0,n.K2)(g,{style:{height:"220px"},visible:""},{default:(0,n.Ql)((function(){return[(0,n.K2)(v,null,{default:(0,n.Ql)((function(){return[((0,n.Wz)(!0),(0,n.An)(n.ae,null,(0,n.mi)(e.row.timelogs,(function(t,i){return(0,n.Wz)(),(0,n.Az)(p,{key:i},{default:(0,n.Ql)((function(){return[(0,n.K2)(f,null,{default:(0,n.Ql)((function(){return[(0,n.K2)(m,{class:"q-gutter-x-xs"},{default:(0,n.Ql)((function(){return[(0,n.QD)("span",ut,(0,a.WA)(e.createdBy(t)),1),(0,n.QD)("span",null,(0,a.WA)(t.formatedTimeSpent),1)]})),_:2},1024),(0,n.K2)(m,{caption:"",lines:"1"},{default:(0,n.Ql)((function(){return[(0,n.mY)((0,a.WA)(e.$trd(t.createdAt)),1)]})),_:2},1024)]})),_:2},1024),(0,n.K2)(f,{side:"",top:""},{default:(0,n.Ql)((function(){return[(0,n.K2)(m,{caption:""},{default:(0,n.Ql)((function(){return[(0,n.K2)(d,{label:e.$tr("isite.cms.label.delete"),onClick:function(i){return e.deleteTimeLog(t)},rounded:"","no-caps":"",unelevated:"",dense:"",color:"grey-3","text-color":"grey-8",class:"q-px-md"},null,8,["label","onClick"])]})),_:2},1024)]})),_:2},1024)]})),_:2},1024)})),128))]})),_:1})]})),_:1})])):(0,n.g1)("",!0),(0,n.K2)(h,{visible:e.loading},null,8,["visible"])])}const ft={createItem:function(e,t,i){return void 0===i&&(i={params:{}}),new Promise((function(n,a){D.c.create(e,t,i).then((function(e){n(e)})).catch((function(e){return a(e)}))}))},deleteItem:function(e,t){return new Promise((function(i,n){D.c.delete(e,t,{}).then((function(e){i(e)})).catch((function(e){return n(e)}))}))}};var pt=function(){return pt=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var a in t=arguments[i],t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},pt.apply(this,arguments)},vt=function(e,t,i,n){function a(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function l(e){try{s(n.next(e))}catch(t){o(t)}}function r(e){try{s(n["throw"](e))}catch(t){o(t)}}function s(e){e.done?i(e.value):a(e.value).then(l,r)}s((n=n.apply(e,t||[])).next())}))},gt=function(e,t){var i,n,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(e){return function(t){return s([e,t])}}function s(r){if(i)throw new TypeError("Generator is already executing.");while(o&&(o=0,r[0]&&(l=0)),l)try{if(i=1,n&&(a=2&r[0]?n["return"]:r[0]?n["throw"]||((a=n["return"])&&a.call(n),0):n.next)&&!(a=a.call(n,r[1])).done)return a;switch(n=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,n=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){l.label=r[1];break}if(6===r[0]&&l.label<a[1]){l.label=a[1],a=r;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(r);break}a[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(s){r=[6,s],n=0}finally{i=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};function ht(e,t){var i="YYYY/MM/DD",a="apiRoutes.qtask.timelogs",o={},l=(0,b.cB)({loading:!1,dateModel:null,dateField:{value:He()().format(i),type:"date"},timeSpentModel:null,timeSpentField:{type:"timeSpent",props:{unit:"minutes"}}}),r={disableButton:(0,n.S6)((function(){return null==l.timeSpentModel||""==l.timeSpentModel}))},s={init:function(){},createTimeLog:function(){var t={taskId:e.row.id,timeSpent:l.timeSpentModel,createdAt:l.dateModel?l.dateModel:He()().format(i)};l.loading=!0,ft.createItem(a,t).then((function(e){l.timeSpentModel=null,l.loading=!1,Q.Qb.info({message:Q._s.tr("isite.cms.message.recordCreated")}),s.reloadRow()}))},deleteTimeLog:function(e){var t=this;Q.Qb.error({mode:"modal",title:"ID: ".concat(e.id),message:Q._s.tr("isite.cms.message.deleteRecord"),actions:[{label:Q._s.tr("isite.cms.label.cancel"),color:"grey"},{label:Q._s.tr("isite.cms.label.delete"),color:"red",handler:function(){return vt(t,void 0,void 0,(function(){return gt(this,(function(t){return l.loading=!0,ft.deleteItem(a,e.id).then((function(e){s.reloadRow(),l.loading=!1})),[2]}))}))}}]})},reloadRow:function(){t("reloadRow",e.row)},createdBy:function(e){var t;return(null===(t=e.creator)||void 0===t?void 0:t.firstName)?"".concat(e.creator.firstName," ").concat(e.creator.lastName):e.creator.email}};return(0,n.u2)((function(){s.init()})),pt(pt(pt(pt({},o),(0,b.kx)(l)),r),s)}const wt=(0,n._M)({props:{row:{default:{}}},setup:function(e,t){var i=t.emit;return ht(e,i)}});var yt=i(70880),bt=i(94380),Dt=i(2992);const kt=(0,G.c)(wt,[["render",mt]]),Qt=kt;te()(wt,"components",{QBtn:Z.c,QSeparator:yt.c,QScrollArea:bt.c,QList:we.c,QItem:ye.c,QItemSection:be.c,QItemLabel:Dt.c});var xt={class:"row q-col-gutter-x-md"},qt={class:"col-12 col-md-8"},$t={class:"text-h6"},Pt={class:"q-my-md"},At={class:"text-subtitle2 text-weight-bold"},Mt=["innerHTML"],Wt={class:"col-12 col-md-4"},Rt={class:"q-mb-md task-details q-pa-sm"},Ft={class:"text-subtitle2 text-weight-bold"},St={class:"q-my-xs q-col-gutter-y-sm"},Tt={class:"row"},Lt={class:"col-5"},Et={class:"col-7"},Ct={class:"row"},zt={class:"col-5"},Vt={class:"col-7"},_t={class:"row"},Kt={class:"col-5"},Ot={class:"col-7"},Ut={class:"row"},It={class:"col-5"},Nt={class:"col-7"},Yt={class:"row"},Bt={class:"col-5"},jt={class:"col-7"},Ht={class:"row"},Gt={class:"col-5"},Jt={class:"col-7"},Xt={class:"row"},Zt={class:"col-5"},ei={class:"col-7"},ti={class:"row"},ii={class:"col-5"},ni={class:"col-7"},ai={class:"q-my-md"},oi={class:"text-subtitle2 text-weight-bold"},li={class:"flex justify-end items-center"};function ri(e,t,i,o,l,r){var s=(0,n.E1)("q-scroll-area"),c=(0,n.E1)("q-btn");return(0,n.Wz)(),(0,n.An)("div",xt,[(0,n.QD)("div",qt,[(0,n.K2)(s,{style:{height:"calc(100vh - 173px)"},visible:"",class:"q-pa-md"},{default:(0,n.Ql)((function(){return[(0,n.QD)("div",null,[(0,n.QD)("span",$t,(0,a.WA)(e.row.title),1)]),(0,n.QD)("div",Pt,[(0,n.QD)("span",At,(0,a.WA)(e.$tr("isite.cms.form.description"))+": ",1),(0,n.QD)("div",{class:"q-my-xs",innerHTML:e.row.description},null,8,Mt)])]})),_:1})]),(0,n.QD)("div",Wt,[(0,n.QD)("div",Rt,[(0,n.QD)("span",Ft,(0,a.WA)(e.$tr("isite.cms.details")),1),(0,n.QD)("div",St,[(0,n.QD)("div",Tt,[(0,n.QD)("div",Lt,(0,a.WA)(e.$tr("isite.cms.form.category"))+" : ",1),(0,n.QD)("div",Et,(0,a.WA)(e.row.category.title),1)]),(0,n.QD)("div",Ct,[(0,n.QD)("div",zt,(0,a.WA)(e.$tr("isite.cms.form.status"))+" : ",1),(0,n.QD)("div",Vt,(0,a.WA)(e.row.status.title),1)]),(0,n.QD)("div",_t,[(0,n.QD)("div",Kt,(0,a.WA)(e.$tr("itask.cms.form.priority"))+" : ",1),(0,n.QD)("div",Ot,(0,a.WA)(e.row.priority.title),1)]),(0,n.QD)("div",Ut,[(0,n.QD)("div",It,(0,a.WA)(e.$tr("itask.cms.form.assigned"))+": ",1),(0,n.QD)("div",Nt,(0,a.WA)(e.assignedTo),1)]),(0,n.QD)("div",Yt,[(0,n.QD)("div",Bt,(0,a.WA)(e.$tr("itask.cms.form.estimatedTime"))+": ",1),(0,n.QD)("div",jt,(0,a.WA)(e.row.formatedEstimatedTime),1)]),(0,n.QD)("div",Ht,[(0,n.QD)("div",Gt,(0,a.WA)(e.$tr("itask.cms.duration"))+": ",1),(0,n.QD)("div",Jt,(0,a.WA)(e.row.duration),1)]),(0,n.QD)("div",Xt,[(0,n.QD)("div",Zt,(0,a.WA)(e.$tr("isite.cms.form.startDate"))+": ",1),(0,n.QD)("div",ei,(0,a.WA)(e.row.startDate),1)]),(0,n.QD)("div",ti,[(0,n.QD)("div",ii,(0,a.WA)(e.$tr("isite.cms.form.endDate"))+": ",1),(0,n.QD)("div",ni,(0,a.WA)(e.row.endDate),1)])]),(0,n.QD)("div",ai,[(0,n.QD)("div",null,[(0,n.QD)("span",oi,(0,a.WA)(e.$tr("itask.cms.timeLogs.title"))+": ",1)]),(0,n.QD)("div",null,[(0,n.K2)(c,{"text-color":"primary",unelevated:"","no-caps":"",label:"".concat(e.row.totalFormatedTimelogsDuration),onClick:t[0]||(t[0]=function(t){return e.$emit("openTimeLogsModal",e.row)})},null,8,["label"])])]),(0,n.QD)("div",li,[(0,n.K2)(c,{label:e.$tr("isite.cms.label.edit"),onClick:t[1]||(t[1]=function(){e.$emit("onUpdate",e.row),e.$emit("close")}),"no-caps":"",unelevated:""},null,8,["label"]),(0,n.K2)(c,{label:e.$tr("isite.cms.label.delete"),onClick:t[2]||(t[2]=function(t){return e.$emit("onDelete",e.row)}),"no-caps":"",unelevated:"",class:"q-ml-sm"},null,8,["label"])])])])])}const si=(0,n._M)({props:{row:{default:{}}},computed:{assignedTo:function(){var e,t;return this.row.assignedTo&&((null===(e=this.row.assignedTo)||void 0===e?void 0:e.firstName)||(null===(t=this.row.assignedTo)||void 0===t?void 0:t.lastName))?"".concat(this.row.assignedTo.firstName," ").concat(this.row.assignedTo.lastName):"-"}},methods:{}}),ci=(0,G.c)(si,[["render",ri]]),di=ci;te()(si,"components",{QScrollArea:bt.c,QBtn:Z.c});const ui="YYYY/MM/DD",mi={props:{},components:{dynamicList:Ce,statusComponent:Ie,timeLogsComponent:Qt,taskComponent:di},watch:{},mounted(){this.$nextTick((function(){}))},data(){return{selectedRow:{timeLogsModal:!1,showModal:!1,row:null},tabs:[{value:"table",label:"Table"},{value:"backlog",label:"Backlog"}],tabModel:"table",date:{from:He()().startOf("week").format(ui),to:He()().endOf("week").format(ui),title:this.$tr("itask.cms.week")},dateRangeFilter:{value:{type:"customRange",from:He()().startOf("week").format(ui),to:He()().endOf("week").format(ui)},type:"dateRange",props:{label:"Date",clearable:!1,removeTime:!0,autoClose:!0}},loading:!1,listData:{apiRoute:"apiRoutes.qtask.tasks",permission:"itask.tasks",search:!0,create:{title:this.$tr("itask.cms.newTask")},read:{title:this.$tr("itask.cms.taskManagement"),tableProps:{dense:!0},columns:[{name:"id",label:this.$tr("isite.cms.form.id"),field:"id",style:"",onClick:({row:e})=>this.openShowModal(e)},{name:"title",label:this.$tr("isite.cms.form.title"),field:"title",align:"rigth",style:"max-width: 250px",onClick:({row:e})=>this.openShowModal(e)},{name:"assignedTo",label:this.$tr("itask.cms.form.assigned"),field:"assignedTo",align:"left",format:({val:e})=>e&&(e.firstName||e.lastName)?`${e.firstName} ${e.lastName}`:"-",dynamicField:{value:[],type:"select",name:"assignedToId",props:{label:this.$tr("itask.cms.form.assigned"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.quser.users",select:{label:"email",id:e=>`${e.id}`}}}},{name:"startDate",label:this.$tr("isite.cms.form.startDate"),field:"startDate",align:"center",style:"padding: 0 5px",component:it,dynamicField:{value:"",type:"date",props:{label:this.$tr("isite.cms.form.startDate")}}},{name:"endDate",label:this.$tr("isite.cms.form.endDate"),field:"endDate",align:"center",style:"padding: 0 5px",component:it,dynamicField:{value:"",type:"date",props:{label:this.$tr("isite.cms.form.endDate")}}},{name:"duration",label:this.$tr("itask.cms.duration"),field:"duration",align:"left",format:({val:e})=>e||"-"},{name:"status",label:this.$tr("isite.cms.form.status"),field:"status",align:"center",style:"padding: 0 0 0 5px",component:Ie,dynamicField:{type:"select",name:"statusId",props:{label:this.$tr("isite.cms.form.status"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.statuses",select:{label:"title",id:e=>`${e.id}`}}}},{name:"priority",label:this.$tr("itask.cms.form.priority"),field:"priority",align:"center",style:"padding: 0 5px 0 0",component:Ie,dynamicField:{value:[],type:"select",name:"priorityId",props:{label:this.$tr("itask.cms.form.priority"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.priorities",select:{label:"title",id:e=>`${e.id}`}}}},{name:"estimatedTime",label:this.$tr("itask.cms.form.estimatedTime"),field:"formatedEstimatedTime",align:"left",format:({row:e})=>e?.formatedEstimatedTime?e.formatedEstimatedTime:"-",dynamicField:{value:"",name:"estimatedTime",type:"timeSpent",props:{label:this.$tr("itask.cms.form.estimatedTime"),unit:"minutes"}}},{name:"category",label:this.$tr("isite.cms.form.category"),align:"left",field:"category",format:({val:e})=>e&&e?.title?e.title:"-",dynamicField:{value:[],type:"select",name:"categoryId",props:{label:this.$tr("isite.cms.form.category"),useInput:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.categories",select:{label:"title",id:e=>`${e.id}`}}}},{name:"totalFormatedTimelogsDuration",label:this.$tr("itask.cms.timeLogs.title"),field:"totalFormatedTimelogsDuration",align:"left",format:({val:e})=>e||"-",onClick:({row:e})=>{this.openTimeLogsModal(e)}},{name:"actions",label:this.$tr("isite.cms.form.actions"),align:"center"}],requestParams:{include:"category,status,priority,timelogs.creator,assignedTo",filter:{rangeDate:{from:He()().startOf("week").format(ui),to:He()().endOf("week").format(ui)}}},filters:{assignedToId:{value:[],type:"select",props:{label:this.$tr("itask.cms.form.assigned"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.quser.users",select:{label:"email",id:e=>`${e.id}`}}},priorityId:{value:[],type:"select",props:{label:this.$tr("itask.cms.form.priority"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.priorities",select:{label:"title",id:e=>`${e.id}`}}},categoryId:{value:[],type:"select",props:{label:this.$tr("isite.cms.form.category"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.categories",select:{label:"title",id:e=>`${e.id}`}}},statusId:{value:[],type:"select",props:{label:this.$tr("isite.cms.form.status"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.statuses",select:{label:"title",id:e=>`${e.id}`}}}},help:{title:this.$tr("itask.cms.taskManagement"),description:this.$tr("itask.cms.taskManagement")}},update:{title:this.$tr("itask.cms.taskManagement")},beforeUpdate:({val:e,row:t})=>new Promise(((e,i)=>{""==t.description&&i(t),He()(t.startDate).format(ui)>He()(t.endDate).format(ui)?(this.$alert.error({message:this.$tr("itask.cms.date.error")}),i(t)):e(t)})),actions:[{icon:"fa-light fa-timer",name:"addTimelog",label:this.$tr("itask.cms.timeLogs.title"),action:e=>{this.openTimeLogsModal(e)}},{icon:"fa-light fa-eye",name:"edit",label:this.$tr("isite.cms.label.show"),action:e=>{this.openShowModal(e)}},{icon:"fa-light fa-pencil",name:"edit",label:this.$tr("isite.cms.label.edit"),action:e=>{this.onUpdate(e)}},{icon:"fa-light fa-trash-can",name:"delete",label:this.$tr("isite.cms.label.delete"),action:e=>{this.onDelete(e)}}]}}},computed:{dynamicListTitle(){const e=He()(this.date.from).format("MMM Do"),t=He()(this.date.to).format("MMM Do");return`${this.date.title}:  ${e} - ${t}`}},methods:{init(){},setDate(e,t,i){this.date={from:e,to:t,title:i},this.dateRangeFilter.value={type:"customRange",from:e,to:t},this.listData.read.requestParams.filter["rangeDate"]=this.date,this.$refs.dynamicList.updateFilter("rangeDate",this.date),this.refreshDynamicList()},refreshDynamicList(){(this.selectedRow.showModal||this.selectedRow.timeLogsModal)&&(this.selectedRow.timeLogsModal=!1,this.selectedRow.showModal=!1,this.selectedRow.row=null),this.$refs.dynamicList.getData({pagination:{page:0}},!0)},goToPrevious(){const e=He()(this.date.from).subtract(1,"weeks").startOf("week").format(ui),t=He()(this.date.from).subtract(1,"weeks").endOf("week").format(ui),i=this.$tr("itask.cms.week");this.setDate(e,t,i)},goToNext(){const e=He()(this.date.from).add(1,"weeks").startOf("week").format(ui),t=He()(this.date.to).add(1,"weeks").endOf("week").format(ui),i=this.$tr("itask.cms.week");this.setDate(e,t,i)},setDateRange(e){if(null!=e&&e?.from&&e?.to){const t=He()(e.from).format(ui),i=He()(e.to).format(ui);t==this.date.from&&i==this.date.to||(this.setDate(t,i,e.label),this.$refs.titleModal.hide())}},openTimeLogsModal(e){this.selectedRow.row=e,this.selectedRow.timeLogsModal=!0},async reloadRow(e){const t=await this.$refs.dynamicList.reloadRow(e);this.selectedRow.row=t},openShowModal(e){this.selectedRow.row=e,this.selectedRow.showModal=!0},onUpdate(e){this.$refs.crudComponent.update(e)},onDelete(e){this.$refs.crudComponent.delete(e)}}};var fi=i(38788),pi=i(7628);const vi=(0,G.c)(mi,[["render",f]]),gi=vi;te()(mi,"components",{QTabs:fi.c,QTab:pi.c,QBtn:Z.c,QTooltip:et.c,QPopupEdit:J.c})}}]);