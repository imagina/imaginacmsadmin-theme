"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[1445],{61445:(e,t,s)=>{s.r(t),s.d(t,{default:()=>L});var a=s(61758);const i={id:"pageId",class:"q-layout-page layout-padding"},l={class:"q-mb-lg backend-page"},r={key:0,class:"row q-col-gutter-md"},o={class:"col-12"},d={class:"row q-col-gutter-md"},n={class:"col-12 col-md-7"},c={class:"col-12 col-md-5"},u={class:"col-12 text-right"},m={class:"col-12 relative-position"},p={class:"box"},h={class:"row gutter-y-sm"},b={class:"col-md-12 q-mt-md"};function g(e,t,g,f,$,y){const v=(0,a.g2)("dynamic-field"),D=(0,a.g2)("q-btn"),k=(0,a.g2)("q-form"),q=(0,a.g2)("crud"),F=(0,a.g2)("inner-loading");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",l,[$.success?((0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("div",o,[(0,a.bF)(k,{autocorrect:"off",autocomplete:"off",ref:"formContent",class:"box",onSubmit:y.updateItem,onValidationError:t[5]||(t[5]=t=>e.$alert.error(e.$tr("isite.cms.message.formInvalid")))},{default:(0,a.k6)((()=>[(0,a.Lk)("div",d,[(0,a.Lk)("div",n,[(0,a.bF)(v,{field:y.dynamicFields.name,modelValue:$.subscriptionData.name,"onUpdate:modelValue":t[0]||(t[0]=e=>$.subscriptionData.name=e)},null,8,["field","modelValue"]),(0,a.bF)(v,{field:y.dynamicFields.description,modelValue:$.subscriptionData.description,"onUpdate:modelValue":t[1]||(t[1]=e=>$.subscriptionData.description=e)},null,8,["field","modelValue"]),(0,a.bF)(v,{field:y.dynamicFields.categoryName,modelValue:$.subscriptionData.categoryName,"onUpdate:modelValue":t[2]||(t[2]=e=>$.subscriptionData.categoryName=e)},null,8,["field","modelValue"])]),(0,a.Lk)("div",c,[(0,a.bF)(v,{field:y.dynamicFields.startDate,modelValue:$.subscriptionData.startDate,"onUpdate:modelValue":t[3]||(t[3]=e=>$.subscriptionData.startDate=e)},null,8,["field","modelValue"]),(0,a.bF)(v,{field:y.dynamicFields.endDate,modelValue:$.subscriptionData.endDate,"onUpdate:modelValue":t[4]||(t[4]=e=>$.subscriptionData.endDate=e)},null,8,["field","modelValue"])]),(0,a.Lk)("div",u,[(0,a.bF)(D,{type:"submit",label:e.$tr("isite.cms.label.save"),color:"green",icon:"fa-light fa-save"},null,8,["label"])])])])),_:1},8,["onSubmit"])]),(0,a.Lk)("div",m,[(0,a.Lk)("div",p,[(0,a.Lk)("div",h,[(0,a.Lk)("div",b,[$.subscriptionId?((0,a.uX)(),(0,a.Wv)(q,{key:0,"crud-data":s.e(6966).then(s.bind(s,16966)),"custom-data":{read:{requestParams:{filter:{subscription:$.subscriptionId}}}}},null,8,["crud-data","custom-data"])):(0,a.Q3)("",!0)])])])])])):(0,a.Q3)("",!0),(0,a.bF)(F,{visible:$.loading},null,8,["visible"])])])}var f=s(71915);const $={name:"subscriptionsForm",data(){return{subscriptionData:{name:"",categoryName:"",description:"",startDate:"",endDate:"",limits:[]},subscriptionId:null,success:!1,loading:!1}},computed:{dynamicFields(){return{plan:{value:"",type:"crud",props:{config:{options:{label:"name",value:"id"}},crudType:"select",crudData:s.e(1290).then(s.bind(s,11290)),clearable:!0,crudProps:{label:this.$tr("iplan.cms.form.plan")}}},name:{value:"",type:"input",props:{readonly:!0,label:`${this.$tr("isite.cms.form.name")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}},categoryName:{value:"",type:"input",props:{readonly:!0,label:`${this.$tr("iplan.cms.form.category")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}},description:{value:"",type:"input",props:{type:"textarea",readonly:!0,label:`${this.$tr("isite.cms.form.description")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}},startDate:{value:"",type:"date",props:{label:`${this.$tr("iplan.cms.form.startDate")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}},endDate:{value:"",type:"date",props:{label:`${this.$tr("iplan.cms.form.endDate")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}}}}},mounted(){f.Bt.on("page.data.refresh",(()=>this.init())),this.init()},methods:{async init(){this.loading=!0,this.success=!1,this.locale=this.$clone(this.dataLocale),this.subscriptionId=this.$route.params.id||null,await this.getData(),this.success=!0,this.loading=!1},async getData(){return new Promise(((e,t)=>{const s=this.$clone(this.subscriptionId);if(s){let a="apiRoutes.qplan.subscriptions",i={refresh:!0,params:{filter:{allTranslations:!0},include:"limits"}};this.$crud.show(a,s,i).then((t=>{this.subscriptionData=this.$clone(t.data),e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),t(!1)}))}))}else e(!0)}))},updateItem(){return new Promise(((e,t)=>{const s=this.$clone(this.subscriptionId);if(s){this.loading=!0;let a="apiRoutes.qplan.subscriptions";this.$crud.update(a,s,this.subscriptionData).then((t=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordUpdated")}`}),this.loading=!1,this.init(),e(!0)})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated"),pos:"bottom"}),this.loading=!1,t(!1)}))}else e(!0)}))}}};var y=s(12807),v=s(83333),D=s(21565),k=s(69001),q=s(98582),F=s.n(q);const V=(0,y.A)($,[["render",g]]),L=V;F()($,"components",{QLayout:v.A,QForm:D.A,QBtn:k.A})}}]);