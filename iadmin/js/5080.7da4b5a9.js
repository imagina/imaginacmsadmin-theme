"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[5080],{82700:(e,t,l)=>{l.r(t),l.d(t,{default:()=>jt});var a=l(92444),o=l(74044);const i={id:"productFormPage",ref:"productFormPage"},s={class:"productForm q-mb-lg backend-page row"},r={class:"col-12 col-lg-10 offset-lg-1 relative-position"},d={class:"box box-auto-height q-mb-md"},n={key:0,class:"row justify-center q-col-gutter-x-md"},m={class:"col-12 q-mb-md"},c={key:0,class:"col-12"},u={class:"box"},p={key:0,class:"box-title"},h={key:1},f={class:"box-title text-primary q-mb-xs"},g={class:"text-body2"},b={class:"row q-col-gutter-md q-mb-md"},$=["onClick"],v={class:"relative-position card"},V={class:"box-title text-primary q-mb-sm"},y={class:"text-body2"},I={class:"text-right"},O={class:"input-title"},q={class:"relative-position text-right"},T={class:"row q-col-gutter-md q-pa-md"},Q={class:"col-12 col-md-6"},D={class:"col-12 col-md-6"},w={class:"row q-col-gutter-xs"},A={class:"col-xs-12 col-sm-4"},K={class:"col-xs-12 col-sm-4"},k={class:"col-xs-12 col-sm-4"},C=(0,a.QD)("br",null,null,-1),E=(0,a.QD)("br",null,null,-1),x=(0,a.QD)("br",null,null,-1),P=(0,a.QD)("br",null,null,-1),W=(0,a.QD)("br",null,null,-1),R={class:"q-pa-md"},F={key:0,class:"q-mb-md"},U={class:"q-pa-md"},z={class:"q-pa-sm"},S={key:1,class:"text-center"},_={class:"q-my-md"},Y={class:"full-width"},L={key:0,class:"q-pa-sm"},N={key:1,class:"text-center q-pa-sm"},M={class:"q-my-md"},B={class:"full-width"},H={key:0,class:"q-pa-sm"},j={key:1,class:"text-center q-pa-sm"},G={class:"q-my-md"},J={class:"full-width"},X={key:0,class:"q-pa-sm"},Z={key:1,class:"text-center q-pa-sm"},ee={class:"q-my-md"},te={key:2,class:"q-px-md text-right"};function le(e,t,le,ae,oe,ie){const se=(0,a.E1)("page-actions"),re=(0,a.E1)("locales"),de=(0,a.E1)("q-icon"),ne=(0,a.E1)("q-separator"),me=(0,a.E1)("q-btn"),ce=(0,a.E1)("q-item"),ue=(0,a.E1)("q-list"),pe=(0,a.E1)("q-btn-dropdown"),he=(0,a.E1)("q-tab-panel"),fe=(0,a.E1)("q-input"),ge=(0,a.E1)("dynamic-field"),be=(0,a.E1)("ck-editor"),$e=((0,a.E1)("q-editor"),(0,a.E1)("q-field")),ve=(0,a.E1)("q-select"),Ve=(0,a.E1)("q-toggle"),ye=(0,a.E1)("crud"),Ie=(0,a.E1)("crud-options"),Oe=(0,a.E1)("q-card-section"),qe=(0,a.E1)("q-card"),Te=(0,a.E1)("q-tab-panels"),Qe=(0,a.E1)("q-form"),De=(0,a.E1)("inner-loading"),we=(0,a.iS)("close-popup");return(0,a.Wz)(),(0,a.An)("div",i,[(0,a.QD)("div",s,[(0,a.QD)("div",r,[(0,a.QD)("div",d,[(0,a.K2)(se,{title:ie.pageTitle,"exclude-actions":["sync"],onRefresh:ie.initForm},null,8,["title","onRefresh"])]),(0,a.K2)(Qe,{autocorrect:"off",autocomplete:"off",ref:"formContent",onSubmit:t[61]||(t[61]=t=>e.itemId||e.field?ie.updateItem():ie.createItem()),onValidationError:t[62]||(t[62]=t=>e.$alert.error(e.$tr("isite.cms.message.formInvalid")))},{default:(0,a.Ql)((()=>[oe.success?((0,a.Wz)(),(0,a.An)("div",n,[(0,a.QD)("div",m,[(0,a.K2)(re,{modelValue:oe.locale,"onUpdate:modelValue":t[0]||(t[0]=e=>oe.locale=e),ref:"localeComponent",form:e.$refs.formContent},null,8,["modelValue","form"])]),oe.locale.success?((0,a.Wz)(),(0,a.An)("div",c,[(0,a.QD)("div",u,[oe.locale.formTemplate.name?((0,a.Wz)(),(0,a.An)("div",p,[(0,a.K2)(de,{name:"fa-light fa-tags"}),(0,a.mY)(" "+(0,o.WA)(oe.locale.formTemplate.name)+" ",1),(0,a.K2)(ne,{class:"q-my-md"})])):(0,a.g1)("",!0),"home"!=oe.lastPanelOpen?((0,a.Wz)(),(0,a.An)("div",h,[(0,a.QD)("div",f,(0,o.WA)(e.$tr(oe.modalForms[oe.lastPanelOpen].title)),1),(0,a.QD)("p",g,(0,o.WA)(e.$tr(oe.modalForms[oe.lastPanelOpen].content)),1),(0,a.K2)(ne,{class:"q-my-md",inset:""})])):(0,a.g1)("",!0),(0,a.K2)(Te,{modelValue:oe.lastPanelOpen,"onUpdate:modelValue":t[59]||(t[59]=e=>oe.lastPanelOpen=e),"keep-alive":"",animated:"",class:"rounded-borders q-pa-none"},{default:(0,a.Ql)((()=>[(0,a.K2)(he,{name:"home"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",b,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(oe.modalForms,((t,l)=>((0,a.Wz)(),(0,a.An)(a.ae,{key:l},["home"===t.type||void 0!=t.vIf&&!t.vIf?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.An)("div",{key:0,class:"col-12 col-md-6 col-xl-4",onClick:()=>ie.showNewForm(t.type)},[(0,a.QD)("div",v,[(0,a.K2)(de,{name:"fal fa-edit",color:"primary",class:"absolute-right q-pr-md q-pt-md"}),(0,a.QD)("div",V,(0,o.WA)(e.$tr(t.title)),1),(0,a.QD)("p",y,(0,o.WA)(e.$tr(t.content)),1)])],8,$))],64)))),128))]),(0,a.QD)("div",I,[oe.productId?((0,a.Wz)(),(0,a.Az)(me,{key:0,rounded:"",unelevated:"",outline:"",color:"green",loading:oe.loading,icon:"fal fa-save",label:e.$tr("isite.cms.label.update"),onClick:t[1]||(t[1]=e=>ie.updateItem())},null,8,["loading","label"])):((0,a.Wz)(),(0,a.Az)(pe,{key:1,label:oe.buttonActions.label,split:"",loading:oe.loading,"content-style":"min-width: 250px !important",unelevated:"",outline:"",color:"green",icon:"fal fa-save",onClick:t[5]||(t[5]=e=>ie.createItem()),rounded:"",align:"right"},{default:(0,a.Ql)((()=>[(0,a.K2)(ue,{link:""},{default:(0,a.Ql)((()=>[(0,a.wt)(((0,a.Wz)(),(0,a.Az)(ce,{onClick:t[2]||(t[2]=e=>oe.buttonActions={label:ie.options.btn.saveAndReturn,value:1})},{default:(0,a.Ql)((()=>[(0,a.mY)((0,o.WA)(ie.options.btn.saveAndReturn),1)])),_:1})),[[we]]),(0,a.wt)(((0,a.Wz)(),(0,a.Az)(ce,{onClick:t[3]||(t[3]=e=>oe.buttonActions={label:ie.options.btn.saveAndEdit,value:2})},{default:(0,a.Ql)((()=>[(0,a.mY)((0,o.WA)(ie.options.btn.saveAndEdit),1)])),_:1})),[[we]]),(0,a.wt)(((0,a.Wz)(),(0,a.Az)(ce,{onClick:t[4]||(t[4]=e=>oe.buttonActions={label:ie.options.btn.saveAndCreate,value:3})},{default:(0,a.Ql)((()=>[(0,a.mY)((0,o.WA)(ie.options.btn.saveAndCreate),1)])),_:1})),[[we]])])),_:1})])),_:1},8,["label","loading"]))])])),_:1}),(0,a.K2)(he,{name:"content"},{default:(0,a.Ql)((()=>[(0,a.K2)(fe,{modelValue:oe.locale.formTemplate.name,"onUpdate:modelValue":[t[6]||(t[6]=e=>oe.locale.formTemplate.name=e),t[7]||(t[7]=e=>ie.setSlug())],outlined:"",dense:"","data-testid":"name",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],label:`${e.$tr("isite.cms.form.name")} (${oe.locale.language})*`},null,8,["modelValue","rules","label"]),(0,a.K2)(fe,{modelValue:oe.locale.formTemplate.slug,"onUpdate:modelValue":t[8]||(t[8]=e=>oe.locale.formTemplate.slug=e),outlined:"",dense:"","data-testid":"slug",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],label:`${e.$tr("isite.cms.form.slug")} (${oe.locale.language})*`},null,8,["modelValue","rules","label"]),(0,a.K2)(fe,{modelValue:oe.locale.formTemplate.summary,"onUpdate:modelValue":t[9]||(t[9]=e=>oe.locale.formTemplate.summary=e),type:"textarea",outlined:"",dense:"","data-testid":"summary",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],label:`${e.$tr("isite.cms.form.summary")} (${oe.locale.language})*`,rows:"3"},null,8,["modelValue","rules","label"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.advancedSummary,"onUpdate:modelValue":t[10]||(t[10]=e=>oe.locale.formTemplate.advancedSummary=e),field:ie.dynamicFields.advancedSummary,"item-id":oe.productId,language:oe.locale.language},null,8,["modelValue","field","item-id","language"]),(0,a.QD)("div",O,(0,o.WA)(`${e.$tr("isite.cms.form.description")} (${oe.locale.language})*`),1),(0,a.K2)($e,{modelValue:oe.locale.formTemplate.description,"onUpdate:modelValue":t[13]||(t[13]=e=>oe.locale.formTemplate.description=e),borderless:"",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},{default:(0,a.Ql)((()=>[(0,a.K2)(be,{modelValue:oe.locale.formTemplate.description,"onUpdate:modelValue":t[11]||(t[11]=e=>oe.locale.formTemplate.description=e),"data-testid":"description"},null,8,["modelValue"]),(0,a.g1)("",!0)])),_:1},8,["modelValue","rules"])])),_:1}),(0,a.K2)(he,{name:"status"},{default:(0,a.Ql)((()=>[(0,a.K2)(ve,{clearable:!1,"emit-value":"","map-options":"",outlined:"",dense:"",label:e.$tr("isite.cms.form.status"),options:ie.options.status,modelValue:oe.locale.formTemplate.status,"onUpdate:modelValue":t[14]||(t[14]=e=>oe.locale.formTemplate.status=e),"data-testid":"status"},null,8,["label","options","modelValue"])])),_:1}),(0,a.K2)(he,{name:"categories"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",q,[(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.categoryId,"onUpdate:modelValue":t[15]||(t[15]=e=>oe.locale.formTemplate.categoryId=e),field:ie.dynamicFields.categoryId},null,8,["modelValue","field"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.categories,"onUpdate:modelValue":t[16]||(t[16]=e=>oe.locale.formTemplate.categories=e),field:ie.dynamicFields.categories},null,8,["modelValue","field"])])])),_:1}),(0,a.K2)(he,{name:"metaInfo"},{default:(0,a.Ql)((()=>[(0,a.K2)(fe,{"data-testid":"metaTitle",modelValue:oe.locale.formTemplate.metaTitle,"onUpdate:modelValue":t[17]||(t[17]=e=>oe.locale.formTemplate.metaTitle=e),outlined:"",dense:"",label:`${e.$tr("isite.cms.form.metaTitle")} (${oe.locale.language})`,class:"q-m-b-sm"},null,8,["modelValue","label"]),(0,a.K2)(fe,{"data-testid":"metaDescription",modelValue:oe.locale.formTemplate.metaDescription,"onUpdate:modelValue":t[18]||(t[18]=e=>oe.locale.formTemplate.metaDescription=e),type:"textarea",outlined:"",dense:"",label:`${e.$tr("isite.cms.form.metaDescription")} (${oe.locale.language})`,rows:"3"},null,8,["modelValue","label"]),(0,a.K2)(fe,{"data-testid":"customUrl",modelValue:oe.locale.formTemplate.customUrl,"onUpdate:modelValue":t[19]||(t[19]=e=>oe.locale.formTemplate.customUrl=e),outlined:"",dense:"",label:`${e.$tr("isite.cms.form.customUrl")}`},null,8,["modelValue","label"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.tags,"onUpdate:modelValue":t[20]||(t[20]=e=>oe.locale.formTemplate.tags=e),field:ie.dynamicFields.tags},null,8,["modelValue","field"])])),_:1}),(0,a.K2)(he,{name:"data"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",T,[(0,a.QD)("div",Q,[(0,a.K2)(fe,{"data-testid":"reference",modelValue:oe.locale.formTemplate.reference,"onUpdate:modelValue":t[21]||(t[21]=e=>oe.locale.formTemplate.reference=e),outlined:"",dense:"",label:e.$tr("isite.cms.form.reference")},null,8,["modelValue","label"]),(0,a.K2)(fe,{"data-testid":"sku",outlined:"",dense:"",modelValue:oe.locale.formTemplate.sku,"onUpdate:modelValue":t[22]||(t[22]=e=>oe.locale.formTemplate.sku=e),label:e.$tr("isite.cms.form.sku")},null,8,["modelValue","label"]),(0,a.K2)(fe,{"data-testid":"price",outlined:"",dense:"",type:"number",modelValue:oe.locale.formTemplate.price,"onUpdate:modelValue":t[23]||(t[23]=e=>oe.locale.formTemplate.price=e),label:e.$tr("isite.cms.form.price")},null,8,["modelValue","label"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.quantity,"onUpdate:modelValue":t[24]||(t[24]=e=>oe.locale.formTemplate.quantity=e),field:ie.dynamicFields.quantity},null,8,["modelValue","field"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.quantityClassId,"onUpdate:modelValue":t[25]||(t[25]=e=>oe.locale.formTemplate.quantityClassId=e),field:ie.dynamicFields.quantityClassId},null,8,["modelValue","field"]),(0,a.K2)(fe,{"data-testid":"minimumOrder",label:e.$tr("icommerce.cms.form.minimumOrder"),outlined:"",dense:"",type:"number",modelValue:oe.locale.formTemplate.minimum,"onUpdate:modelValue":t[26]||(t[26]=e=>oe.locale.formTemplate.minimum=e)},null,8,["label","modelValue"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.stockStatus,"onUpdate:modelValue":t[27]||(t[27]=e=>oe.locale.formTemplate.stockStatus=e),field:ie.dynamicFields?.stockStatus},null,8,["modelValue","field"]),(0,a.K2)(fe,{"data-testid":"sortOrder",label:e.$tr("icommerce.cms.form.sortOrder"),outlined:"",dense:"",type:"number",modelValue:oe.locale.formTemplate.sortOrder,"onUpdate:modelValue":t[28]||(t[28]=e=>oe.locale.formTemplate.sortOrder=e)},null,8,["label","modelValue"])]),(0,a.QD)("div",D,[(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.dateAvailable,"onUpdate:modelValue":t[29]||(t[29]=e=>oe.locale.formTemplate.dateAvailable=e),field:ie.dynamicFields.dateAvailable},null,8,["modelValue","field"]),(0,a.K2)(fe,{"data-testid":"points",modelValue:oe.locale.formTemplate.points,"onUpdate:modelValue":t[30]||(t[30]=e=>oe.locale.formTemplate.points=e),outlined:"",dense:"",label:e.$trp("isite.cms.form.point")},null,8,["modelValue","label"]),(0,a.QD)("div",w,[(0,a.QD)("div",A,[(0,a.K2)(fe,{"data-testid":"length",modelValue:oe.locale.formTemplate.length,"onUpdate:modelValue":t[31]||(t[31]=e=>oe.locale.formTemplate.length=e),label:e.$tr("isite.cms.form.length"),outlined:"",dense:"",type:"number"},null,8,["modelValue","label"])]),(0,a.QD)("div",K,[(0,a.K2)(fe,{"data-testid":"width",modelValue:oe.locale.formTemplate.width,"onUpdate:modelValue":t[32]||(t[32]=e=>oe.locale.formTemplate.width=e),label:e.$tr("isite.cms.form.width"),outlined:"",dense:"",type:"number"},null,8,["modelValue","label"])]),(0,a.QD)("div",k,[(0,a.K2)(fe,{"data-testid":"height",modelValue:oe.locale.formTemplate.height,"onUpdate:modelValue":t[33]||(t[33]=e=>oe.locale.formTemplate.height=e),label:e.$tr("isite.cms.form.height"),outlined:"",dense:"",type:"number"},null,8,["modelValue","label"])])]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.lengthClassId,"onUpdate:modelValue":t[34]||(t[34]=e=>oe.locale.formTemplate.lengthClassId=e),field:ie.dynamicFields.lengthClassId},null,8,["modelValue","field"]),(0,a.K2)(fe,{"data-testid":"weight",modelValue:oe.locale.formTemplate.weight,"onUpdate:modelValue":t[35]||(t[35]=e=>oe.locale.formTemplate.weight=e),label:e.$tr("isite.cms.form.weight"),outlined:"",dense:"",type:"number"},null,8,["modelValue","label"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.weightClassId,"onUpdate:modelValue":t[36]||(t[36]=e=>oe.locale.formTemplate.weightClassId=e),field:ie.dynamicFields.weightClassId},null,8,["modelValue","field"]),(0,a.K2)(fe,{"data-testid":"orderWeight",label:e.$tr("icommerce.cms.form.orderWeight"),outlined:"",dense:"",modelValue:oe.locale.formTemplate.orderWeight,"onUpdate:modelValue":t[37]||(t[37]=e=>oe.locale.formTemplate.orderWeight=e)},null,8,["label","modelValue"]),(0,a.K2)(fe,{"data-testid":"weight",modelValue:oe.locale.formTemplate.volume,"onUpdate:modelValue":t[38]||(t[38]=e=>oe.locale.formTemplate.volume=e),label:e.$tr("icommerce.cms.form.volume"),outlined:"",dense:"",type:"number"},null,8,["modelValue","label"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.volumeClassId,"onUpdate:modelValue":t[39]||(t[39]=e=>oe.locale.formTemplate.volumeClassId=e),field:ie.dynamicFields.volumeClassId},null,8,["modelValue","field"]),(0,a.K2)(Ve,{"data-testid":"shipping",modelValue:oe.locale.formTemplate.shipping,"onUpdate:modelValue":t[40]||(t[40]=e=>oe.locale.formTemplate.shipping=e),"true-value":!0,"false-value":!1,label:e.$tr("icommerce.cms.form.requriedShipping"),color:"primary"},null,8,["modelValue","label"]),C,(0,a.K2)(Ve,{"data-testid":"freeShipping",modelValue:oe.locale.formTemplate.freeshipping,"onUpdate:modelValue":t[41]||(t[41]=e=>oe.locale.formTemplate.freeshipping=e),"true-value":!0,"false-value":!1,label:e.$tr("icommerce.cms.form.freeShipping"),color:"primary"},null,8,["modelValue","label"]),E,(0,a.K2)(Ve,{"data-testid":"subtract",modelValue:oe.locale.formTemplate.subtract,"onUpdate:modelValue":t[42]||(t[42]=e=>oe.locale.formTemplate.subtract=e),"true-value":!0,"false-value":!1,label:e.$tr("icommerce.cms.form.subtractFromStock"),color:"primary"},null,8,["modelValue","label"]),x,(0,a.K2)(Ve,{"data-testid":"subtract",modelValue:oe.locale.formTemplate.featured,"onUpdate:modelValue":t[43]||(t[43]=e=>oe.locale.formTemplate.featured=e),"true-value":"1","false-value":"0",label:e.$tr("icommerce.cms.form.featured"),color:"primary"},null,8,["modelValue","label"]),P,(0,a.K2)(Ve,{"data-testid":"isCall",modelValue:oe.locale.formTemplate.isCall,"onUpdate:modelValue":t[44]||(t[44]=e=>oe.locale.formTemplate.isCall=e),"true-value":"1","false-value":"0",label:e.$tr("icommerce.cms.form.isCall"),color:"primary"},null,8,["modelValue","label"]),W,(0,a.K2)(Ve,{"data-testid":"showPriceIsCall",modelValue:oe.locale.formTemplate.showPriceIsCall,"onUpdate:modelValue":t[45]||(t[45]=e=>oe.locale.formTemplate.showPriceIsCall=e),"true-value":"1","false-value":"0",label:e.$tr("icommerce.cms.form.showPriceIsCall"),color:"primary"},null,8,["modelValue","label"]),((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(oe.extraFields,((e,t)=>((0,a.Wz)(),(0,a.An)("div",{key:t,ref_for:!0,ref:t},[e.isFakeField||e.fakeFieldName?((0,a.Wz)(),(0,a.Az)(ge,{modelValue:oe.locale.formTemplate[e.fakeFieldName||"options"][e.name||t],"onUpdate:modelValue":l=>oe.locale.formTemplate[e.fakeFieldName||"options"][e.name||t]=l,key:t,field:{...e,testId:e.testId||e.name||t},language:oe.locale.language,"item-id":oe.productId,ref_for:!0,ref:`field-${e.name||t}`},null,8,["modelValue","onUpdate:modelValue","field","language","item-id"])):(0,a.g1)("",!0),e.isFakeField||e.fakeFieldName?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.Az)(ge,{modelValue:oe.locale.formTemplate[e.name||t],"onUpdate:modelValue":l=>oe.locale.formTemplate[e.name||t]=l,key:t,field:{...e,testId:e.testId||e.name||t},language:oe.locale.language,"item-id":oe.productId,ref_for:!0,ref:`field-${e.name||t}`},null,8,["modelValue","onUpdate:modelValue","field","language","item-id"]))])))),128))])])])),_:1}),(0,a.K2)(he,{name:"relations"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",R,[ie.canManageRecordMaster?((0,a.Wz)(),(0,a.An)("div",F,[(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.options.masterRecord,"onUpdate:modelValue":t[46]||(t[46]=e=>oe.locale.formTemplate.options.masterRecord=e),field:ie.dynamicFields?.masterRecord},null,8,["modelValue","field"])])):(0,a.g1)("",!0),(0,a.g1)("",!0),e.$hasAccess("icommerce.taxclasses.manage")?((0,a.Wz)(),(0,a.Az)(ye,{key:2,"crud-data":l.e(9296).then(l.bind(l,69296)),type:"select","crud-props":{label:`${e.$tr("icommerce.cms.form.taxClass")}`,"data-testid":"taxClassId"},modelValue:oe.locale.formTemplate.taxClassId,"onUpdate:modelValue":t[48]||(t[48]=e=>oe.locale.formTemplate.taxClassId=e),config:{options:{label:"name",value:"id"}}},null,8,["crud-data","crud-props","modelValue"])):(0,a.g1)("",!0),(0,a.K2)(ye,{"crud-data":l.e(8).then(l.bind(l,50008)),type:"select","crud-props":{label:`${e.$tr("icommerce.cms.form.manufacturer")}`,"data-testid":"manufacturerId",clearable:!0},modelValue:oe.locale.formTemplate.manufacturerId,"onUpdate:modelValue":t[49]||(t[49]=e=>oe.locale.formTemplate.manufacturerId=e),config:{options:{label:"name",value:"id"}}},null,8,["crud-data","crud-props","modelValue"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.relatedProducts,"onUpdate:modelValue":t[50]||(t[50]=e=>oe.locale.formTemplate.relatedProducts=e),field:ie.dynamicFields?.relatedProducts},null,8,["modelValue","field"])])])),_:1}),(0,a.K2)(he,{name:"images"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",U,[(0,a.K2)(fe,{"data-testid":"optionsVideo",modelValue:oe.locale.formTemplate.options.video,"onUpdate:modelValue":t[51]||(t[51]=e=>oe.locale.formTemplate.options.video=e),outlined:"",dense:"",label:e.$tr("isite.cms.form.video")},null,8,["modelValue","label"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.mediasSingle,"onUpdate:modelValue":t[52]||(t[52]=e=>oe.locale.formTemplate.mediasSingle=e),field:ie.dynamicFields?.mainImage,"item-id":oe.productId},null,8,["modelValue","field","item-id"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.mediasSingle,"onUpdate:modelValue":t[53]||(t[53]=e=>oe.locale.formTemplate.mediasSingle=e),field:ie.dynamicFields?.sizereference,"item-id":oe.productId},null,8,["modelValue","field","item-id"]),(0,a.K2)(ge,{modelValue:oe.locale.formTemplate.mediasMulti,"onUpdate:modelValue":t[54]||(t[54]=e=>oe.locale.formTemplate.mediasMulti=e),field:ie.dynamicFields.gallery,"item-id":oe.productId},null,8,["modelValue","field","item-id"])])])),_:1}),(0,a.K2)(he,{name:"options"},{default:(0,a.Ql)((()=>[(0,a.K2)(qe,null,{default:(0,a.Ql)((()=>[(0,a.K2)(Oe,{class:"q-pa-sm"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",z,[oe.productId?((0,a.Wz)(),(0,a.Az)(Ie,{key:0,productId:oe.productId},null,8,["productId"])):((0,a.Wz)(),(0,a.An)("div",S,[(0,a.QD)("div",_,[(0,a.K2)(de,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.mY)(" "+(0,o.WA)(`${e.$tr("icommerce.cms.message.warnAddOpt")}...`),1)]),(0,a.K2)(me,{icon:"fas fa-save",label:ie.options.btn.saveAndEdit,rounded:"",unelevated:"",onClick:t[55]||(t[55]=e=>(oe.buttonActions.value=4,ie.createItem())),color:"green"},null,8,["label"])]))])])),_:1})])),_:1})])),_:1}),(0,a.K2)(he,{name:"discount"},{default:(0,a.Ql)((()=>[(0,a.K2)(qe,null,{default:(0,a.Ql)((()=>[(0,a.K2)(Oe,{class:"q-pa-sm"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",Y,[oe.productId?((0,a.Wz)(),(0,a.An)("div",L,[(0,a.K2)(ye,{"crud-data":l.e(8232).then(l.bind(l,78232)),"custom-data":{read:{requestParams:{include:"department",filter:{productId:oe.productId}}},formRight:{productId:{value:oe.productId}}}},null,8,["crud-data","custom-data"])])):((0,a.Wz)(),(0,a.An)("div",N,[(0,a.QD)("div",M,[(0,a.K2)(de,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.mY)(" "+(0,o.WA)(`${e.$tr("icommerce.cms.message.warnAddDiscount")}...`),1)]),(0,a.K2)(me,{icon:"fas fa-save",label:ie.options.btn.saveAndEdit,rounded:"",unelevated:"",onClick:t[56]||(t[56]=e=>(oe.buttonActions.value=4,ie.createItem())),color:"green"},null,8,["label"])]))])])),_:1})])),_:1})])),_:1}),(0,a.K2)(he,{name:"productWarehouse"},{default:(0,a.Ql)((()=>[(0,a.K2)(qe,null,{default:(0,a.Ql)((()=>[(0,a.K2)(Oe,{class:"q-pa-sm"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",B,[oe.productId?((0,a.Wz)(),(0,a.An)("div",H,[(0,a.K2)(ye,{"crud-data":l.e(571).then(l.bind(l,70571)),"custom-data":ie.customCrudData.productWarehouse,onCreated:ie.getDataProduct,onUpdated:ie.getDataProduct,onDeleted:ie.getDataProduct},null,8,["crud-data","custom-data","onCreated","onUpdated","onDeleted"]),(0,a.K2)(ye,{"crud-data":l.e(3100).then(l.bind(l,43100)),"custom-data":ie.customCrudData.productOptValueWarehouse,onCreated:ie.getDataProduct,onUpdated:ie.getDataProduct,onDeleted:ie.getDataProduct},null,8,["crud-data","custom-data","onCreated","onUpdated","onDeleted"])])):((0,a.Wz)(),(0,a.An)("div",j,[(0,a.QD)("div",G,[(0,a.K2)(de,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.mY)(" "+(0,o.WA)(`${e.$tr("icommerce.cms.message.warnWarehouse")}...`),1)]),(0,a.K2)(me,{icon:"fas fa-save",label:ie.options.btn.saveAndEdit,rounded:"",unelevated:"",onClick:t[57]||(t[57]=e=>(oe.buttonActions.value=4,ie.createItem())),color:"green"},null,8,["label"])]))])])),_:1})])),_:1})])),_:1}),(0,a.K2)(he,{name:"priceList"},{default:(0,a.Ql)((()=>[(0,a.K2)(qe,null,{default:(0,a.Ql)((()=>[(0,a.K2)(Oe,{class:"q-pa-sm"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",J,[oe.productId?((0,a.Wz)(),(0,a.An)("div",X,[(0,a.K2)(ye,{"crud-data":l.e(6432).then(l.bind(l,26432)),"custom-data":ie.customCrudData.productPriceList},null,8,["crud-data","custom-data"])])):((0,a.Wz)(),(0,a.An)("div",Z,[(0,a.QD)("div",ee,[(0,a.K2)(de,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.mY)(" "+(0,o.WA)(`${e.$tr("icommerce.cms.message.warnPriceList")}...`),1)]),(0,a.K2)(me,{icon:"fas fa-save",label:ie.options.btn.saveAndEdit,rounded:"",unelevated:"",onClick:t[58]||(t[58]=e=>(oe.buttonActions.value=4,ie.createItem())),color:"green"},null,8,["label"])]))])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),"home"!=oe.lastPanelOpen?((0,a.Wz)(),(0,a.An)("div",te,[(0,a.K2)(me,{outline:"",rounded:"",color:"green",label:e.$tr("isite.cms.label.back"),icon:"fal fa-arrow-left",onClick:t[60]||(t[60]=()=>ie.backHomePanel())},null,8,["label"])])):(0,a.g1)("",!0)])])):(0,a.g1)("",!0)])):(0,a.g1)("",!0)])),_:1},512),(0,a.K2)(De,{visible:oe.loading},null,8,["visible"])])])],512)}l(23816);var ae=l(35088);const oe={id:"crudOptions",class:"relative-position"},ie={class:"row q-col-gutter-sm"},se={class:"col-12 col-md-4"},re={class:"border q-pa-sm"},de={class:"q-mb-sm"},ne={class:"q-py-sm"},me={key:0,class:"text-grey-8"},ce={class:"text-right q-mt-md"},ue={class:"col-12 col-md-8"},pe={key:0,class:"q-pa-lg"},he={key:1},fe={class:"inline-block"},ge={class:"input-title capitalize"},be={class:"inline-block q-ml-lg"},$e={class:"input-title capitalize"},ve={key:0,class:"inline-block q-ml-lg"},Ve=(0,a.QD)("div",{class:"input-title"},"Parent",-1),ye={class:"inline-block q-ml-lg"},Ie={class:"input-title capitalize"},Oe={class:"row q-col-gutter-sm q-mt-sm"},qe={key:0,class:"col-12 col-md-4"},Te={class:"input-title"},Qe={key:1,class:"col-12 col-md-4"},De={key:2,class:"col-12 q-mt-md"},we=(0,a.QD)("label",null,"Nueva opciÃ³n de producto",-1),Ae={class:"relative-position q-pa-md"},Ke={key:0,class:"q-mb-md"},ke=(0,a.QD)("div",{class:"input-title"},"Parent",-1),Ce={class:"text-right q-mt-md"};function Ee(e,t,i,s,r,d){const n=(0,a.E1)("recursive-options"),m=(0,a.E1)("q-btn"),c=(0,a.E1)("q-icon"),u=(0,a.E1)("q-toggle"),p=(0,a.E1)("tree-select"),h=(0,a.E1)("q-input"),f=(0,a.E1)("crud-option-values"),g=(0,a.E1)("inner-loading"),b=(0,a.E1)("q-toolbar-title"),$=(0,a.E1)("q-toolbar"),v=(0,a.E1)("crud"),V=(0,a.E1)("q-card"),y=(0,a.E1)("q-dialog"),I=(0,a.iS)("close-popup");return(0,a.Wz)(),(0,a.An)("div",oe,[(0,a.QD)("div",ie,[(0,a.QD)("div",se,[(0,a.QD)("div",re,[(0,a.QD)("div",de,[(0,a.QD)("div",ne,(0,o.WA)(e.$tr("icommerce.cms.productOptions")),1)]),r.productOptions.length?((0,a.Wz)(),(0,a.Az)(n,{key:1,modelValue:r.template.currentOption,"onUpdate:modelValue":[t[0]||(t[0]=e=>r.template.currentOption=e),t[1]||(t[1]=e=>d.setDataOption())],"list-items":r.productOptions,ref:"optionList",onAdd:t[2]||(t[2]=e=>d.addOption(r.template.currentOption)),onDelete:t[3]||(t[3]=e=>d.deleteOption(r.template.currentOption))},null,8,["modelValue","list-items"])):((0,a.Wz)(),(0,a.An)("div",me,(0,o.WA)(`${e.$tr("icommerce.cms.message.noOptions")}...`),1)),(0,a.QD)("div",ce,[(0,a.K2)(m,{label:e.$tr("isite.cms.label.add"),rounded:"",outline:"",color:"green",onClick:t[4]||(t[4]=e=>r.modal.show=!0)},null,8,["label"])])])]),(0,a.QD)("div",ue,[null==r.template.currentOption?((0,a.Wz)(),(0,a.An)("div",pe,[(0,a.K2)(c,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.mY)(" "+(0,o.WA)(`${e.$tr("icommerce.cms.message.selectProduct")}...`),1)])):((0,a.Wz)(),(0,a.An)("div",he,[(0,a.QD)("div",fe,[(0,a.QD)("div",ge,(0,o.WA)(e.$tr("isite.cms.form.option")),1),(0,a.K2)(c,{color:"primary",name:"fas fa-caret-right"}),(0,a.mY)(" "+(0,o.WA)(d.findOption(r.template.form.id).description),1)]),(0,a.QD)("div",be,[(0,a.QD)("div",$e,(0,o.WA)(e.$tr("isite.cms.form.type")),1),(0,a.K2)(c,{color:"primary",name:"fas fa-caret-right"}),(0,a.mY)(" "+(0,o.WA)(d.findOption(r.template.form.id).type),1)]),parseInt(r.template.form.parentId)?((0,a.Wz)(),(0,a.An)("div",ve,[Ve,(0,a.K2)(c,{color:"primary",name:"fas fa-caret-right"}),(0,a.mY)(" "+(0,o.WA)(d.findOption(r.template.form.parentId).description),1)])):(0,a.g1)("",!0),(0,a.QD)("div",ye,[(0,a.QD)("div",Ie,(0,o.WA)(e.$tr("isite.cms.form.required")),1),(0,a.K2)(u,{modelValue:r.template.form.required,"onUpdate:modelValue":[t[5]||(t[5]=e=>r.template.form.required=e),t[6]||(t[6]=e=>d.updateProductOption())]},null,8,["modelValue"])]),(0,a.QD)("div",Oe,[d.showFieldForm&&parseInt(r.template.form.parentId)&&r.template.parentValues.length?((0,a.Wz)(),(0,a.An)("div",qe,[(0,a.QD)("div",Te,(0,o.WA)(`${e.$tr("icommerce.cms.form.parentOptionValue")} *`),1),(0,a.K2)(p,{modelValue:r.template.form.parentOptionValueId,"onUpdate:modelValue":[t[7]||(t[7]=e=>r.template.form.parentOptionValueId=e),t[8]||(t[8]=e=>d.updateProductOption())],clearable:!1,options:r.template.parentValues,placeholder:"Select opion value..."},null,8,["modelValue","options"])])):(0,a.g1)("",!0),d.showFieldForm?((0,a.Wz)(),(0,a.An)("div",Qe,[(0,a.K2)(h,{modelValue:r.template.form.value,"onUpdate:modelValue":t[9]||(t[9]=e=>r.template.form.value=e),label:`${e.$tr("icommerce.cms.form.optionValue")} *`,onBlur:t[10]||(t[10]=e=>d.updateProductOption())},null,8,["modelValue","label"])])):(0,a.g1)("",!0),d.showFieldForm?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.An)("div",De,[(0,a.K2)(f,{"product-option":r.template.form},null,8,["product-option"])]))])]))])]),(0,a.K2)(g,{visible:r.loading},null,8,["visible"]),(0,a.K2)(y,{modelValue:r.modal.show,"onUpdate:modelValue":t[13]||(t[13]=e=>r.modal.show=e),class:"backend-page"},{default:(0,a.Ql)((()=>[(0,a.K2)(V,null,{default:(0,a.Ql)((()=>[(0,a.K2)($,{class:"bg-primary text-white"},{default:(0,a.Ql)((()=>[(0,a.K2)(b,null,{default:(0,a.Ql)((()=>[(0,a.K2)(c,{name:"fa fa-folder",class:"q-mr-sm"}),we])),_:1}),(0,a.wt)((0,a.K2)(m,{flat:"",icon:"fas fa-times"},null,512),[[I]])])),_:1}),(0,a.QD)("div",Ae,[r.modal.parentOption?((0,a.Wz)(),(0,a.An)("div",Ke,[ke,(0,a.K2)(c,{color:"primary",name:"fas fa-caret-right"}),(0,a.mY)(" "+(0,o.WA)(r.modal.parentOption.description),1)])):(0,a.g1)("",!0),(0,a.K2)(v,{"crud-data":l.e(1392).then(l.bind(l,41392)),modelValue:r.modal.optionSelected,"onUpdate:modelValue":t[11]||(t[11]=e=>r.modal.optionSelected=e),type:"select",onCreated:d.getOptions,"crud-props":{label:`${e.$tr("isite.cms.form.option")} *`},config:{options:{label:"description",value:"id"}}},null,8,["crud-data","modelValue","onCreated","crud-props"]),(0,a.QD)("div",Ce,[(0,a.K2)(m,{label:e.$tr("isite.cms.label.save"),color:"green",rounded:"",unelevated:"",onClick:t[12]||(t[12]=e=>d.createProductOption())},null,8,["label"])]),(0,a.K2)(g,{visible:r.modal.loading},null,8,["visible"])])])),_:1})])),_:1},8,["modelValue"])])}function xe(e,t,l,i,s,r){const d=(0,a.E1)("q-radio"),n=(0,a.E1)("q-item-section"),m=(0,a.E1)("q-tooltip"),c=(0,a.E1)("q-btn"),u=(0,a.E1)("recursive-options-list",!0),p=(0,a.E1)("q-expansion-item"),h=(0,a.E1)("draggable"),f=(0,a.E1)("q-list");return s.loading?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.Az)(f,{key:0,"no-border":"",separator:"",link:"",id:"listOptionsCommerce",class:"q-pa-none"},{default:(0,a.Ql)((()=>[!s.productOptions.length?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.Az)(h,(0,a.Gu)({key:0,tag:"div"},r.dragOptions,{list:s.productOptions,group:{name:"g1"},onChange:r.vEmit,"item-key":"id"}),{item:(0,a.Ql)((({element:l})=>[(0,a.K2)(p,{"expand-icon-class":"hidden"},{header:(0,a.Ql)((()=>[(0,a.K2)(d,{modelValue:s.optionSelected,"onUpdate:modelValue":[t[0]||(t[0]=e=>s.optionSelected=e),t[1]||(t[1]=e=>r.vEmit())],val:l.id},null,8,["modelValue","val"]),(0,a.K2)(n,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,o.WA)(l.description),1)])),_:2},1024),(0,a.K2)(n,{side:""},{default:(0,a.Ql)((()=>[(0,a.QD)("div",null,[r.permitChildren(l)?((0,a.Wz)(),(0,a.Az)(c,{key:0,icon:"fas fa-plus",color:"positive",size:"xs",onClick:e=>r.vEmitAddOption(l.id),round:"",outline:""},{default:(0,a.Ql)((()=>[(0,a.K2)(m,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,o.WA)(`${e.$tr("isite.cms.label.add")} ${e.$tr("isite.cms.label.option")}`),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.g1)("",!0),(0,a.K2)(c,{icon:"far fa-trash-alt",color:"red",round:"",outline:"",class:"q-ml-xs",size:"xs",onClick:e=>r.vEmitDelete(l.id)},{default:(0,a.Ql)((()=>[(0,a.K2)(m,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,o.WA)(`${e.$tr("isite.cms.label.delete")}`),1)])),_:1})])),_:2},1032,["onClick"])])])),_:2},1024)])),default:(0,a.Ql)((()=>[l.children?((0,a.Wz)(),(0,a.Az)(u,{key:0,"list-items":l.children,"parent-id":l.id,modelValue:s.optionSelected,"onUpdate:modelValue":[t[2]||(t[2]=e=>s.optionSelected=e),r.vEmit],onAdd:t[3]||(t[3]=e=>r.vEmitAddOption(s.optionSelected)),onDelete:t[4]||(t[4]=e=>r.vEmitDelete(s.optionSelected))},null,8,["list-items","parent-id","modelValue","onUpdate:modelValue"])):(0,a.g1)("",!0)])),_:2},1024)])),_:1},16,["list","onChange"]))])),_:1}))}var Pe=l(10328),We=l.n(Pe);const Re={name:"recursiveOptionsList",components:{draggable:We()},props:{listItems:{default:!1},parentId:{default:0},modelValue:{default:null}},emits:["update:modelValue","add","delete"],watch:{listItems(){this.init()},modelValue(){this.optionSelected=this.modelValue}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{loading:!1,productOptions:[],optionSelected:null}},methods:{init(){this.loading=!0,this.productOptions=this.$clone(this.$array.builTree(this.listItems,this.parentId)),this.loading=!1},permitChildren(e){let t=["select","radio"],l=t.indexOf(e.type);return-1!=l},vEmit(){this.$emit("update:modelValue",this.optionSelected)},vEmitAddOption(e){this.optionSelected=e,this.vEmit(),this.$emit("add")},vEmitDelete(e){this.optionSelected=e,this.vEmit(),this.$emit("delete")},vRefresh(){this.init()}},computed:{dragOptions(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}}};var Fe=l(68716),Ue=l(99588),ze=l(61656),Se=l(48736),_e=l(11032),Ye=l(99140),Le=l(90111),Ne=l(84884),Me=l(95252),Be=l.n(Me);const He=(0,Fe.c)(Re,[["render",xe]]),je=He;Be()(Re,"components",{QList:Ue.c,QExpansionItem:ze.c,QRadio:Se.c,QItemSection:_e.c,QBtn:Ye.c,QTooltip:Le.c,QItem:Ne.c});const Ge={id:"crudOptionValues",class:"relative-position backend-page"},Je={class:"input-title"},Xe={class:"row q-col-gutter-x-md"},Ze={class:"col-12 col-md-6"},et={class:"input-title relative-position q-mb-md"},tt={key:0},lt={class:"input-title"},at={class:"input-title"},ot={class:"col-12 col-md-6"},it={class:"content-prefix row"},st={class:"input-title col-12"},rt={class:"col-2"},dt={class:"col-10 q-pl-sm"},nt={class:"content-prefix row"},mt={class:"input-title col-12"},ct={class:"col-2"},ut={class:"col-10 q-pl-sm"},pt={class:"content-prefix row"},ht={class:"input-title col-12"},ft={class:"col-2"},gt={class:"col-10 q-pl-sm"};function bt(e,t,i,s,r,d){const n=(0,a.E1)("q-btn"),m=(0,a.E1)("q-tooltip"),c=(0,a.E1)("q-td"),u=(0,a.E1)("q-table"),p=(0,a.E1)("q-toolbar-title"),h=(0,a.E1)("q-toolbar"),f=(0,a.E1)("crud"),g=(0,a.E1)("tree-select"),b=(0,a.E1)("q-field"),$=(0,a.E1)("dynamic-field"),v=(0,a.E1)("q-input"),V=(0,a.E1)("inner-loading"),y=(0,a.E1)("q-form"),I=(0,a.E1)("q-card"),O=(0,a.E1)("q-dialog"),q=(0,a.iS)("close-popup");return(0,a.Wz)(),(0,a.An)("div",Ge,[(0,a.K2)(u,{rows:r.table.data,columns:d.columns,"row-key":"name"},{"top-left":(0,a.Ql)((()=>[(0,a.QD)("span",Je,(0,o.WA)(e.$tr("icommerce.cms.form.productOptionValues")),1)])),"top-right":(0,a.Ql)((()=>[(0,a.K2)(n,{icon:"fas fa-edit",color:"green",label:e.$tr("icommerce.cms.newOptionValue"),onClick:t[0]||(t[0]=e=>{r.modal.itemId=!1,r.modal.show=!0}),class:"btn-small",outline:"",rounded:""},null,8,["label"])])),"body-cell-actions":(0,a.Ql)((t=>[(0,a.K2)(c,null,{default:(0,a.Ql)((()=>[(0,a.K2)(n,{color:"green",icon:"fas fa-pen",size:"xs",outline:"",round:"",onClick:e=>{r.modal.itemId=t.row.id,d.setItemUpdate()},padding:"sm"},{default:(0,a.Ql)((()=>[(0,a.K2)(m,{delay:300},{default:(0,a.Ql)((()=>[(0,a.mY)((0,o.WA)(e.$tr("isite.cms.label.edit")),1)])),_:1})])),_:2},1032,["onClick"]),(0,a.K2)(n,{color:"red",icon:"fas fa-trash-alt",size:"xs",class:"q-ml-xs",onClick:e=>d.deleteItem(t.row.id),outline:"",round:"",padding:"sm"},{default:(0,a.Ql)((()=>[(0,a.K2)(m,{delay:300},{default:(0,a.Ql)((()=>[(0,a.mY)((0,o.WA)(e.$tr("isite.cms.label.delete")),1)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:1},8,["rows","columns"]),r.success?((0,a.Wz)(),(0,a.Az)(O,{key:0,id:"formCategory",class:"modal-form",modelValue:r.modal.show,"onUpdate:modelValue":t[18]||(t[18]=e=>r.modal.show=e),"no-esc-dismiss":"","no-backdrop-dismiss":""},{default:(0,a.Ql)((()=>[(0,a.K2)(I,{style:{"max-width":"1245px"},class:"bg-white backend-page"},{default:(0,a.Ql)((()=>[(0,a.K2)(h,{class:"bg-primary text-white"},{default:(0,a.Ql)((()=>[r.modal.itemId?((0,a.Wz)(),(0,a.Az)(p,{key:1},{default:(0,a.Ql)((()=>[(0,a.mY)((0,o.WA)(`${e.$tr("icommerce.cms.updateProductOptionValue")} ID: ${r.modal.itemId}`),1)])),_:1})):((0,a.Wz)(),(0,a.Az)(p,{key:0},{default:(0,a.Ql)((()=>[(0,a.mY)((0,o.WA)(e.$tr("icommerce.cms.newProductOptionValue")),1)])),_:1})),(0,a.wt)((0,a.K2)(n,{flat:"",icon:"fas fa-times"},null,512),[[q]])])),_:1}),(0,a.K2)(y,{onSubmit:t[14]||(t[14]=e=>r.modal.itemId?d.updateItem():d.createItem()),ref:"formContent",onValidationError:t[15]||(t[15]=t=>e.$alert.error(e.$tr("isite.cms.message.formInvalid"))),class:"q-pa-md",autocomplete:"off"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",Xe,[(0,a.QD)("div",Ze,[(0,a.QD)("div",et,[(0,a.mY)((0,o.WA)(`${e.$tr("icommerce.cms.form.optionValue")} *`)+" ",1),(0,a.K2)(f,{"crud-data":l.e(604).then(l.bind(l,20604)),type:"button-create",onCreated:d.getOptionValues,class:"absolute-right","custom-data":{read:{requestParams:{filter:{optionId:r.form.optionId}}},formLeft:{optionId:{value:r.form.optionId}}}},null,8,["crud-data","onCreated","custom-data"])]),(0,a.K2)(b,{modelValue:r.form.optionValueId,"onUpdate:modelValue":t[2]||(t[2]=e=>r.form.optionValueId=e),borderless:"",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},{default:(0,a.Ql)((()=>[(0,a.K2)(g,{clearable:!1,options:r.options.values,"value-consists-of":"BRANCH_PRIORITY",modelValue:r.form.optionValueId,"onUpdate:modelValue":t[1]||(t[1]=e=>r.form.optionValueId=e),placeholder:""},null,8,["options","modelValue"])])),_:1},8,["modelValue","rules"]),r.options.parentValues.length?((0,a.Wz)(),(0,a.An)("div",tt,[(0,a.K2)($,{modelValue:r.form.parentOptionValueId,"onUpdate:modelValue":t[3]||(t[3]=e=>r.form.parentOptionValueId=e),field:{type:"select",required:!0,props:{label:`${e.$tr("icommerce.cms.form.parentOptionValue")} *`,options:r.options.parentValues}}},null,8,["modelValue","field"])])):(0,a.g1)("",!0),(0,a.K2)(v,{modelValue:r.form.quantity,"onUpdate:modelValue":t[4]||(t[4]=e=>r.form.quantity=e),type:"number",outlined:"",dense:"",label:`${e.$tr("isite.cms.form.quantity")} *`,rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","label","rules"]),(0,a.QD)("div",lt,(0,o.WA)(e.$tr("isite.cms.form.stock")),1),(0,a.K2)(g,{modelValue:r.form.stockStatus,"onUpdate:modelValue":t[5]||(t[5]=e=>r.form.stockStatus=e),options:[{label:this.$tr("isite.cms.label.available"),id:1},{label:this.$tr("isite.cms.label.soldOut"),id:0}],"data-testid":"stockStatus",clearable:!1,"value-consists-of":"BRANCH_PRIORITY",class:"q-mb-md"},null,8,["modelValue","options"]),(0,a.QD)("div",at,(0,o.WA)(`${e.$tr("icommerce.cms.form.subtractFromStock")}`),1),(0,a.K2)(b,{modelValue:r.form.subtract,"onUpdate:modelValue":t[7]||(t[7]=e=>r.form.subtract=e),borderless:""},{default:(0,a.Ql)((()=>[(0,a.K2)(g,{clearable:!1,options:r.options.subtract,"value-consists-of":"BRANCH_PRIORITY",modelValue:r.form.subtract,"onUpdate:modelValue":t[6]||(t[6]=e=>r.form.subtract=e),placeholder:"",class:"q-mb-md"},null,8,["options","modelValue"])])),_:1},8,["modelValue"])]),(0,a.QD)("div",ot,[(0,a.QD)("div",it,[(0,a.QD)("div",st,(0,o.WA)(`${e.$tr("isite.cms.form.price")} *`),1),(0,a.QD)("div",rt,[(0,a.K2)(g,{clearable:!1,options:r.options.prefix,modelValue:r.form.pricePrefix,"onUpdate:modelValue":t[8]||(t[8]=e=>r.form.pricePrefix=e),placeholder:""},null,8,["options","modelValue"])]),(0,a.QD)("div",dt,[(0,a.K2)(v,{modelValue:r.form.price,"onUpdate:modelValue":t[9]||(t[9]=e=>r.form.price=e),style:{padding:"0px"},outlined:"",dense:"",type:"number",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","rules"])])]),(0,a.QD)("div",nt,[(0,a.QD)("div",mt,(0,o.WA)(`${e.$trp("isite.cms.form.point")} *`),1),(0,a.QD)("div",ct,[(0,a.K2)(g,{clearable:!1,options:r.options.prefix,modelValue:r.form.pointsPrefix,"onUpdate:modelValue":t[10]||(t[10]=e=>r.form.pointsPrefix=e),placeholder:""},null,8,["options","modelValue"])]),(0,a.QD)("div",ut,[(0,a.K2)(v,{modelValue:r.form.points,"onUpdate:modelValue":t[11]||(t[11]=e=>r.form.points=e),style:{padding:"0px"},outlined:"",dense:"",type:"number",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","rules"])])]),(0,a.QD)("div",pt,[(0,a.QD)("div",ht,(0,o.WA)(`${e.$tr("isite.cms.form.weight")} *`),1),(0,a.QD)("div",ft,[(0,a.K2)(g,{clearable:!1,options:r.options.prefix,modelValue:r.form.weightPrefix,"onUpdate:modelValue":t[12]||(t[12]=e=>r.form.weightPrefix=e),placeholder:""},null,8,["options","modelValue"])]),(0,a.QD)("div",gt,[(0,a.K2)(v,{modelValue:r.form.weight,"onUpdate:modelValue":t[13]||(t[13]=e=>r.form.weight=e),style:{padding:"0px"},outlined:"",dense:"",type:"number",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","rules"])])])])]),(0,a.K2)(V,{visible:r.loading},null,8,["visible"])])),_:1},512),(0,a.K2)(h,{class:"bg-white"},{default:(0,a.Ql)((()=>[(0,a.K2)(p),r.modal.itemId?((0,a.Wz)(),(0,a.Az)(n,{key:1,label:e.$tr("isite.cms.label.update"),icon:"fas fa-pen",color:"green",loading:r.loading,onClick:t[17]||(t[17]=t=>e.$refs.formContent.submit())},null,8,["label","loading"])):((0,a.Wz)(),(0,a.Az)(n,{key:0,icon:"fas fa-save",color:"green",label:e.$tr("isite.cms.label.save"),loading:r.loading,onClick:t[16]||(t[16]=t=>e.$refs.formContent.submit())},null,8,["label","loading"]))])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,a.g1)("",!0),(0,a.K2)(V,{visible:r.loading},null,8,["visible"])])}const $t={props:{productOption:{defalt:!1}},watch:{productOption:{deep:!0,handler:function(e){this.initForm()}},"modal.itemId":{deep:!0,handler:function(e){e||this.resetform()}}},mounted(){this.$nextTick((function(){this.initForm()}))},data(){return{loading:!1,success:!1,optionId:null,table:{data:[]},modal:{show:!1,itemId:!1,formOptionValue:!1},form:{},options:{}}},computed:{dataForm(){return{productOptionId:null,productId:null,optionId:null,optionValueId:null,parentOptionValueId:null,quantity:null,stockStatus:1,subtract:1,price:null,pricePrefix:"+",points:null,pointsPrefix:"+",weight:null,weightPrefix:"+"}},dataOptions(){return{values:[],parentValues:[],subtract:[{label:this.$tr("isite.cms.label.yes"),id:1},{label:this.$tr("isite.cms.label.no"),id:0}],prefix:[{label:"+",id:"+"},{label:"-",id:"-"}]}},columns(){return[{name:"id",label:this.$tr("isite.cms.form.id"),field:"id"},{name:"optionValue",label:this.$tr("icommerce.cms.form.optionValue"),field:"optionValue",align:"left"},{name:"parentOptionValue",label:this.$tr("icommerce.cms.form.parentOptionValue"),field:"parentOptionValue",align:"left"},{name:"quantity",label:this.$tr("isite.cms.form.quantity"),field:"quantity"},{name:"price",label:this.$tr("isite.cms.form.price"),field:"price"},{name:"points",label:this.$trp("isite.cms.form.point"),field:"points"},{name:"weight",label:this.$trp("isite.cms.form.weight"),field:"weight"},{name:"actions",label:this.$trp("isite.cms.form.actions")}]}},methods:{async initForm(){this.loading=!0,this.success=!1,this.modal.show=!1,await this.resetform(),await this.getData(),this.success=!0,this.loading=!1},async resetform(){this.form=this.$clone(this.dataForm),this.options=this.$clone(this.dataOptions),this.productOption&&(this.form.productOptionId=this.productOption.id,this.form.productId=this.productOption.productId,this.form.optionId=this.productOption.optionId),this.getOptionValues()},getData(){return new Promise(((e,t)=>{let l="apiRoutes.qcommerce.productOptionValues",a={refresh:!0,params:{include:"",filter:{productOptionId:this.productOption.id}}};this.$crud.index(l,a).then((t=>{this.table.data=t.data,e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),this.loading=!1,t(e)}))}))}))},createItem(){let e=this.$clone(this.form);if(e.parentOptionValueId){let t=this.options.parentValuesData.find((t=>t.optionValueId==e.parentOptionValueId));e.parentProdOptValId=t.id}this.loading=!0;let t="apiRoutes.qcommerce.productOptionValues";this.$crud.create(t,e).then((e=>{this.$alert.success({message:this.$tr("isite.cms.message.recordCreated")}),this.initForm(),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoCreated")}),this.loading=!1}))},updateItem(){this.loading=!0;let e="apiRoutes.qcommerce.productOptionValues";this.$crud.update(e,this.modal.itemId,this.form).then((e=>{this.$alert.success({message:this.$tr("isite.cms.message.recordUpdated")}),this.initForm(),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated")}),this.loading=!1}))},deleteItem(e){this.loading=!0;let t="apiRoutes.qcommerce.productOptionValues";this.$crud.delete(t,e).then((e=>{this.$alert.success({message:this.$tr("isite.cms.message.recordDeleted")}),this.initForm(),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoDeleted")}),this.loading=!1}))},setItemUpdate(){const e=this.$clone(this.modal.itemId),t=this.table.data.find((t=>t.id==e));this.form=Object.assign({},this.form,t),this.modal.show=!0},async getOptionValues(){this.loading=!0,await Promise.all([new Promise(((e,t)=>{this.options.values=[];let l={refresh:!0,params:{filter:{optionId:this.productOption.optionId}}};this.$crud.index("apiRoutes.qcommerce.optionValues",l).then((t=>{this.options.values=t.data.map((e=>({label:e.description,id:e.id}))),e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{t(e)}))}))})),new Promise(((e,t)=>{if(this.options.parentValues=[],this.options.parentValuesData=[],!this.productOption.parentOptionId)return e(!0);let l={refresh:!0,params:{filter:{productOptionId:this.productOption.parentId}}};this.$crud.index("apiRoutes.qcommerce.productOptionValues",l).then((t=>{this.options.parentValuesData=this.$clone(t.data),this.options.parentValues=t.data.map((e=>({label:e.optionValue,value:e.optionValueId}))),e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{t(e)}))}))}))]),this.loading=!1}}};var vt=l(40792),Vt=l(50213),yt=l(30852),It=l(70608),Ot=l(6536),qt=l(36524),Tt=l(14288),Qt=l(69452),Dt=l(20540),wt=l(81020);const At=(0,Fe.c)($t,[["render",bt]]),Kt=At;Be()($t,"components",{QTable:vt.c,QBtn:Ye.c,QTd:Vt.c,QTooltip:Le.c,QDialog:yt.c,QCard:It.c,QToolbar:Ot.c,QToolbarTitle:qt.c,QForm:Tt.c,QField:Qt.c,QInput:Dt.c}),Be()($t,"directives",{ClosePopup:wt.c});const kt={props:{productId:{default:!1}},components:{recursiveOptions:je,crudOptionValues:Kt},watch:{},mounted(){this.$nextTick((function(){this.init()}))},data(){return{loading:!1,loadingOptions:!1,modal:{show:!1,optionData:!1,parentOption:0,optionSelected:null,loading:!1,formOption:!1},productOptions:[],productOptionsRoot:[],productOptionValues:[],template:{optionSelected:null,parentOptions:[],currentOption:null,options:[],form:{},values:[],parentValues:[]}}},computed:{showFieldForm(){let e=["text","textarea"],t=e.indexOf(this.template.form.type);return-1!=t}},methods:{async init(){this.loading=!0,await this.getData(),this.getOptions(),this.loading=!1},getData(){return new Promise(((e,t)=>{this.loading=!0;let l="apiRoutes.qcommerce.products",a={refresh:!0,params:{include:"productOptions",fields:"id"}};this.$crud.show(l,this.productId,a).then((t=>{this.productOptions=this.$clone(this.arrayToTree(t.data.productOptions)),this.productOptionsRoot=this.$clone(t.data.productOptions),this.productOptionsRoot.forEach((e=>{e.hasOwnProperty("required")||(e.required=!1)})),this.productOptionValues=this.$clone(t.data.optionValues),this.loading=!1,e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),t(!1)}))}))}))},getOptionValues(e,t="values"){this.loading=!0;let l="apiRoutes.qcommerce.optionValues",a={params:{filter:{optionId:e}}};this.$crud.index(l,a).then((e=>{this.template[t]=[],e.data.forEach((e=>{this.template[t].push({label:e.description,id:e.id})})),this.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),this.loading=!1}))}))},addOption(e=!1){this.modal.parentOption=e?this.findOption(e):0,this.modal.show=!0},createProductOption(){if(this.modal.optionSelected){this.modal.loading=!0;let e="apiRoutes.qcommerce.productOptions",t={productId:this.productId,optionId:this.$clone(this.modal.optionSelected.toString()),parentId:this.modal.parentOption.id||0,required:0};this.$crud.create(e,t).then((async e=>{for(var t of(this.$alert.success({message:this.$tr("isite.cms.message.recordCreated")}),await this.getData(),this.modal.optionSelected=null,this.productOptions)){let e=this.$clone(this.template.currentOption);t.id>=e&&(this.template.currentOption=t.id)}this.setDataOption(),this.$refs.optionList.vRefresh(),this.modal.loading=!1,this.modal.show=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoCreated")}),this.modal.show=!1,this.modal.loading=!1,this.modal.optionSelected=null}))}},updateProductOption(){this.loading=!0;let e="apiRoutes.qcommerce.productOptions",t=this.$clone(this.template.form);t.parentId||(t.parentId=0),t.parentOptionValueId||(t.parentOptionValueId=null),this.productOptionsRoot.find((e=>{e.id==this.template.currentOption&&void 0!=this.template.form?.required&&(e.required=this.template.form.required)})),this.$crud.update(e,t.id,t).then((e=>{this.$alert.success({message:this.$tr("isite.cms.message.recordUpdated")}),this.setDataOption(),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated")}),this.loading=!1}))},deleteOption(e){if(this.checkToDeleteOption(e)){const t=this.findOption(e);this.$q.dialog({title:t.keyDescription,preventClose:!0,message:this.$tr("isite.cms.message.deleteRecord"),color:"red",ok:this.$tr("isite.cms.label.delete"),cancel:this.$tr("isite.cms.label.cancel")}).onOk((t=>{this.loading=!0;let l="apiRoutes.qcommerce.productOptions";this.$crud.delete(l,e,{params:{}}).then((async e=>{this.template.currentOption=null,this.$alert.success({message:this.$tr("isite.cms.message.recordDeleted")}),await this.getData(),this.$refs.optionList.vRefresh(),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoDeleted")}),this.loading=!1}))})).onCancel((e=>{}))}},checkToDeleteOption(e){const t=this.$clone(this.template.currentOption);this.template.currentOption=e,t!=e&&this.setDataOption();const l=this.findOption(e,"parentId");if(!l)return!0;this.$q.dialog({message:this.$tr("icommerce.cms.message.noDeleteOption",{name:l.keyDescription}),title:this.$tr("isite.cms.label.warning"),color:"red"}).then((e=>!1)).catch((e=>{}))},setDataOption(){const e=this.$clone(this.template.currentOption),t=this.$clone(this.template.form);if(t.id)for(var l in this.productOptions)this.productOptions[l].id==t.id&&(this.productOptions[l]=t);if(e){this.setParentOptions();const t=this.findOption(e);this.template.form=this.$clone(t),this.getOptionValues(t.optionId),this.setParentValues()}this.$refs.optionList.vRefresh(),this.updateOrder()},setParentOptions(){this.template.parentOptions=[];const e=this.$clone(this.template.currentOption);this.productOptions.forEach(((t,l)=>{t.id!=e&&this.template.parentOptions.push({label:t.description,id:t.id})}))},setParentValues(){const e=this.$clone(this.template.form.parentId);if(e){const t=this.findOption(e);this.template.form.parentOptionId=t.optionId,this.getOptionValues(t.optionId,"parentValues")}else this.template.form.parentOptionId=null,this.template.parentValues=[],this.template.form.parentOptionValueId=null},getOptions(){this.loadingOptions=!0;let e="apiRoutes.qcommerce.options",t={refresh:!0,params:{}};this.$crud.index(e,t).then((e=>{let t=[];e.data.forEach((e=>{t.push({label:e.description,id:e.id})})),this.template.options=this.$clone(t),this.loadingOptions=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),this.loading=!1}))}))},findOption(e,t="id"){const l=this.$clone(this.productOptionsRoot);let a=!1,o=l.findIndex((l=>l[t]==e));return o>=0&&(a=l[o],a.keyDescription=o+1+"."+l[o].description),a},updateOrder(){return!1},arrayToTree(e,t=0){return e.filter((l=>{if((l.parentId||0)==t)return l["children"]=this.arrayToTree(e,l.id)}))},treeToArray(e,t,l=null){let a=[...e];a.forEach(((e,a)=>{e.position=a,e.parentId=l,t.push(e),e.children.length&&this.treeToArray(e.children,t,e.id)}))}}};var Ct=l(58120),Et=l(64640);const xt=(0,Fe.c)(kt,[["render",Ee]]),Pt=xt;Be()(kt,"components",{QBtn:Ye.c,QIcon:Ct.c,QToggle:Et.c,QInput:Dt.c,QDialog:yt.c,QCard:It.c,QToolbar:Ot.c,QToolbarTitle:qt.c}),Be()(kt,"directives",{ClosePopup:wt.c});var Wt=l(63528),Rt=l(8880);const{getScrollTarget:Ft,setScrollPosition:Ut}=Rt["default"],zt={components:{crudOptions:Pt,recursiveList:ae.c,ckEditor:Wt.c},watch:{$route(e,t){this.initForm()},"locale.formTemplate.categoryId"(e){setTimeout((()=>{if(this.locale.formTemplate&&this.locale.formTemplate.categories&&e){let t=this.$clone(this.locale.formTemplate.categories);-1==t.indexOf(e.toString())&&-1==t.indexOf(e)&&t.push(this.$clone(e)),this.locale.formTemplate.categories=this.$clone(t)}}),500)},"locale.formTemplate.slug"(e){if(e){let t=this.$clone(this.$helper.getSlug(e));e!=t&&(this.locale.formTemplate.slug=this.$clone(t))}}},mounted(){this.$nextTick((function(){this.initForm();const e=this.$route.path.split("/"),t=e[e.length-2];"create"===t&&(this.isCreateMode=!0)}))},data(){return{isCreateMode:!1,locale:{},vTab:"tab-data",loading:!1,loadingCategory:!1,success:!1,productId:!1,editorText:{toolbar:[["bold","italic","strike","underline","removeFormat"],["link"],[{label:"Font Size",icon:"format_size",fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]}],["quote","unordered","ordered"],["fullscreen"]]},optionsTemplate:{categories:[],products:[],relatedProducts:[]},buttonActions:{label:"",value:1},modalShow:{category:!1},extraFields:[],modalForms:{content:{show:!1,type:"content",title:this.$tr("icommerce.cms.form.content"),content:this.$tr("icommerce.cms.form.formContent")},status:{show:!1,type:"status",title:this.$tr("icommerce.cms.form.status"),content:this.$tr("icommerce.cms.form.statusContent")},categories:{show:!1,type:"categories",title:this.$tr("icommerce.cms.form.categories"),content:this.$tr("icommerce.cms.form.categoriesContent")},metaInfo:{show:!1,type:"metaInfo",title:this.$tr("icommerce.cms.form.metaInfo"),content:this.$tr("icommerce.cms.form.metaInfoContent")},data:{show:!1,type:"data",title:this.$tr("icommerce.cms.form.data"),content:this.$tr("icommerce.cms.form.dataContent")},relations:{show:!1,type:"relations",title:this.$tr("icommerce.cms.form.link"),content:this.$tr("icommerce.cms.form.relationsContent")},images:{show:!1,type:"images",title:this.$tr("icommerce.cms.form.images"),content:this.$tr("icommerce.cms.form.imagesContent")},options:{show:!1,type:"options",title:this.$tr("icommerce.cms.form.options"),content:this.$tr("icommerce.cms.form.optionsContent")},discount:{show:!1,type:"discount",title:this.$tr("icommerce.cms.form.discount"),content:this.$tr("icommerce.cms.form.discountContent")},productWarehouse:{show:!1,type:"productWarehouse",title:this.$tr("icommerce.cms.form.productWarehouse"),content:this.$tr("icommerce.cms.form.productWarehouseContent"),vIf:this.$getSetting("icommerce::warehouseFunctionability")},priceList:{show:!1,type:"priceList",title:this.$tr("icommerce.cms.form.priceLists"),content:this.$tr("icommercepricelist.cms.form.productPriceListContent"),vIf:!!this.$hasAccess("icommercepricelist.productlist.manage")},home:{show:!1,type:"home",title:"",content:""}},lastPanelOpen:"home"}},computed:{modalTemplatesAttributes(){return{customPosition:!0,title:`${this.modalForms[this.lastPanelOpen].title}`,actions:[{props:{label:this.$tr("isite.cms.label.close"),color:"green",rounded:!0,icon:"fal fa-fill-drip"},action:()=>{this.modalForms[this.lastPanelOpen].show=!1}}]}},pageTitle(){return this.$tr(this.$route.meta.title)},dataLocale(){return{fields:{parentId:"",status:1,categoryId:0,categories:[],addedById:this.$store.state.quserAuth.userId,sku:0,quantity:1,stockStatus:1,price:0,dateAvailable:null,weight:0,length:0,width:0,height:0,volume:0,minimum:1,reference:"",shipping:!1,showPriceIsCall:!1,subtract:!1,freeshipping:!1,orderWeight:0,rating:3,points:0,relatedProducts:[],tags:[],productOptions:[],discounts:[],mediasSingle:{},mediasMulti:{},options:{masterRecord:0,video:null},taxClassId:null,weightClassId:null,lengthClassId:null,volumeClassId:null,quantityClassId:null,manufacturerId:null,metaTitle:"",metaDescription:"",featured:"0",isCall:"0",sortOrder:"0",itemTypeId:1,customUrl:""},fieldsTranslatable:{name:"",slug:"",summary:"",description:"",metaTitle:"",metaDescription:"",advancedSummary:""}}},updateOptions(){this.$route.params.editOptions&&setTimeout((()=>{this.vTab="tab-options";let e=Ft(this.$refs.productFormPage),t=this.$refs.productFormPage.scrollHeight;Ut(e,t,1e3)}),500)},options(){return{status:[{label:this.$tr("isite.cms.label.enabled"),value:1},{label:this.$tr("isite.cms.label.disabled"),value:0}],btn:{saveAndReturn:this.$tr("isite.cms.message.saveAndReturn"),saveAndEdit:this.$tr("isite.cms.message.saveAndEdit"),saveAndCreate:this.$tr("isite.cms.message.saveAndCreate")}}},canManageRecordMaster(){let e=!0;if(this.productId&&!this.$hasAccess("isite.master.records.edit")){e=!1;let t=this.locale.formTemplate;t&&t.options&&parseInt(t.options.masterRecord)&&this.$router.push({name:"app.home"})}return this.productId||this.$hasAccess("isite.master.records.create")||(e=!1),e},dynamicFields(){return{quantity:{value:0,type:"input",help:this.settings.isWarehouseEnable?{description:this.$tr("icommerce.cms.fieldEditableOnlyWarehouse")}:{},props:{outlined:!0,dense:!0,label:this.$tr("isite.cms.form.quantity"),type:"number",readonly:this.settings.isWarehouseEnable}},discounts:{value:null,type:"select",testId:"discounts",props:{label:this.$tr("icommerce.cms.form.discount")+"*",rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")],clearable:!0,multiple:!0},loadOptions:{apiRoute:"apiRoutes.qdiscountable.discounts",select:{label:"name",id:"id"}}},tags:{value:[],type:"select",props:{label:this.$trp("isite.cms.form.tag"),useInput:!0,useChips:!0,multiple:!0,hideDropdownIcon:!0,inputDebounce:"0",newValueMode:"add-unique"}},categoryId:{value:null,type:"crud",props:{crudType:"select",crudData:l.e(6424).then(l.bind(l,56424)),customData:{read:{requestParams:{include:"parent",refresh:!0}}},crudProps:{label:`${this.$tr("isite.cms.form.category")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]},config:{filterByQuery:!0,options:{id:"id",label:"title",sublabel:e=>e.parent?.title||null}}}},categories:{value:[],type:"crud",props:{crudType:"select",crudData:l.e(6424).then(l.bind(l,56424)),customData:{read:{requestParams:{include:"parent",refresh:!0}}},crudProps:{label:this.$trp("isite.cms.form.category"),multiple:!0,useChips:!0},config:{filterByQuery:!0,options:{id:"id",label:"title",sublabel:e=>e.parent?.title||null}}}},quantityClassId:{value:null,type:"crud",props:{crudType:"select",crudData:l.e(1980).then(l.bind(l,31980)),crudProps:{label:`${this.$tr("icommerce.cms.sidebar.quantityClasses")}`}}},weightClassId:{value:null,type:"crud",props:{crudType:"select",crudData:l.e(2531).then(l.bind(l,54912)),crudProps:{label:`${this.$tr("icommerce.cms.sidebar.weightClasses")}`}}},lengthClassId:{value:null,type:"crud",props:{crudType:"select",crudData:l.e(6524).then(l.bind(l,14144)),crudProps:{label:`${this.$tr("icommerce.cms.sidebar.lengthClasses")}`}}},volumeClassId:{value:null,type:"crud",props:{crudType:"select",crudData:l.e(4808).then(l.bind(l,34808)),crudProps:{label:`${this.$tr("icommerce.cms.sidebar.volumeClasses")}`}}},mainImage:{type:"media",props:{label:this.$tr("isite.cms.form.image"),zone:"mainimage",entity:"Modules\\Icommerce\\Entities\\Product",entityId:this.productId?this.productId:null}},gallery:{type:"media",props:{label:this.$tr("isite.cms.form.gallery"),zone:"gallery",entity:"Modules\\Icommerce\\Entities\\Product",entityId:this.productId?this.productId:null}},sizereference:{type:"media",props:{label:this.$tr("icommerce.cms.label.dataSheet"),zone:"sizereference",entity:"Modules\\Icommerce\\Entities\\Product",entityId:this.productId?this.productId:null}},dateAvailable:{value:this.$moment().format("YYYY/MM/DD"),type:"date",props:{label:this.$tr("icommerce.cms.form.availableDate")}},advancedSummary:{value:"",type:"html",isTranslatable:!0,help:{description:this.$tr("icommerce.cms.form.advancedSummaryHelp")},props:{label:`${this.$tr("icommerce.cms.advancedSummary")}`}},stockStatus:{type:"select",props:{label:this.$tr("isite.cms.form.stock"),clearable:!1,options:[{label:this.$tr("isite.cms.label.available"),value:1},{label:this.$tr("isite.cms.label.soldOut"),value:0}]}},masterRecord:{type:"select",props:{label:this.$tr("isite.cms.form.masterRecord"),clearable:!1,options:[{label:this.$tr("isite.cms.label.yes"),value:1},{label:this.$tr("isite.cms.label.no"),value:0}]}},relatedProducts:{type:"select",props:{label:this.$tr("icommerce.cms.form.relatedProducts"),useInput:!0,useChips:!0,multiple:!0},loadOptions:{apiRoute:"apiRoutes.qcommerce.products",filterByQuery:!0,select:{label:"name",id:"id"}}}}},customCrudData(){return{productWarehouse:{read:{title:this.$tr("icommerce.cms.form.generalWarehouse"),excludeActions:["sync","recommendations"],requestParams:{include:"product,warehouse",filter:{productId:this.productId}}},formLeft:{productId:{value:this.productId,type:"select",required:!0,props:{label:`${this.$tr("isite.cms.form.product")}*`,readonly:!0},loadOptions:{apiRoute:"apiRoutes.qcommerce.products",select:{label:"name",id:"id"}}}}},productOptValueWarehouse:{read:{title:this.$tr("icommerce.cms.form.warehouseByOptions"),excludeActions:["sync","recommendations"],requestParams:{include:"warehouse,productOptionValue.option,productOptionValue.optionValue",filter:{include:"product,warehouse",productId:this.productId}}},formLeft:{productId:{value:this.productId,type:"select",required:!0,props:{label:`${this.$tr("isite.cms.form.product")}*`,readonly:!0},loadOptions:{apiRoute:"apiRoutes.qcommerce.products",select:{label:"name",id:"id"}}}}},productPriceList:{read:{title:this.$tr("icommerce.cms.form.priceLists"),excludeActions:["sync","recommendations"],requestParams:{include:"product,priceList",filter:{productId:this.productId}}},formLeft:{productId:{value:this.productId,type:"select",required:!0,props:{label:`${this.$tr("isite.cms.form.product")}*`,readonly:!0},loadOptions:{apiRoute:"apiRoutes.qcommerce.products",select:{label:"name",id:"id"}}},productPrice:{value:this.locale.formTemplate.price,type:"input",fakeFieldName:"product",props:{label:`${this.$tr("isite.cms.form.product")}*`,vIf:!1}}}}}},settings(){return{isWarehouseEnable:"1"==this.$getSetting("icommerce::warehouseFunctionality")}}},methods:{validateFieldsHomeTab(){const e=this.locale.formTemplate;var t=!0;return["name","slug","summary","description"].forEach((l=>{e[l]&&e[l].trim().length||(t=!1)})),e.categoryId&&e.categories.length||(t=!1),t},async backHomePanel(){await this.$refs.localeComponent.validateForm()&&(this.lastPanelOpen="home")},showNewForm(e){this.lastPanelOpen=e,this.modalForms[e].show=!0},async initForm(){this.loading=!0,this.success=!1,this.vTab="tab-data",this.buttonActions={label:this.options.btn.saveAndReturn,value:1},await this.orderFields(),this.productId=this.$route.params.id,this.locale.success&&this.$refs.localeComponent.vReset(),await this.getData(),this.success=!0,this.updateOptions,this.loading=!1},getCategories(){return new Promise(((e,t)=>{this.loadingCategory=!0;let l="apiRoutes.qcommerce.categories",a={refresh:!0,params:{include:"parent"}};this.$crud.index(l,a).then((t=>{this.optionsTemplate.categories=this.$array.tree(t.data),this.loadingCategory=!1,e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),this.loadingCategory=!1,t(!0)}))}))}))},getData(){return new Promise(((e,t)=>{const l=this.$clone(this.productId);if(l){let a="apiRoutes.qcommerce.products",o={refresh:!0,params:{include:"relatedProducts,categories,category,parent,discounts,manufacturer",filter:{allTranslations:!0}}};this.$crud.show(a,l,o).then((t=>{this.orderDataItemToLocale(t.data),e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),console.error(e),this.loading=!1,t(!1)}))}))}else e(!0)}))},orderDataItemToLocale(e){let t=this.$clone(e);e.parent&&(this.optionsTemplate.products=this.$array.tree([e.parent],{label:"name",id:"id"})),t.categories.forEach(((e,l)=>{t.categories[l]=e.id})),t.relatedProducts.forEach(((e,l)=>{t.relatedProducts[l]=e.id})),e.relatedProducts&&e.relatedProducts.length&&(this.optionsTemplate.relatedProducts=this.$array.tree(e.relatedProducts,{label:"name",id:"id"})),this.locale.form=this.$clone({...t,dateAvailable:t.dateAvailable?t.dateAvailable.replaceAll("-","/"):this.$moment().format("YYYY/MM/DD")}),setTimeout((()=>{}),3e3)},async createItem(){if(this.validateFieldsHomeTab()){this.loading=!0;let e="apiRoutes.qcommerce.products";this.$crud.create(e,this.getDataForm()).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordCreated")} ID: ${e.data.id}`}),this.actionAfterCreated(e.data.id)})).catch((e=>{this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.recordNoCreated"),pos:"bottom"})}))}else this.$alert.error({message:this.$tr("isite.cms.message.formInvalid")})},async updateItem(){if(this.validateFieldsHomeTab()){this.loading=!0;let e="apiRoutes.qcommerce.products",t={...this.getDataForm(),id:this.productId};this.$crud.update(e,this.productId,t).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordUpdated")}`}),this.$router.push({name:"qcommerce.admin.products.index"}),this.initForm()})).catch((e=>{this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated"),pos:"bottom"})}))}else this.$alert.error({message:this.$tr("isite.cms.message.formInvalid")})},getDataForm(){let e=this.$clone(this.locale.form);for(var t in e){let l=e[t];null!=l&&void 0!=l||delete e[t]}return delete e.productOptions,{...e,manufacturerId:this.locale.form.manufacturerId||null}},actionAfterCreated(e){setTimeout((()=>{let t=this.buttonActions.value;switch(t){case 1:this.$router.push({name:"qcommerce.admin.products.index"});break;case 2:this.$router.push({name:"qcommerce.admin.products.edit",params:{id:e}}),this.loading=!1;break;case 3:this.$refs.localeComponent.vReset(),this.loading=!1;break;case 4:this.$router.push({name:"qcommerce.admin.products.edit",params:{id:e,editOptions:1}}),this.loading=!1;break}}),2e3)},setSlug(){if(!this.productId){let e=this.$clone(this.locale.formTemplate.name);this.locale.formTemplate.slug=this.$clone(this.$helper.getSlug(e))}},getExtraFields(){return new Promise(((e,t)=>{let l={refresh:!0,params:{filter:{configName:"icommerce.crud-fields.products"}}};this.$crud.index("apiRoutes.qsite.configs",l).then((t=>{t.data&&Object.keys(t.data).length&&(this.extraFields=this.$clone(t.data)),e(t.data)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{t(e)}))}))}))},orderFields(){return new Promise((async e=>{let t=this.$clone(this.dataLocale);return await this.getExtraFields(),Object.keys(this.extraFields).forEach((e=>{let l=this.extraFields[e];l.permission&&!this.$hasAccess(l.permission)||(l.isTranslatable?t.fieldsTranslatable[l.name||e]=l.value:l.isFakeField?t.fields.options[l.name||e]=l.value:l.fakeFieldName?(t.fields[l.fakeFieldName]||(t.fields[l.fakeFieldName]={}),t.fields[l.fakeFieldName][l.name||e]=l.value):t.fields[l.name||e]=l.value)})),this.locale=this.$clone(t),e(!0)}))},getDataProduct(){this.loading=!0;const e=this.$clone(this.productId);if(e){let t="apiRoutes.qcommerce.products",l={refresh:!0};this.$crud.show(t,e,l).then((e=>{this.locale.formTemplate.quantity=e.data.quantity,this.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),console.error(e),this.loading=!1}))}))}else this.loading=!1}}};var St=l(70880),_t=l(65264),Yt=l(5296),Lt=l(82764),Nt=l(85664),Mt=l(36008),Bt=l(71008);const Ht=(0,Fe.c)(zt,[["render",le]]),jt=Ht;Be()(zt,"components",{QForm:Tt.c,QIcon:Ct.c,QSeparator:St.c,QTabPanels:_t.c,QTabPanel:Yt.c,QBtn:Ye.c,QBtnDropdown:Lt.c,QList:Ue.c,QItem:Ne.c,QInput:Dt.c,QField:Qt.c,QEditor:Nt.c,QSelect:Mt.c,QToggle:Et.c,QCard:It.c,QCardSection:Bt.c}),Be()(zt,"directives",{ClosePopup:wt.c})}}]);