"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[9424],{9424:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var a=s(92444);const i={id:"pageId",class:"q-layout-page layout-padding"},l={class:"q-mb-lg backend-page"},r={key:0,class:"row q-col-gutter-md"},o={class:"col-12"},n={class:"row q-col-gutter-md"},d={class:"col-12 col-md-7"},c={class:"col-12 col-md-5"},u={class:"col-12 text-right"},m={class:"col-12 relative-position"},p={class:"box"},h={class:"row gutter-y-sm"},b={class:"col-md-12 q-mt-md"};function g(e,t,g,f,D,$){const y=(0,a.E1)("dynamic-field"),v=(0,a.E1)("q-btn"),q=(0,a.E1)("q-form"),V=(0,a.E1)("crud"),Q=(0,a.E1)("inner-loading");return(0,a.Wz)(),(0,a.An)("div",i,[(0,a.QD)("div",l,[D.success?((0,a.Wz)(),(0,a.An)("div",r,[(0,a.QD)("div",o,[(0,a.K2)(q,{autocorrect:"off",autocomplete:"off",ref:"formContent",class:"box",onSubmit:$.updateItem,onValidationError:t[5]||(t[5]=t=>e.$alert.error(e.$tr("isite.cms.message.formInvalid")))},{default:(0,a.Ql)((()=>[(0,a.QD)("div",n,[(0,a.QD)("div",d,[(0,a.K2)(y,{field:$.dynamicFields.name,modelValue:D.subscriptionData.name,"onUpdate:modelValue":t[0]||(t[0]=e=>D.subscriptionData.name=e)},null,8,["field","modelValue"]),(0,a.K2)(y,{field:$.dynamicFields.description,modelValue:D.subscriptionData.description,"onUpdate:modelValue":t[1]||(t[1]=e=>D.subscriptionData.description=e)},null,8,["field","modelValue"]),(0,a.K2)(y,{field:$.dynamicFields.categoryName,modelValue:D.subscriptionData.categoryName,"onUpdate:modelValue":t[2]||(t[2]=e=>D.subscriptionData.categoryName=e)},null,8,["field","modelValue"])]),(0,a.QD)("div",c,[(0,a.K2)(y,{field:$.dynamicFields.startDate,modelValue:D.subscriptionData.startDate,"onUpdate:modelValue":t[3]||(t[3]=e=>D.subscriptionData.startDate=e)},null,8,["field","modelValue"]),(0,a.K2)(y,{field:$.dynamicFields.endDate,modelValue:D.subscriptionData.endDate,"onUpdate:modelValue":t[4]||(t[4]=e=>D.subscriptionData.endDate=e)},null,8,["field","modelValue"])]),(0,a.QD)("div",u,[(0,a.K2)(v,{type:"submit",label:e.$tr("isite.cms.label.save"),color:"green",icon:"fa-light fa-save"},null,8,["label"])])])])),_:1},8,["onSubmit"])]),(0,a.QD)("div",m,[(0,a.QD)("div",p,[(0,a.QD)("div",h,[(0,a.QD)("div",b,[D.subscriptionId?((0,a.Wz)(),(0,a.Az)(V,{key:0,"crud-data":s.e(139).then(s.bind(s,92520)),"custom-data":{read:{requestParams:{filter:{subscription:D.subscriptionId}}}}},null,8,["crud-data","custom-data"])):(0,a.g1)("",!0)])])])])])):(0,a.g1)("",!0),(0,a.K2)(Q,{visible:D.loading},null,8,["visible"])])])}var f=s(8932);const D={name:"subscriptionsForm",data(){return{subscriptionData:{name:"",categoryName:"",description:"",startDate:"",endDate:"",limits:[]},subscriptionId:null,success:!1,loading:!1}},computed:{dynamicFields(){return{plan:{value:"",type:"crud",props:{config:{options:{label:"name",value:"id"}},crudType:"select",crudData:s.e(5968).then(s.bind(s,95968)),clearable:!0,crudProps:{label:this.$tr("iplan.cms.form.plan")}}},name:{value:"",type:"input",props:{readonly:!0,label:`${this.$tr("isite.cms.form.name")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}},categoryName:{value:"",type:"input",props:{readonly:!0,label:`${this.$tr("iplan.cms.form.category")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}},description:{value:"",type:"input",props:{type:"textarea",readonly:!0,label:`${this.$tr("isite.cms.form.description")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}},startDate:{value:"",type:"date",props:{label:`${this.$tr("iplan.cms.form.startDate")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}},endDate:{value:"",type:"date",props:{label:`${this.$tr("iplan.cms.form.endDate")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]}}}}},mounted(){f.kN.on("page.data.refresh",(()=>this.init())),this.init()},methods:{async init(){this.loading=!0,this.success=!1,this.locale=this.$clone(this.dataLocale),this.subscriptionId=this.$route.params.id||null,await this.getData(),this.success=!0,this.loading=!1},async getData(){return new Promise(((e,t)=>{const s=this.$clone(this.subscriptionId);if(s){let a="apiRoutes.qplan.subscriptions",i={refresh:!0,params:{filter:{allTranslations:!0},include:"limits"}};this.$crud.show(a,s,i).then((t=>{this.subscriptionData=this.$clone(t.data),e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),t(!1)}))}))}else e(!0)}))},updateItem(){return new Promise(((e,t)=>{const s=this.$clone(this.subscriptionId);if(s){this.loading=!0;let a="apiRoutes.qplan.subscriptions";this.$crud.update(a,s,this.subscriptionData).then((t=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordUpdated")}`}),this.loading=!1,this.init(),e(!0)})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated"),pos:"bottom"}),this.loading=!1,t(!1)}))}else e(!0)}))}}};var $=s(68716),y=s(41628),v=s(14288),q=s(99140),V=s(95252),Q=s.n(V);const I=(0,$.c)(D,[["render",g]]),w=I;Q()(D,"components",{QLayout:y.c,QForm:v.c,QBtn:q.c})}}]);