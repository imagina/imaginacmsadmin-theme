"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[8486],{18486:(e,l,t)=>{t.r(l),t.d(l,{default:()=>J});var a=t(61758),s=t(58790);const o={id:"pageId",class:"q-layout-page layout-padding"},i={class:"relative-position q-mb-lg backend-page"},r={class:"box"},d={key:0,class:"row"},m={class:"col-12 q-mb-md"},n={key:0,class:"col-12 col-md-8"},c={class:"row q-col-gutter-sm"},u={class:"col-12"},p={class:"text-caption"},f={class:"col-4"},h={class:"col-8"},b={class:"row q-col-gutter-sm"},g={class:"col-12"},$={class:"text-caption"},v={class:"col-4"},y={class:"col-8"},V={key:0,class:"options-for-select"},T={key:1,class:"col-12 col-md-4"},q={class:"col-12 text-right"};function x(e,l,t,x,F,k){const R=(0,a.g2)("locales"),C=(0,a.g2)("q-input"),I=(0,a.g2)("q-select"),L=(0,a.g2)("optionsForSelect"),w=(0,a.g2)("q-checkbox"),U=(0,a.g2)("q-btn"),Q=(0,a.g2)("q-form"),A=(0,a.g2)("inner-loading");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.Lk)("div",i,[(0,a.Lk)("div",r,[F.success?((0,a.uX)(),(0,a.CE)("div",d,[(0,a.Lk)("div",m,[(0,a.bF)(R,{modelValue:F.locale,"onUpdate:modelValue":l[0]||(l[0]=e=>F.locale=e),ref:"localeComponent",form:e.$refs.formContent},null,8,["modelValue","form"])]),F.locale.success?((0,a.uX)(),(0,a.Wv)(Q,{key:0,autocorrect:"off",autocomplete:"off",ref:"formContent",class:"q-col-gutter-x-md full-width row",onSubmit:l[13]||(l[13]=e=>F.fieldId?k.update():k.create()),onValidationError:l[14]||(l[14]=l=>e.$alert.error(e.$tr("isite.cms.message.formInvalid")))},{default:(0,a.k6)((()=>[F.locale.success?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.bF)(C,{"data-testid":"name",outlined:"",dense:"",modelValue:F.locale.formTemplate.name,"onUpdate:modelValue":l[1]||(l[1]=e=>F.locale.formTemplate.name=e),label:`${e.$tr("isite.cms.form.name")}*`,rules:[l=>!!l||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","label","rules"]),(0,a.bF)(C,{"data-testid":"label",outlined:"",dense:"",modelValue:F.locale.formTemplate.label,"onUpdate:modelValue":l[2]||(l[2]=e=>F.locale.formTemplate.label=e),rules:[l=>!!l||e.$tr("isite.cms.message.fieldRequired")],label:`${e.$tr("iforms.cms.form.label")} (${F.locale.language})*`},null,8,["modelValue","rules","label"]),(0,a.bF)(C,{"data-testid":"placeholder",outlined:"",dense:"",modelValue:F.locale.formTemplate.placeholder,"onUpdate:modelValue":l[3]||(l[3]=e=>F.locale.formTemplate.placeholder=e),rules:[l=>!!l||e.$tr("isite.cms.message.fieldRequired")],label:`${e.$tr("iforms.cms.form.placeholder")} (${F.locale.language})*`},null,8,["modelValue","rules","label"]),(0,a.bF)(C,{"data-testid":"description",outlined:"",dense:"",modelValue:F.locale.formTemplate.description,"onUpdate:modelValue":l[4]||(l[4]=e=>F.locale.formTemplate.description=e),rules:[l=>!!l||e.$tr("isite.cms.message.fieldRequired")],label:`${e.$tr("isite.cms.form.description")} (${F.locale.language})*`},null,8,["modelValue","rules","label"]),(0,a.Lk)("div",c,[(0,a.Lk)("div",u,[(0,a.Lk)("span",p,(0,s.v_)(`${e.$tr("isite.cms.form.prefix")}`),1)]),(0,a.Lk)("div",f,[(0,a.bF)(I,{"data-testid":"prefixType",modelValue:F.locale.formTemplate.prefix.type,"onUpdate:modelValue":l[5]||(l[5]=e=>F.locale.formTemplate.prefix.type=e),options:F.prefixTypes,outlined:"",dense:"","emit-value":"","map-options":"",label:`${e.$tr("isite.cms.form.type")}`},null,8,["modelValue","options","label"])]),(0,a.Lk)("div",h,[(0,a.bF)(C,{"data-testid":"prefixValue",outlined:"",dense:"",label:`${e.$tr("iforms.cms.form.value")}`,modelValue:F.locale.formTemplate.prefix.value,"onUpdate:modelValue":l[6]||(l[6]=e=>F.locale.formTemplate.prefix.value=e)},null,8,["label","modelValue"])])]),(0,a.Lk)("div",b,[(0,a.Lk)("div",g,[(0,a.Lk)("span",$,(0,s.v_)(`${e.$tr("iforms.cms.form.suffix")}`),1)]),(0,a.Lk)("div",v,[(0,a.bF)(I,{"data-testid":"prefixType",modelValue:F.locale.formTemplate.suffix.type,"onUpdate:modelValue":l[7]||(l[7]=e=>F.locale.formTemplate.suffix.type=e),options:F.prefixTypes,outlined:"",dense:"","emit-value":"","map-options":"",label:`${e.$tr("isite.cms.form.type")}`},null,8,["modelValue","options","label"])]),(0,a.Lk)("div",y,[(0,a.bF)(C,{"data-testid":"suffix",outlined:"",dense:"",label:`${e.$tr("iforms.cms.form.value")}`,modelValue:F.locale.formTemplate.suffix.value,"onUpdate:modelValue":l[8]||(l[8]=e=>F.locale.formTemplate.suffix.value=e)},null,8,["label","modelValue"])])]),(0,a.bF)(I,{"data-testid":"type",modelValue:F.locale.formTemplate.width,"onUpdate:modelValue":l[9]||(l[9]=e=>F.locale.formTemplate.width=e),options:F.columnWidths,rules:[l=>!!l||e.$tr("isite.cms.message.fieldRequired")],outlined:"",dense:"","emit-value":"","map-options":"",label:`${e.$tr("isite.cms.form.width")}*`},null,8,["modelValue","options","rules","label"]),(0,a.bF)(I,{"data-testid":"type",modelValue:F.locale.formTemplate.type,"onUpdate:modelValue":l[10]||(l[10]=e=>F.locale.formTemplate.type=e),options:F.types,rules:[l=>!!l||e.$tr("isite.cms.message.fieldRequired")],outlined:"",dense:"","emit-value":"","map-options":"",label:`${e.$tr("isite.cms.form.type")}*`},null,8,["modelValue","options","rules","label"]),[5,6,8].indexOf(F.locale.formTemplate.type)>=0?((0,a.uX)(),(0,a.CE)("div",V,[(0,a.bF)(L,{model:F.locale.formTemplate},null,8,["model"])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),F.locale.success?((0,a.uX)(),(0,a.CE)("div",T,[(0,a.bF)(C,{"data-testid":"order",outlined:"",dense:"",modelValue:F.locale.formTemplate.order,"onUpdate:modelValue":l[11]||(l[11]=e=>F.locale.formTemplate.order=e),label:`${e.$tr("iforms.cms.form.order")}`},null,8,["modelValue","label"]),(0,a.bF)(w,{"data-testid":"required",label:e.$tr("isite.cms.form.required"),modelValue:F.locale.formTemplate.required,"onUpdate:modelValue":l[12]||(l[12]=e=>F.locale.formTemplate.required=e)},null,8,["label","modelValue"])])):(0,a.Q3)("",!0),(0,a.Lk)("div",q,[F.fieldId?((0,a.uX)(),(0,a.Wv)(U,{key:0,color:"positive",loading:F.loading,icon:"fas fa-edit",label:e.$tr("isite.cms.label.update"),rounded:"",type:"submit"},null,8,["loading","label"])):((0,a.uX)(),(0,a.Wv)(U,{key:1,color:"positive",loading:F.loading,icon:"fas fa-edit",label:e.$tr("isite.cms.label.create"),rounded:"",type:"submit"},null,8,["loading","label"]))])])),_:1},512)):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])]),(0,a.bF)(A,{visible:F.loading},null,8,["visible"])])}t(10239);function F(e,l,t,s,o,i){const r=(0,a.g2)("q-btn"),d=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-input"),n=(0,a.g2)("q-item"),c=(0,a.g2)("q-list");return(0,a.uX)(),(0,a.Wv)(c,{class:"q-mt-md"},{default:(0,a.k6)((()=>[(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.eW)(" Options "),(0,a.bF)(r,{onClick:l[0]||(l[0]=e=>i.add()),icon:"fa-light fa-plus",dense:"",flat:"",color:"primary"})])),_:1}),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.model.selectable,((e,l)=>((0,a.uX)(),(0,a.Wv)(n,{key:l,id:"optionSelect"+l},{default:(0,a.k6)((()=>[(0,a.bF)(d,{main:""},{default:(0,a.k6)((()=>[(0,a.bF)(m,{outlined:"",dense:"",modelValue:e.name,"onUpdate:modelValue":l=>e.name=l,placeholder:"Name Option"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,a.bF)(d,{right:""},{default:(0,a.k6)((()=>[(0,a.bF)(r,{onClick:l=>i.remove(e),icon:"fa fa-close",dense:"",flat:"",color:"primary"},null,8,["onClick"])])),_:2},1024)])),_:2},1032,["id"])))),128))])),_:1})}const k={props:{model:{type:Object,default:()=>({selectable:[]})}},data(){return{}},methods:{add(){let e={name:""};this.model.selectable.push(e)},remove(e){let l=this.model.selectable.findIndex((l=>l===e));this.model.selectable.splice(l,1)}}};var R=t(12807),C=t(54514),I=t(63418),L=t(69001),w=t(75329),U=t(78020),Q=t(98582),A=t.n(Q);const E=(0,R.A)(k,[["render",F]]),X=E;A()(k,"components",{QList:C.A,QItemSection:I.A,QBtn:L.A,QItem:w.A,QInput:U.A});var O=t(85401);const{hD:S,setScrollPosition:_}=O.Ay,D={components:{optionsForSelect:X},watch:{$route(e,l){this.initForm()}},mounted(){this.$nextTick((function(){this.initForm()}))},validations(){return this.getObjectValidation()},data(){return{locale:{},vTab:"data",loading:!1,loadingCategory:!1,success:!1,fieldId:!1,optionsTemplate:{categories:[],products:[],relatedProducts:[]},buttonActions:{label:"",value:1},modalShow:{category:!1},types:[],forms:[],fields:[],prefixTypes:[{value:"icon",label:this.$tr("isite.cms.form.icon")},{value:"text",label:this.$tr("isite.cms.label.text")}],columnWidths:[{value:12,label:this.$tr("iforms.cms.form.columns.full")},{value:9,label:this.$tr("iforms.cms.form.columns.nine")},{value:8,label:this.$tr("iforms.cms.form.columns.eight")},{value:6,label:this.$tr("iforms.cms.form.columns.six")},{value:4,label:this.$tr("iforms.cms.form.columns.four")},{value:3,label:this.$tr("iforms.cms.form.columns.three")}]}},computed:{dataLocale(){return{fields:{type:null,name:"",required:!1,formId:this.$route.params.formId,selectable:[],order:0,width:"12",prefix:{type:"icon",value:""},suffix:{type:"icon",value:""}},fieldsTranslatable:{label:"",placeholder:"",description:""}}},updateOptions(){this.$route.params.editOptions&&setTimeout((()=>{this.vTab="options";let e=S(this.$refs.productFormPage),l=this.$refs.productFormPage.scrollHeight;_(e,l,1e3)}),500)},options(){return{}},canManageRecordMaster(){return!0}},methods:{async initForm(){this.loading=!0,this.success=!1,this.vTab="data",this.locale=this.$clone(this.dataLocale),this.fieldId=this.$route.params.id,this.locale.success&&this.$refs.localeComponent.vReset(),await this.getData(),this.getTypes(),this.getForms(),this.getFields(),this.success=!0,this.updateOptions,this.loading=!1},getData(){return new Promise(((e,l)=>{const t=this.$clone(this.fieldId);if(t){let a="apiRoutes.qform.fields",s={refresh:!0,params:{filter:{allTranslations:!0}}};this.$crud.show(a,t,s).then((l=>{this.orderDataItemToLocale(l.data),e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{console.error(e),this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),this.loading=!1,l(!1)}))}))}else e(!0)}))},orderDataItemToLocale(e){let l=this.$clone(e);l.selectable=JSON.parse(e.selectable),this.locale.form=this.$clone(l)},async create(){if(await this.$refs.localeComponent.validateForm()){this.loading=!0;let e="apiRoutes.qform.fields";this.$crud.create(e,this.getDataForm()).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordCreated")} ID: ${e.data.id}`}),this.$router.push({name:"qform.admin.fields.index",params:{id:this.$route.params.formId}})})).catch((e=>{this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.recordNoCreated"),pos:"bottom"})}))}},async update(){if(await this.$refs.localeComponent.validateForm()){this.loading=!0;let e="apiRoutes.qform.fields";this.$crud.update(e,this.fieldId,this.getDataForm()).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordUpdated")}`}),this.initForm()})).catch((e=>{this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated"),pos:"bottom"})}))}},getDataForm(){let e=this.locale.form;for(var l in e){let t=e[l];null!=t&&void 0!=t||delete e[l]}return e.selectable=JSON.stringify(e.selectable),e.prefix=e.prefix||{type:"",value:""},e.suffix=e.suffix||{type:"",value:""},e},getTypes(){this.loading=!0;let e={params:{}};this.$crud.index("apiRoutes.qform.types",e).then((e=>{this.types=e.data.map((e=>({value:e.id,label:e.name}))),this.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),this.loading=!1}))}))},getForms(){this.loading=!0;let e={params:{}};this.$crud.index("apiRoutes.qform.forms",e).then((e=>{this.forms=e.data.map((e=>({value:e.id,label:e.title}))),this.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{console.error(e),this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),this.loading=!1}))}))},getFields(){this.loading=!0;let e={params:{}};this.$crud.index("apiRoutes.qform.fields",e).then((e=>{this.fields=e.data.map((e=>({value:e.id,label:e.label}))),this.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),this.loading=!1}))}))}}};var W=t(83333),N=t(21565),P=t(833),j=t(12225);const B=(0,R.A)(D,[["render",x]]),J=B;A()(D,"components",{QLayout:W.A,QForm:N.A,QInput:U.A,QSelect:P.A,QCheckbox:j.A,QBtn:L.A})}}]);