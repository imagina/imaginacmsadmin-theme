"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[8267],{8267:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ce});var i=s(61758);const r={id:"pageId",class:"q-layout-page layout-padding"},o={class:"q-mb-lg backend-page"},a={class:"row q-col-gutter-md"},n={class:"col-xs-12 col-md-5"},l={class:"box"},d={class:"row gutter-y-sm"},c={class:"col-12 relative-position"},m={class:"col-xs-12 col-md-7"},u={class:"box"},h={class:"row gutter-y-sm"},p={class:"col-12 relative-position"};function g(e,t,s,g,b,f){const v=(0,i.g2)("positionForm"),$=(0,i.g2)("inner-loading"),k=(0,i.g2)("positionBanners");return(0,i.uX)(),(0,i.CE)("div",r,[(0,i.Lk)("div",o,[(0,i.Lk)("div",a,[(0,i.Lk)("div",n,[(0,i.Lk)("div",l,[(0,i.Lk)("div",d,[(0,i.Lk)("div",c,[(0,i.bF)(v,{"form-data":b.position},null,8,["form-data"]),(0,i.bF)($,{visible:b.loading},null,8,["visible"])])])])]),(0,i.Lk)("div",m,[(0,i.Lk)("div",u,[(0,i.Lk)("div",h,[(0,i.Lk)("div",p,[b.loading?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(k,{key:0,position:b.position,onRefresh:t[0]||(t[0]=e=>f.getPosition(!0))},null,8,["position"])),(0,i.bF)($,{visible:b.loading},null,8,["visible"])])])])])])])])}const b={class:"row"},f={class:"col-12",style:{width:"100%"}},v={class:"text-right"};function $(e,t,s,r,o,a){const n=(0,i.g2)("q-input"),l=(0,i.g2)("q-select"),d=(0,i.g2)("q-checkbox"),c=(0,i.g2)("q-form"),m=(0,i.g2)("q-btn"),u=(0,i.g2)("inner-loading");return(0,i.uX)(),(0,i.CE)("div",b,[(0,i.Lk)("div",f,[(0,i.bF)(c,{class:"q-mt-lg",onSubmit:t[4]||(t[4]=e=>a.updateOrCreateSlider(o.form)),ref:"formContent",onValidationError:t[5]||(t[5]=t=>e.$alert.error(e.$tr("isite.cms.message.formInvalid"))),autocomplete:"off"},{default:(0,i.k6)((()=>[(0,i.bF)(n,{label:`${e.$tr("isite.cms.form.name")} *`,type:"text",outlined:"",dense:"",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],modelValue:o.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.name=e)},null,8,["label","rules","modelValue"]),(0,i.bF)(n,{label:`${e.$tr("isite.cms.form.slug")} *`,type:"text",outlined:"",dense:"",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],modelValue:o.form.systemName,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.systemName=e)},null,8,["label","rules","modelValue"]),(0,i.bF)(l,{label:e.$tr("isite.cms.form.status"),modelValue:o.form.active,"onUpdate:modelValue":t[2]||(t[2]=e=>o.form.active=e),"emit-value":"","map-options":"",options:[{label:e.$tr("isite.cms.label.enabled"),value:!0},{label:e.$tr("isite.cms.label.disabled"),value:!1}],outlined:"",dense:""},null,8,["label","modelValue","options"]),(0,i.bF)(d,{modelValue:o.form.showAsPopup,"onUpdate:modelValue":t[3]||(t[3]=e=>o.form.showAsPopup=e),label:e.$tr("ibanners.cms.label.showAsPopup"),"true-value":!0,"false-value":!1},null,8,["modelValue","label"])])),_:1},512),(0,i.Lk)("div",v,[(0,i.bF)(m,{onClick:t[6]||(t[6]=t=>e.$refs.formContent.submit()),icon:"fas fa-save",class:"btn-small",color:"green",label:e.$tr("isite.cms.label.save"),unelevated:"",rounded:"",loading:o.loading},null,8,["label","loading"])])]),(0,i.bF)(u,{visible:o.loading},null,8,["visible"])])}const k={name:"positionsForm",props:{formData:{type:Object}},watch:{formData:{deep:!0,handler:function(){this.setFormData()}}},mounted(){this.$nextTick((function(){this.setFormData()}))},data(){return{loading:!1,form:{options:{}}}},methods:{setFormData(){this.form=this.$clone(this.formData)},updateOrCreateSlider(e){this.loading=!0,this.form.id&&this.$crud.update("apiRoutes.qbanner.positions",e.id,e).then((e=>{this.$alert.info({message:this.$tr("isite.cms.message.recordUpdated")}),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated")}),this.loading=!1}))},hasPermissionRecordMAster(e){let t=e.options||!1,s={create:!0,edit:!0,index:!0,destroy:!0};return t&&parseInt(t.masterRecord)&&(s={create:this.$hasAccess("isite.master.records.create"),edit:this.$hasAccess("isite.master.records.edit"),index:this.$hasAccess("isite.master.records.index"),destroy:this.$hasAccess("isite.master.records.destroy")}),s}}};var y=s(12807),q=s(21565),C=s(78020),w=s(833),x=s(12225),A=s(69001),B=s(98582),F=s.n(B);const L=(0,y.A)(k,[["render",$]]),U=L;F()(k,"components",{QForm:q.A,QInput:C.A,QSelect:w.A,QCheckbox:x.A,QBtn:A.A});var V=s(58790);const D={class:"row relative-position"},E={class:"col-12"},R={class:"text-right q-mb-md"},O={class:"row items-center q-pa-sm"},Q={class:"col-6"},X={class:"col-6 text-right"},P={key:0,class:"full-width"},S=["src"],_={key:1,width:"100%",height:"300",class:"img-responsive center-block",loop:"",controls:"false"},I=["src"],N={key:1,class:"full-width"},T=["src"],j={key:1,width:"100%",height:"300",class:"img-responsive center-block",loop:"",controls:"false"},z=["src"];function M(e,t,r,o,a,n){const l=(0,i.g2)("crud"),d=(0,i.g2)("q-chip"),c=(0,i.g2)("q-btn"),m=(0,i.g2)("q-separator"),u=(0,i.g2)("q-card"),h=(0,i.g2)("draggable"),p=(0,i.g2)("inner-loading");return(0,i.uX)(),(0,i.CE)("div",D,[(0,i.Lk)("div",E,[(0,i.Lk)("div",R,[(0,i.bF)(l,{"crud-data":s.e(9627).then(s.bind(s,99627)),ref:"crudBanner",type:"button-create","crud-props":{unelevated:!0,rounded:!0},onUpdated:t[0]||(t[0]=t=>e.$emit("refresh")),onCreated:t[1]||(t[1]=t=>e.$emit("refresh")),"custom-data":{formLeft:{positionId:{value:e.$route.params.id}}}},null,8,["crud-data","custom-data"])]),(0,i.bF)(h,{onChange:n.updateOrderBanners,modelValue:r.position.banners,"onUpdate:modelValue":t[2]||(t[2]=e=>r.position.banners=e),group:"banners","item-key":"id"},{item:(0,i.k6)((({element:t,index:s})=>[((0,i.uX)(),(0,i.Wv)(u,{class:"my-card q-mb-md",key:"banner"+s},{default:(0,i.k6)((()=>[(0,i.Lk)("div",O,[(0,i.Lk)("div",Q,[(0,i.bF)(d,{square:"",icon:"fas fa-images","text-color":"white",color:t.active?"green":"grey"},{default:(0,i.k6)((()=>[(0,i.eW)((0,V.v_)(t.title),1)])),_:2},1032,["color"])]),(0,i.Lk)("div",X,[(0,i.bF)(c,{color:"blue-4",size:"sm",round:"",icon:"fas fa-pen",unelevated:"",class:"q-mr-sm",onClick:s=>e.$refs.crudBanner.update(t)},null,8,["onClick"]),(0,i.bF)(c,{onClick:e=>n.deleteBannerDialog(t.id,s),color:"red",unelevated:"",size:"sm",round:"",icon:"far fa-trash-alt"},null,8,["onClick"])])]),(0,i.bF)(m),t.imageUrl?((0,i.uX)(),(0,i.CE)("div",P,[t.imageUrl.indexOf("youtube.com")?((0,i.uX)(),(0,i.CE)("iframe",{key:0,width:"100%",height:"300",src:t.imageUrl,class:"tw-border-none",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,S)):t.imageUrl.indexOf(".mp4")?((0,i.uX)(),(0,i.CE)("video",_,[(0,i.Lk)("source",{src:t.imageUrl,type:"video/mp4"},null,8,I)])):((0,i.uX)(),(0,i.CE)("div",{key:2,style:(0,V.Tr)(`\n        background: url('${t.imageUrl}');\n        background-size: cover;\n        background-position: center;\n        height: 300px;\n        display: block;\n        max-width: 100%;`)},null,4))])):t.url?((0,i.uX)(),(0,i.CE)("div",N,[t.url.indexOf("youtube.com")?((0,i.uX)(),(0,i.CE)("iframe",{key:0,width:"100%",height:"300",src:t.url,class:"tw-border-none",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,T)):t.url.indexOf(".mp4")?((0,i.uX)(),(0,i.CE)("video",j,[(0,i.Lk)("source",{src:t.url,type:"video/mp4"},null,8,z)])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])),_:2},1024))])),_:1},8,["onChange","modelValue"])]),(0,i.bF)(p,{visible:a.loading},null,8,["visible"])])}const W={class:"q-mt-md"};function Y(e,t,s,r,o,a){return(0,i.uX)(),(0,i.CE)("div",W)}var G=s(71915);const H={props:{banner:{type:Object,default:()=>({imageUrl:""}),required:!0},index:{type:Number,required:!0}},methods:{deleteBannerDialog(e,t){this.$q.dialog({title:"Confirm",ok:"Delete",message:"You are sure to eliminate this slide?",cancel:!0,persistent:!0}).onOk((()=>{this.$crud.delete("apiRoutes.qbanner.banners",e).then((e=>{this.$alert.info({message:this.$tr("isite.cms.message.recordDeleted")}),G.Bt.emit("deleteBanner","deleteBanner")})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoDeleted"),pos:"bottom"})}))})).onCancel((()=>{}))},deleteBanner(e,t){}}},J=(0,y.A)(H,[["render",Y]]),K=J;var Z=s(10057),ee=s.n(Z);const te={name:"positionBanners",emits:["refresh"],components:{draggable:ee(),renderMedia:K},mounted(){this.init()},data(){return{loading:!1}},props:{position:{type:Object,default:()=>({id:0})}},watch:{},methods:{init(){this.openEditSlide()},openEditSlide(){setTimeout((()=>{if(this.$route.query.edit){let e=(this.position.banners||[]).find((e=>e.id==this.$route.query.edit));e&&this.$refs.crudBanner.update(e)}}),500)},hasPermissionRecordMAster(e){let t=e.options||!1,s={create:!0,edit:!0,index:!0,destroy:!0};return t&&parseInt(t.masterRecord)&&(s={create:this.$hasAccess("isite.master.records.create"),edit:this.$hasAccess("isite.master.records.edit"),index:this.$hasAccess("isite.master.records.index"),destroy:this.$hasAccess("isite.master.records.destroy")}),s},log(){let e=this.position.banners.map((e=>({id:e.id})));console.error(e)},updateOrderBanners(){let e=this.position.banners.map((e=>({id:e.id}))),t={banners:e};this.loading=!0,this.$crud.create("apiRoutes.qbanner.orderBanners",t).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordUpdated")}`}),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),console.warn(e),this.loading=!1}))},deleteBannerDialog(e,t){this.$q.dialog({title:"Confirm",ok:"Delete",message:"You are sure to eliminate this banner?",cancel:!0,persistent:!0}).onOk((()=>{this.$crud.delete("apiRoutes.qbanner.banners",e).then((e=>{this.$alert.info({message:this.$tr("isite.cms.message.recordDeleted")}),G.Bt.emit("deleteBanner","deleteBanner")})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoDeleted"),pos:"bottom"})}))})).onCancel((()=>{}))}}};var se=s(97569),ie=s(88141),re=s(37015);const oe=(0,y.A)(te,[["render",M]]),ae=oe;F()(te,"components",{QCard:se.A,QChip:ie.A,QBtn:A.A,QSeparator:re.A});const ne={components:{positionForm:U,positionBanners:ae},beforeUnmount(){G.Bt.off("deleteBanner",this.getPosition),G.Bt.off("page.data.refresh")},mounted(){this.init()},data(){return{loading:!1,position:{}}},methods:{init(){G.Bt.on("page.data.refresh",(()=>this.getPosition(!0))),this.getPosition(!0),G.Bt.on("deleteSlide",this.getPosition)},getPosition(e=!1){let t=this.$route.params.id,s={refresh:e,params:{}};this.loading=!0,this.$crud.show("apiRoutes.qbanner.positions",t,s).then((e=>{this.position=e.data,this.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{console.warn(e),this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"})}))}))}}};var le=s(83333);const de=(0,y.A)(ne,[["render",g]]),ce=de;F()(ne,"components",{QLayout:le.A})}}]);