"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[1724],{41876:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Js});var a=i(92444),s=i(74044);const o={id:"subContent",class:"row justify-between items-center"},n={class:"row items-center"},l={key:2,id:"fakeRouteInformationContent",class:"q-hide q-md-show"},r={id:"routerPageContent",class:"layout-padding"};function c(e,t,i,c,d,m){const u=(0,a.E1)("bannerAlert"),h=(0,a.E1)("q-tooltip"),p=(0,a.E1)("q-btn"),f=(0,a.E1)("q-breadcrumbs-el"),g=(0,a.E1)("q-breadcrumbs"),b=(0,a.E1)("activities"),w=(0,a.E1)("router-view"),v=(0,a.E1)("Alert"),Q=(0,a.E1)("q-page-container"),A=(0,a.E1)("cropper-component"),k=(0,a.E1)("activities-actions"),y=(0,a.E1)("notification-dialog"),q=(0,a.E1)("q-layout");return(0,a.Wz)(),(0,a.Az)(q,{id:"layoutMaster",view:"iadmin"==d.appConfig.mode?"lHh LpR lFf":"lHr LpR lFf"},{default:(0,a.Ql)((()=>[((0,a.Wz)(),(0,a.Az)((0,a.mk)(m.components.header))),((0,a.Wz)(),(0,a.Az)((0,a.mk)(m.components.drawer))),(0,a.K2)(Q,null,{default:(0,a.Ql)((()=>[m.isAppOffline||m.isWarning?((0,a.Wz)(),(0,a.Az)(u,(0,s.Gk)((0,a.Gu)({key:0},m.configBanner())),null,16)):(0,a.g1)("",!0),"iadmin"==d.appConfig.mode?((0,a.Wz)(),(0,a.An)("div",{key:1,id:"routeInformationContent",class:(0,s.WN)("q-hide q-md-show "+(1==m.iadminTheme?"bg-primary":"bg-white"))},[(0,a.QD)("div",o,[(0,a.QD)("div",n,[(0,a.K2)(p,{icon:"fas fa-arrow-left",unelevated:"",round:"",color:"primary",dense:"",class:"btn-small q-mr-md",onClick:t[0]||(t[0]=t=>e.$helper.backHistory())},{default:(0,a.Ql)((()=>[(0,a.K2)(h,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("isite.cms.label.back")),1)])),_:1})])),_:1}),(0,a.K2)(g,{class:"text-blue-grey"},{default:(0,a.Ql)((()=>[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(m.breadcrumbs,((e,t)=>((0,a.Wz)(),(0,a.Az)(f,{key:t,label:e.label,icon:e.icon,to:!!e.to&&{name:e.to}},null,8,["label","icon","to"])))),128))])),_:1})]),(0,a.K2)(b,(0,s.Gk)((0,a.o9)(m.globalActivities.helpCenter)),null,16)])],2)):(0,a.g1)("",!0),"iadmin"==d.appConfig.mode?((0,a.Wz)(),(0,a.An)("div",l)):(0,a.g1)("",!0),(0,a.QD)("div",r,[m.appState.loadPage?((0,a.Wz)(),(0,a.Az)(w,{key:0})):(0,a.g1)("",!0),(0,a.K2)(v)])])),_:1}),(0,a.K2)(A,{ref:"cropperComponent"},null,512),(0,a.K2)(b,(0,s.Gk)((0,a.o9)(m.globalActivities.adminPopup)),null,16),(0,a.K2)(k),((0,a.Wz)(),(0,a.Az)((0,a.mk)(m.components.footer))),(0,a.K2)(y)])),_:1},8,["view"])}i(23816);var d=i(8124);const m={id:"masterAdminHeader"},u={class:(0,s.WN)("q-hide q-md-show bg-primary")};function h(e,t,i,s,o,n){const l=(0,a.E1)("q-toolbar-title"),r=(0,a.E1)("site-actions"),c=(0,a.E1)("q-toolbar"),d=(0,a.E1)("q-header");return(0,a.Wz)(),(0,a.An)("div",m,[(0,a.K2)(d,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",u,[(0,a.K2)(c,{id:"toolbarTop",color:"primary"},{default:(0,a.Ql)((()=>[(0,a.K2)(l),(0,a.K2)(r)])),_:1})])])),_:1})])}const p={id:"siteActionscomponent"},f={class:"q-py-sm q-px-md"},g={class:"text-subtitle1 text-primary"},b={class:"text-caption text-blue-grey"},w={class:"q-ml-xs q-mr-sm text-blue-grey"},v={class:"row no-wrap q-pa-md"},Q={class:"column"},A={style:{"max-width":"110px"}},k={class:"text-center"},y=["src"],q={class:"text-subtitle1 ellipsis q-mt-md"},$={class:"ellipsis text-caption"},z={class:"column text-left"};function x(e,t,i,o,n,l){const r=(0,a.E1)("q-separator"),c=(0,a.E1)("q-icon"),d=(0,a.E1)("q-item-section"),m=(0,a.E1)("q-item"),u=(0,a.E1)("q-list"),h=(0,a.E1)("q-menu"),x=(0,a.E1)("q-tooltip"),D=(0,a.E1)("q-badge"),E=(0,a.E1)("q-btn"),W=(0,a.E1)("q-avatar"),S=(0,a.iS)("ripple"),K=(0,a.iS)("close-popup");return(0,a.Wz)(),(0,a.An)("div",p,[(0,a.QD)("div",{class:(0,s.WN)(`row q-gutter-${i.gutter}`)},[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(l.actions.buttons,((t,i)=>((0,a.Wz)(),(0,a.An)(a.ae,null,[void 0==t?.vIf||t.vIf?((0,a.Wz)(),(0,a.Az)(E,(0,a.Gu)({key:i},t.props,{onClick:e=>void 0!=t.action?t.action():null}),{default:(0,a.Ql)((()=>[t.menu?((0,a.Wz)(),(0,a.Az)(h,{key:0,fit:""},{default:(0,a.Ql)((()=>[(0,a.QD)("div",f,[(0,a.QD)("div",g,(0,s.WA)(t.label),1),(0,a.K2)(r,{class:"q-my-sm"}),(0,a.QD)("div",b,(0,s.WA)(e.$tr("isite.cms.message.descriptionHelpCenter"))+".",1),(0,a.K2)(u,{separator:"",class:"no-shadow",style:{"min-width":"260px"}},{default:(0,a.Ql)((()=>[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(t.menu.actions,((e,t)=>(0,a.wt)(((0,a.Wz)(),(0,a.Az)(m,{key:t,clickable:"",onClick:t=>void 0!=e.action?e.action():null},{default:(0,a.Ql)((()=>[(0,a.K2)(d,{class:"text-blue-grey"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",null,[(0,a.K2)(c,{name:e.icon,class:"q-mr-sm",color:"primary",size:"xs"},null,8,["name"]),(0,a.mY)(" "+(0,s.WA)(e.label),1)])])),_:2},1024),(0,a.K2)(d,{side:""},{default:(0,a.Ql)((()=>[(0,a.K2)(c,{name:"fa-light fa-chevron-right",size:"12px"})])),_:1})])),_:2},1032,["onClick"])),[[S],[K]]))),128))])),_:2},1024)])])),_:2},1024)):(0,a.g1)("",!0),(0,a.K2)(x,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(t.label),1)])),_:2},1024),t.badgeLabel||t.badge?((0,a.Wz)(),(0,a.Az)(D,{key:1,color:t.badgeColor||"orange",rounded:"",floating:""},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(t.badgeLabel),1)])),_:2},1032,["color"])):(0,a.g1)("",!0)])),_:2},1040,["onClick"])):(0,a.g1)("",!0)],64)))),256)),l.quserState.authenticated&&"iadmin"==n.configMode?((0,a.Wz)(),(0,a.Az)(E,{key:0,id:"profileButton",rounded:"","no-caps":"",padding:"2px 8px",color:"white",unelevated:""},{default:(0,a.Ql)((()=>[(0,a.QD)("div",{id:"profileImage",class:"img-as-bg",style:(0,s.MN)(`background-image: url('${l.profileImage.smallThumb}')`)},null,4),(0,a.QD)("div",w,(0,s.WA)(l.quserState.userData.firstName),1),(0,a.K2)(c,{name:"fas fa-chevron-down",size:"14px",color:"blue-grey"}),(0,a.K2)(h,{anchor:"bottom right",self:"top right"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",v,[(0,a.QD)("div",Q,[(0,a.QD)("div",A,[(0,a.QD)("div",k,[(0,a.K2)(W,{size:"72px",class:"q-mx-auto"},{default:(0,a.Ql)((()=>[(0,a.QD)("img",{src:l.profileImage.mediumThumb},null,8,y)])),_:1})]),(0,a.QD)("div",q,(0,s.WA)(l.quserState.userData.fullName),1),(0,a.QD)("div",$,(0,s.WA)(l.quserState.userData.roles.map((e=>e.name)).join(", ")),1)])]),(0,a.K2)(r,{vertical:"",inset:"",class:"q-ml-lg q-mr-sm"}),(0,a.QD)("div",z,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(l.actions.menu,((e,t)=>((0,a.Wz)(),(0,a.An)(a.ae,null,[void 0==e?.vIf||e.vIf?(0,a.wt)(((0,a.Wz)(),(0,a.Az)(E,(0,a.Gu)({key:t},e.props,{padding:"xs md",onClick:t=>void 0!=e.action?e.action():null}),null,16,["onClick"])),[[K]]):(0,a.g1)("",!0)],64)))),256))])])])),_:1})])),_:1})):(0,a.g1)("",!0)],2)])}var D=i(8932),E=i(18528)["c"];const W={beforeUnmount(){D.kN.off("header.badge.manage")},props:{gutter:{type:String,default:"sm"},size:{type:String,default:"small"}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{configMode:E("app.mode"),badge:{chat:!1,notification:!1},defaultButtonProps:{round:!0,dense:!0,color:"white",unelevated:!0,class:"btn-small",textColor:"blue-grey",noCaps:!0}}},computed:{isAppOffline(){return this.$store.state.qofflineMaster.isAppOffline},quserState(){return this.$store.state.quserAuth},theme(){return parseInt(this.$getSetting("isite::iadminTheme"))},params(){return this.$clone(this.$route.meta.subHeader||{})},showGoToSiteButton(){return this.$getSetting("isite::showGoToSiteButton")||!1},actions(){let e=this.$store.state.qsiteApp.baseUrl;if(this.quserState.organizationId){let t=this.quserState.organizations.find((e=>e.id==this.quserState.organizationId));t&&(e=t.url)}return{buttons:[{vIf:this.$getSetting("isite::offline"),name:"offline",label:this.$tr("isite.cms.label.offline"),badgeColor:"orange",badgeLabel:this.$store.state.qofflineMaster.totalRequests,props:{...this.defaultButtonProps,icon:"fa-light fa-cloud-slash",class:"btn-small"},action:()=>D.kN.emit("toggleMasterDrawer","offline")},{vIf:this.showGoToSiteButton,name:"goToSite",label:this.$tr("isite.cms.configList.goToSite"),props:{...this.defaultButtonProps,label:this.$tr("isite.cms.showSite"),type:"a",id:"siteActionGoToSite",href:e,target:"_blank",round:!1,rounded:!0,padding:"xs md"}},{name:"checking",vIf:"ipanel"==E("app.mode")&&this.$hasAccess("icheckin.shifts.create"),label:this.$tr("icheckin.cms.sidebar.checkin"),props:{...this.defaultButtonProps,icon:"fas fa-stopwatch",round:!0},action:()=>D.kN.emit("toggleMasterDrawer","checkin")},{name:"chat",label:"Chat",vIf:"iadmin"==E("app.mode")&&this.$hasAccess("ichat.conversations.index"),badge:this.badge.chat,props:{...this.defaultButtonProps,icon:"fa-light fa-message-lines",class:"btn-small"},action:()=>D.kN.emit("toggleMasterDrawer","chat")},{name:"notifications",label:this.$trp("isite.cms.label.notification"),badge:this.badge.notification,props:{...this.defaultButtonProps,icon:"fa-light fa-bell",class:"btn-small"},action:()=>D.kN.emit("toggleMasterDrawer","notification")},{name:"helpCenter",label:this.$trp("isite.cms.label.helpCenter"),vIf:parseInt(this.$getSetting("isite::hcStatus")||"0"),props:{id:"siteActionHelpCenter",...this.defaultButtonProps,icon:"fal fa-question-circle"},menu:{actions:[{icon:"fa-light fa-question-circle",label:"FAQ",action:()=>D.kN.emit("toggleHelpSection",{sectionName:"faq"})}]}},{name:"clearCache",label:this.$tr("isite.cms.configList.clearCache"),props:{...this.defaultButtonProps,icon:"fa-light fa-broom"},action:()=>this.$router.push({name:"app.update.app",query:{fromCache:1}})}],menu:[{name:"profile",props:{...this.defaultButtonProps,label:this.$tr("iprofile.cms.sidebar.panelProfile"),icon:"fa-light fa-circle-user",round:!1,rounded:!0,align:"left",id:"profileButton"},action:()=>"user.profile.me"!=this.$route.name?this.$router.push({name:"user.profile.me"}):null},{name:"settings",vIf:"iadmin"==E("app.mode"),props:{...this.defaultButtonProps,label:this.$trp("isite.cms.label.setting"),icon:"fa-light fa-folder-gear",round:!1,rounded:!0,align:"left"},action:()=>D.kN.emit("toggleMasterDrawer","config")},{name:"settings",vIf:"iadmin"==E("app.mode")&&!this.isAppOffline,props:{...this.defaultButtonProps,label:this.$tr("isite.cms.configList.signOut"),icon:"fa-light fa-right-from-bracket",round:!1,rounded:!0,align:"left"},action:this.logout}]}},profileImage(){return this.$store.getters["quserAuth/profileImage"]}},methods:{init(){D.kN.on("header.badge.manage",(e=>{Object.keys(e).forEach((t=>this.badge[t]=e[t]))}))},logout(){this.$router.push({name:"auth.logout"})}}};var S=i(68716),K=i(99140),C=i(93832),_=i(70880),I=i(99588),M=i(84884),T=i(11032),N=i(58120),L=i(90111),B=i(29104),P=i(11252),R=i(85220),V=i(81020),U=i(95252),H=i.n(U);const O=(0,S.c)(W,[["render",x]]),Y=O;H()(W,"components",{QBtn:K.c,QMenu:C.c,QSeparator:_.c,QList:I.c,QItem:M.c,QItemSection:T.c,QIcon:N.c,QTooltip:L.c,QBadge:B.c,QAvatar:P.c}),H()(W,"directives",{Ripple:R.c,ClosePopup:V.c});var F=i(18528)["c"];const j={props:{},components:{siteActions:Y},mounted(){this.$nextTick((function(){this.init()}))},data(){return{projectName:this.$getSetting("core::site-name"),logo:this.$store.state.qsiteApp.logo,appConfig:F("app"),loadHeaderIpanel:!1}},computed:{quserState(){return this.$store.state.quserAuth}},methods:{init(){},getHeaderIpanel(){"ipanel"==F("app.mode")&&this.$remember.async({key:"headerIpanelHTML",seconds:10800,refresh:!1,callBack:()=>new Promise(((e,t)=>{let i=this.$store.state.qsiteApp.baseUrl;this.$axios.get(i+"/isite/header").then((t=>{e(t)})).catch((e=>{console.error("[HEADER-IPANEL]",e.response),t(e.response)}))}))}).then((e=>{var t=document.createElement("template");t.innerHTML=e.data,window.customElements.define("embedded-header-ipanel",class extends HTMLElement{connectedCallback(){const e=this.attachShadow({mode:"closed"});e.appendChild(document.importNode(t.content,!0))}}),this.loadHeaderIpanel=!0})).catch((e=>{console.error("[HEADER-IPANEL]",e)}))}}};var G=i(88936),J=i(6536),Z=i(36524);const X=(0,S.c)(j,[["render",h]]),ee=X;H()(j,"components",{QHeader:G.c,QToolbar:J.c,QToolbarTitle:Z.c});const te={id:"masterAdminHeader"},ie={class:(0,s.WN)("q-hide q-md-show")};function ae(e,t,i,s,o,n){const l=(0,a.E1)("q-btn"),r=(0,a.E1)("q-toolbar-title"),c=(0,a.E1)("site-actions"),d=(0,a.E1)("q-toolbar"),m=(0,a.E1)("q-header");return(0,a.Wz)(),(0,a.An)("div",te,[(0,a.K2)(m,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",ie,[(0,a.K2)(d,{id:"toolbarTop"},{default:(0,a.Ql)((()=>["iadmin"===o.appConfig.mode?((0,a.Wz)(),(0,a.Az)(l,{key:0,icon:"fas fa-bars",unelevated:"",class:"text-primary buttonToogleMenuClose",onClick:t[0]||(t[0]=e=>o.eventBus.emit("toggleMasterDrawer","menu"))})):(0,a.g1)("",!0),(0,a.K2)(r),(0,a.K2)(c)])),_:1})])])),_:1})])}var se=i(18528)["c"];const oe={components:{siteActions:Y},mounted(){this.$nextTick((function(){this.init()}))},data(){return{projectName:this.$getSetting("core::site-name"),logo:this.$store.state.qsiteApp.logo,appConfig:se("app"),loadHeaderIpanel:!1,eventBus:D.kN}},computed:{quserState(){return this.$store.state.quserAuth}},methods:{init(){},getHeaderIpanel(){"ipanel"==se("app.mode")&&this.$remember.async({key:"headerIpanelHTML",seconds:10800,refresh:!1,callBack:()=>new Promise(((e,t)=>{let i=this.$store.state.qsiteApp.baseUrl;this.$axios.get(i+"/isite/header").then((t=>{e(t)})).catch((e=>{console.error("[HEADER-IPANEL]",e.response),t(e.response)}))}))}).then((e=>{var t=document.createElement("template");t.innerHTML=e.data,window.customElements.define("embedded-header-ipanel",class extends HTMLElement{connectedCallback(){const e=this.attachShadow({mode:"closed"});e.appendChild(document.importNode(t.content,!0))}}),this.loadHeaderIpanel=!0})).catch((e=>{console.error("[HEADER-IPANEL]",e)}))}}},ne=(0,S.c)(oe,[["render",ae]]),le=ne;H()(oe,"components",{QHeader:G.c,QToolbar:J.c,QBtn:K.c,QToolbarTitle:Z.c});const re={id:"masterDrawers1"},ce={id:"logoSite",class:"relative-position"},de={id:"versionContent",class:"absolute absolute-bottom-right text-white"};function me(e,t,i,o,n,l){const r=(0,a.E1)("q-img"),c=(0,a.E1)("q-icon"),d=(0,a.E1)("menu-list"),m=(0,a.E1)("q-scroll-area"),u=(0,a.E1)("q-drawer"),h=(0,a.E1)("config-list"),p=(0,a.E1)("chat-list"),f=(0,a.E1)("master-recommendation"),g=(0,a.E1)("master-notifications"),b=(0,a.E1)("offline");return(0,a.Wz)(),(0,a.An)("div",re,[(0,a.K2)(u,{id:"menuMaster",class:"no-shadow",modelValue:n.drawer.menu,"onUpdate:modelValue":t[0]||(t[0]=e=>n.drawer.menu=e),ref:"menuMaster",onClickCapture:t[1]||(t[1]=e=>n.miniState?n.eventBus.emit("toggleMasterDrawer","menu"):null)},{default:(0,a.Ql)((()=>[(0,a.QD)("div",ce,[(0,a.K2)(r,{fit:"contain",src:l.logo,style:{height:"80px","min-height":"80px"}},null,8,["src"]),(0,a.QD)("div",de,[(0,a.K2)(c,{name:"fas fa-code-branch",class:"q-mr-xs"}),(0,a.mY)(" "+(0,s.WA)(l.versionText),1)])]),(0,a.K2)(m,{id:"adminMenu",style:(0,s.MN)("height: calc(100vh - 146px")},{default:(0,a.Ql)((()=>[(0,a.K2)(d,{ref:"menuList",group:"",translatable:e.menuTranslatable,menu:e.menuSelect},null,8,["translatable","menu"])])),_:1},8,["style"])])),_:1},8,["modelValue"]),(0,a.K2)(u,{bordered:"",id:"configMaster",overlay:"",modelValue:n.drawer.config,"onUpdate:modelValue":t[2]||(t[2]=e=>n.drawer.config=e),side:"right"},{default:(0,a.Ql)((()=>[(0,a.K2)(h)])),_:1},8,["modelValue"]),e.$hasAccess("ichat.conversations.index")?((0,a.Wz)(),(0,a.Az)(u,{key:0,bordered:"",id:"chatMaster",overlay:"",modelValue:n.drawer.chat,"onUpdate:modelValue":t[3]||(t[3]=e=>n.drawer.chat=e),side:"right"},{default:(0,a.Ql)((()=>[(0,a.K2)(p)])),_:1},8,["modelValue"])):(0,a.g1)("",!0),!l.routeSubHeader.recommendations?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.Az)(u,{key:1,id:"drawerRecommendationMaster",modelValue:n.drawer.recommendation,"onUpdate:modelValue":t[4]||(t[4]=e=>n.drawer.recommendation=e),side:"right",behavior:"mobile",overlay:!0},{default:(0,a.Ql)((()=>[(0,a.K2)(f)])),_:1},8,["modelValue"])),(0,a.K2)(g,{"is-open":n.drawer.notification,isMobile:"mobile"==this.windowSize},null,8,["is-open","isMobile"]),e.$getSetting("isite::offline")?((0,a.Wz)(),(0,a.Az)(u,{key:2,bordered:"",id:"drawerOfflineMaster",modelValue:n.drawer.offline,"onUpdate:modelValue":t[5]||(t[5]=e=>n.drawer.offline=e),side:"right",overlay:""},{default:(0,a.Ql)((()=>[(0,a.K2)(b)])),_:1},8,["modelValue"])):(0,a.g1)("",!0)])}var ue=i(38688);const he={id:"configList",class:"q-pa-md"},pe={class:"row justify-between items-center"},fe={class:"text-subtitle1 row items-center"},ge={key:0},be={class:"title-block q-mb-sm"},we={key:0,class:"q-py-none"},ve={class:"full-width text-primary"},Qe={key:0,class:"q-mt-xs"},Ae={key:1,class:"q-py-sm"},ke={class:"row items-center"},ye={key:0},qe={key:1,class:"q-py-sm"},$e={key:2,color:"grey-10",style:{"text-decoration":"none"}},ze={class:"title-block"},xe={class:"q-mt-xs q-px-sm"},De={class:"text-primary"},Ee={class:"block text-grey-8",style:{"line-height":"1.4"}},We={class:"q-mt-xs q-px-sm"},Se={class:"text-primary"},Ke={class:"block text-grey-8",style:{"line-height":"1.4"}},Ce={class:"title-block q-mb-sm"},_e={key:1,class:"q-px-sm text-grey-7",style:{"line-height":"1.2"}},Ie={class:"title-block"},Me={class:"q-mt-xs q-px-sm"},Te={class:"text-primary"},Ne={key:1,class:"block ellipsis"},Le={class:"title-block"},Be=["onClick"],Pe={class:"title-block"},Re={class:"text-subtitle2 fixed fixed-bottom text-blue-grey q-px-md q-py-sm text-right"};function Ve(e,t,i,o,n,l){const r=(0,a.E1)("q-icon"),c=(0,a.E1)("q-separator"),d=(0,a.E1)("q-item-section"),m=(0,a.E1)("q-item"),u=(0,a.E1)("q-select"),h=(0,a.E1)("q-spinner"),p=(0,a.E1)("q-no-ssr"),f=(0,a.E1)("dynamic-field");return(0,a.Wz)(),(0,a.An)("div",he,[(0,a.QD)("div",pe,[(0,a.QD)("div",fe,[(0,a.K2)(r,{name:"fas fa-cog",color:"primary",size:"20px",class:"q-mr-sm"}),(0,a.QD)("label",null,(0,s.WA)(e.$tr("isite.cms.label.configuration",{capitalize:!0})),1)]),(0,a.K2)(r,{name:"fas fa-times",color:"blue-grey",size:"20px",class:"cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","config"))})]),(0,a.K2)(c,{class:"q-my-md"}),(0,a.K2)(p,null,{default:(0,a.Ql)((()=>[e.$hasAccess("profile.user.impersonate")||l.quserState.impersonating?((0,a.Wz)(),(0,a.An)("div",ge,[(0,a.QD)("div",be,(0,s.WA)(e.$tr("isite.cms.label.impersonate")),1),l.quserState.impersonating?((0,a.Wz)(),(0,a.Az)(m,{key:1,tag:"label",link:"",onClick:l.impersonate},{default:(0,a.Ql)((()=>[(0,a.K2)(d,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",ke,[n.loadingImpersonate?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.An)("div",ye,[(0,a.K2)(r,{color:"red",class:"q-mr-sm",name:"fas fa-sign-out-alt",size:"20px"})])),n.loadingImpersonate?((0,a.Wz)(),(0,a.An)("div",qe,[(0,a.K2)(h,{class:"q-mr-sm"}),(0,a.mY)(" "+(0,s.WA)(`${e.$tr("isite.cms.label.loading")}...`),1)])):(0,a.g1)("",!0),n.loadingImpersonate?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.An)("div",$e,(0,s.WA)(e.$t("isite.cms.configList.leaveImpersonating",{capitalize:!0})),1))])])),_:1})])),_:1},8,["onClick"])):((0,a.Wz)(),(0,a.An)("div",we,[(0,a.QD)("div",ve,[n.loadingImpersonate?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.An)("div",Qe,[(0,a.K2)(u,{outlined:"",dense:"",modelValue:n.userToImpersonate,"onUpdate:modelValue":[t[1]||(t[1]=e=>n.userToImpersonate=e),t[2]||(t[2]=e=>l.impersonate())],"use-input":"","hide-selected":"","emit-value":"","map-options":"","input-debounce":"800",options:n.userList,onFilter:l.getUsers,placeholder:`${e.$tr("isite.cms.label.find")} ${e.$tr("isite.cms.label.user")}...`,style:{width:"100%"}},{"no-option":(0,a.Ql)((()=>[(0,a.K2)(m,null,{default:(0,a.Ql)((()=>[(0,a.K2)(d,{class:"text-grey"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("isite.cms.message.searchNotFound")),1)])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","placeholder"])])),n.loadingImpersonate?((0,a.Wz)(),(0,a.An)("div",Ae,[(0,a.K2)(h,{class:"q-mr-sm"}),(0,a.mY)(" "+(0,s.WA)(`${e.$tr("isite.cms.label.loading")}...`),1)])):(0,a.g1)("",!0)])]))])):(0,a.g1)("",!0)])),_:1}),e.$hasAccess("profile.user.impersonate")||l.quserState.impersonating?((0,a.Wz)(),(0,a.Az)(c,{key:0,class:"q-my-md"})):(0,a.g1)("",!0),(0,a.K2)(p,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",ze,(0,s.WA)(e.$tr("isite.cms.label.session",{capitalize:!0})),1),(0,a.QD)("div",xe,[(0,a.QD)("div",De,[(0,a.K2)(r,{name:"fas fa-user-circle"}),(0,a.mY)(" "+(0,s.WA)(e.$trp("isite.cms.label.role")),1)]),(0,a.QD)("label",Ee,(0,s.WA)(l.quserState.userData.roles.map((e=>e.name)).join(", ")),1)]),(0,a.QD)("div",We,[(0,a.QD)("div",Se,[(0,a.K2)(r,{name:"fas fa-people-arrows"}),(0,a.mY)(" "+(0,s.WA)(this.$trp("iprofile.cms.label.userGroup")),1)]),(0,a.QD)("label",Ke,(0,s.WA)(l.quserState.userData.departments.map((e=>e.title)).join(", ")),1)])])),_:1}),e.$hasAccess("profile.user.impersonate")||l.quserState.impersonating?((0,a.Wz)(),(0,a.Az)(c,{key:1,class:"q-my-md"})):(0,a.g1)("",!0),l.organizationField?((0,a.Wz)(),(0,a.Az)(p,{key:2},{default:(0,a.Ql)((()=>[(0,a.QD)("div",Ce,(0,s.WA)(e.$tr("isite.cms.label.organization")),1),l.organizationField?((0,a.Wz)(),(0,a.Az)(f,{key:0,modelValue:n.organizationId,"onUpdate:modelValue":[t[3]||(t[3]=e=>n.organizationId=e),l.setOrganization],field:l.organizationField},null,8,["modelValue","field","onUpdate:modelValue"])):((0,a.Wz)(),(0,a.An)("div",_e,(0,s.WA)(e.$tr("isite.cms.messages.noOrganization"))+"... ",1))])),_:1})):(0,a.g1)("",!0),(0,a.K2)(c,{class:"q-my-md"}),(0,a.QD)("div",null,[(0,a.QD)("div",Ie,(0,s.WA)(e.$tr("isite.cms.label.language",{capitalize:!0})),1),(0,a.QD)("div",Me,[(0,a.QD)("div",Te,[(0,a.K2)(r,{name:"fas fa-language"}),(0,a.mY)(" "+(0,s.WA)(e.$tr("isite.cms.label.language",{capitalize:!0})),1)]),n.show.locales?((0,a.Wz)(),(0,a.Az)(u,{key:0,options:n.options.locales,dense:"",outlined:"","emit-value":"","map-options":"",filter:"","hide-underline":"","onUpdate:modelValue":[l.updateLocale,t[4]||(t[4]=e=>n.locale=e)],modelValue:n.locale,class:"full-width q-if-focused q-if-focusable"},null,8,["options","onUpdate:modelValue","modelValue"])):((0,a.Wz)(),(0,a.An)("label",Ne,(0,s.WA)(n.options.locales[0].label),1))])]),(0,a.K2)(c,{class:"q-my-md"}),((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(l.customConfigs,(t=>((0,a.Wz)(),(0,a.An)("div",null,[(0,a.QD)("div",Le,(0,s.WA)(e.$trp(t.moduleTitle,{capitalize:!0})),1),((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(t.configList,(t=>((0,a.Wz)(),(0,a.An)("div",{class:"q-px-sm cursor-pointer q-pt-md",onClick:e=>t.action()},[(0,a.K2)(r,{color:"primary",size:"18px",name:t.icon,class:"q-mr-sm"},null,8,["name"]),(0,a.mY)(" "+(0,s.WA)(e.$t(t.title,{capitalize:!0})),1)],8,Be)))),256))])))),256)),(0,a.K2)(c,{class:"q-my-md"}),(0,a.QD)("div",null,[(0,a.QD)("div",Pe,(0,s.WA)(e.$trp("isite.cms.label.action",{capitalize:!0})),1),(0,a.QD)("div",{class:"q-px-sm cursor-pointer q-pt-md",onClick:t[5]||(t[5]=t=>e.$router.push({name:"app.update.app",query:{fromCache:1}}))},[(0,a.K2)(r,{color:"primary",size:"18px",name:"fas fa-broom",class:"q-mr-sm"}),(0,a.mY)(" "+(0,s.WA)(e.$t("isite.cms.configList.clearCache",{capitalize:!0})),1)]),(0,a.QD)("div",{class:"q-px-sm cursor-pointer q-pt-md",onClick:t[6]||(t[6]=e=>l.toggleFullscreen())},[(0,a.K2)(r,{color:"primary",size:"18px",name:"fas fa-expand",class:"q-mr-sm"}),(0,a.mY)(" "+(0,s.WA)(e.$t("isite.cms.configList.fullScreen",{capitalize:!0})),1)]),(0,a.K2)(p,null,{default:(0,a.Ql)((()=>[l.quserState.authenticated?((0,a.Wz)(),(0,a.An)("div",{key:0,class:"q-px-sm cursor-pointer q-pt-md",onClick:t[7]||(t[7]=t=>e.$router.push({name:"auth.logout"}))},[(0,a.K2)(r,{color:"red",size:"18px",name:"fas fa-sign-out-alt",class:"q-mr-sm"}),(0,a.mY)(" "+(0,s.WA)(e.$t("isite.cms.configList.signOut",{capitalize:!0})),1)])):(0,a.g1)("",!0)])),_:1})]),(0,a.QD)("div",Re,[(0,a.K2)(r,{name:"fas fa-code-branch",class:"q-mr-xs"}),(0,a.mY)(" "+(0,s.WA)(l.versionText),1)])])}var Ue=i(18528)["c"];const He={mounted(){this.$nextTick((async function(){this.setOptions()}))},data(){return{valueConsistsOf:"BRANCH_PRIORITY",organizationId:this.$clone(this.$store.state.quserAuth.organizationId),roleId:!1,departmentId:!1,locale:this.$store.state.qsiteApp.defaultLocale,options:{roles:this.$store.getters["quserAuth/userRolesSelect"],departments:this.$store.getters["quserAuth/userDepartmentsSelect"],locales:this.$store.getters["qsiteApp/getSelectedLocalesSelect"]},show:{roles:!1,departments:!1,locales:!1},fullScreen:this.$q?.fullscreen?.isActive,userToImpersonate:null,loadingImpersonate:!1,userList:[],loadingCacheClear:!1,eventBus:D.kN}},computed:{isAppOffline(){return this.$store.state.qofflineMaster.isAppOffline},customConfigs(){const e=Object.values(Ue("main")).map((e=>e.configList?{moduleTitle:e.moduleTitle,configList:e.configList}:{moduleTitle:e.moduleTitle,configList:[]}));return e.filter((e=>e.configList.length>0))},versionText(){return"v"+Ue("app.version")},quserState(){return this.$store.state.quserAuth},forceRoleAndDepartment(){return Ue("app.forceRoleAndDepartment")},organizationField(){let e=this.$store.state.quserAuth.organizations||[];return!!e.length&&{value:null,type:"select",props:{label:this.$tr("isite.cms.label.organization"),options:e.map((e=>({label:e.title,value:e.id}))),readonly:1==e.length}}}},methods:{toggleFullscreen(){this.$q?.fullscreen?.toggle()},async setOptions(){let e=await this.$cache.get.item("auth.role.id"),t=await this.$cache.get.item("auth.department.id");this.roleId=e,this.departmentId=t,this.options.roles.length>=2&&(this.show.roles=!0),this.options.departments.length>=2&&(this.show.departments=!0),1==this.options.departments.length&&this.options.departments[0].children&&(this.show.departments=!0),this.options.locales.length>=2&&(this.show.locales=!0)},async updateDepRolUser(e=!1){if(this.forceRoleAndDepartment){const e=await this.$cache.get.item("auth.department.id"),t=await this.$cache.get.item("auth.role.id");e==this.departmentId&&t==this.roleId||(await this.$cache.set("auth.department.id",this.departmentId),await this.$cache.set("auth.role.id",this.roleId),this.$store.dispatch("qsiteApp/REFRESH_PAGE"))}},async updateLocale(){this.$store.dispatch("qsiteApp/SET_LOCALE",{locale:this.locale,vue:this}).then((e=>{this.$store.dispatch("qsiteApp/REFRESH_PAGE")})).catch((e=>console.error(e)))},getUsers(e,t,i){if(e.length<2)return i();let a={params:{take:100,filter:{search:e}}};this.$crud.index("apiRoutes.quser.users",a).then((e=>{t((()=>{let t=this.$store.state.quserAuth.userId,i=[];e.data.forEach((e=>{e.id!=t&&i.push({label:e.fullName,value:e.id})})),this.userList=this.$clone(i)}))})).catch((e=>{this.$apiResponse.handleError(e,(()=>{t((()=>{this.userList=[]}))}))}))},async impersonate(){this.loadingImpersonate=!0,this.quserState.impersonating?await this.$store.dispatch("quserAuth/USER_LEAVE_IMPERSONATE"):this.userToImpersonate&&await this.$store.dispatch("quserAuth/USER_IMPERSONATE",this.userToImpersonate),this.loadingImpersonate=!1},async setOrganization(e){await this.$store.dispatch("quserAuth/SET_ORGANIZATION",{organizationId:e}),this.$store.dispatch("qsiteApp/REFRESH_PAGE")}}};var Oe=i(68092),Ye=i(36008),Fe=i(21028);const je=(0,S.c)(He,[["render",Ve]]),Ge=je;H()(He,"components",{QIcon:N.c,QSeparator:_.c,QNoSsr:Oe.c,QSelect:Ye.c,QItem:M.c,QItemSection:T.c,QSpinner:Fe.c});var Je=i(264);const Ze={key:0,id:"drawerChatComponent",class:"q-pa-md"},Xe={class:"row justify-between items-center"},et={class:"text-subtitle1 row items-center"},tt={class:"relative-position"},it={id:"userListcontent",class:"relative-position"},at=["src"],st=["src"],ot={id:"chatBodyContent",ref:"chatBodyContent"},nt={key:0,class:"text-center q-py-xs"},lt={style:{width:"100%"},class:"q-py-sm q-px-md"},rt={key:0,class:"text-center text-grey-7 q-mt-md"},ct={id:"inputChatContent",class:"q-pa-sm"};function dt(e,t,i,o,n,l){const r=(0,a.E1)("q-icon"),c=(0,a.E1)("q-separator"),d=(0,a.E1)("q-item-section"),m=(0,a.E1)("q-item"),u=(0,a.E1)("q-select"),h=(0,a.E1)("inner-loading"),p=(0,a.E1)("not-result"),f=(0,a.E1)("q-avatar"),g=(0,a.E1)("q-list"),b=(0,a.E1)("q-toolbar-title"),w=(0,a.E1)("q-btn"),v=(0,a.E1)("q-toolbar"),Q=(0,a.E1)("q-spinner-dots"),A=(0,a.E1)("q-chat-message"),k=(0,a.E1)("q-infinite-scroll"),y=(0,a.E1)("q-input"),q=(0,a.E1)("q-card"),$=(0,a.E1)("q-dialog"),z=(0,a.iS)("close-popup");return e.$hasAccess("ichat.conversations.index")?((0,a.Wz)(),(0,a.An)("div",Ze,[(0,a.QD)("div",Xe,[(0,a.QD)("div",et,[(0,a.K2)(r,{name:"fa-light fa-message",color:"primary",size:"20px",class:"q-mr-sm"}),(0,a.QD)("label",null,(0,s.WA)(e.$tr("isite.cms.label.chat",{capitalize:!0})),1)]),(0,a.K2)(r,{name:"fas fa-times",color:"blue-grey",size:"20px",class:"cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","chat"))})]),(0,a.K2)(c,{class:"q-my-md"}),(0,a.QD)("div",tt,[(0,a.K2)(u,{outlined:"",dense:"",modelValue:n.search.userId,"onUpdate:modelValue":[t[1]||(t[1]=e=>n.search.userId=e),l.createConversation],"use-input":"","hide-selected":"","emit-value":"","map-options":"","input-debounce":"800",options:n.search.userList,onFilter:l.searchUsers,placeholder:`${e.$tr("isite.cms.label.find")} ${e.$tr("isite.cms.label.user")}...`,style:{width:"100%"},class:"q-mb-sm"},{"no-option":(0,a.Ql)((()=>[(0,a.K2)(m,null,{default:(0,a.Ql)((()=>[(0,a.K2)(d,{class:"text-grey"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("isite.cms.message.searchNotFound")),1)])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","placeholder","onUpdate:modelValue"]),(0,a.QD)("div",it,[(0,a.K2)(h,{visible:n.conversations.loading},null,8,["visible"]),n.conversations.loading||n.conversations.list.length?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.Az)(p,{key:0,class:"q-my-lg"})),!n.conversations.loading&&n.conversations.list.length?((0,a.Wz)(),(0,a.Az)(g,{key:1},{default:(0,a.Ql)((()=>[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(l.conversationsList,((e,t)=>((0,a.Wz)(),(0,a.An)(a.ae,{key:t},[e.userData?((0,a.Wz)(),(0,a.Az)(m,{key:0,clickable:"",class:"q-px-xs",onClick:t=>l.openChat(e)},{default:(0,a.Ql)((()=>[(0,a.K2)(d,{avatar:""},{default:(0,a.Ql)((()=>[!e.userData||!e.userData?.mainImage?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.Az)(f,{key:0},{default:(0,a.Ql)((()=>[(0,a.QD)("img",{src:e.userData?.mainImage},null,8,at)])),_:2},1024))])),_:2},1024),(0,a.K2)(d,{class:"ellipsis text-capitalize"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.userData.fullName.toLowerCase()),1)])),_:2},1024),e.unReadMessages?((0,a.Wz)(),(0,a.Az)(d,{key:0,side:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{name:"fas fa-circle",color:"teal",size:"14px"})])),_:1})):(0,a.g1)("",!0)])),_:2},1032,["onClick"])):(0,a.g1)("",!0)],64)))),128))])),_:1})):(0,a.g1)("",!0)])]),(0,a.K2)($,{id:"personalChatContent",modelValue:n.chat.open,"onUpdate:modelValue":t[3]||(t[3]=e=>n.chat.open=e),seamless:"",position:"bottom"},{default:(0,a.Ql)((()=>[n.chat.conversation?((0,a.Wz)(),(0,a.Az)(q,{key:0,style:{width:"350px"}},{default:(0,a.Ql)((()=>[(0,a.K2)(v,null,{default:(0,a.Ql)((()=>[(0,a.K2)(f,null,{default:(0,a.Ql)((()=>[(0,a.QD)("img",{src:n.chat?.conversation?.userData?.mainImage},null,8,st)])),_:1}),(0,a.K2)(b,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(n.chat.conversation.userData.fullName),1)])),_:1}),(0,a.wt)((0,a.K2)(w,{flat:"",round:"",dense:"",icon:"fa fa-close"},null,512),[[z]])])),_:1}),(0,a.K2)(c),(0,a.QD)("div",ot,[n.chat.open?((0,a.Wz)(),(0,a.Az)(k,{key:0,ref:"chatInfiniteSroll",onLoad:l.getMessages,reverse:"","scroll-target":"#chatBodyContent",offset:100},{default:(0,a.Ql)((()=>[n.chat.loading?((0,a.Wz)(),(0,a.An)("div",nt,[(0,a.K2)(Q,{color:"primary",size:"2em"})])):(0,a.g1)("",!0),(0,a.QD)("div",lt,[n.chat.loading||l.messageList.length?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.An)("div",rt,(0,s.WA)(e.$tr("ichat.cms.message.noMessages")),1)),((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(l.messageList,((e,t)=>((0,a.Wz)(),(0,a.Az)(A,{key:t,sent:!!e.sent,text:[e.text],stamp:e.stamp,"bg-color":e.color},null,8,["sent","text","stamp","bg-color"])))),128))])])),_:1},8,["onLoad"])):(0,a.g1)("",!0)],512),(0,a.QD)("div",ct,[(0,a.K2)(y,{dense:"",outlined:"",modelValue:n.chat.textMessage,"onUpdate:modelValue":t[2]||(t[2]=e=>n.chat.textMessage=e),ref:"inputChat",placeholder:e.$tr("ichat.cms.label.sendMessage"),color:"grey-8",onKeyup:(0,Je.jj)(l.sendMessage,["enter"])},{append:(0,a.Ql)((()=>[(0,a.K2)(w,{unelevated:"",icon:"fas fa-paper-plane",onClick:l.sendMessage,padding:"sm"},null,8,["onClick"])])),_:1},8,["modelValue","placeholder","onKeyup"])])])),_:1})):(0,a.g1)("",!0)])),_:1},8,["modelValue"])])):(0,a.g1)("",!0)}const mt={beforeUnmount(){D.kN.off("inotification.chat.message")},props:{},components:{},mounted(){this.$nextTick((async function(){this.init()}))},data(){return{search:{userId:null,userList:[]},conversations:{loading:!1,list:[]},chat:{loading:!1,open:!1,conversation:!1,pagination:{perPage:20,page:0,lastPage:5},messages:[],scrollInfo:!1,textMessage:""},eventBus:D.kN}},computed:{conversationsList(){let e=!1,t=this.$clone(this.conversations.list);return t.forEach((t=>{let i=t.users.find((e=>e.id!=this.$store.state.quserAuth.userId));i&&(t.userData={id:i.id,mainImage:i?.mainImage,fullName:i.fullName}),t.unReadMessages&&(e=!0)})),D.kN.emit("header.badge.manage",{chat:e}),t},chatContentStyle(){return{thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#aaadba",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#c2c5c6",width:"9px",opacity:.2}}},messageList(){let e=this.$clone(this.chat.messages).reverse();return e.forEach((e=>{e.text=e.body,e.sent=e.userId==this.$store.state.quserAuth.userId,e.stamp=this.$trd(e.createdAt,{type:"time"}),e.color=e.sent?"grey-4":"indigo-2"})),e}},methods:{init(){this.getConversations(!0),this.listenPusher()},listenPusher(){D.kN.on("inotification.chat.message",(e=>{if(e.data){let t=e.data;if(this.chat.open&&this.chat.conversation.id==t.conversationId)this.pushMessage(t);else{let e=this.conversations.list.findIndex((e=>e.id==t.conversationId));-1!=e?this.conversations.list[e].unReadMessages=!0:this.getConversations(!0)}}}))},searchUsers(e,t,i){if(e.length<2)return i();let a={params:{take:20,filter:{search:e}}};this.$crud.index("apiRoutes.quser.users",a).then((e=>{t((()=>{let t=this.$store.state.quserAuth.userId,i=[];e.data.forEach((e=>{e.id!=t&&i.push({label:e.fullName,value:e.id})})),this.search.userList=this.$clone(i)}))})).catch((e=>{this.$apiResponse.handleError(e,(()=>{t((()=>{this.search.userList=[]}))}))}))},getConversations(e=!1){return new Promise(((t,i)=>{this.conversations.loading=!0;let a={refresh:e,params:{include:"users,lastMessage"}};this.$crud.index("apiRoutes.qchat.conversations",a).then((e=>{this.conversations.list=e.data,this.conversations.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.conversations.loading=!1}))}))}))},createConversation(e){return new Promise((t=>{let i=!1,a=[e,this.$store.state.quserAuth.userId];this.search.userId=null,this.conversationsList.forEach((e=>{let t=e.users.map((e=>e.id));-1!=t.indexOf(a[0])&&-1!=t.indexOf(a[1])&&(i=e)})),i?this.openChat(i):(this.conversations.loading=!0,this.$crud.create("apiRoutes.qchat.conversations",{users:a}).then((async e=>{this.conversations.list.push(e.data),this.openChat(this.conversationsList.find((t=>t.id==e.data.id))),this.conversations.loading=!1})).catch((e=>{this.conversations.loading=!1})))}))},openChat(e){const t=()=>{setTimeout((()=>{this.$refs.chatInfiniteSroll.reset(),this.$refs.chatInfiniteSroll.updateScrollTarget(),this.$refs.chatInfiniteSroll.poll(),this.$refs.inputChat.focus()}),100),this.chat.conversation=e,this.chat.open=!0,this.chat.messages=[],this.chat.pagination.page=0;let t=this.conversations.list.findIndex((t=>t.id==e.id));this.conversations.list[t].unReadMessages=!1};this.chat.open&&this.chat.conversation.id==e.id||(this.chat.open?(this.chat.open=!1,setTimeout((()=>t()),300)):t()),D.kN.emit("toggleMasterDrawer","chat")},getMessages(e,t){return new Promise(((e,i)=>{if(this.chat.pagination.page+=1,this.chat.pagination.page<=this.chat.pagination.lastPage){1==this.chat.pagination.page&&(this.chat.messages=[]),this.chat.loading=!0;let e={refresh:!0,params:{page:this.chat.pagination.page,take:this.chat.pagination.perPage,filter:{conversationId:this.chat.conversation.id}}};this.$crud.index("apiRoutes.qchat.messages",e).then((e=>{this.chat.messages=this.chat.messages.concat(e.data),this.chat.pagination.lastPage=e.meta.page.lastPage,this.chat.loading=!1,t()})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.chat.loading=!1}))}))}else this.$refs.chatInfiniteSroll.stop(),t&&t()}))},setEmoji(e){let t=this.$clone(this.chat.textMessage),i=this.$refs.inputChat.$refs.input,a=i.selectionStart,s=t.substring(0,a),o=t.substring(a,t.length);this.chat.textMessage=s+e+o},sendMessage(){return new Promise(((e,t)=>{if(this.chat.textMessage.length){let e={conversationId:this.chat.conversation.id,body:this.chat.textMessage,userId:this.$store.state.quserAuth.userId};this.$crud.create("apiRoutes.qchat.messages",e),this.pushMessage(e)}}))},pushMessage(e){this.chat.messages.unshift({createdAt:this.$moment().format(),...e}),this.chat.textMessage="",setTimeout((()=>{this.$refs.chatBodyContent.scrollTo(0,this.$refs.chatBodyContent.scrollHeight)}),100)}}};var ut=i(30852),ht=i(70608),pt=i(75960),ft=i(54420),gt=i(47340),bt=i(20540),wt=i(69452);const vt=(0,S.c)(mt,[["render",dt]]),Qt=vt;H()(mt,"components",{QIcon:N.c,QSeparator:_.c,QSelect:Ye.c,QItem:M.c,QItemSection:T.c,QList:I.c,QAvatar:P.c,QDialog:ut.c,QCard:ht.c,QToolbar:J.c,QToolbarTitle:Z.c,QBtn:K.c,QInfiniteScroll:pt.c,QSpinnerDots:ft.c,QChatMessage:gt.c,QInput:bt.c,QField:wt.c}),H()(mt,"directives",{ClosePopup:V.c});const At={id:"listMenu"};function kt(e,t,i,o,n,l){const r=(0,a.E1)("q-tooltip"),c=(0,a.E1)("q-icon"),d=(0,a.E1)("q-item-section"),m=(0,a.E1)("q-item"),u=(0,a.E1)("recursive-menu"),h=(0,a.E1)("q-expansion-item"),p=(0,a.E1)("q-no-ssr");return(0,a.wt)(((0,a.Wz)(),(0,a.An)("div",null,[(0,a.QD)("div",At,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(l.menuData,((t,o)=>((0,a.Wz)(),(0,a.Az)(p,{key:o,class:(0,s.WN)("content-item "+(i.inLine?"inline-block":""))},{default:(0,a.Ql)((()=>[i.withTooltip?((0,a.Wz)(),(0,a.Az)(r,(0,s.Gk)((0,a.Gu)({key:0},i.tooltipProps||{})),{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(i.translatable?e.$tr(t.title):t.title),1)])),_:2},1040)):(0,a.g1)("",!0),void 0==t.itemProps?.vIf||t.itemProps?.vIf?((0,a.Wz)(),(0,a.Az)(m,(0,a.Gu)({key:1,id:`menuItem-${l.parseIdItem(t.name)}`||`menuItem-${o}`},t.itemProps),{default:(0,a.Ql)((()=>[t.icon&&i.showIcons?((0,a.Wz)(),(0,a.Az)(d,{key:0,avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(c,{name:t.icon},null,8,["name"])])),_:2},1024)):(0,a.g1)("",!0),(0,a.K2)(d,{class:"text-capitalize"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(i.translatable?e.$tr(t.title):t.title),1)])),_:2},1024)])),_:2},1040,["id"])):l.checkItemMultiple(t)?((0,a.Wz)(),(0,a.Az)(h,(0,a.Gu)({icon:t.icon,key:o,label:i.translatable?e.$tr(t.title):t.title},i.group?{group:n.listUid}:{},{"header-class":l.selectedChildren(t),"default-opened":!!l.selectedChildren(t),class:l.selectedChildren(t)?"expansion-selected":""}),{default:(0,a.Ql)((()=>[((0,a.Wz)(),(0,a.Az)(u,{translatable:i.translatable,"show-icons":i.showIcons,key:o,menu:t.children,group:i.group},null,8,["translatable","show-icons","menu","group"]))])),_:2},1040,["icon","label","header-class","default-opened","class"])):(0,a.g1)("",!0)])),_:2},1032,["class"])))),128))])],512)),[[Je.Ub,n.showMenu]])}const yt={name:"recursiveMenu",components:{},props:{withTooltip:{type:Boolean,default:!1},menu:{default:!1},showIcons:{type:Boolean,default:!0},translatable:{type:Boolean,default:!0},inLine:{type:Boolean,default:!1},group:{type:Boolean,defualt:!1},tooltipProps:{type:Object,default:null}},watch:{menu(){this.init()}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{showMenu:!1,listUid:this.$uid().toString(),props:{}}},computed:{menuData(){let e=this.$props.menu.map((e=>(e.itemProps={class:this.getClassItem(e),tag:"a",key:this.$uid(),vIf:this.checkItemSingle(e),clickable:!0},e.toRoute?e.itemProps.href=e.toRoute:e.itemProps.to={name:e.name,params:e.params||{}},e)));return e}},methods:{init(){this.props=this.$clone(this.$props),setTimeout((()=>{this.checkCollapsibles(),this.showMenu=!0}),300)},parseIdItem(e){return e.replaceAll(".","")},checkItemSingle(e){let t=!0;return e.activated||(t=!1),e.children&&(t=!1),e.name||(t=!1),e.permission&&!this.$hasAccess(e.permission)&&(t=!1),t},checkItemMultiple(e){let t=!0;return e.children||(t=!1),e.children&&!e.children.length&&(t=!1),e.permission&&!this.$hasAccess(e.permission)&&(t=!1),t},checkCollapsibles(){let e=this.$el.getElementsByClassName("q-expansion-item");for(let t of e){let e=t.getElementsByClassName("single-item");e.length||(t.style.display="none")}},redirectTo(e){e.linkType&&"external"==e.linkType?window.open(`https://${e.url}`,e.target):e.name&&this.$router.push({name:e.name,params:e.params||{}})},selectedChildren(e){let t="",i=e=>{let t=this.$route.name,a=!1;return e&&e.forEach((e=>{e.name==t&&(a=!0),e.children&&i(e.children)&&(a=!0)})),a};return e.children&&i(e.children)&&(t=" item-is-active"),t},getClassItem(e){let t="single-item";return this.$route.name==e.name&&JSON.stringify(this.$route.params)==JSON.stringify(e.params||{})&&(t+=" item-is-active"),t}}};var qt=i(61656);const $t=(0,S.c)(yt,[["render",kt]]),zt=$t;H()(yt,"components",{QNoSsr:Oe.c,QTooltip:L.c,QItem:M.c,QItemSection:T.c,QIcon:N.c,QExpansionItem:qt.c});const xt={id:"checkinComponent"},Dt={class:"row justify-between items-center q-pa-md"},Et={class:"text-subtitle1 row items-center"},Wt={key:1,style:{height:"200px",padding:"22px 0"},class:"blue-grey text-center"},St={class:"q-px-md"},Kt={class:"q-mt-md"},Ct={id:"chronometerContent"},_t={class:"text-center"},It={class:"cursor-pointer",style:{"font-size":"12px"}},Mt={key:0},Tt={id:"timer",class:"q-box blue-grey text-center text-blue-grey"},Nt={class:"q-body-1"},Lt={id:"screen",class:"q-display-2 q-mb-sm"},Bt={class:"q-caption"},Pt={key:2},Rt={class:"q-pa-md"},Vt={class:"text-center absolute-bottom q-my-md"};function Ut(e,t,i,o,n,l){const r=(0,a.E1)("q-icon"),c=(0,a.E1)("q-separator"),d=(0,a.E1)("open-map"),m=(0,a.E1)("q-btn"),u=(0,a.E1)("dynamic-field");return(0,a.Wz)(),(0,a.An)("div",xt,[(0,a.QD)("div",Dt,[(0,a.QD)("div",Et,[(0,a.K2)(r,{name:"fas fa-clock",color:"primary",size:"20px",class:"q-mr-sm"}),(0,a.QD)("label",null,(0,s.WA)(e.$tr("icheckin.cms.sidebar.checkin",{capitalize:!0})),1)]),(0,a.K2)(r,{name:"fas fa-times",color:"blue-grey",size:"20px",class:"cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","checkin"))})]),(0,a.K2)(c,{class:"q-my-sm"}),n.currentLocation?((0,a.Wz)(),(0,a.Az)(d,{key:0,modelValue:n.mapMarket,"onUpdate:modelValue":t[1]||(t[1]=e=>n.mapMarket=e),"read-only":"",height:"200px"},null,8,["modelValue"])):((0,a.Wz)(),(0,a.An)("div",Wt,[(0,a.QD)("div",St,[(0,a.K2)(r,{color:"grey-6",name:"fas fa-map-marked-alt",size:"80px"}),(0,a.QD)("div",Kt,[(0,a.K2)(r,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.mY)(" "+(0,s.WA)(this.$tr("icheckin.cms.sidebar.locationAddress")),1)])])])),(0,a.QD)("div",Ct,[(0,a.QD)("div",_t,[n.activeShift?((0,a.Wz)(),(0,a.Az)(m,{key:1,color:"red",class:"q-mx-xs",size:"28px",round:"",loading:n.loading,onClick:l.endShift},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{id:"iconButton",name:"fas fa-stop",size:"25px",class:"q-pa-xs q-mb-xs full-width"}),(0,a.QD)("label",It,(0,s.WA)(this.$tr("isite.cms.label.close")),1)])),_:1},8,["loading","onClick"])):((0,a.Wz)(),(0,a.Az)(m,{key:0,loading:n.loading,onClick:l.createShift,round:"",color:"green",size:"23px",icon:"fas fa-play",class:"cursor-pointer q-pa-xs"},null,8,["loading","onClick"]))]),l.startChronometer?((0,a.Wz)(),(0,a.An)("div",Mt,[(0,a.QD)("div",Tt,[(0,a.QD)("div",Nt,(0,s.WA)(n.activeShift.checkinAt?e.$trd(n.activeShift.checkinAt,{type:"long"}):""),1),(0,a.QD)("div",Lt,(0,s.WA)(n.time.text),1),(0,a.K2)(c,{size:"1px",color:"blue-grey",class:"q-my-xs"}),(0,a.QD)("div",Bt,[(0,a.K2)(r,{name:"fas fa-map-marker-alt",class:"q-mr-xs"}),(0,a.QD)("b",null,(0,s.WA)(l.locationDescription),1)])])])):(0,a.g1)("",!0)]),n.activeShift?((0,a.Wz)(),(0,a.An)("div",Pt,[(0,a.QD)("div",Rt,[(0,a.K2)(u,{modelValue:n.comment.text,"onUpdate:modelValue":[t[2]||(t[2]=e=>n.comment.text=e),l.sendComment],field:l.fields.comments},null,8,["modelValue","field","onUpdate:modelValue"])])])):(0,a.g1)("",!0),(0,a.QD)("div",Vt,[(0,a.K2)(m,{unelevated:"",color:"green",rounded:"","no-caps":"",label:e.$tr("icheckin.cms.sidebar.Shifts"),icon:"fas fa-user-clock",to:{name:"qcheckin.main.shifts.index"}},null,8,["label","to"])])])}var Ht=i(8468);const Ot={beforeUnmount(){D.kN.off("qcheckin.checkout")},props:{},emits:["checkin","checkout"],components:{openMap:Ht.c},watch:{},mounted(){this.$nextTick((function(){this.init()}))},beforeRouteLeave(e,t,i){this.control&&clearInterval(this.control),i()},data(){return{loading:!1,currentLocation:!1,mapMarket:!1,activeShift:!1,time:{text:"00:00:00",hh:0,mm:0,ss:0},control:!1,comment:{loading:!1,text:null},eventBus:D.kN}},computed:{fields(){return{comments:{value:"",type:"input",props:{label:`${this.$tr("isite.cms.form.comment")}`,type:"textarea",rows:"3",icon:"fas fa-comment-dots",debounce:1500}}}},locationDescription(){return this.currentLocation?`Lat: ${this.currentLocation.latitude}, Lng: ${this.currentLocation.longitude}`:this.$tr("icheckin.cms.sidebar.noLocation")}},methods:{init(){this.getActiveShift(),this.getCurrentLocation(),D.kN.on("qcheckin.checkout",(e=>{e.id==this.activeShift.id&&this.endShift()}))},async getCurrentLocation(){let e=await this.$helper.getCurrentPosition();e&&(this.currentLocation={latitude:e.coords.latitude,longitude:e.coords.longitude},this.mapMarket={lat:e.coords.latitude,lng:e.coords.longitude})},getActiveShift(){return new Promise(((e,t)=>{this.loading=!0;let i={refresh:!0,params:{filter:{noCheckout:!0,field:"checkin_by"}}},a=this.$store.state.quserAuth.userId;this.$crud.show("apiRoutes.qcheckin.shifts",a,i).then((t=>{"object"==typeof t.data&&(this.activeShift={...this.$clone(t.data),checkinAt:this.$moment().format(t.data.checkinAt)},this.comment.text=t.data.options.comment||null,this.startChronometer()),this.loading=!1,e(t.data)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.loading=!1,t(e)}))}))}))},async createShift(){this.loading=!0;let e={options:{},geoLocation:{}};this.currentLocation&&(e.geoLocation={checkin:this.$clone(this.currentLocation)}),this.$crud.create("apiRoutes.qcheckin.checkin",e).then((e=>{this.activeShift=this.$clone(e.data),this.startChronometer(),this.loading=!1})).catch((e=>{this.loading=!1}))},startChronometer(){this.activeShift&&(this.time.ss=this.$clone(this.activeShift.diff.s),this.time.mm=this.$clone(this.activeShift.diff.i),this.time.hh=this.$clone(this.activeShift.diff.h),this.time.text=(0==this.time.hh?"00":this.time.hh<10?"0"+this.time.hh:this.time.hh)+":"+(0==this.time.mm?"00":this.time.mm<10?"0"+this.time.mm:this.time.mm)+":"+(0==this.time.ss?"00":this.time.ss<10?"0"+this.time.ss:this.time.ss),this.control=setInterval(this.timer,1e3),this.$emit("checkin"))},timer(){let e,t,i;this.activeShift.diff.s++,60==this.activeShift.diff.s&&(this.activeShift.diff.s=0,this.activeShift.diff.i++),60==this.activeShift.diff.i&&(this.activeShift.diff.i=0,this.activeShift.diff.h++),e=this.$clone(this.activeShift.diff.s),t=this.$clone(this.activeShift.diff.i),i=this.$clone(this.activeShift.diff.h),this.activeShift.diff.s<10&&(e="0"+e),t<10&&(t="0"+t),i<10&&(i="0"+i),this.time.text=i+":"+t+":"+e},sendComment(){if(this.activeShift){this.loading=!0;let e={options:{...this.activeShift.options,comment:this.comment.text||"No comments"}};this.$crud.update("apiRoutes.qcheckin.shifts",this.activeShift.id,e).then((e=>{this.loading=!1})).catch((e=>this.loading=!1))}},async endShift(){this.loading=!0;let e={params:{filter:{checkout:!0}}},t=this.$clone(this.activeShift);this.currentLocation&&(t.geoLocation.checkout=this.$clone(this.currentLocation)),this.$crud.update("apiRoutes.qcheckin.checkout",t.id,t,e).then((e=>{this.activeShift=!1,clearInterval(this.control),this.$emit("checkout"),this.comment.text=null,this.loading=!1})).catch((e=>this.loading=!1))}}},Yt=(0,S.c)(Ot,[["render",Ut]]),Ft=Yt;H()(Ot,"components",{QIcon:N.c,QSeparator:_.c,QBtn:K.c});const jt={id:"recommendationsComponent"},Gt={key:0,class:"relative-position"},Jt={class:"box row justify-between items-center"},Zt={class:"text-ellipsis text-subtitle1 row items-center"},Xt={class:"ellipsis relative-position"},ei={class:"text-subtitle2 q-pr-lg"},ti={class:"ellipsis"},ii={class:"row items-center"},ai={class:"text-caption text-justify"},si={key:1,class:"box item q-px-none q-py-md"};function oi(e,t,i,o,n,l){const r=(0,a.E1)("crud"),c=(0,a.E1)("q-icon"),d=(0,a.E1)("q-tooltip"),m=(0,a.E1)("q-btn"),u=(0,a.E1)("q-separator"),h=(0,a.E1)("q-item-section"),p=(0,a.E1)("q-item"),f=(0,a.E1)("q-list"),g=(0,a.E1)("q-menu"),b=(0,a.E1)("q-scroll-area"),w=(0,a.E1)("inner-loading"),v=(0,a.iS)("close-popup");return(0,a.Wz)(),(0,a.An)("div",jt,[(0,a.K2)(r,(0,a.Gu)(l.crudRecommendationParams,{onCreated:t[0]||(t[0]=e=>l.getData()),onUpdated:t[1]||(t[1]=e=>l.getData()),onDeleted:t[2]||(t[2]=e=>l.getData())}),null,16),n.recommendationName?((0,a.Wz)(),(0,a.An)("div",Gt,[(0,a.QD)("div",Jt,[(0,a.QD)("div",Zt,[(0,a.K2)(c,{class:"q-mr-sm",size:"20px",color:"primary",name:"fas fa-hat-wizard"}),(0,a.mY)(" "+(0,s.WA)(e.$trp("isite.cms.label.recommendation")),1)]),e.$hasAccess("isite.recommendations.create")&&"ipanel"!=n.appConfig.mode?((0,a.Wz)(),(0,a.Az)(m,{key:0,icon:"fas fa-plus",round:"",unelevated:"",size:"10px",color:"green",onClick:t[3]||(t[3]=t=>e.$refs.recommendations.create())},{default:(0,a.Ql)((()=>[(0,a.K2)(d,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("isite.cms.label.add")),1)])),_:1})])),_:1})):(0,a.g1)("",!0)]),(0,a.K2)(u,{class:"q-my-sm"}),n.items.length?((0,a.Wz)(),(0,a.Az)(b,{key:0,"thumb-style":n.thumbStyle,style:{height:"calc(100vh - 167px)"}},{default:(0,a.Ql)((()=>[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(n.items,(t=>((0,a.Wz)(),(0,a.An)("div",{class:"box item q-px-none q-py-md",key:t.id},[(0,a.QD)("div",Xt,[(0,a.QD)("div",ei,[(0,a.K2)(c,{size:"20px",class:"q-mr-sm",color:"primary",name:"fas fa-magic"}),(0,a.QD)("div",ti,(0,s.WA)(t.title),1),(0,a.K2)(d,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(t.title),1)])),_:2},1024)]),e.$hasAccess("isite.recommendations.manage")&&"ipanel"!=n.appConfig.mode?((0,a.Wz)(),(0,a.Az)(m,{key:0,class:"file-card__bottom_actions absolute-right",icon:"fas fa-ellipsis-v",unelevated:"",round:"",size:"sm",color:"blue-grey",flat:"",padding:"sm"},{default:(0,a.Ql)((()=>[(0,a.K2)(g,{anchor:"bottom left",self:"bottom end"},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{style:{"min-width":"100px"}},{default:(0,a.Ql)((()=>[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(l.fileActions,((e,i)=>(0,a.wt)(((0,a.Wz)(),(0,a.Az)(p,{clickable:"",key:i,onClick:i=>e.action(t)},{default:(0,a.Ql)((()=>[(0,a.K2)(h,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",ii,[(0,a.K2)(c,{name:e.icon,class:"q-mr-sm",color:"blue-grey",size:"18px"},null,8,["name"]),(0,a.mY)(" "+(0,s.WA)(e.label),1)])])),_:2},1024)])),_:2},1032,["onClick"])),[[v]]))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024)):(0,a.g1)("",!0)]),(0,a.K2)(u,{class:"q-my-xs"}),(0,a.QD)("div",ai,(0,s.WA)(t.description),1)])))),128))])),_:1},8,["thumb-style"])):((0,a.Wz)(),(0,a.An)("div",si,(0,s.WA)(e.$trp("isite.cms.message.notFound")),1)),(0,a.K2)(w,{visible:n.loading},null,8,["visible"])])):(0,a.g1)("",!0)])}var ni=i(18528)["c"];const li={props:{},components:{},watch:{"$route.name":{deep:!0,handler:function(e){this.init()}}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{loading:!1,recommendationName:!1,items:!1,windowWith:window.innerWidth,appConfig:ni("app"),thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"$custom-accent-color",width:"5px",opacity:.1}}},computed:{crudRecommendationParams(){return{crudData:i.e(6776).then(i.bind(i,14392)),type:"only-create",ref:"recommendations",customData:{formLeft:{name:{value:this.recommendationName}}}}},fileActions(){return[{label:this.$tr("isite.cms.label.edit"),icon:"fas fa-pen",color:"green",action:e=>{this.$refs.recommendations.update(e)}},{label:this.$tr("isite.cms.label.delete"),icon:"fas fa-trash",color:"red",action:e=>{this.$refs.recommendations.delete(e)}}]},windowSize(){return this.windowWith>="992"?"desktop":"mobile"}},methods:{init(){this.resetData(),this.getData(),window.addEventListener("resize",(()=>{this.windowWith=window.innerWidth}))},resetData(){this.$route.meta.subHeader&&this.$route.meta.subHeader.recommendations?this.recommendationName=this.$route.meta.subHeader.recommendations.name:this.recommendationName=!1,this.items=!1},getData(){return new Promise(((e,t)=>{if(!this.recommendationName)return t(!1);this.loading=!0;let i={refresh:!0,params:{filter:{name:this.recommendationName}}};this.$crud.index("apiRoutes.qsite.recommendations",i).then((t=>{this.loading=!1,this.items=t.data,e(t.data)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.loading=!1}))}))}))}}};var ri=i(94380);const ci=(0,S.c)(li,[["render",oi]]),di=ci;H()(li,"components",{QIcon:N.c,QBtn:K.c,QTooltip:L.c,QSeparator:_.c,QScrollArea:ri.c,QMenu:C.c,QList:I.c,QItem:M.c,QItemSection:T.c}),H()(li,"directives",{ClosePopup:V.c});const mi={class:"row col justify-between items-center tw-p-5"},ui={class:"tw-text-xl tw-leading-5 text-weight-bold"},hi={class:"tw-flex tw-justify-end tw-content-center tw-items-center tw-gap-x-4"},pi={class:"full-width tw-px-5 tw-pt-[15px]"},fi={class:"flex justify-end"},gi={key:0};function bi(e,t,i,o,n,l){const r=(0,a.E1)("q-icon"),c=(0,a.E1)("q-btn"),d=(0,a.E1)("q-separator"),m=(0,a.E1)("notification-card"),u=(0,a.E1)("q-virtual-scroll"),h=(0,a.E1)("inner-loading"),p=(0,a.E1)("not-result"),f=(0,a.E1)("q-dialog"),g=(0,a.iS)("close-popup");return(0,a.Wz)(),(0,a.Az)(f,{modelValue:n.openDialog,"onUpdate:modelValue":t[3]||(t[3]=e=>n.openDialog=e),posititon:"right","transition-hide":"slide-up","transition-show":"slide-down",onShow:l.getData,onHide:l.hideModal},{default:(0,a.Ql)((()=>[(0,a.QD)("div",{id:"drawerNotificationsComponent",style:(0,s.MN)(l.style)},[(0,a.QD)("div",mi,[(0,a.QD)("label",ui,(0,s.WA)(e.$tr("notification.cms.sidebar.adminGroup")),1),(0,a.QD)("div",hi,[(0,a.wt)(((0,a.Wz)(),(0,a.Az)(c,{unelevated:"",rounded:"",dense:"",padding:"none",size:"xs"},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{name:"fa-regular fa-times",color:"grey-7",size:"22px",class:"cursor-pointer"})])),_:1})),[[g]])])]),(0,a.K2)(d),(0,a.QD)("div",pi,[(0,a.wt)((0,a.QD)("div",fi,[(0,a.K2)(c,{class:"tw-text-sm tw-leading-[18px] tw-font-semibold",flat:"",dense:"",unelevated:"","no-caps":"",padding:"none",label:e.$tr("notification.cms.markAllAsRead"),onClick:t[0]||(t[0]=e=>l.markAllAsRead())},null,8,["label"])],512),[[Je.Ub,l.notificationsData.length&&!n.loading]]),(0,a.K2)(u,{class:"max-height-scroll",separator:"",items:l.notificationsData.slice(0,5)},{default:(0,a.Ql)((({item:e,index:i})=>[((0,a.Wz)(),(0,a.Az)(m,{key:e.id,"item-notification":e,"source-settings":n.sourceSettings,onOpenModal:t[1]||(t[1]=e=>l.openModal(e))},null,8,["item-notification","source-settings"]))])),_:1},8,["items"]),(0,a.K2)(h,{visible:n.loading},null,8,["visible"]),l.notificationsData.length&&!n.loading?((0,a.Wz)(),(0,a.An)("div",gi,[(0,a.K2)(c,{unelevated:"",dense:"","no-caps":"",class:"full-width tw-mt-4 tw-mb-6 tw-rounded-lg",color:"grey-3","text-color":"grey-8",onClick:t[2]||(t[2]=e=>l.gotoNotifications()),label:e.$tr("notification.cms.seeAll",{capitalize:!0})},null,8,["label"])])):n.loading?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.Az)(p,{key:1,class:"tw-mt-4 tw-pl-5"}))])],4)])),_:1},8,["modelValue","onShow","onHide"])}var wi=i(62792),vi=i(27056),Qi=i(83696);const Ai={beforeUnmount(){D.kN.off("inotification.notifications.new"),Qi.c.removeEvent()},props:{isMobile:!1,isOpen:!1},components:{notificationCard:vi.c},mounted(){this.$nextTick((function(){this.init()}))},watch:{notificationFirebase:{deep:!0,handler:function(e,t){this.notifications.unshift(e)}},isOpen(e){this.openDialog=this.$clone(e)}},data(){return{loading:!1,openDialog:!1,notifications:[],thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"$custom-accent-color",width:"5px",opacity:.1},refScrollArea:null,pagination:{page:1,perPage:5,lastPage:-1},sourceSettings:null,eventBus:D.kN}},computed:{notificationFirebase(){return Qi.c.notification},style(){return this.isMobile?"margin: 0px;":"margin: 50px 10px 0px 0px;"},notificationsData(){let e=[],t=this.$clone(this.notifications);return D.kN.emit("header.badge.manage",{notification:!1}),t&&t.length&&t.forEach((t=>{t.id||this.$uid(),t.title,t.message,t.icon,t.createdAt||this.$moment(),t.isRead,t.link,!(!t.options||!t.options.isImportant)&&t.options.isImportant;t.isRead||D.kN.emit("header.badge.manage",{notification:!0}),e.push(t)})),e}},methods:{async init(){Qi.c.addEvent(),this.listenEvents(),await this.getSources(),Qi.c.icon=this.$store.state.qsiteApp.logo},listenEvents(){D.kN.on("inotification.notifications.new",(e=>{this.notifications.unshift(e),this.$alert.info({message:`${e.title.substr(0,30)}...`,icon:"fas fa-bell",actions:[{label:this.$tr("isite.cms.label.show"),color:"white",handler:()=>D.kN.emit("openMasterDrawer","notification")}]}),this.$helper.playSound({url:`${this.$store.state.qsiteApp.baseUrl}/modules/notification/audio/sound_notification.mp3`})}))},getData(){return new Promise(((e,t)=>{this.loading=!0;let i={refresh:!0,params:{take:this.pagination.perPage,page:this.pagination.page,filter:{me:!0,type:"broadcast"}}};wi.c.getNotifications(i).then((t=>{this.notifications=[...this.notifications,...t.data],this.pagination.lastPage=t.meta.page.lastPage,this.pagination.page=t.meta.page.currentPage,this.loading=!1,e(t.data)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.loading=!1}))}))}))},gotoNotifications(){"notification.admin.notificationIndex"!=this.$route.name&&this.$router.push({name:"notification.admin.notificationIndex"})},getSources(){this.loading=!0,wi.c.getSources().then((e=>{this.sourceSettings=e}))},lastItem(e){const t=this.notifications[this.notifications.length-1];return t.id==e.id},markAsRead(e){this.notifications.find((t=>{t.id==e.id&&(t.isRead=!0)}))},markAllAsRead(){this.notifications=this.notifications.map((e=>({...e,isRead:!0}))),wi.c.markAllAsRead()},openModal(e){D.kN.emit("imagina.notification.open",e)},hideModal(){this.notifications=[],D.kN.emit("toggleMasterDrawer","notification")}}};var ki=i(91688);const yi=(0,S.c)(Ai,[["render",bi],["__scopeId","data-v-76486251"]]),qi=yi;H()(Ai,"components",{QDialog:ut.c,QBtn:K.c,QIcon:N.c,QSeparator:_.c,QVirtualScroll:ki.c}),H()(Ai,"directives",{ClosePopup:V.c});const $i={id:"drawerOffline",class:"q-pa-md"},zi={class:"row justify-between items-center"},xi={class:"text-subtitle1 row items-center"};function Di(e,t,i,o,n,l){const r=(0,a.E1)("q-icon"),c=(0,a.E1)("q-separator"),d=(0,a.E1)("q-item-label"),m=(0,a.E1)("q-item-section"),u=(0,a.E1)("q-item"),h=(0,a.E1)("q-list");return(0,a.Wz)(),(0,a.An)("div",$i,[(0,a.QD)("div",zi,[(0,a.QD)("div",xi,[(0,a.K2)(r,{name:"fa fa-cloud-upload",color:"primary",size:"20px",class:"q-mr-sm"}),(0,a.QD)("label",null,(0,s.WA)(e.$tr("isite.cms.label.offlineRequests",{capitalize:!0})),1)]),(0,a.K2)(r,{name:"fas fa-times",color:"blue-grey",size:"20px",class:"cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","offline"))})]),(0,a.K2)(c,{class:"q-my-md"}),(0,a.K2)(h,null,{default:(0,a.Ql)((()=>[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(l.requests,(t=>((0,a.Wz)(),(0,a.An)("div",{key:t?.id},[(0,a.K2)(u,{class:"tw-flex-col tw-py-5 tw-rounded-lg tw-bg-white tw-shadow-lg tw-mb-4"},{default:(0,a.Ql)((()=>[(0,a.K2)(m,null,{default:(0,a.Ql)((()=>[(0,a.K2)(d,{class:"tw-text-sm tw-text-gray-400"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(l.getTitle(t)?.titleOffline),1)])),_:2},1024),l.getTitle(t)?.id?((0,a.Wz)(),(0,a.Az)(d,{key:0,class:"tw-font-bold tw-text-base"},{default:(0,a.Ql)((()=>[(0,a.mY)(" ID: "+(0,s.WA)(l.getTitle(t)?.id),1)])),_:2},1024)):(0,a.g1)("",!0)])),_:2},1024),(0,a.K2)(m,{class:"tw-flex-row tw-justify-between tw-items-center tw-mt-2 tw-text-gray-400",style:{"margin-left":"0"}},{default:(0,a.Ql)((()=>[(0,a.K2)(d,{class:"tw-font-semibold"},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{name:n.actions[t?.requestData?.method].icon,color:n.actions[t?.requestData?.method].color,size:"14px",class:"q-mr-sm"},null,8,["name","color"]),(0,a.mY)(" "+(0,s.WA)(n.actions[t?.requestData?.method].action),1)])),_:2},1024),(0,a.K2)(d,{class:"tw-text-sm"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$moment(t?.timestamp).fromNow()),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])}var Ei=i(82236);const Wi={name:"drawerOffline",props:{},components:{},watch:{},beforeUnmount(){D.kN.off("header.badge.manage")},mounted(){this.$nextTick((async()=>{this.$store.dispatch("qofflineMaster/OFFLINE_REQUESTS",{userId:this.$store.state.quserAuth.userId}),await(0,Ei.E)()}))},computed:{requests(){return this.$store.state.qofflineMaster.requestsReversed}},data(){return{refreshIntervalId:null,eventBus:D.kN,actions:{POST:{icon:"fa-solid fa-square-plus",action:"Create",color:"secondary"},PUT:{icon:"fa-solid fa-arrows-rotate",action:"Update",color:"warning"},DELETE:{icon:"fa-solid fa-trash",action:"Delete",color:"negative"}}}},methods:{decode(e){try{if(!e)return;const t=new TextDecoder("utf-8"),i=t.decode(e);return i?JSON.parse(i):{}}catch(t){console.error("Error decoding data",t)}},getTitle(e){if(e?.requestData?.body){const t=this.decode(e.requestData.body),i=t?.attributes;return{id:i?.id||"",titleOffline:i?.titleOffline||i?.title_offline||""}}}}};var Si=i(2992);const Ki=(0,S.c)(Wi,[["render",Di]]),Ci=Ki;H()(Wi,"components",{QIcon:N.c,QSeparator:_.c,QList:I.c,QItem:M.c,QItemSection:T.c,QItemLabel:Si.c});var _i=i(18528)["c"];const Ii={beforeUnmount(){D.kN.off("toggleMasterDrawer"),D.kN.off("openMasterDrawer")},mixins:[ue.c],props:{},components:{menuList:zt,configList:Ge,chatList:Qt,checkin:Ft,masterRecommendation:di,masterNotifications:qi,offline:Ci},mounted(){this.$nextTick((function(){this.init()}))},data(){return{windowHeight:window.innerHeight,windowWith:window.innerWidth,projectName:this.$getSetting("core::site-name"),miniState:"mobile"!=this.windowSize,drawer:{menu:!this.$q.platform.is.mobile,config:!1,chat:!1,checkin:!1,recommendation:!1,notification:!1,offline:!1},appConfig:_i("app"),eventBus:D.kN}},computed:{windowSize(){return this.windowWith>="992"?"desktop":"mobile"},routeSubHeader(){return this.drawer.recommendation=!1,this.$route.meta.subHeader||{}},versionText(){return"v"+_i("app.version")},logo(){return this.$store.state.qsiteApp.logo}},methods:{init(){this.handlerEvent(),window.addEventListener("resize",(()=>{this.windowHeight=window.innerHeight,this.windowWith=window.innerWidth}))},handlerEvent(){D.kN.on("toggleMasterDrawer",(e=>this.toggleDrawer(e))),D.kN.on("openMasterDrawer",(e=>this.drawer[e]=!0))},toggleDrawer(e){for(var t in this.drawer)t!=e&&("menu"==t&&"mobile"!=this.windowSize?this.miniState=!0:this.drawer[t]=!1);"menu"==e?"mobile"==this.windowSize?(this.miniState=!1,this.drawer.menu=!this.drawer.menu):(this.drawer.menu=!0,this.miniState=!this.miniState):this.drawer[e]=!this.drawer[e]}}};var Mi=i(42744),Ti=i(6616);const Ni=(0,S.c)(Ii,[["render",me]]),Li=Ni;H()(Ii,"components",{QDrawer:Mi.c,QImg:Ti.c,QIcon:N.c,QScrollArea:ri.c,QExpansionItem:qt.c,QItem:M.c});const Bi={id:"masterDrawers2"},Pi={id:"logoSite2",class:"relative-position"},Ri={key:0,id:"miniLogoSite"};function Vi(e,t,i,o,n,l){const r=(0,a.E1)("q-img"),c=(0,a.E1)("menu-list"),d=(0,a.E1)("q-scroll-area"),m=(0,a.E1)("q-drawer"),u=(0,a.E1)("config-list"),h=(0,a.E1)("chat-list"),p=(0,a.E1)("master-recommendation"),f=(0,a.E1)("master-notifications"),g=(0,a.E1)("offline");return(0,a.Wz)(),(0,a.An)("div",Bi,[(0,a.K2)(m,{id:"menuMaster2",class:"no-shadow",modelValue:n.drawer.menu,"onUpdate:modelValue":t[0]||(t[0]=e=>n.drawer.menu=e),ref:"menuMaster",mini:n.miniState,onClickCapture:t[1]||(t[1]=e=>n.miniState?n.eventBus.emit("toggleMasterDrawer","menu"):null)},{default:(0,a.Ql)((()=>[(0,a.wt)((0,a.QD)("div",Pi,[(0,a.K2)(r,{fit:"contain",src:n.logo,style:{height:"80px","min-height":"80px"}},null,8,["src"])],512),[[Je.Ub,!n.miniState]]),n.miniState?((0,a.Wz)(),(0,a.An)("div",Ri,[(0,a.K2)(r,{fit:"contain",src:l.minilogo},null,8,["src"])])):(0,a.g1)("",!0),(0,a.K2)(d,{id:"adminMenu",class:"bg-primary",style:(0,s.MN)("height: calc(100vh - 146px")},{default:(0,a.Ql)((()=>[(0,a.K2)(c,{ref:"menuList",group:"",translatable:e.menuTranslatable,menu:e.menuSelect,"with-tooltip":n.miniState,"tooltip-props":{anchor:"center right"}},null,8,["translatable","menu","with-tooltip"])])),_:1},8,["style"])])),_:1},8,["modelValue","mini"]),(0,a.K2)(m,{bordered:"",id:"configMaster",overlay:"",modelValue:n.drawer.config,"onUpdate:modelValue":t[2]||(t[2]=e=>n.drawer.config=e),side:"right"},{default:(0,a.Ql)((()=>[(0,a.K2)(u)])),_:1},8,["modelValue"]),e.$hasAccess("ichat.conversations.index")?((0,a.Wz)(),(0,a.Az)(m,{key:0,bordered:"",id:"chatMaster",overlay:"",modelValue:n.drawer.chat,"onUpdate:modelValue":t[3]||(t[3]=e=>n.drawer.chat=e),side:"right"},{default:(0,a.Ql)((()=>[(0,a.K2)(h)])),_:1},8,["modelValue"])):(0,a.g1)("",!0),!l.routeSubHeader.recommendations?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.Az)(m,{key:1,id:"drawerRecommendationMaster",modelValue:n.drawer.recommendation,"onUpdate:modelValue":t[4]||(t[4]=e=>n.drawer.recommendation=e),side:"right",overlay:!1},{default:(0,a.Ql)((()=>[(0,a.K2)(p)])),_:1},8,["modelValue"])),(0,a.K2)(f,{"is-open":n.drawer.notification,isMobile:"mobile"==this.windowSize},null,8,["is-open","isMobile"]),l.offlineDrawer?((0,a.Wz)(),(0,a.Az)(m,{key:2,class:"tw-bg-gray-100",id:"drawerOfflineMaster",modelValue:n.drawer.offline,"onUpdate:modelValue":t[5]||(t[5]=e=>n.drawer.offline=e),side:"right",overlay:""},{default:(0,a.Ql)((()=>[(0,a.K2)(g)])),_:1},8,["modelValue"])):(0,a.g1)("",!0)])}var Ui=i(18528)["c"];const Hi={beforeUnmount(){D.kN.off("toggleMasterDrawer"),D.kN.off("openMasterDrawer")},mixins:[ue.c],props:{},components:{menuList:zt,configList:Ge,chatList:Qt,checkin:Ft,masterRecommendation:di,masterNotifications:qi,offline:Ci},mounted(){this.$nextTick((function(){this.init()}))},data(){return{windowHeight:window.innerHeight,windowWith:window.innerWidth,projectName:this.$getSetting("core::site-name"),logo:this.$store.state.qsiteApp.logo,miniState:"mobile"!=this.windowSize,drawer:{menu:!1,config:!1,chat:!1,checkin:!1,recommendation:!1,notification:!1,offline:!1},appConfig:Ui("app"),eventBus:D.kN}},computed:{offlineDrawer(){return this.$getSetting("isite::offline")},windowSize(){return this.windowWith>="992"?"desktop":"mobile"},primaryContrast(){return this.$getSetting("isite::primaryContrast")},secondaryContrast(){return this.$getSetting("isite::secondaryContrast")},minilogo(){return this.$getMediaSetting("isite::logoIadminSM")["path"]},routeSubHeader(){return this.drawer.recommendation=!1,this.$route.meta.subHeader||{}},versionText(){return"v"+Ui("app.version")},openMenu:{get(){return this.drawer.menu},set(e){this.drawer.menu=e}}},methods:{init(){this.handlerEvent(),this.contrast(),window.addEventListener("resize",(()=>{this.windowHeight=window.innerHeight,this.windowWith=window.innerWidth})),this.openMenu="mobile"!=this.windowSize},contrast(){const e=document.querySelector("#masterDrawers2");if(!e)return"#000000";const t=getComputedStyle(e).getPropertyValue("--q-primary"),i=this.$helper.pickTextColor(t),a=getComputedStyle(e).getPropertyValue("--q-secondary"),s=this.$helper.pickTextColor(a);return this.primaryContrast?e.style.setProperty("--q-color-contrast",this.primaryContrast):e.style.setProperty("--q-color-contrast",i),this.secondaryContrast?e.style.setProperty("--q-color-contrast-two",this.secondaryContrast):e.style.setProperty("--q-color-contrast-two",s),this.primaryContrast?this.primaryContrast:i},handlerEvent(){D.kN.on("toggleMasterDrawer",(e=>this.toggleDrawer(e))),D.kN.on("openMasterDrawer",(e=>this.drawer[e]=!0))},toggleDrawer(e){for(var t in this.drawer)t!=e&&("menu"==t&&"mobile"!=this.windowSize?this.miniState=!0:this.drawer[t]=!1);"menu"==e?"mobile"==this.windowSize?(this.miniState=!1,this.drawer.menu=!this.drawer.menu):(this.drawer.menu=!0,this.miniState=!this.miniState):this.drawer[e]=!this.drawer[e]}}};var Oi=i(14512);const Yi=(0,S.c)(Hi,[["render",Vi]]),Fi=Yi;H()(Hi,"components",{QDrawer:Mi.c,QImg:Ti.c,QScrollArea:ri.c,QColor:Oi.c,QItem:M.c,QIcon:N.c,QExpansionItem:qt.c});const ji={id:"masterFooter"},Gi={key:0,id:"footerContent",class:"row q-md-hide items-center"},Ji=(0,a.QD)("div",null,"Menu",-1),Zi={id:"footerMobileProfile",class:"item-footer col cursor-pointer"},Xi=["src"],ea={id:"item-main",class:(0,s.WN)("cursor-pointer row items-center justify-center bg-white")};function ta(e,t,i,o,n,l){const r=(0,a.E1)("q-icon"),c=(0,a.E1)("q-avatar"),d=(0,a.E1)("q-btn"),m=(0,a.E1)("q-footer"),u=(0,a.E1)("q-toolbar-title"),h=(0,a.E1)("q-toolbar"),p=(0,a.E1)("q-separator"),f=(0,a.E1)("q-item-section"),g=(0,a.E1)("q-item"),b=(0,a.E1)("q-list"),w=(0,a.E1)("q-card-section"),v=(0,a.E1)("q-card"),Q=(0,a.E1)("q-dialog"),A=(0,a.iS)("close-popup"),k=(0,a.iS)("ripple");return(0,a.Wz)(),(0,a.An)("div",ji,[(0,a.K2)(m,{class:"bg-primary shadow-2"},{default:(0,a.Ql)((()=>["iadmin"==n.appConfig.mode?((0,a.Wz)(),(0,a.An)("div",Gi,[(0,a.QD)("div",{id:"footerMobileMenu",class:"item-footer col cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","menu"))},[(0,a.K2)(r,{class:"item-icon",name:"fas fa-bars"}),Ji]),(0,a.QD)("div",Zi,[l.quserState.authenticated?((0,a.Wz)(),(0,a.Az)(d,{key:0,to:{name:"user.profile.me"},flat:"","no-caps":"",class:"item-icon",padding:"none"},{default:(0,a.Ql)((()=>[(0,a.K2)(c,{size:"20px"},{default:(0,a.Ql)((()=>[(0,a.QD)("img",{src:l.quserState?.userData?.mainImage},null,8,Xi)])),_:1})])),_:1},8,["to"])):(0,a.g1)("",!0),(0,a.QD)("div",null,(0,s.WA)(e.$tr("isite.cms.label.profile")),1)]),(0,a.QD)("div",{id:"footerMobileMain",class:"col",onClick:t[1]||(t[1]=e=>l.doMainAction())},[(0,a.QD)("div",ea,[(0,a.K2)(r,{class:"item-icon",color:"primary",name:n.mainAction.icon},null,8,["name"])])]),(0,a.QD)("div",{id:"footerMobileGoToSite",class:"item-footer col cursor-pointer bg",onClick:t[2]||(t[2]=t=>e.$helper.openExternalURL(e.$store.state.qsiteApp.baseUrl))},[(0,a.K2)(r,{class:"item-icon",name:"fa-light fa-eye"}),(0,a.QD)("div",null,(0,s.WA)(e.$tr("isite.cms.configList.goToSite")),1)]),(0,a.QD)("div",{id:"footerMobileOthers",class:"item-footer col cursor-pointer",onClick:t[3]||(t[3]=e=>n.modal.show=!0)},[(0,a.K2)(r,{class:"item-icon",name:"fas fa-ellipsis-h"}),(0,a.QD)("div",null,(0,s.WA)(e.$trp("isite.cms.label.other")),1)])])):(0,a.g1)("",!0)])),_:1}),"iadmin"==n.appConfig.mode?((0,a.Wz)(),(0,a.Az)(Q,{key:0,modelValue:n.modal.show,"onUpdate:modelValue":t[10]||(t[10]=e=>n.modal.show=e),position:"bottom"},{default:(0,a.Ql)((()=>[(0,a.K2)(v,{style:{width:"350px"}},{default:(0,a.Ql)((()=>[(0,a.K2)(h,null,{default:(0,a.Ql)((()=>[(0,a.K2)(r,{class:"item-icon",name:"fas fa-ellipsis-v"}),(0,a.K2)(u,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$trp("isite.cms.label.other")),1)])),_:1}),(0,a.wt)((0,a.K2)(d,{flat:"",round:"",dense:"",icon:"fa fa-close"},null,512),[[A]])])),_:1}),(0,a.K2)(p),(0,a.K2)(w,{class:"row items-center no-wrap q-pa-none"},{default:(0,a.Ql)((()=>[(0,a.wt)(((0,a.Wz)(),(0,a.Az)(b,{separator:"",class:"full-width"},{default:(0,a.Ql)((()=>[(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{clickable:"",onClick:t[4]||(t[4]=e=>n.eventBus.emit("toggleMasterDrawer","config"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fa-light fa-folder-gear"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("isite.cms.label.setting")),1)])),_:1})])),_:1})),[[k]]),(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{clickable:"",onClick:t[5]||(t[5]=e=>n.eventBus.emit("toggleMasterDrawer","offline"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fa-light fa-wifi-slash"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("isite.cms.label.offlineRequests")),1)])),_:1})])),_:1})),[[k]]),e.$hasAccess("ichat.conversations.index")?(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{key:0,clickable:"",onClick:t[6]||(t[6]=e=>n.eventBus.emit("toggleMasterDrawer","chat"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fa-light fa-message"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)("Chat")])),_:1})])),_:1})),[[k]]):(0,a.g1)("",!0),e.$hasAccess("icheckin.shifts.create")?(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{key:1,clickable:"",onClick:t[7]||(t[7]=e=>n.eventBus.emit("toggleMasterDrawer","checkin"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fas fa-stopwatch"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("icheckin.cms.sidebar.checkin")),1)])),_:1})])),_:1})),[[k]]):(0,a.g1)("",!0),!l.params.recommendations?(0,a.g1)("",!0):(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{key:2,clickable:"",onClick:t[8]||(t[8]=e=>n.eventBus.emit("toggleMasterDrawer","recommendation"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fas fa-hat-wizard"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$trp("isite.cms.label.recommendation")),1)])),_:1})])),_:1})),[[k]]),(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{clickable:"",onClick:t[9]||(t[9]=e=>n.eventBus.emit("toggleMasterDrawer","notification"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fa-light fa-bell"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$trp("isite.cms.label.notification")),1)])),_:1})])),_:1})),[[k]])])),_:1})),[[A]])])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,a.g1)("",!0)])}var ia=i(18528)["c"];const aa={beforeUnmount(){D.kN.off("setMobileMainAction")},props:{},components:{},watch:{$route:{deep:!0,handler:function(e){this.mainAction=ia("app.mobilMainAction")}}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{mainAction:ia("app.mobilMainAction"),appConfig:ia("app"),modal:{show:!1},eventBus:D.kN}},computed:{quserState(){return this.$store.state.quserAuth},routeSubHeader(){return this.$route.meta.subHeader||{}},currentRoute(){return this.$route},params(){return this.currentRoute.meta.subHeader||{}}},methods:{init(){D.kN.on("setMobileMainAction",(e=>{this.mainAction={...this.mainAction,...e}}))},doMainAction(){this.mainAction.callBack?this.mainAction.callBack():this.mainAction.route&&this.$route.name!=this.mainAction.route&&this.$router.push({name:this.mainAction.route})}}};var sa=i(22244),oa=i(71008);const na=(0,S.c)(aa,[["render",ta]]),la=na;H()(aa,"components",{QFooter:sa.c,QIcon:N.c,QBtn:K.c,QAvatar:P.c,QDialog:ut.c,QCard:ht.c,QToolbar:J.c,QToolbarTitle:Z.c,QSeparator:_.c,QCardSection:oa.c,QList:I.c,QItem:M.c,QItemSection:T.c}),H()(aa,"directives",{ClosePopup:V.c,Ripple:R.c});const ra={id:"masterFooter"},ca={key:0,id:"footerContent",class:"row q-md-hide items-center"},da=(0,a.QD)("div",null,"Menu",-1),ma={id:"footerMobileProfile",class:"item-footer col cursor-pointer"},ua=["src"],ha={id:"item-main",class:(0,s.WN)("cursor-pointer row items-center justify-center bg-white")};function pa(e,t,i,o,n,l){const r=(0,a.E1)("q-icon"),c=(0,a.E1)("q-avatar"),d=(0,a.E1)("q-btn"),m=(0,a.E1)("q-footer"),u=(0,a.E1)("q-toolbar-title"),h=(0,a.E1)("q-toolbar"),p=(0,a.E1)("q-separator"),f=(0,a.E1)("q-item-section"),g=(0,a.E1)("q-item"),b=(0,a.E1)("q-list"),w=(0,a.E1)("q-card-section"),v=(0,a.E1)("q-card"),Q=(0,a.E1)("q-dialog"),A=(0,a.iS)("close-popup"),k=(0,a.iS)("ripple");return(0,a.Wz)(),(0,a.An)("div",ra,[(0,a.K2)(m,{class:"bg-primary shadow-2"},{default:(0,a.Ql)((()=>["iadmin"==n.appConfig.mode?((0,a.Wz)(),(0,a.An)("div",ca,[(0,a.QD)("div",{id:"footerMobileMenu",class:"item-footer col cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","menu"))},[(0,a.K2)(r,{class:"item-icon",name:"fas fa-bars"}),da]),(0,a.QD)("div",ma,[l.quserState.authenticated?((0,a.Wz)(),(0,a.Az)(d,{key:0,to:{name:"user.profile.me"},flat:"","no-caps":"",class:"item-icon",padding:"none"},{default:(0,a.Ql)((()=>[(0,a.K2)(c,{size:"20px"},{default:(0,a.Ql)((()=>[(0,a.QD)("img",{src:l.quserState?.userData?.mainImage},null,8,ua)])),_:1})])),_:1},8,["to"])):(0,a.g1)("",!0),(0,a.QD)("div",null,(0,s.WA)(e.$tr("isite.cms.label.profile")),1)]),(0,a.QD)("div",{id:"footerMobileMain",class:"col",onClick:t[1]||(t[1]=e=>l.doMainAction())},[(0,a.QD)("div",ha,[(0,a.K2)(r,{class:"item-icon",color:"primary",name:n.mainAction.icon},null,8,["name"])])]),(0,a.QD)("div",{class:"item-footer col cursor-pointer",onClick:t[2]||(t[2]=t=>e.$eventBus.emit("toggleMasterDrawer","config"))},[(0,a.K2)(r,{class:"item-icon",name:"fas fa-cog"}),(0,a.QD)("div",null,(0,s.WA)(e.$tr("isite.cms.label.setting")),1)]),(0,a.QD)("div",{id:"footerMobileOthers",class:"item-footer col cursor-pointer",onClick:t[3]||(t[3]=e=>n.modal.show=!0)},[(0,a.K2)(r,{class:"item-icon",name:"fas fa-ellipsis-h"}),(0,a.QD)("div",null,(0,s.WA)(e.$trp("isite.cms.label.other")),1)])])):(0,a.g1)("",!0)])),_:1}),"iadmin"==n.appConfig.mode?((0,a.Wz)(),(0,a.Az)(Q,{key:0,modelValue:n.modal.show,"onUpdate:modelValue":t[11]||(t[11]=e=>n.modal.show=e),position:"bottom"},{default:(0,a.Ql)((()=>[(0,a.K2)(v,{style:{width:"350px"}},{default:(0,a.Ql)((()=>[(0,a.K2)(h,null,{default:(0,a.Ql)((()=>[(0,a.K2)(r,{class:"item-icon",name:"fas fa-ellipsis-v"}),(0,a.K2)(u,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$trp("isite.cms.label.other")),1)])),_:1}),(0,a.wt)((0,a.K2)(d,{flat:"",round:"",dense:"",icon:"fa fa-close"},null,512),[[A]])])),_:1}),(0,a.K2)(p),(0,a.K2)(w,{class:"row items-center no-wrap q-pa-none"},{default:(0,a.Ql)((()=>[(0,a.wt)(((0,a.Wz)(),(0,a.Az)(b,{separator:"",class:"full-width"},{default:(0,a.Ql)((()=>[(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{clickable:"",onClick:t[4]||(t[4]=e=>n.eventBus.emit("toggleMasterDrawer","config"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fa-light fa-folder-gear"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("isite.cms.label.setting")),1)])),_:1})])),_:1})),[[k]]),(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{clickable:"",onClick:t[5]||(t[5]=e=>n.eventBus.emit("toggleMasterDrawer","offline"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fa-light fa-wifi-slash"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("isite.cms.label.offlineRequests")),1)])),_:1})])),_:1})),[[k]]),e.$hasAccess("ichat.conversations.index")?(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{key:0,clickable:"",onClick:t[6]||(t[6]=e=>n.eventBus.emit("toggleMasterDrawer","chat"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fa-light fa-message"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)("Chat")])),_:1})])),_:1})),[[k]]):(0,a.g1)("",!0),e.$hasAccess("icheckin.shifts.create")?(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{key:1,clickable:"",onClick:t[7]||(t[7]=e=>n.eventBus.emit("toggleMasterDrawer","checkin"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fas fa-stopwatch"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("icheckin.cms.sidebar.checkin")),1)])),_:1})])),_:1})),[[k]]):(0,a.g1)("",!0),!l.params.recommendations?(0,a.g1)("",!0):(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{key:2,clickable:"",onClick:t[8]||(t[8]=e=>n.eventBus.emit("toggleMasterDrawer","recommendation"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fas fa-hat-wizard"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$trp("isite.cms.label.recommendation")),1)])),_:1})])),_:1})),[[k]]),(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{clickable:"",onClick:t[9]||(t[9]=e=>n.eventBus.emit("toggleMasterDrawer","notification"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fa-light fa-bell"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$trp("isite.cms.label.notification")),1)])),_:1})])),_:1})),[[k]]),(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{clickable:"",onClick:t[10]||(t[10]=t=>e.$router.push({name:"auth.logout"}))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fa-light fa-right-from-bracket"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("isite.cms.configList.signOut")),1)])),_:1})])),_:1})),[[k]])])),_:1})),[[A]])])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,a.g1)("",!0)])}var fa=i(18528)["c"];const ga={beforeUnmount(){D.kN.off("setMobileMainAction")},props:{},components:{},watch:{$route:{deep:!0,handler:function(e){this.mainAction=fa("app.mobilMainAction")}}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{mainAction:fa("app.mobilMainAction"),appConfig:fa("app"),loadFooterIpanel:!1,modal:{show:!1},eventBus:D.kN}},computed:{quserState(){return this.$store.state.quserAuth},routeSubHeader(){return this.$route.meta.subHeader||{}},currentRoute(){return this.$route},params(){return this.currentRoute.meta.subHeader||{}}},methods:{init(){D.kN.on("setMobileMainAction",(e=>{this.mainAction={...this.mainAction,...e}}))},doMainAction(){this.mainAction.callBack?this.mainAction.callBack():this.mainAction.route&&this.$route.name!=this.mainAction.route&&this.$router.push({name:this.mainAction.route})}}},ba=(0,S.c)(ga,[["render",pa]]),wa=ba;H()(ga,"components",{QFooter:sa.c,QIcon:N.c,QBtn:K.c,QAvatar:P.c,QDialog:ut.c,QCard:ht.c,QToolbar:J.c,QToolbarTitle:Z.c,QSeparator:_.c,QCardSection:oa.c,QList:I.c,QItem:M.c,QItemSection:T.c}),H()(ga,"directives",{ClosePopup:V.c,Ripple:R.c});const va={id:"masterPanelHeader"},Qa={id:"breadCrumbContent",class:"q-hide q-md-show"};function Aa(e,t,i,s,o,n){const l=(0,a.E1)("q-btn"),r=(0,a.E1)("q-breadcrumbs-el"),c=(0,a.E1)("q-breadcrumbs"),d=(0,a.E1)("q-toolbar-title"),m=(0,a.E1)("site-actions"),u=(0,a.E1)("q-toolbar"),h=(0,a.E1)("q-header");return(0,a.Wz)(),(0,a.An)("div",va,[(0,a.K2)(h,null,{default:(0,a.Ql)((()=>[(0,a.K2)(u,{id:"toolbarTop"},{default:(0,a.Ql)((()=>[(0,a.K2)(l,{id:"buttonToogleMenu",icon:"fas fa-bars",unelevated:"",color:"primary",onClick:t[0]||(t[0]=e=>o.eventBus.emit("toggleMasterDrawer","menu"))}),(0,a.K2)(d,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",Qa,[(0,a.K2)(c,{class:"text-blue-grey",gutter:"none"},{default:(0,a.Ql)((()=>[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(n.breadcrumbs,((e,t)=>((0,a.Wz)(),(0,a.Az)(r,{key:t,label:e.label,to:!!e.to&&{name:e.to}},null,8,["label","to"])))),128))])),_:1})])])),_:1}),(0,a.K2)(m)])),_:1})])),_:1})])}var ka=i(18528)["c"];const ya={beforeUnmount(){D.kN.off("header.badge.manage")},components:{siteActions:Y},mounted(){this.$nextTick((function(){this.init()}))},data(){return{projectName:this.$getSetting("core::site-name"),logo:this.$store.state.qsiteApp.logo,appConfig:ka("app"),badge:{chat:!1,notification:!1},loadHeaderIpanel:!1,eventBus:D.kN}},computed:{currentRoute(){return this.$route},params(){return this.currentRoute.meta.subHeader||{}},breadcrumbs(){let e=[],t=this.params.breadcrumb?this.$clone(this.params.breadcrumb):[];t=this.$clone(t.reverse());let i=-1==this.currentRoute.name.indexOf("app.home")?[ka("pages.mainqsite.home"),this.currentRoute.meta]:[ka("pages.mainqsite.home")];return t.forEach((e=>i.splice(1,0,ka(`pages.${e}`)))),i.forEach((t=>{t&&t.activated&&this.$hasAccess(t.permission)&&e.push({label:this.$tr(t.headerTitle||t.title),icon:t.icon,to:t.name})})),e}},methods:{init(){D.kN.on("header.badge.manage",(e=>{Object.keys(e).forEach((t=>this.badge[t]=e[t]))}))}}};var qa=i(92852),$a=i(15736);const za=(0,S.c)(ya,[["render",Aa]]),xa=za;H()(ya,"components",{QHeader:G.c,QToolbar:J.c,QBtn:K.c,QToolbarTitle:Z.c,QBreadcrumbs:qa.c,QBreadcrumbsEl:$a.c,QIcon:N.c});const Da={id:"masterDrawers"},Ea={key:0,class:"q-pa-md logo-bg-primary text-center"},Wa={key:0,id:"btnProfile"},Sa={class:"row items-center justify-between"},Ka={class:"row items-center"},Ca={key:0,class:"q-ml-xs"},_a={key:0,class:"q-pr-md"},Ia={class:"row no-wrap q-pa-md"},Ma={class:"column"},Ta={style:{"max-width":"110px"}},Na={class:"text-center"},La=["src"],Ba={class:"text-subtitle1 ellipsis q-mt-md"},Pa={class:"ellipsis text-caption"},Ra={class:"column"},Va={class:"text-h6 q-mb-xs text-blue-grey"},Ua={class:"row items-center text-blue-grey text-right"},Ha={class:"row items-center text-blue-grey"};function Oa(e,t,i,o,n,l){const r=(0,a.E1)("q-img"),c=(0,a.E1)("menu-list"),d=(0,a.E1)("q-scroll-area"),m=(0,a.E1)("q-icon"),u=(0,a.E1)("q-avatar"),h=(0,a.E1)("q-separator"),p=(0,a.E1)("q-item-section"),f=(0,a.E1)("q-item"),g=(0,a.E1)("q-list"),b=(0,a.E1)("q-menu"),w=(0,a.E1)("q-no-ssr"),v=(0,a.E1)("q-drawer"),Q=(0,a.E1)("checkin"),A=(0,a.E1)("master-recommendation"),k=(0,a.E1)("master-notifications"),y=(0,a.iS)("close-popup");return(0,a.Wz)(),(0,a.An)("div",Da,[(0,a.K2)(v,{id:"menuMaster",class:"no-shadow",modelValue:n.drawer.menu,"onUpdate:modelValue":t[0]||(t[0]=e=>n.drawer.menu=e),ref:"menuMaster",mini:n.miniState,onClickCapture:t[1]||(t[1]=e=>n.miniState?n.eventBus.emit("toggleMasterDrawer","menu"):null)},{default:(0,a.Ql)((()=>[!n.miniState&&n.drawer.menu?((0,a.Wz)(),(0,a.An)("div",Ea,[(0,a.K2)(r,{fit:"contain",src:n.logo,style:{height:"120px","min-height":"120px","max-width":"80%"}},null,8,["src"])])):(0,a.g1)("",!0),(0,a.K2)(d,{style:(0,s.MN)(`height: calc(100vh - ${n.miniState?"50":"202"}px`)},{default:(0,a.Ql)((()=>[(0,a.K2)(c,{ref:"menuList",group:"",translatable:e.menuTranslatable,menu:e.menuSelect,"with-tooltip":n.miniState},null,8,["translatable","menu","with-tooltip"])])),_:1},8,["style"]),(0,a.K2)(w,null,{default:(0,a.Ql)((()=>[l.quserState.authenticated?((0,a.Wz)(),(0,a.An)("div",Wa,[(0,a.QD)("div",Sa,[(0,a.QD)("div",Ka,[(0,a.QD)("div",{id:"profileImage",class:"img-as-bg q-mr-sm items-center",style:(0,s.MN)(`background-image: url('${l.profileImage.smallThumb}')`)},null,4),n.miniState?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.An)("div",Ca,(0,s.WA)(l.quserState.userData.firstName),1))]),n.miniState?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.An)("div",_a,[(0,a.K2)(m,{name:"fas fa-chevron-up"})]))]),(0,a.K2)(b,{anchor:"bottom right",self:"top right"},{default:(0,a.Ql)((()=>[(0,a.QD)("div",Ia,[(0,a.QD)("div",Ma,[(0,a.QD)("div",Ta,[(0,a.QD)("div",Na,[(0,a.K2)(u,{size:"72px",class:"q-mx-auto"},{default:(0,a.Ql)((()=>[(0,a.QD)("img",{src:l.profileImage.mediumThumb},null,8,La)])),_:1})]),(0,a.QD)("div",Ba,(0,s.WA)(l.quserState.userData.fullName),1),(0,a.QD)("div",Pa,(0,s.WA)(l.quserState.userData.roles.map((e=>e.name)).join(", ")),1)])]),(0,a.K2)(h,{vertical:"",inset:"",class:"q-mx-lg"}),(0,a.QD)("div",Ra,[(0,a.QD)("div",Va,(0,s.WA)(e.$tr("isite.cms.label.profile")),1),(0,a.K2)(g,null,{default:(0,a.Ql)((()=>[(0,a.wt)(((0,a.Wz)(),(0,a.Az)(f,{clickable:"",to:{name:"user.profile.me"},style:{padding:"0","min-width":"130px"}},{default:(0,a.Ql)((()=>[(0,a.K2)(p,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",Ua,[(0,a.K2)(m,{name:"fas fa-user-circle",color:"green",size:"16px",class:"q-mr-sm"}),(0,a.mY)(" "+(0,s.WA)(e.$tr("iprofile.cms.sidebar.panelProfile")),1)])])),_:1})])),_:1},8,["to"])),[[y]]),(0,a.wt)(((0,a.Wz)(),(0,a.Az)(f,{clickable:"",to:{name:"auth.logout"},style:{padding:"0","min-width":"130px"}},{default:(0,a.Ql)((()=>[(0,a.K2)(p,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",Ha,[(0,a.K2)(m,{name:"fas fa-sign-out-alt",color:"red",size:"16px",class:"q-mr-sm"}),(0,a.mY)(" "+(0,s.WA)(e.$t("isite.cms.configList.signOut")),1)])])),_:1})])),_:1},8,["to"])),[[y]])])),_:1})])])])),_:1})])):(0,a.g1)("",!0)])),_:1})])),_:1},8,["modelValue","mini"]),"ipanel"==n.appConfig.mode&&e.$hasAccess("icheckin.shifts.create")?((0,a.Wz)(),(0,a.Az)(v,{key:0,id:"drawerCheckinMaster",modelValue:n.drawer.checkin,"onUpdate:modelValue":t[2]||(t[2]=e=>n.drawer.checkin=e),side:"right",bordered:""},{default:(0,a.Ql)((()=>[(0,a.K2)(Q)])),_:1},8,["modelValue"])):(0,a.g1)("",!0),!l.routeSubHeader.recommendations?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.Az)(v,{key:1,id:"drawerRecommendationMaster",modelValue:n.drawer.recommendation,"onUpdate:modelValue":t[3]||(t[3]=e=>n.drawer.recommendation=e),side:"right"},{default:(0,a.Ql)((()=>[(0,a.K2)(A)])),_:1},8,["modelValue"])),(0,a.K2)(k,{"is-open":n.drawer.notification,isMobile:"mobile"==this.windowSize},null,8,["is-open","isMobile"])])}var Ya=i(18528)["c"];const Fa={beforeUnmount(){D.kN.off("toggleMasterDrawer"),D.kN.off("openMasterDrawer")},mixins:[ue.c],props:{},components:{menuList:zt,configList:Ge,chatList:Qt,checkin:Ft,masterRecommendation:di,masterNotifications:qi},mounted(){this.$nextTick((function(){this.init()}))},data(){return{windowHeight:window.innerHeight,windowWith:window.innerWidth,projectName:this.$getSetting("core::site-name"),logo:this.$store.state.qsiteApp.logo,miniState:"mobile"!=this.windowSize,drawer:{menu:"mobile"!=this.windowSize,config:!1,chat:!1,filter:!1,checkin:!1,recommendation:!1,notification:!1},appConfig:Ya("app"),filter:this.$filter,eventBus:D.kN}},computed:{quserState(){return this.$store.state.quserAuth},windowSize(){return this.windowWith>="992"?"desktop":"mobile"},routeSubHeader(){return this.drawer.recommendation=!1,this.$route.meta.subHeader||{}},profileImage(){return this.$store.getters["quserAuth/profileImage"]}},methods:{init(){this.handlerEvent(),window.addEventListener("resize",(()=>{this.windowHeight=window.innerHeight,this.windowWith=window.innerWidth}))},handlerEvent(){D.kN.on("toggleMasterDrawer",(e=>this.toggleDrawer(e))),D.kN.on("openMasterDrawer",(e=>this.drawer[e]=!0))},toggleDrawer(e){for(var t in this.drawer)t!=e&&("menu"==t&&"mobile"!=this.windowSize?this.miniState=!0:this.drawer[t]=!1);"menu"==e?"mobile"==this.windowSize?(this.miniState=!1,this.drawer.menu=!this.drawer.menu):(this.drawer.menu=!0,this.miniState=!this.miniState):this.drawer[e]=!this.drawer[e]}}};var ja=i(41628);const Ga=(0,S.c)(Fa,[["render",Oa]]),Ja=Ga;H()(Fa,"components",{QDrawer:Mi.c,QImg:Ti.c,QScrollArea:ri.c,QNoSsr:Oe.c,QIcon:N.c,QMenu:C.c,QAvatar:P.c,QSeparator:_.c,QList:I.c,QItem:M.c,QItemSection:T.c,QLayout:ja.c,QExpansionItem:qt.c}),H()(Fa,"directives",{ClosePopup:V.c});const Za={id:"masterFooter"},Xa={key:0,id:"panelFooterContent",class:"row q-md-hide items-center"},es=(0,a.QD)("div",null,"Menu",-1),ts={class:"item-footer col cursor-pointer"},is=["src"];function as(e,t,i,o,n,l){const r=(0,a.E1)("q-icon"),c=(0,a.E1)("q-avatar"),d=(0,a.E1)("q-btn"),m=(0,a.E1)("q-footer"),u=(0,a.E1)("q-toolbar-title"),h=(0,a.E1)("q-toolbar"),p=(0,a.E1)("q-separator"),f=(0,a.E1)("q-item-section"),g=(0,a.E1)("q-item"),b=(0,a.E1)("q-list"),w=(0,a.E1)("q-card-section"),v=(0,a.E1)("q-card"),Q=(0,a.E1)("q-dialog"),A=(0,a.iS)("close-popup"),k=(0,a.iS)("ripple");return(0,a.Wz)(),(0,a.An)("div",Za,[(0,a.K2)(m,{class:"bg-white"},{default:(0,a.Ql)((()=>["iadmin"==n.appConfig.mode?((0,a.Wz)(),(0,a.An)("div",Xa,[(0,a.QD)("div",{class:"item-footer col cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","menu"))},[(0,a.K2)(r,{class:"item-icon",name:"fas fa-bars"}),es]),(0,a.QD)("div",ts,[l.quserState.authenticated?((0,a.Wz)(),(0,a.Az)(d,{key:0,to:{name:"user.profile.me"},flat:"","no-caps":"",class:"item-icon",padding:"none"},{default:(0,a.Ql)((()=>[(0,a.K2)(c,{size:"20px"},{default:(0,a.Ql)((()=>[(0,a.QD)("img",{src:l.profileImage.smallThumb},null,8,is)])),_:1})])),_:1},8,["to"])):(0,a.g1)("",!0),(0,a.QD)("div",null,(0,s.WA)(e.$tr("isite.cms.label.profile")),1)]),(0,a.QD)("div",{class:"col",onClick:t[1]||(t[1]=e=>l.doMainAction())},[(0,a.QD)("div",{id:"item-main",class:(0,s.WN)(`cursor-pointer row items-center justify-center bg-${n.mainAction.color}`)},[(0,a.K2)(r,{class:"item-icon",name:n.mainAction.icon},null,8,["name"])],2)]),(0,a.QD)("div",{class:"item-footer col cursor-pointer",onClick:t[2]||(t[2]=e=>n.eventBus.emit("toggleMasterDrawer","config"))},[(0,a.K2)(r,{class:"item-icon",name:"fas fa-cog"}),(0,a.QD)("div",null,(0,s.WA)(e.$tr("isite.cms.label.setting")),1)]),(0,a.QD)("div",{class:"item-footer col cursor-pointer",onClick:t[3]||(t[3]=e=>n.modal.show=!0)},[(0,a.K2)(r,{class:"item-icon",name:"fas fa-ellipsis-h"}),(0,a.QD)("div",null,(0,s.WA)(e.$trp("isite.cms.label.other")),1)])])):(0,a.g1)("",!0)])),_:1}),"iadmin"==n.appConfig.mode?((0,a.Wz)(),(0,a.Az)(Q,{key:0,modelValue:n.modal.show,"onUpdate:modelValue":t[9]||(t[9]=e=>n.modal.show=e),position:"bottom"},{default:(0,a.Ql)((()=>[(0,a.K2)(v,{style:{width:"350px"}},{default:(0,a.Ql)((()=>[(0,a.K2)(h,null,{default:(0,a.Ql)((()=>[(0,a.K2)(r,{class:"item-icon",name:"fas fa-ellipsis-v"}),(0,a.K2)(u,null,{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$trp("isite.cms.label.other")),1)])),_:1}),(0,a.wt)((0,a.K2)(d,{flat:"",round:"",dense:"",icon:"fa fa-close"},null,512),[[A]])])),_:1}),(0,a.K2)(p),(0,a.K2)(w,{class:"row items-center no-wrap q-pa-none"},{default:(0,a.Ql)((()=>[(0,a.wt)(((0,a.Wz)(),(0,a.Az)(b,{separator:"",class:"full-width"},{default:(0,a.Ql)((()=>[(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{clickable:"",onClick:t[4]||(t[4]=t=>e.$helper.openExternalURL(e.$store.state.qsiteApp.baseUrl))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"far fa-eye"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("isite.cms.configList.goToSite")),1)])),_:1})])),_:1})),[[k]]),e.$hasAccess("ichat.conversations.index")?(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{key:0,clickable:"",onClick:t[5]||(t[5]=e=>n.eventBus.emit("toggleMasterDrawer","chat"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fa-light fa-message"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)("Chat")])),_:1})])),_:1})),[[k]]):(0,a.g1)("",!0),e.$hasAccess("icheckin.shifts.create")?(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{key:1,clickable:"",onClick:t[6]||(t[6]=e=>n.eventBus.emit("toggleMasterDrawer","checkin"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fas fa-stopwatch"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$tr("icheckin.cms.sidebar.checkin")),1)])),_:1})])),_:1})),[[k]]):(0,a.g1)("",!0),!l.params.recommendations?(0,a.g1)("",!0):(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{key:2,clickable:"",onClick:t[7]||(t[7]=e=>n.eventBus.emit("toggleMasterDrawer","recommendation"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fas fa-hat-wizard"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$trp("isite.cms.label.recommendation")),1)])),_:1})])),_:1})),[[k]]),(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{clickable:"",onClick:t[8]||(t[8]=e=>n.eventBus.emit("toggleMasterDrawer","notification"))},{default:(0,a.Ql)((()=>[(0,a.K2)(f,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"primary",name:"fas fa-bell"})])),_:1}),(0,a.K2)(f,{class:"ellipsis"},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(e.$trp("isite.cms.label.notification")),1)])),_:1})])),_:1})),[[k]])])),_:1})),[[A]])])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,a.g1)("",!0)])}var ss=i(18528)["c"];const os={beforeUnmount(){D.kN.off("setMobileMainAction")},props:{},components:{},watch:{$route:{deep:!0,handler:function(e){this.mainAction=ss("app.mobilMainAction")}}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{mainAction:ss("app.mobilMainAction"),appConfig:ss("app"),loadFooterIpanel:!1,modal:{show:!1},eventBus:D.kN}},computed:{quserState(){return this.$store.state.quserAuth},routeSubHeader(){return this.$route.meta.subHeader||{}},currentRoute(){return this.$route},params(){return this.currentRoute.meta.subHeader||{}},profileImage(){return this.$store.getters["quserAuth/profileImage"]}},methods:{init(){D.kN.on("setMobileMainAction",(e=>{this.mainAction={...this.mainAction,...e}}))},doMainAction(){this.mainAction.callBack?this.mainAction.callBack():this.mainAction.route&&this.$route.name!=this.mainAction.route&&this.$router.push({name:this.mainAction.route})}}},ns=(0,S.c)(os,[["render",as]]),ls=ns;H()(os,"components",{QFooter:sa.c,QIcon:N.c,QBtn:K.c,QAvatar:P.c,QDialog:ut.c,QCard:ht.c,QToolbar:J.c,QToolbarTitle:Z.c,QSeparator:_.c,QCardSection:oa.c,QList:I.c,QItem:M.c,QItemSection:T.c}),H()(os,"directives",{ClosePopup:V.c,Ripple:R.c});var rs=i(68260);const cs={id:"actionsGamification"},ds={id:"content-script-modal"},ms=["innerHTML"],us=["innerHTML"];function hs(e,t,i,s,o,n){const l=(0,a.E1)("dynamic-form"),r=(0,a.E1)("master-modal");return(0,a.Wz)(),(0,a.An)("div",cs,[(0,a.K2)(r,{modelValue:o.modal.form.show,"onUpdate:modelValue":t[1]||(t[1]=e=>o.modal.form.show=e),title:o.modal.form.title,customPosition:!0},{default:(0,a.Ql)((()=>[o.modal.form.blocks?((0,a.Wz)(),(0,a.Az)(l,{key:0,loading:o.modal.form.loading,blocks:o.modal.form.blocks,onSubmit:t[0]||(t[0]=e=>n.sendFormData(e)),description:o.modal.form.description},null,8,["loading","blocks","description"])):(0,a.g1)("",!0)])),_:1},8,["modelValue","title"]),(0,a.K2)(r,{modelValue:o.modal.script.show,"onUpdate:modelValue":t[2]||(t[2]=e=>o.modal.script.show=e),title:o.modal.script.title,customPosition:!0},{default:(0,a.Ql)((()=>[(0,a.QD)("div",ds,[(0,a.QD)("p",{innerHTML:o.modal.script.description},null,8,ms)])])),_:1},8,["modelValue","title"]),(0,a.K2)(r,{id:"iframeModalActivity",modelValue:o.modal.iframe.show,"onUpdate:modelValue":t[3]||(t[3]=e=>o.modal.iframe.show=e),title:o.category?o.category.title:"",customPosition:!0},{default:(0,a.Ql)((()=>[(0,a.QD)("div",{id:"iframeActivity",innerHTML:o.modal.iframe.iframe},null,8,us)])),_:1},8,["modelValue","title"])])}var ps=i(18528)["c"];const fs={beforeUnmount(){D.kN.off("open.gamification.activity")},props:{},components:{},watch:{"modal.script.show":e=>{if(!e){const e=document.getElementsByClassName("b24-window-mounts")[0],t=document.body.getElementsByTagName("script"),i=t[t.length-1];e?.remove(),i?.remove()}}},mounted(){this.$nextTick((function(){D.kN.on("open.gamification.activity",this.openActivity)}))},data(){return{category:null,modal:{form:{show:!1,loading:!1,formId:void 0,sent:!1,title:"",description:"",blocks:[]},script:{show:!1,loading:!0,title:"",description:""},iframe:{show:!1,iframe:null}}}},computed:{},methods:{openActivity(e){switch(e.type){case 2:this.$helper.openExternalURL(`${e.url}`,!0);break;case 3:const t=e.form.fields,i=t.map(((e,t)=>e.dynamicField)),a=[{name:"block1",fields:i}];this.modal.form.show=!0,this.modal.form.title=e.title,this.modal.form.description=e.description,this.modal.form.blocks=a,this.modal.form.formId=e.formId;break;case 4:const s=document.createRange().createContextualFragment(e.options.externalScript);this.modal.script.show=!0,this.modal.script.title=e.title,this.modal.script.description=e.description,this.modal.script.loading=!0,setTimeout((()=>{const e=document.getElementById("content-script-modal");e.appendChild(s),this.modal.script.loading=!1}),1e3);break;case 5:this.modal.iframe={show:!0,iframe:e.options.iframe};break;default:let o=this.$store.state.qsiteApp.baseUrl;this.$helper.openExternalURL(`${o}/${e.url}`,!1);break}},sendFormData(e){const t={...e,form_id:this.modal.form.formId};this.modal.form.loading=!0,this.$axios.post(`${this.baseUrl}${ps("apiRoutes.qform.leads")}`,t).then((e=>{200===e.status&&(this.modal.form.loading=!1,this.modal.form.show=!1,this.$alert.info({message:`${this.$tr("isite.cms.message.recordCreated")}`}))})).catch((e=>{this.modal.form.loading=!1,this.modal.form.show=!1,this.$alert.error({message:`${this.$tr("isite.cms.message.recordNoCreated")}`}),console.error(e)}))}}},gs=(0,S.c)(fs,[["render",hs]]),bs=gs;function ws(e,t,i,a,s,o){return null}const vs={name:"Alert",beforeUnmount(){window.removeEventListener("online",this.connectionSwitch),window.removeEventListener("offline",this.connectionSwitch)},mounted(){window.addEventListener("online",this.connectionSwitch),window.addEventListener("offline",this.connectionSwitch),this.connectionSwitch()},methods:{connectionSwitch(){navigator.onLine?this.$store.dispatch("qofflineMaster/APP_ONLINE"):this.$store.dispatch("qofflineMaster/APP_OFFLINE")}}},Qs=(0,S.c)(vs,[["render",ws]]),As=Qs,ks={class:"banner-wrapper"},ys={key:2};function qs(e,t,i,o,n,l){const r=(0,a.E1)("q-icon"),c=(0,a.E1)("marquee");return(0,a.Wz)(),(0,a.An)("div",ks,[(0,a.QD)("div",{class:(0,s.WN)([i.classWrapper,"banner"]),onClick:t[0]||(t[0]=(...e)=>i.action&&i.action(...e))},[i.icon&&i.icon.name?((0,a.Wz)(),(0,a.Az)(r,{key:0,size:i.icon.size,name:i.icon.name,class:(0,s.WN)([i.icon.class,"q-mr-sm"])},null,8,["size","name","class"])):(0,a.g1)("",!0),i.marquee?((0,a.Wz)(),(0,a.Az)(c,{key:1},{default:(0,a.Ql)((()=>[(0,a.mY)((0,s.WA)(i.message),1)])),_:1})):i.marquee?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.An)("span",ys,(0,s.WA)(i.message),1))],2)])}const $s={name:"bannerAlert",data:()=>({eventBus:D.kN}),props:{classWrapper:{type:String,default:""},marquee:{type:Boolean,default:!1},icon:{type:Object,default:()=>({})},message:{type:String,default:""},action:{type:Function,default:()=>{}}}},zs=(0,S.c)($s,[["render",qs]]),xs=zs;H()($s,"components",{QIcon:N.c});var Ds=i(73376),Es=i(7460),Ws=i.n(Es),Ss={class:"row justify-between items-center"},Ks={class:"text-subtitle1 row items-center"},Cs={class:"text-grey-9 text-weight-bold"},_s={class:"container-section-dialog q-pb-md"},Is={class:"scrollable-section-dialog"},Ms={class:"tw-text-[#555555] tw-text-sm text-weight-bold"},Ts=["innerHTML"],Ns={class:"text-caption text-grey-6"};function Ls(e,t,i,o,n,l){var r=(0,a.E1)("q-icon"),c=(0,a.E1)("q-card-section"),d=(0,a.E1)("q-item-section"),m=(0,a.E1)("q-item-label"),u=(0,a.E1)("q-tooltip"),h=(0,a.E1)("q-item"),p=(0,a.E1)("q-img"),f=(0,a.E1)("q-btn"),g=(0,a.E1)("q-card-actions"),b=(0,a.E1)("q-card"),w=(0,a.E1)("q-dialog");return(0,a.Wz)(),(0,a.Az)(w,{modelValue:e.dialog,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.dialog=t})},{default:(0,a.Ql)((function(){return[(0,a.K2)(b,{style:{width:"100%","max-width":"700px","max-height":"90vh","border-radius":"15px"}},{default:(0,a.Ql)((function(){return[(0,a.K2)(c,{class:"tw-p-6"},{default:(0,a.Ql)((function(){return[(0,a.QD)("div",Ss,[(0,a.QD)("div",Ks,[(0,a.K2)(r,{name:"fa-solid fa-bell",color:"grey-9",size:"22px",class:"q-mr-sm"}),(0,a.QD)("label",Cs,(0,s.WA)(e.$tr("isite.cms.label.notification",{capitalize:!0})),1)]),(0,a.K2)(r,{name:"fa-light fa-times",color:"grey-7",size:"20px",class:"cursor-pointer",onClick:t[0]||(t[0]=function(t){return e.closeModal()})})])]})),_:1}),(0,a.QD)("div",_s,[(0,a.QD)("div",Is,[(0,a.K2)(c,{class:"tw-p-6 tw-pt-0"},{default:(0,a.Ql)((function(){return[(0,a.K2)(h,{class:"no-margin no-padding"},{default:(0,a.Ql)((function(){return[(0,a.K2)(d,{avatar:"",top:""},{default:(0,a.Ql)((function(){return[(0,a.QD)("div",{class:"flex flex-center tw-w-[70px] tw-h-[70px] tw-rounded-lg notification-notification-icon-big",style:(0,s.MN)({backgroundColor:e.sourceData.backgroundColor})},[(0,a.K2)(r,{name:e.sourceData.icon,style:(0,s.MN)({color:e.sourceData.color,fontSize:"48px"})},null,8,["name","style"])],4)]})),_:1}),(0,a.K2)(d,{top:""},{default:(0,a.Ql)((function(){return[(0,a.K2)(m,null,{default:(0,a.Ql)((function(){return[(0,a.QD)("span",Ms,(0,s.WA)(e.notification.title),1)]})),_:1}),(0,a.K2)(m,null,{default:(0,a.Ql)((function(){return[(0,a.QD)("div",{class:"tw-text-[#555555] tw-text-sm",innerHTML:e.notification.message},null,8,Ts)]})),_:1}),(0,a.K2)(m,{lines:"1"},{default:(0,a.Ql)((function(){return[(0,a.QD)("span",Ns,[(0,a.mY)((0,s.WA)(e.notification.timeAgo)+" ",1),(0,a.K2)(u,{anchor:"bottom end",self:"center right"},{default:(0,a.Ql)((function(){return[(0,a.mY)((0,s.WA)(e.notification.createdAt),1)]})),_:1})])]})),_:1})]})),_:1})]})),_:1})]})),_:1}),e.imageUrl?((0,a.Wz)(),(0,a.Az)(c,{key:0,class:"tw-p-6 tw-py-0"},{default:(0,a.Ql)((function(){return[(0,a.K2)(p,{class:"tw-rounded-2xl",src:e.imageUrl,ratio:16/9},null,8,["src"])]})),_:1})):(0,a.g1)("",!0)])]),e.notification.link?((0,a.Wz)(),(0,a.Az)(g,{key:0,align:"right",class:"q-px-md q-pb-md"},{default:(0,a.Ql)((function(){return[(0,a.K2)(f,{label:e.$tr("notification.cms.cancel"),rounded:"","no-caps":"",unelevated:"",color:"grey-3","text-color":"grey-8",onClick:t[1]||(t[1]=function(t){return e.closeModal()}),class:"q-px-md tw-w-[90px]"},null,8,["label"]),(0,a.K2)(f,{rounded:"","no-caps":"",unelevated:"",color:"green-5",onClick:t[2]||(t[2]=function(t){return e.goToLink()}),class:"q-px-md tw-w-[124px]"},{default:(0,a.Ql)((function(){return[(0,a.QD)("span",null,(0,s.WA)(e.linkLabel),1),(0,a.K2)(r,{name:"fa-light fa-arrow-up-right-from-square",color:"white",size:"14px",class:"cursor-pointer q-ml-sm"})]})),_:1})]})),_:1})):(0,a.g1)("",!0)]})),_:1})]})),_:1},8,["modelValue"])}var Bs=i(75836),Ps=function(){return Ps=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var s in t=arguments[i],t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},Ps.apply(this,arguments)};function Rs(e,t){var i=(0,Bs.cB)({dialog:!1,notification:null}),s={imageUrl:(0,a.S6)((function(){var e,t,a;return!!(null===(a=null===(t=null===(e=i.notification)||void 0===e?void 0:e.mediaFiles)||void 0===t?void 0:t.mainimage)||void 0===a?void 0:a.id)&&i.notification.mediaFiles.mainimage.mediumThumb})),linkLabel:(0,a.S6)((function(){var e,t;return(null===(t=null===(e=i.notification)||void 0===e?void 0:e.options)||void 0===t?void 0:t.linkLabel)?i.notification.options.linkLabel:D._s.tr("notification.cms.openLink")})),sourceData:(0,a.S6)((function(){var e;return Ps({backgroundColor:"#D9D9D9",color:"#2196f3",icon:"fa-light fa-bell"},(null===(e=i.notification)||void 0===e?void 0:e.sourceData)||{})}))},o={init:function(){D.kN.on("imagina.notification.open",(function(e){i.notification=e,i.dialog=!0}))},goToLink:function(){D.i4.openExternalURL(i.notification.link,!0)},closeModal:function(){i.dialog=!1,t("update:modelValue",!1)}};return(0,a.u2)((function(){o.init()})),(0,a.GE)((function(){D.kN.off("imagina.notification.open")})),Ps(Ps(Ps({},(0,Bs.kx)(i)),s),o)}const Vs=(0,a._M)({props:{notification:{default:{}},sourceSettings:{default:[]}},components:{},setup:function(e,t){var i=t.emit;return Rs(e,i)}});var Us=i(66480);const Hs=(0,S.c)(Vs,[["render",Ls]]),Os=Hs;H()(Vs,"components",{QDialog:ut.c,QCard:ht.c,QCardSection:oa.c,QIcon:N.c,QItem:M.c,QItemSection:T.c,QItemLabel:Si.c,QTooltip:L.c,QImg:Ti.c,QCardActions:Us.c,QBtn:K.c});var Ys=i(18528)["c"];const Fs={name:"MasterLayout",mixins:[d.c],components:{cropperComponent:rs.c,activitiesActions:bs,headerAdminTheme1:ee,headerAdminTheme2:le,drawersAdminTheme1:Li,drawersAdminTheme2:Fi,footerAdminTheme1:la,footerAdminTheme2:wa,headerPanel:xa,drawersPanel:Ja,footerPanel:ls,Alert:As,bannerAlert:xs,notificationDialog:Os},watch:{shouldChangePassword(e){e&&e.shouldChangePassword&&e.messages.forEach((e=>{this.$alert[e.type||"info"](e)}))}},mounted(){this.$nextTick((async function(){this.init()}))},data(){return{appConfig:Ys("app"),homePage:"isite_cms_main_home",modalForce:{shouldChangePassword:!1},bannerType:{offline:{icon:{name:"fa-regular fa-wifi-slash"},message:this.$tr("isite.cms.message.appOffline"),classWrapper:"tw-text-white tw-bg-gray-900",action:()=>D.kN.emit("toggleMasterDrawer","offline")},notification:{marquee:!0,message:this.$store.getters["qsiteApp/getSettingValueByName"]("isite::globalWarningMessage"),classWrapper:"tw-bg-yellow-400 tw-text-black tw-font-semibold"}}}},computed:{isAppOffline(){return this.$store.state.qofflineMaster.isAppOffline},appState(){return this.$store.state.qsiteApp},iadminTheme(){return this.$getSetting("isite::iadminTheme")||1},components(){if("iadmin"==this.appConfig.mode){const e={theme1:{header:ee,drawer:Li,footer:la},theme2:{header:le,drawer:Fi,footer:wa}};return e[`theme${this.iadminTheme}`]}return{header:xa,drawer:Ja,footer:ls}},pagesConfig(){return this.$store.state.qsiteApp.pages},breadcrumbs(){let e=[],t=(this.$route.meta?.subHeader?.breadcrumb||[]).reverse();const i=Ds.c.mainapp.home,a=-1==this.$route.name.indexOf("app.home")?[i,this.$route.meta]:[i];return t.forEach((e=>{a.splice(1,0,Ws().get(Ds.c,e))})),a.forEach((t=>{if(!t)return;const i=t.options?t.options.activated:t.activated;t&&i&&this.$hasAccess(t.permission)&&e.push({label:this.$tr(t.title),icon:t.icon,to:t.name})})),e},shouldChangePassword(){return this.$store.state.quserAuth.shouldChangePassword},globalActivities(){return{helpCenter:{systemName:"help_center",view:"button",vIf:this.$q.platform.is.desktop,btnProps:{color:"info",flat:!0}},adminPopup:{systemName:"admin_popup",view:"popup"}}},isWarning(){return this.$store.getters["qsiteApp/getSettingValueByName"]("isite::globalWarningMessage")}},methods:{init(){this.idlTime()},idlTime(){const e=parseInt(this.$getSetting("iprofile::logoutIdlTime")||0);if(e){var t;const i=()=>{clearTimeout(t),this.$store.state.quserAuth.authenticated&&(t=setTimeout((async()=>{this.$store.dispatch("quserAuth/AUTH_LOGOUT"),this.$alert.warning({mode:"modal",title:this.$tr("iprofile.cms.message.logout"),message:this.$tr("iprofile.cms.message.logoutIdlTime"),actions:[{label:this.$tr("iprofile.cms.label.login"),handler:async()=>{clearTimeout(t),this.$router.push({name:"auth.login",query:this.$route.query})}}]})}),60*e*1e3))};i(),document.onmousemove=i,document.onkeydown=i}},configBanner(){return this.isAppOffline?this.bannerType.offline:this.isWarning?this.bannerType.notification:void 0}}};var js=i(93440);const Gs=(0,S.c)(Fs,[["render",c]]),Js=Gs;H()(Fs,"components",{QLayout:ja.c,QPageContainer:js.c,QBtn:K.c,QTooltip:L.c,QBreadcrumbs:qa.c,QBreadcrumbsEl:$a.c})}}]);