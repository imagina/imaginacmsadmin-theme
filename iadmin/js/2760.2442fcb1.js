"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[2760],{2760:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_n});var i=n(92444),o=n(264),a=n(74044);const l={class:"row"},r={class:"col-xs-12 col-sm-12 col-md-6 q-mb-sm"},s={class:"q-px-md"},c={class:"tw-w-full row q-my-md items-center justify-end"},u={class:"row justify-center q-mx-sm"},d={class:"cursor-pointer row items-center"},m={class:"text-blue-grey",style:{"line-height":"1"}},f={class:"text-caption",style:{"line-height":"1"}},p={style:{width:"240px"}};function g(e,t,g,v,h,b){const y=(0,i.E1)("q-tab"),w=(0,i.E1)("q-tabs"),k=(0,i.E1)("q-tooltip"),Q=(0,i.E1)("q-btn"),D=(0,i.E1)("q-icon"),x=(0,i.E1)("dynamic-field"),C=(0,i.E1)("q-popup-edit"),P=(0,i.E1)("dynamicList"),M=(0,i.E1)("taskComponent"),A=(0,i.E1)("master-modal"),q=(0,i.E1)("crud"),$=(0,i.E1)("timeLogsComponent"),W=(0,i.E1)("inner-loading");return(0,i.Wz)(),(0,i.An)("div",null,[(0,i.QD)("div",l,[(0,i.wt)((0,i.QD)("div",r,[(0,i.K2)(w,{modelValue:h.tabModel,"onUpdate:modelValue":t[0]||(t[0]=e=>h.tabModel=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left","no-caps":"","narrow-indicator":"",style:{"align-items":"center"}},{default:(0,i.Ql)((()=>[((0,i.Wz)(!0),(0,i.An)(i.ae,null,(0,i.mi)(h.tabs,((e,t)=>((0,i.Wz)(),(0,i.Az)(y,{key:t,name:e.value,label:e.label},null,8,["name","label"])))),128))])),_:1},8,["modelValue"])],512),[[o.Ub,!1]])]),(0,i.QD)("div",s,[h.tabModel==h.tabs[0].value?((0,i.Wz)(),(0,i.Az)(P,{key:0,ref:"dynamicList",listConfig:h.listConfig,onNew:t[6]||(t[6]=()=>e.$refs.crudComponent.create())},{"top-table":(0,i.Ql)((()=>[(0,i.QD)("div",c,[(0,i.K2)(Q,{"text-color":"primary",style:{border:"1px solid rgba(0, 13, 71, 0.15)"},class:"q-mr-sm btn-small",icon:"fa-regular fa-chevron-left",dense:"",rounded:"",unelevated:"",onClick:t[1]||(t[1]=e=>b.goToPrevious()),padding:"8px"},{default:(0,i.Ql)((()=>[(0,i.K2)(k,{anchor:"bottom middle",self:"top middle"},{default:(0,i.Ql)((()=>[(0,i.mY)((0,a.WA)(e.$tr("itask.cms.previousWeek")),1)])),_:1})])),_:1}),(0,i.QD)("div",u,[(0,i.QD)("div",d,[(0,i.K2)(D,{name:"fal fa-calendar-range",color:"amber",class:"q-mr-sm",size:"23px"}),(0,i.QD)("div",m,[(0,i.QD)("div",f,(0,a.WA)(e.$tr("isite.cms.label.date")),1),(0,i.mY)(" "+(0,a.WA)(b.dynamicListTitle),1)])]),(0,i.K2)(k,null,{default:(0,i.Ql)((()=>[(0,i.mY)((0,a.WA)(e.$tr("isite.cms.label.edit")),1)])),_:1}),(0,i.K2)(C,{ref:"titleModal",modelValue:h.dateRangeFilter.value,"onUpdate:modelValue":t[4]||(t[4]=e=>h.dateRangeFilter.value=e),"transition-show":"fade-in","transition-hide":"fade-out",cover:!1,anchor:"bottom start"},{default:(0,i.Ql)((()=>[(0,i.QD)("div",p,[(0,i.K2)(x,{modelValue:h.dateRangeFilter.value,"onUpdate:modelValue":[t[2]||(t[2]=e=>h.dateRangeFilter.value=e),t[3]||(t[3]=e=>b.setDateRange(e))],field:h.dateRangeFilter},null,8,["modelValue","field"])])])),_:1},8,["modelValue"])]),(0,i.K2)(Q,{"text-color":"primary",style:{border:"1px solid rgba(0, 13, 71, 0.15)"},class:"q-ml-sm btn-small",icon:"fa-regular fa-chevron-right",dense:"",rounded:"",unelevated:"",onClick:t[5]||(t[5]=e=>b.goToPrevious()),padding:"8px"},{default:(0,i.Ql)((()=>[(0,i.K2)(k,{anchor:"bottom middle",self:"top middle"},{default:(0,i.Ql)((()=>[(0,i.mY)((0,a.WA)(e.$tr("itask.cms.nextWeek")),1)])),_:1})])),_:1})])])),_:1},8,["listConfig"])):(0,i.g1)("",!0)]),(0,i.K2)(A,{modelValue:h.selectedRow.showModal,"onUpdate:modelValue":t[11]||(t[11]=e=>h.selectedRow.showModal=e),title:`Task : ${h.selectedRow.row?.id}`,"custom-position":"",onHide:t[12]||(t[12]=e=>h.selectedRow.showModal=!1)},{default:(0,i.Ql)((()=>[(0,i.K2)(M,{row:h.selectedRow.row,onOnClose:t[7]||(t[7]=e=>h.selectedRow.showModal=!1),onOnUpdate:t[8]||(t[8]=e=>b.onUpdate(e)),onOnDelete:t[9]||(t[9]=e=>b.onDelete(e)),onOpenTimeLogsModal:t[10]||(t[10]=e=>b.openTimeLogsModal(e))},null,8,["row"])])),_:1},8,["modelValue","title"]),(0,i.K2)(q,{ref:"crudComponent",type:null,"crud-data":n.e(5684).then(n.bind(n,95684)),onCreated:t[13]||(t[13]=e=>b.refreshDynamicList()),onUpdated:t[14]||(t[14]=e=>b.refreshDynamicList()),onDeleted:t[15]||(t[15]=e=>b.refreshDynamicList())},null,8,["crud-data"]),(0,i.K2)(A,{modelValue:h.selectedRow.timeLogsModal,"onUpdate:modelValue":t[18]||(t[18]=e=>h.selectedRow.timeLogsModal=e),title:e.$tr("itask.cms.timeLogs.title"),width:"460px",onHide:t[19]||(t[19]=e=>h.selectedRow.timeLogsModal=!1)},{default:(0,i.Ql)((()=>[(0,i.K2)($,{row:h.selectedRow.row,onCloseModal:t[16]||(t[16]=e=>h.selectedRow.timeLogsModal=!1),onReloadRow:t[17]||(t[17]=e=>b.reloadRow(e))},null,8,["row"])])),_:1},8,["modelValue","title"]),(0,i.K2)(W,{visible:h.loading},null,8,["visible"])])}var v={id:"componentDynamicList"},h={id:"backend-page"},b={class:"q-my-md"},y={key:2,class:(0,a.WN)("row text-primary text-weight-bold ellipsis title-content items-center")},w={key:0,id:"titleCrudTable"};function k(e,t,n,o,l,r){var s=(0,i.E1)("page-actions"),c=(0,i.E1)("dynamicFilter"),u=(0,i.E1)("dynamicTable");return(0,i.Wz)(),(0,i.An)("div",v,[(0,i.QD)("div",h,[(0,i.QD)("div",b,[e.loadPageActions?((0,i.Wz)(),(0,i.Az)(s,{key:0,"extra-actions":e.extraActions,excludeActions:e.excludeActions,title:e.title,help:e.help,"expires-in":e.expiresIn,dynamicFilter:e.dynamicFilter,dynamicFilterValues:e.dynamicFilterValues,dynamicFilterSummary:e.dynamicFilterSummary,onToggleDynamicFilterModal:e.toggleDynamicFilterModal,onNew:t[0]||(t[0]=function(t){return e.$emit("new")}),onSearch:t[1]||(t[1]=function(t){return e.search(t)}),onRefresh:t[2]||(t[2]=function(t){return e.getData({pagination:{page:1}},!0)})},null,8,["extra-actions","excludeActions","title","help","expires-in","dynamicFilter","dynamicFilterValues","dynamicFilterSummary","onToggleDynamicFilterModal"])):(0,i.g1)("",!0),e.dynamicFilter?((0,i.Wz)(),(0,i.Az)(c,{key:1,systemName:e.systemName,modelValue:e.showDynamicFilterModal,filters:e.dynamicFilter,onShowModal:t[3]||(t[3]=function(t){return e.showDynamicFilterModal=!0}),onHideModal:t[4]||(t[4]=function(t){return e.showDynamicFilterModal=!1}),"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.updateDynamicFilterValues(t)}),"onUpdate:summary":t[6]||(t[6]=function(t){return e.dynamicFilterSummary=t})},null,8,["systemName","modelValue","filters"])):(0,i.g1)("",!0),e.loadPageActions?(0,i.g1)("",!0):((0,i.Wz)(),(0,i.An)("div",y,[e.title?((0,i.Wz)(),(0,i.An)("label",w,(0,a.WA)(e.title),1)):(0,i.g1)("",!0)])),(0,i.oF)(e.$slots,"top-table"),(0,i.K2)(u,{class:(0,a.WN)({"q-mt-md q-pt-md":!e.hasTopTableSlot}),tableProps:e.tableProps,columns:e.columns,rows:e.rows,actions:e.actions,pagination:e.pagination,loading:e.loading,beforeUpdate:e.beforeUpdate,onOnPagination:t[7]||(t[7]=function(t){return e.setPagination(t)}),onUpdateRow:t[8]||(t[8]=function(t){return e.updateRow(t)})},null,8,["class","tableProps","columns","rows","actions","pagination","loading","beforeUpdate"])])])])}var Q=n(75836),D=n(20584);const x={getData:function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n={}),new Promise((function(i,o){var a={refresh:t,params:n};D.c.index(e,a).then((function(e){i(e)})).catch((function(e){return o(e)}))}))},updateItem:function(e,t,n,i){return void 0===i&&(i={params:{}}),new Promise((function(o,a){D.c.update(e,t,n,i).then((function(e){o(e)})).catch((function(e){return a(e)}))}))},showItem:function(e,t,n){return void 0===n&&(n={}),new Promise((function(i,o){D.c.show(e,t,n).then((function(e){i(e)})).catch((function(e){return o(e)}))}))}};var C=n(8932),P=function(){return P=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},P.apply(this,arguments)},M=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function l(e){try{s(i.next(e))}catch(t){a(t)}}function r(e){try{s(i["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):o(e.value).then(l,r)}s((i=i.apply(e,t||[])).next())}))},A=function(e,t){var n,i,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");while(a&&(a=0,r[0]&&(l=0)),l)try{if(n=1,i&&(o=2&r[0]?i["return"]:r[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,i=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){l.label=r[1];break}if(6===r[0]&&l.label<o[1]){l.label=o[1],o=r;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(r);break}o[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};function q(e,t){(0,i._S)().appContext.config.globalProperties;var n={},o=(0,i.Q9)(),a=(0,Q.cB)({loading:!1,columns:[],rows:[],requestParams:{},showModal:!1,expiresIn:null,showDynamicFilterModal:!1,dynamicFilterValues:{},dynamicFilterSummary:{},pagination:{page:1,rowsNumber:"",rowsPerPage:10,descending:!0,maxPages:6}}),l={hasTopTableSlot:(0,i.S6)((function(){return!!o["top-table"]})),hasPermission:(0,i.S6)((function(){var t,n,i,o,a,l,r,s;return{create:!(null===(t=e.listConfig)||void 0===t?void 0:t.permission)||C.is.hasAccess("".concat(null===(n=e.listConfig)||void 0===n?void 0:n.permission,".create")),index:!(null===(i=e.listConfig)||void 0===i?void 0:i.permission)||C.is.hasAccess("".concat(null===(o=e.listConfig)||void 0===o?void 0:o.permission,".index")),edit:!(null===(a=e.listConfig)||void 0===a?void 0:a.permission)||C.is.hasAccess("".concat(null===(l=e.listConfig)||void 0===l?void 0:l.permission,".edit")),destroy:!(null===(r=e.listConfig)||void 0===r?void 0:r.permission)||C.is.hasAccess("".concat(null===(s=e.listConfig)||void 0===s?void 0:s.permission,".destroy"))}})),beforeUpdate:(0,i.S6)((function(){var t;return(null===(t=e.listConfig)||void 0===t?void 0:t.beforeUpdate)||null})),title:(0,i.S6)((function(){var t,n;return(null===(n=null===(t=null===e||void 0===e?void 0:e.listConfig)||void 0===t?void 0:t.read)||void 0===n?void 0:n.title)||""})),help:(0,i.S6)((function(){var t,n;return(null===(n=null===(t=null===e||void 0===e?void 0:e.listConfig)||void 0===t?void 0:t.read)||void 0===n?void 0:n.help)||{}})),actions:(0,i.S6)((function(){var t;return(null===(t=null===e||void 0===e?void 0:e.listConfig)||void 0===t?void 0:t.actions)||!1})),tableProps:(0,i.S6)((function(){var t,n;return(null===(n=null===(t=null===e||void 0===e?void 0:e.listConfig)||void 0===t?void 0:t.read)||void 0===n?void 0:n.tableProps)||null})),extraActions:(0,i.S6)((function(){var t,n,i,o=[];return(null===(i=null===(n=null===(t=e.listConfig)||void 0===t?void 0:t.pageActions)||void 0===n?void 0:n.extraActions)||void 0===i?void 0:i.length)>0&&o.push.apply(o,e.listConfig.pageActions.extraActions),o.includes("new")&&!l.hasPermission.value["create"]&&o.splice(o.indexOf("new"),1),o.filter((function(e){return!e.vIfAction}))})),excludeActions:(0,i.S6)((function(){var t,n;return(null===(n=null===(t=e.listConfig)||void 0===t?void 0:t.pageActions)||void 0===n?void 0:n.excludeActions)||[]})),dynamicFilter:(0,i.S6)((function(){var t,n,i;return(null===(t=e.listConfig.read)||void 0===t?void 0:t.filters)&&Object.keys(null===(n=e.listConfig.read)||void 0===n?void 0:n.filters).length>0?null===(i=e.listConfig.read)||void 0===i?void 0:i.filters:{}})),systemName:(0,i.S6)((function(){var t,n,i;return(null===(t=e.listConfig.read)||void 0===t?void 0:t.systemName)||(null===(n=e.listConfig)||void 0===n?void 0:n.permission)||(null===(i=e.listConfig)||void 0===i?void 0:i.entityName)}))},r={init:function(){return M(this,void 0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,r.setColumns()];case 1:return e.sent(),a.dynamicFilterValues||r.getData({pagination:{page:1}},!0),[2]}}))}))},search:function(t){t?a.requestParams.filter={search:t}:a.requestParams=P({},e.listConfig.read.requestParams),a.requestParams["filter"]=P(P({},a.requestParams["filter"]),a.dynamicFilterValues),a.pagination.page=1,a.pagination.take=10,r.getData()},setColumns:function(){a.columns=e.listConfig.read.columns,a.columns.forEach((function(e){e.align=(null===e||void 0===e?void 0:e.align)||"center",e["isEditable"]=l.hasPermission.value["edit"]&&e.hasOwnProperty("dynamicField")}))},setPagination:function(e){e.rowsPerPage!=a.pagination.rowsPerPage&&(e.page=1),a.pagination=e,r.getData()},getData:function(n,i){var o,l,r,s,c;return void 0===n&&(n=!1),void 0===i&&(i=!1),M(this,void 0,void 0,(function(){return A(this,(function(u){return a.loading=!0,a.requestParams=P(P({order:{field:(null===(o=a.pagination)||void 0===o?void 0:o.sortBy)||"id",way:void 0!=a.pagination.descending?a.pagination.descending?"desc":"asc":"desc"}},null!==(l=e.listConfig.read.requestParams)&&void 0!==l?l:{}),{filter:P(P(P({},(null===(r=a.requestParams)||void 0===r?void 0:r.filter)||{}),(null===(c=null===(s=e.listConfig.read)||void 0===s?void 0:s.requestParams)||void 0===c?void 0:c.filter)||{}),a.dynamicFilterValues),page:(null===n||void 0===n?void 0:n.page)||a.pagination.page,take:a.pagination.rowsPerPage}),x.getData(e.listConfig.apiRoute,i,a.requestParams).then((function(e){a.expiresIn=null===e||void 0===e?void 0:e.expiresIn,(null===e||void 0===e?void 0:e.data)&&(a.rows=e.data,a.loading=!1,a.pagination.page=(0,C.ct)(null===e||void 0===e?void 0:e.meta.page.currentPage),a.pagination.rowsNumber=(0,C.ct)(null===e||void 0===e?void 0:e.meta.page.total),a.pagination.rowsPerPage=(0,C.ct)(a.pagination.rowsPerPage),a.pagination.descending=(0,C.ct)(a.pagination.descending),t("dataLoaded",e.data))})).catch((function(e){a.loading=!1,C.Qb.error({message:C._s.tr("isite.cms.message.errorRequest"),pos:"bottom"})})),[2]}))}))},updateRow:function(n){var i=a.rows.findIndex((function(e){return e.id==n.id}));a.rows[i]["isLoading"]=!0,x.updateItem(e.listConfig.apiRoute,n.id,n).then((function(o){var l;if(null===o||void 0===o?void 0:o.data){var r=(null===(l=e.listConfig.read)||void 0===l?void 0:l.requestParams)?P({},e.listConfig.read.requestParams):{};x.showItem(e.listConfig.apiRoute,n.id,{params:r,refresh:!0}).then((function(e){a.rows[i]=e.data,a.rows[i]["isLoading"]=!1,t("updatedRow",e.data)}))}}))},reloadRow:function(t){var n;return M(this,void 0,void 0,(function(){var i,o;return A(this,(function(l){switch(l.label){case 0:return i=a.rows.findIndex((function(e){return e.id==t.id})),a.rows[i]["isLoading"]=!0,o=(null===(n=e.listConfig.read)||void 0===n?void 0:n.requestParams)?P({},e.listConfig.read.requestParams):{},[4,x.showItem(e.listConfig.apiRoute,t.id,{params:o,refresh:!0}).then((function(e){a.rows[i]=e.data,a.rows[i]["isLoading"]=!1}))];case 1:return l.sent(),[2,a.rows[i]]}}))}))},toggleDynamicFilterModal:function(){a.showDynamicFilterModal=!a.showDynamicFilterModal},updateFilter:function(e,t){a.dynamicFilterValues[e]=t},updateDynamicFilterValues:function(e){a.dynamicFilterValues=e,a.requestParams.filter=a.dynamicFilterValues,a.pagination.page=1,r.getData()}};return(0,i.u2)((function(){r.init()})),P(P(P(P({},n),(0,Q.kx)(a)),l),r)}var $={id:"dynamic-table"},W={key:1};function T(e,t,n,o,l,r){var s=(0,i.E1)("q-inner-loading"),c=(0,i.E1)("contextMenu"),u=(0,i.E1)("editablePopup"),d=(0,i.E1)("btn-menu"),m=(0,i.E1)("contentType"),f=(0,i.E1)("q-td"),p=(0,i.E1)("q-tr"),g=(0,i.E1)("master-pagination"),v=(0,i.E1)("q-table");return(0,i.Wz)(),(0,i.An)("div",$,[(0,i.K2)(v,(0,i.Gu)(e.tableProps,{title:e.title,loading:e.loading,rows:e.rows,columns:e.columns,"row-key":"name",pagination:e.paginationModel,"onUpdate:pagination":t[3]||(t[3]=function(t){return e.paginationModel=t}),"hide-pagination":""}),{loading:(0,i.Ql)((function(){return[(0,i.K2)(s,{showing:"",color:"primary"})]})),body:(0,i.Ql)((function(n){return[(0,i.K2)(p,{props:n},{default:(0,i.Ql)((function(){return[(0,i.K2)(c,{"v-if":e.actions,actions:e.actions,"action-data":n.row},null,8,["v-if","actions","action-data"]),((0,i.Wz)(!0),(0,i.An)(i.ae,null,(0,i.mi)(n.cols,(function(o){return(0,i.Wz)(),(0,i.Az)(f,{key:o.name,props:n,class:(0,a.WN)(e.getCellClass(o,n.row)),onClick:function(t){return e.onClick(o,n.row)}},{default:(0,i.Ql)((function(){return[!e.isColActions(o)&&e.isColEditable(o,n.row)?((0,i.Wz)(),(0,i.Az)(u,{key:0,row:n.row,col:o,beforeUpdate:e.beforeUpdate,onUpdateRow:t[0]||(t[0]=function(t){return e.$emit("updateRow",t)})},null,8,["row","col","beforeUpdate"])):(0,i.g1)("",!0),e.isColActions(o)?((0,i.Wz)(),(0,i.An)("div",W,[(0,i.K2)(d,{actions:e.actions,"action-data":n.row},null,8,["actions","action-data"])])):(0,i.g1)("",!0),e.isColActions(o)?(0,i.g1)("",!0):((0,i.Wz)(),(0,i.Az)(m,{key:2,col:o,row:n.row,val:o.value},null,8,["col","row","val"]))]})),_:2},1032,["props","class","onClick"])})),128))]})),_:2},1032,["props"])]})),bottom:(0,i.Ql)((function(n){return[(0,i.K2)(g,{modelValue:e.paginationModel,"onUpdate:modelValue":[t[1]||(t[1]=function(t){return e.paginationModel=t}),t[2]||(t[2]=function(t){return e.$emit("onPagination",t)})],pagesNumber:n.pagesNumber,isFirstPage:n.isFirstPage,isLastPage:n.isLastPage},null,8,["modelValue","pagesNumber","isFirstPage","isLastPage"])]})),_:1},16,["title","loading","rows","columns","pagination"])])}var R=function(){return R=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},R.apply(this,arguments)};function E(e,t){(0,i._S)().appContext.config.globalProperties;var n={},o=(0,Q.cB)({paginationModel:{page:1,rowsNumber:null,rowsPerPage:10,descending:!0,maxPages:6}}),a={},l={init:function(){o.paginationModel=e.pagination},isColActions:function(e){return"actions"==e.name},isColEditable:function(e,t){return(null===e||void 0===e?void 0:e.dynamicField)&&!(null===t||void 0===t?void 0:t.isLoading)},onClick:function(e,t){(null===e||void 0===e?void 0:e.onClick)&&e.onClick(e.value,t)},getCellClass:function(e,t){return!(null===e||void 0===e?void 0:e.dynamicField)&&!(null===e||void 0===e?void 0:e.onClick)||(null===t||void 0===t?void 0:t.isLoading)?"":"cursor-pointer"}};return(0,i.u2)((function(){l.init()})),(0,i.Kg)(e,(function(e,t){o.paginationModel=e.pagination}),{deep:!0}),R(R(R(R({},n),(0,Q.kx)(o)),a),l)}var L={class:"text-blue-grey"},F={class:"q-py-sm"},S={class:"justify-end row q-gutter-sm"};function z(e,t,n,l,r,s){var c=(0,i.E1)("q-separator"),u=(0,i.E1)("dynamic-field"),d=(0,i.E1)("q-btn"),m=(0,i.E1)("q-form"),f=(0,i.E1)("q-popup-edit");return e.dynamicField?((0,i.Wz)(),(0,i.Az)(f,{key:0,ref:"popupEditRef",modelValue:e.row[e.col.name],"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.row[e.col.name]=t}),"no-caps":"",cover:!1,anchor:"bottom start","transition-show":"fade-in","transition-hide":"fade-out","max-width":e.maxWidth},{default:(0,i.Ql)((function(n){return[(0,i.K2)(m,{autocorrect:"off",autocomplete:"off",ref:"formContent",onSubmit:function(t){return e.runBeforeUpdate(n)},onValidationError:t[1]||(t[1]=function(t){return e.$alert.error(e.$tr("isite.cms.message.formInvalid"))})},{default:(0,i.Ql)((function(){return[(0,i.QD)("b",L,(0,a.WA)(e.$tr("isite.cms.label.edit"))+": ID "+(0,a.WA)(e.row.id)+" | "+(0,a.WA)(e.col.label),1),(0,i.K2)(c,{class:"q-mt-sm"}),(0,i.QD)("div",F,[e.isSelectField?((0,i.Wz)(),(0,i.Az)(u,{key:0,modelValue:n.value.id,"onUpdate:modelValue":function(e){return n.value.id=e},field:e.dynamicField},null,8,["modelValue","onUpdate:modelValue","field"])):((0,i.Wz)(),(0,i.Az)(u,{key:1,modelValue:n.value,"onUpdate:modelValue":function(e){return n.value=e},field:e.dynamicField},null,8,["modelValue","onUpdate:modelValue","field"])),(0,i.QD)("div",S,[(0,i.K2)(d,{label:e.$tr("isite.cms.label.cancel"),"no-caps":"",color:"grey",unelevated:"",rounded:"",onClick:(0,o.Y7)(n.cancel,["stop","prevent"])},null,8,["label","onClick"]),(0,i.K2)(d,{label:e.$tr("isite.cms.label.save"),color:"green","no-caps":"",unelevated:"",rounded:"",onClick:t[0]||(t[0]=function(t){return e.$refs.formContent.submit()}),disable:!1===n.validate(n.value)||n.initialValue===n.value},null,8,["label","disable"])])])]})),_:2},1032,["onSubmit"])]})),_:1},8,["modelValue","max-width"])):(0,i.g1)("",!0)}var V=function(){return V=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},V.apply(this,arguments)},_=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function l(e){try{s(i.next(e))}catch(t){a(t)}}function r(e){try{s(i["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):o(e.value).then(l,r)}s((i=i.apply(e,t||[])).next())}))},K=function(e,t){var n,i,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");while(a&&(a=0,r[0]&&(l=0)),l)try{if(n=1,i&&(o=2&r[0]?i["return"]:r[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,i=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){l.label=r[1];break}if(6===r[0]&&l.label<o[1]){l.label=o[1],o=r;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(r);break}o[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};function I(e,t){var n={},o=(0,Q.cB)({dynamicModel:null}),a={dynamicField:(0,i.S6)((function(){var t,n=null!==(t=e.col.dynamicField)&&void 0!==t?t:null;return n&&e.col.isEditable?("function"==typeof n&&(n=n(e.row)),V({name:e.col.name,maxWidth:"300px"},n)):null})),maxWidth:(0,i.S6)((function(){var e,t;return null!==(t=null===(e=a.dynamicField)||void 0===e?void 0:e.value.maxWidth)&&void 0!==t?t:""})),isSelectField:(0,i.S6)((function(){var e;return"select"==a.dynamicField.value.type&&!(null===(e=a.dynamicField.props)||void 0===e?void 0:e.multiple)}))},l={runBeforeUpdate:function(n){return _(this,void 0,void 0,(function(){var i,o,l;return K(this,(function(r){switch(r.label){case 0:return i=!0,o=a.isSelectField.value?n.value.id:n.value,l=V({},e.row),l[a.dynamicField.value.name]=o,e.beforeUpdate?[4,e.beforeUpdate({val:o,row:l}).then((function(e){e?(n.value=e,l[a.dynamicField.value.name]=e):n.set(),t("updateRow",l)})).catch((function(e){n.value=e||n.initialValue,i=!1}))]:[3,2];case 1:return r.sent(),[3,3];case 2:n.set(),t("updateRow",l),r.label=3;case 3:return[2,i]}}))}))}};return(0,i.u2)((function(){})),V(V(V(V({},n),(0,Q.kx)(o)),a),l)}const O=(0,i._M)({props:{row:{type:Object,default:null},col:{type:Object,default:null},beforeUpdate:{type:Function,required:!1,default:null}},setup:function(e,t){var n=t.emit;return I(e,n)},components:{}});var U=n(68716),N=n(86742),B=n(14288),j=n(70880),Y=n(99140),H=n(95252),G=n.n(H);const J=(0,U.c)(O,[["render",z]]),X=J;G()(O,"components",{QPopupEdit:N.c,QForm:B.c,QSeparator:j.c,QBtn:Y.c});var Z={key:1,class:"ellipsis tw-flex-1 tw-min-w-1"},ee=["innerHTML"],te=["innerHTML"],ne={key:0,class:"text-weight-bold"};function ie(e,t,n,l,r,s){var c=(0,i.E1)("q-tooltip"),u=(0,i.E1)("q-skeleton");return(0,i.Wz)(),(0,i.An)("div",{style:(0,a.MN)(e.style)},[e.component?(0,i.wt)(((0,i.Wz)(),(0,i.Az)((0,i.mk)(e.component),(0,i.Gu)({key:0},e.componentProps,(0,i.kB)(e.componentEvents||{})),null,16)),[[o.Ub,!e.isLoading]]):(0,i.g1)("",!0),e.isComponent?(0,i.g1)("",!0):(0,i.wt)(((0,i.Wz)(),(0,i.An)("div",Z,[(0,i.QD)("label",{innerHTML:e.val,class:(0,a.WN)({"content-type-onclick":e.isClickeable,"cursor-pointer":e.isEditable})},null,10,ee),(0,i.K2)(c,null,{default:(0,i.Ql)((function(){return[(0,i.QD)("div",{innerHTML:e.getTooltip()},null,8,te),e.isClickeable?((0,i.Wz)(),(0,i.An)("label",ne,(0,a.WA)(e.$tr("isite.cms.label.clickToAction")),1)):(0,i.g1)("",!0)]})),_:1})],512)),[[o.Ub,!e.isLoading]]),e.isLoading?((0,i.Wz)(),(0,i.Az)(u,{key:2,animated:"",type:"text"})):(0,i.g1)("",!0)],4)}const oe={colorCell:(0,i.Mn)((function(){return n.e(5876).then(n.bind(n,95876))})),date:(0,i.Mn)((function(){return n.e(7088).then(n.bind(n,67088))}))};var ae=function(){return ae=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ae.apply(this,arguments)};function le(e,t){var n={},o=(0,Q.cB)({component:(0,Q.kl)(),componentProps:null,componentEvents:null}),a={isClickeable:(0,i.S6)((function(){var t;return!!(null===(t=e.col)||void 0===t?void 0:t.onClick)})),isEditable:(0,i.S6)((function(){var t;return!!(null===(t=e.col)||void 0===t?void 0:t.dynamicField)})),isComponent:(0,i.S6)((function(){var t;return(null===(t=e.col)||void 0===t?void 0:t.contentType)||!1})),isLoading:(0,i.S6)((function(){var t;return(null===(t=e.row)||void 0===t?void 0:t.isLoading)||!1})),showOnLoading:(0,i.S6)((function(){var t,n;return a.isLoading.value&&("id"!=(null===(t=e.col)||void 0===t?void 0:t.name)||"id"!=(null===(n=e.col)||void 0===n?void 0:n.field))})),style:(0,i.S6)((function(){var t;return(null===(t=e.col)||void 0===t?void 0:t.style)||""}))},l={init:function(){l.loadComponent()},loadComponent:function(){if(a.isComponent.value){var t=e.col.contentType(e.row);(null===t||void 0===t?void 0:t.template)&&(o.component=l.getComponent(t.template),(null===t||void 0===t?void 0:t.props)&&(o.componentProps=t.props),(null===t||void 0===t?void 0:t.events)&&(o.componentEvents=t.events))}},getComponent:function(e){return"string"===typeof e?(0,Q.Md)(oe[e]):(0,Q.Md)(e)},getTooltip:function(){var t,n;return(null===(t=e.col)||void 0===t?void 0:t.tooltip)?null===(n=e.col)||void 0===n?void 0:n.tooltip:C.i4.deleteHtml(e.val)}};return(0,i.u2)((function(){l.init()})),(0,i.Kg)(e,(function(e,t){l.init()}),{deep:!0}),ae(ae(ae(ae({},n),(0,Q.kx)(o)),a),l)}const re=(0,i._M)({props:{col:{type:Object,default:function(){return{}}},row:{type:Object,default:function(){return{}}},val:{type:null,default:null}},setup:function(e,t){var n=t.emit;return le(e,n)}});var se=n(90111),ce=n(39692);const ue=(0,U.c)(re,[["render",ie]]),de=ue;G()(re,"components",{QTooltip:se.c,QSkeleton:ce.cp});var me={class:"row items-center text-blue-grey"};function fe(e,t,n,o,l,r){var s=(0,i.E1)("q-icon"),c=(0,i.E1)("q-item-section"),u=(0,i.E1)("q-item"),d=(0,i.E1)("q-list"),m=(0,i.E1)("q-menu"),f=(0,i.iS)("close-popup");return e.actions&&e.actions.length?((0,i.Wz)(),(0,i.Az)(m,{key:0,"touch-position":"","context-menu":"","max-width":"200px",class:"btn-menu-component__menu",anchor:"bottom right",self:"top right"},{default:(0,i.Ql)((function(){return[(0,i.K2)(d,{dense:"",separator:""},{default:(0,i.Ql)((function(){return[((0,i.Wz)(!0),(0,i.An)(i.ae,null,(0,i.mi)(e.actions,(function(t,n){return(0,i.wt)(((0,i.Wz)(),(0,i.Az)(u,(0,i.Gu)(t.props,{onClick:function(n){return e.runAction(t)}}),{default:(0,i.Ql)((function(){return[(0,i.K2)(c,null,{default:(0,i.Ql)((function(){return[(0,i.QD)("div",me,[(0,i.K2)(s,{name:t.icon,color:"blue-grey",size:"16px"},null,8,["name"]),(0,i.mY)("   "+(0,a.WA)(t.label||t.tooltip),1)])]})),_:2},1024)]})),_:2},1040,["onClick"])),[[f]])})),256))]})),_:1})]})),_:1})):(0,i.g1)("",!0)}var pe=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function l(e){try{s(i.next(e))}catch(t){a(t)}}function r(e){try{s(i["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):o(e.value).then(l,r)}s((i=i.apply(e,t||[])).next())}))},ge=function(e,t){var n,i,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");while(a&&(a=0,r[0]&&(l=0)),l)try{if(n=1,i&&(o=2&r[0]?i["return"]:r[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,i=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){l.label=r[1];break}if(6===r[0]&&l.label<o[1]){l.label=o[1],o=r;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(r);break}o[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};const ve=(0,i._M)({props:{actions:{default:[]},actionData:{default:[]}},methods:{runAction:function(e){return pe(this,void 0,void 0,(function(){var t;return ge(this,(function(n){switch(n.label){case 0:return t=this.$clone(this.actionData||{}),e.action?[4,e.action(t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))}}});var he=n(93832),be=n(99588),ye=n(84884),we=n(11032),ke=n(58120),Qe=n(81020);const De=(0,U.c)(ve,[["render",fe]]),xe=De;G()(ve,"components",{QMenu:he.c,QList:be.c,QItem:ye.c,QItemSection:we.c,QIcon:ke.c}),G()(ve,"directives",{ClosePopup:Qe.c});var Ce={class:"col-12 q-ml-sm q-mr-lg flex flex-center"},Pe={class:"flex items-center"},Me={class:"flex items-center tw-mr-4 text-blue-grey"},Ae={class:"sm:tw-text-sm"},qe={class:"sm:tw-text-sm"},$e={class:"actionsBtnPag"},We=(0,i.QD)("i",{class:"fa-solid fa-chevron-left"},null,-1),Te=(0,i.QD)("i",{class:"fa-solid fa-chevron-right"},null,-1);function Re(e,t,n,o,l,r){var s=(0,i.E1)("q-pagination"),c=(0,i.E1)("q-select"),u=(0,i.E1)("q-btn");return(0,i.Wz)(),(0,i.An)("div",{class:(0,a.WN)("bottonCrud full-width flex items-center ".concat(e.isMobile?"justify-center":"justify-between"))},[(0,i.QD)("div",{class:(0,a.WN)(["sm:tw-text-sm","text-blue-grey ".concat(e.isMobile?"q-mb-sm":""," ")])},[(0,i.mY)((0,a.WA)(e.$tr("isite.cms.label.showing"))+" ",1),(0,i.QD)("b",null,(0,a.WA)(e.countPage()),1),(0,i.mY)(" "+(0,a.WA)(e.$trp("isite.cms.label.entry")),1)],2),(0,i.QD)("div",Ce,[e.showPagination()?((0,i.Wz)(),(0,i.Az)(s,{key:0,id:"crudPaginationComponent",modelValue:e.paginationModel.page,"onUpdate:modelValue":[t[0]||(t[0]=function(t){return e.paginationModel.page=t}),t[1]||(t[1]=function(t){return e.emit()})],round:"","input-class":"no-shadow",color:"while","text-color":"primary","active-color":"primary","active-text-color":"white",max:e.pagesNumber,"max-pages":e.paginationModel.maxPages,ellipses:!1,"boundary-numbers":!1,unelevated:""},null,8,["modelValue","max","max-pages"])):(0,i.g1)("",!0)]),(0,i.QD)("div",Pe,[(0,i.QD)("div",Me,[(0,i.QD)("span",Ae,(0,a.WA)(e.$tr("isite.cms.label.show")),1),(0,i.K2)(c,{modelValue:e.paginationModel.rowsPerPage,"onUpdate:modelValue":[t[2]||(t[2]=function(t){return e.paginationModel.rowsPerPage=t}),t[3]||(t[3]=function(t){return e.resetPage()})],options:e.rowsPerPageOption,"options-cover":"",dense:"",class:"q-mx-sm text-caption",outlined:""},null,8,["modelValue","options"]),(0,i.QD)("span",qe,(0,a.WA)(e.$trp("isite.cms.label.entry")),1)]),(0,i.QD)("div",$e,[(0,i.K2)(u,{color:"primary",class:"tw-mr-2",dense:"",size:"14px",round:"",flat:"",disable:e.isFirstPage,onClick:t[4]||(t[4]=function(t){return e.prevPage()})},{default:(0,i.Ql)((function(){return[We]})),_:1},8,["disable"]),(0,i.K2)(u,{color:"primary",dense:"",size:"14px",round:"",flat:"",disable:e.isLastPage,onClick:t[5]||(t[5]=function(t){return e.nextPage()})},{default:(0,i.Ql)((function(){return[Te]})),_:1},8,["disable"])])])],2)}var Ee=function(){return Ee=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ee.apply(this,arguments)};function Le(e,t){(0,i._S)().appContext.config.globalProperties;var n={},o=(0,Q.cB)({paginationModel:{page:1,rowsNumber:null,rowsPerPage:10,descending:!0,maxPages:6}}),a={rowsPerPageOption:(0,i.S6)((function(){return[5,10,20,50,100,300,500]})),isFirstPage:(0,i.S6)((function(){return e.isFirstPage})),isLastPage:(0,i.S6)((function(){return null===e||void 0===e?void 0:e.isLastPage}))},l={countPage:function(){var e=o.paginationModel.page,t=o.paginationModel.rowsPerPage,n=o.paginationModel.rowsNumber,i=e*t-t+1,l=a.isLastPage.value?n:e*t;return"".concat(i," - ").concat(l," ").concat(C._s.tr("isite.cms.label.of")," ").concat(n)},emit:function(){t("update:modelValue",o.paginationModel)},init:function(){o.paginationModel=e.modelValue},nextPage:function(){o.paginationModel.page+=1,l.emit()},prevPage:function(){o.paginationModel.page-=1,l.emit()},resetPage:function(){o.paginationModel.page=1,l.emit()}};return(0,i.u2)((function(){l.init()})),(0,i.Kg)(e,(function(e,t){o.paginationModel=e.modelValue}),{deep:!0}),Ee(Ee(Ee(Ee({},n),(0,Q.kx)(o)),a),l)}const Fe=(0,i._M)({props:{modelValue:{type:Object,default:function(){return{page:1,rowsNumber:0,rowsPerPage:10,descending:!0,maxPages:6}}},pagesNumber:{default:1},isFirstPage:{default:!0},isLastPage:{default:!1}},components:{},setup:function(e,t){var n=t.emit;return Le(e,n)},computed:{windowSize:function(){return window.innerWidth>=500?"desktop":"mobile"},isMobile:function(){return"mobile"==this.windowSize}},methods:{showPagination:function(){return"desktop"==this.windowSize&&this.pagesNumber>1}}});var Se=n(15496),ze=n(36008);const Ve=(0,U.c)(Fe,[["render",Re]]),_e=Ve;G()(Fe,"components",{QPagination:Se.c,QSelect:ze.c,QBtn:Y.c});const Ke=(0,i._M)({props:{tableProps:{default:null},loading:{default:!1},title:{default:""},columns:{default:[]},rows:{default:[]},actions:{default:[]},pagination:{default:[]},beforeUpdate:{type:Function,default:!1}},components:{editablePopup:X,contextMenu:xe,contentType:de,masterPagination:_e},setup:function(e,t){var n=t.emit;return E(e,n)},computed:{},methods:{}});var Ie=n(40792),Oe=n(23372),Ue=n(45144),Ne=n(50213);const Be=(0,U.c)(Ke,[["render",T]]),je=Be;G()(Ke,"components",{QTable:Ie.c,QInnerLoading:Oe.c,QTr:Ue.c,QTd:Ne.c,QBtn:Y.c});var Ye=n(1436);const He=(0,i._M)({props:{loadPageActions:{default:!0},listConfig:{apiRoute:{default:""},permission:{default:""},read:{columns:{default:[]},requestParams:{default:{}},filters:{default:{}},help:{default:{}}},beforeUpdate:{type:Function,required:!1,default:null},actions:{default:[]}}},components:{dynamicTable:je,dynamicFilter:Ye.c},setup:function(e,t){var n=t.emit;return q(e,n)}}),Ge=(0,U.c)(He,[["render",k]]),Je=Ge;G()(He,"components",{QTable:Ie.c,QBtn:Y.c});var Xe={class:"q-mb-md"},Ze={class:"row q-gutter-x-md items-center"},et={class:"q-gutter-y-xs"},tt={class:"q-gutter-y-xs"},nt={class:"q-gutter-y-xs"},it={class:"q-py-md"},ot={class:"time-logs-format"},at={key:0,class:"q-mt-sm"},lt={class:"text-weight-medium"};function rt(e,t,n,o,l,r){var s,c=(0,i.E1)("dynamic-field"),u=(0,i.E1)("q-btn"),d=(0,i.E1)("q-separator"),m=(0,i.E1)("q-item-label"),f=(0,i.E1)("q-item-section"),p=(0,i.E1)("q-item"),g=(0,i.E1)("q-list"),v=(0,i.E1)("q-scroll-area"),h=(0,i.E1)("inner-loading");return(0,i.Wz)(),(0,i.An)("div",null,[(0,i.QD)("div",Xe,[(0,i.QD)("p",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.total"))+" : "+(0,a.WA)(e.row.totalFormatedTimelogsDuration),1)]),(0,i.QD)("div",Ze,[(0,i.QD)("div",et,[(0,i.QD)("p",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.startDate")),1),(0,i.K2)(c,{modelValue:e.dateModel,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.dateModel=t}),field:e.dateField,style:{width:"160px"}},null,8,["modelValue","field"])]),(0,i.QD)("div",tt,[(0,i.QD)("p",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.timeSpent")),1),(0,i.K2)(c,{modelValue:e.timeSpentModel,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.timeSpentModel=t}),field:e.timeSpentField,style:{width:"160px"}},null,8,["modelValue","field"])]),(0,i.QD)("div",nt,[(0,i.K2)(u,{label:e.$tr("isite.cms.label.save"),rounded:"","no-caps":"",unelevated:"",color:"primary",onClick:t[2]||(t[2]=function(){return e.createTimeLog()}),disable:e.disableButton},null,8,["label","disable"])])]),(0,i.QD)("div",it,[(0,i.QD)("p",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.format.title")),1),(0,i.QD)("ul",ot,[(0,i.QD)("li",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.format.weeks")),1),(0,i.QD)("li",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.format.days")),1),(0,i.QD)("li",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.format.hours")),1),(0,i.QD)("li",null,(0,a.WA)(e.$tr("itask.cms.timeLogs.format.minutes")),1)])]),(null===(s=e.row.timelogs)||void 0===s?void 0:s.length)?((0,i.Wz)(),(0,i.An)("div",at,[(0,i.K2)(d,{class:"q-my-sm"}),(0,i.K2)(v,{style:{height:"220px"},visible:""},{default:(0,i.Ql)((function(){return[(0,i.K2)(g,null,{default:(0,i.Ql)((function(){return[((0,i.Wz)(!0),(0,i.An)(i.ae,null,(0,i.mi)(e.row.timelogs,(function(t,n){return(0,i.Wz)(),(0,i.Az)(p,{key:n},{default:(0,i.Ql)((function(){return[(0,i.K2)(f,null,{default:(0,i.Ql)((function(){return[(0,i.K2)(m,{class:"q-gutter-x-xs"},{default:(0,i.Ql)((function(){return[(0,i.QD)("span",lt,(0,a.WA)(e.createdBy(t)),1),(0,i.QD)("span",null,(0,a.WA)(t.formatedTimeSpent),1)]})),_:2},1024),(0,i.K2)(m,{caption:"",lines:"1"},{default:(0,i.Ql)((function(){return[(0,i.mY)((0,a.WA)(e.$trd(t.createdAt)),1)]})),_:2},1024)]})),_:2},1024),(0,i.K2)(f,{side:"",top:""},{default:(0,i.Ql)((function(){return[(0,i.K2)(m,{caption:""},{default:(0,i.Ql)((function(){return[(0,i.K2)(u,{label:e.$tr("isite.cms.label.delete"),onClick:function(n){return e.deleteTimeLog(t)},rounded:"","no-caps":"",unelevated:"",dense:"",color:"grey-3","text-color":"grey-8",class:"q-px-md"},null,8,["label","onClick"])]})),_:2},1024)]})),_:2},1024)]})),_:2},1024)})),128))]})),_:1})]})),_:1})])):(0,i.g1)("",!0),(0,i.K2)(h,{visible:e.loading},null,8,["visible"])])}const st={createItem:function(e,t,n){return void 0===n&&(n={params:{}}),new Promise((function(i,o){D.c.create(e,t,n).then((function(e){i(e)})).catch((function(e){return o(e)}))}))},deleteItem:function(e,t){return new Promise((function(n,i){D.c.delete(e,t,{}).then((function(e){n(e)})).catch((function(e){return i(e)}))}))}};var ct=n(49456),ut=n.n(ct),dt=function(){return dt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},dt.apply(this,arguments)},mt=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function l(e){try{s(i.next(e))}catch(t){a(t)}}function r(e){try{s(i["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):o(e.value).then(l,r)}s((i=i.apply(e,t||[])).next())}))},ft=function(e,t){var n,i,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");while(a&&(a=0,r[0]&&(l=0)),l)try{if(n=1,i&&(o=2&r[0]?i["return"]:r[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,i=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){l.label=r[1];break}if(6===r[0]&&l.label<o[1]){l.label=o[1],o=r;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(r);break}o[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};function pt(e,t){var n="YYYY/MM/DD",o="apiRoutes.qtask.timelogs",a={},l=(0,Q.cB)({loading:!1,dateModel:null,dateField:{value:ut()().format(n),type:"date"},timeSpentModel:null,timeSpentField:{type:"timeSpent",props:{unit:"minutes"}}}),r={disableButton:(0,i.S6)((function(){return null==l.timeSpentModel||""==l.timeSpentModel}))},s={init:function(){},createTimeLog:function(){var t={taskId:e.row.id,timeSpent:l.timeSpentModel,createdAt:l.dateModel?l.dateModel:ut()().format(n)};l.loading=!0,st.createItem(o,t).then((function(e){l.timeSpentModel=null,l.loading=!1,C.Qb.info({message:C._s.tr("isite.cms.message.recordCreated")}),s.reloadRow()}))},deleteTimeLog:function(e){var t=this;C.Qb.error({mode:"modal",title:"ID: ".concat(e.id),message:C._s.tr("isite.cms.message.deleteRecord"),actions:[{label:C._s.tr("isite.cms.label.cancel"),color:"grey"},{label:C._s.tr("isite.cms.label.delete"),color:"red",handler:function(){return mt(t,void 0,void 0,(function(){return ft(this,(function(t){return l.loading=!0,st.deleteItem(o,e.id).then((function(e){s.reloadRow(),l.loading=!1})),[2]}))}))}}]})},reloadRow:function(){t("reloadRow",e.row)},createdBy:function(e){var t;return(null===(t=e.creator)||void 0===t?void 0:t.firstName)?"".concat(e.creator.firstName," ").concat(e.creator.lastName):e.creator.email}};return(0,i.u2)((function(){s.init()})),dt(dt(dt(dt({},a),(0,Q.kx)(l)),r),s)}const gt=(0,i._M)({props:{row:{default:{}}},setup:function(e,t){var n=t.emit;return pt(e,n)}});var vt=n(94380),ht=n(2992);const bt=(0,U.c)(gt,[["render",rt]]),yt=bt;G()(gt,"components",{QBtn:Y.c,QSeparator:j.c,QScrollArea:vt.c,QList:be.c,QItem:ye.c,QItemSection:we.c,QItemLabel:ht.c});var wt={class:"row q-col-gutter-x-md"},kt={class:"col-12 col-md-8"},Qt={style:{"min-height":"230px",height:"100%"}},Dt={class:"text-h6"},xt={class:"q-my-md"},Ct={class:"text-subtitle2 text-weight-bold"},Pt=["innerHTML"],Mt={class:"flex justify-start text-caption"},At={class:"q-mt-md"},qt={class:"col-12 col-md-4"},$t={class:"q-mb-md task-details q-pa-sm"},Wt={class:"text-subtitle2 text-weight-bold"},Tt={class:"q-my-xs q-col-gutter-y-sm"},Rt={class:"row"},Et={class:"col-5"},Lt={class:"col-7"},Ft={class:"row"},St={class:"col-5"},zt={class:"col-7"},Vt={class:"row"},_t={class:"col-5"},Kt={class:"col-7"},It={class:"row"},Ot={class:"col-5"},Ut={class:"col-7"},Nt={class:"row"},Bt={class:"col-5"},jt={class:"col-7"},Yt={class:"row"},Ht={class:"col-5"},Gt={class:"col-7"},Jt={class:"row"},Xt={class:"col-5"},Zt={class:"col-7"},en={class:"row"},tn={class:"col-5"},nn={class:"col-7"},on={class:"q-my-md"},an={class:"text-subtitle2 text-weight-bold"},ln={class:"flex justify-end items-center"};function rn(e,t,n,o,l,r){var s=(0,i.E1)("comments-component"),c=(0,i.E1)("q-scroll-area"),u=(0,i.E1)("q-btn");return(0,i.Wz)(),(0,i.An)("div",wt,[(0,i.QD)("div",kt,[(0,i.K2)(c,{style:{height:"calc(100vh - 173px)"},visible:"",class:"q-pa-md"},{default:(0,i.Ql)((function(){return[(0,i.QD)("div",Qt,[(0,i.QD)("div",null,[(0,i.QD)("span",Dt,(0,a.WA)(e.row.title),1)]),(0,i.QD)("div",xt,[(0,i.QD)("span",Ct,(0,a.WA)(e.$tr("isite.cms.form.description"))+": ",1),(0,i.QD)("div",{class:"q-my-xs",innerHTML:e.row.description},null,8,Pt)])]),(0,i.QD)("div",Mt,[(0,i.QD)("span",null,(0,a.WA)(e.$trd(e.row.updatedAt,{type:"long"})),1)]),(0,i.QD)("div",At,[(0,i.K2)(s,{commentableId:Number(e.row.id),field:{type:"html"},commentableType:"Modules\\Itask\\Entities\\Task"},null,8,["commentableId"])])]})),_:1})]),(0,i.QD)("div",qt,[(0,i.QD)("div",$t,[(0,i.QD)("span",Wt,(0,a.WA)(e.$tr("isite.cms.details")),1),(0,i.QD)("div",Tt,[(0,i.QD)("div",Rt,[(0,i.QD)("div",Et,(0,a.WA)(e.$tr("isite.cms.form.category"))+" : ",1),(0,i.QD)("div",Lt,(0,a.WA)(e.row.category.title),1)]),(0,i.QD)("div",Ft,[(0,i.QD)("div",St,(0,a.WA)(e.$tr("isite.cms.form.status"))+" : ",1),(0,i.QD)("div",zt,(0,a.WA)(e.row.status.title),1)]),(0,i.QD)("div",Vt,[(0,i.QD)("div",_t,(0,a.WA)(e.$tr("itask.cms.form.priority"))+" : ",1),(0,i.QD)("div",Kt,(0,a.WA)(e.row.priority.title),1)]),(0,i.QD)("div",It,[(0,i.QD)("div",Ot,(0,a.WA)(e.$tr("itask.cms.form.assigned"))+": ",1),(0,i.QD)("div",Ut,(0,a.WA)(e.assignedTo),1)]),(0,i.QD)("div",Nt,[(0,i.QD)("div",Bt,(0,a.WA)(e.$tr("itask.cms.form.estimatedTime"))+": ",1),(0,i.QD)("div",jt,(0,a.WA)(e.row.formatedEstimatedTime),1)]),(0,i.QD)("div",Yt,[(0,i.QD)("div",Ht,(0,a.WA)(e.$tr("itask.cms.duration"))+": ",1),(0,i.QD)("div",Gt,(0,a.WA)(e.row.duration),1)]),(0,i.QD)("div",Jt,[(0,i.QD)("div",Xt,(0,a.WA)(e.$tr("isite.cms.form.startDate"))+": ",1),(0,i.QD)("div",Zt,(0,a.WA)(e.row.startDate),1)]),(0,i.QD)("div",en,[(0,i.QD)("div",tn,(0,a.WA)(e.$tr("isite.cms.form.endDate"))+": ",1),(0,i.QD)("div",nn,(0,a.WA)(e.row.endDate),1)])]),(0,i.QD)("div",on,[(0,i.QD)("div",null,[(0,i.QD)("span",an,(0,a.WA)(e.$tr("itask.cms.timeLogs.title"))+": ",1)]),(0,i.QD)("div",null,[(0,i.K2)(u,{"text-color":"primary",unelevated:"","no-caps":"",rounded:"",label:"".concat(e.row.totalFormatedTimelogsDuration),onClick:t[0]||(t[0]=function(t){return e.$emit("openTimeLogsModal",e.row)})},null,8,["label"])])]),(0,i.QD)("div",ln,[(0,i.K2)(u,{label:e.$tr("isite.cms.label.edit"),onClick:t[1]||(t[1]=function(){e.$emit("onUpdate",e.row),e.$emit("close")}),rounded:"","no-caps":"",unelevated:""},null,8,["label"]),(0,i.K2)(u,{label:e.$tr("isite.cms.label.delete"),onClick:t[2]||(t[2]=function(t){return e.$emit("onDelete",e.row)}),"no-caps":"",unelevated:"",class:"q-ml-sm"},null,8,["label"])])])])])}var sn={key:0,id:"comments"},cn={class:"text-subtitle2 text-weight-bold q-my-md"},un=["src"],dn={class:"row"},mn={class:"col-10 flex justify-start items-center"},fn={class:"col-2 flex justify-end"},pn=["innerHTML"],gn={key:0,class:"q-my-sm"},vn={class:"flex justify-end items-start"},hn={class:"q-mt-md"};function bn(e,t,n,l,r,s){var c=(0,i.E1)("q-avatar"),u=(0,i.E1)("q-item-section"),d=(0,i.E1)("btn-menu"),m=(0,i.E1)("q-item-label"),f=(0,i.E1)("dynamic-field"),p=(0,i.E1)("q-btn"),g=(0,i.E1)("q-item"),v=(0,i.E1)("q-list"),h=(0,i.E1)("inner-loading");return e.hasPermission.index?((0,i.Wz)(),(0,i.An)("div",sn,[(0,i.QD)("div",cn,(0,a.WA)(e.$tc("isite.cms.form.comment",2)),1),e.comments.length?((0,i.Wz)(),(0,i.Az)(v,{key:0,separator:"",padding:""},{default:(0,i.Ql)((function(){return[((0,i.Wz)(!0),(0,i.An)(i.ae,null,(0,i.mi)(e.comments,(function(n,l){return(0,i.Wz)(),(0,i.Az)(g,{key:l},{default:(0,i.Ql)((function(){return[(0,i.K2)(u,{top:"",avatar:""},{default:(0,i.Ql)((function(){return[(0,i.K2)(c,null,{default:(0,i.Ql)((function(){return[(0,i.QD)("img",{src:"".concat(e.profileImage(n)),style:{width:"32px",height:"32px"}},null,8,un)]})),_:2},1024)]})),_:2},1024),(0,i.K2)(u,null,{default:(0,i.Ql)((function(){return[(0,i.K2)(m,{caption:""},{default:(0,i.Ql)((function(){return[(0,i.QD)("div",dn,[(0,i.QD)("div",mn,[(0,i.QD)("span",null,(0,a.WA)(e.createdBy(n)),1)]),(0,i.QD)("div",fn,[(0,i.K2)(d,{actions:e.actions,"action-data":n},null,8,["actions","action-data"])])])]})),_:2},1024),(0,i.K2)(m,null,{default:(0,i.Ql)((function(){return[(0,i.K2)(o.Ox,{name:"slide-fade"},{default:(0,i.Ql)((function(){return[(null===n||void 0===n?void 0:n.edit)?((0,i.Wz)(),(0,i.Az)(f,{key:0,class:"q-my-md",modelValue:e.updateCommentModel,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.updateCommentModel=t}),field:e.field},null,8,["modelValue","field"])):(0,i.g1)("",!0)]})),_:2},1024),(null===n||void 0===n?void 0:n.edit)?(0,i.g1)("",!0):((0,i.Wz)(),(0,i.An)("div",{key:0,innerHTML:n.comment},null,8,pn))]})),_:2},1024),(0,i.K2)(m,{caption:""},{default:(0,i.Ql)((function(){return[(null===n||void 0===n?void 0:n.edit)?(0,i.g1)("",!0):((0,i.Wz)(),(0,i.An)("div",gn,(0,a.WA)(e.$trd(n.updatedAt,{type:"long"})),1))]})),_:2},1024),(null===n||void 0===n?void 0:n.edit)?((0,i.Wz)(),(0,i.Az)(m,{key:0,class:"q-mb-md"},{default:(0,i.Ql)((function(){return[(0,i.QD)("div",vn,[(0,i.K2)(p,{label:e.$tr("isite.cms.label.update"),"no-caps":"",unelevated:"",color:"primary",rounded:"",onClick:function(t){return e.updateComment(n)}},null,8,["label","onClick"]),(0,i.K2)(p,{label:e.$tr("isite.cms.label.cancel"),"no-caps":"",unelevated:"",rounded:"",class:"q-ml-sm",onClick:function(t){return e.resetEdit(n)}},null,8,["label","onClick"])])]})),_:2},1024)):(0,i.g1)("",!0)]})),_:2},1024)]})),_:2},1024)})),128))]})),_:1})):(0,i.g1)("",!0),(0,i.QD)("div",hn,[e.hasPermission.create?((0,i.Wz)(),(0,i.Az)(f,{key:0,modelValue:e.newCommentModel,"onUpdate:modelValue":[t[1]||(t[1]=function(t){return e.newCommentModel=t}),t[2]||(t[2]=function(t){return e.resetEdit()})],class:"q-mb-md",field:e.field},null,8,["modelValue","field"])):(0,i.g1)("",!0),e.hasPermission.create?((0,i.Wz)(),(0,i.Az)(p,{key:1,label:e.$tr("isite.cms.label.save"),onClick:t[3]||(t[3]=function(t){return e.createComment()}),"no-caps":"",unelevated:"",rounded:"",color:"primary",disable:e.disableButton},null,8,["label","disable"])):(0,i.g1)("",!0)]),(0,i.K2)(h,{visible:e.loading},null,8,["visible"])])):(0,i.g1)("",!0)}var yn="apiRoutes.qcomment.comments",wn="icomments.comments";const kn={getCommentsList:function(e,t){return void 0===e&&(e=!1),void 0===t&&(t={}),new Promise((function(n,i){var o={refresh:e,params:t};D.c.index(yn,o).then((function(e){n(e)})).catch((function(e){return i(e)}))}))},createComment:function(e,t){return void 0===t&&(t={}),new Promise((function(n,i){D.c.create(yn,e,t).then((function(e){n(e)})).catch((function(e){return i(e)}))}))},showComment:function(e,t){return void 0===t&&(t={}),new Promise((function(n,i){D.c.show(yn,e,{params:t,refresh:!0}).then((function(e){n(e)})).catch((function(e){return i(e)}))}))},updateComment:function(e,t,n){return void 0===n&&(n={params:{}}),new Promise((function(i,o){D.c.update(yn,e,t,n).then((function(e){i(e)})).catch((function(e){return o(e)}))}))},deleteComment:function(e,t){return void 0===t&&(t={}),new Promise((function(n,i){D.c.delete(yn,e,t).then((function(e){n(!0)})).catch((function(e){return i(e)}))}))}};var Qn=n(33112),Dn=n.n(Qn),xn=function(){return xn=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},xn.apply(this,arguments)},Cn=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function l(e){try{s(i.next(e))}catch(t){a(t)}}function r(e){try{s(i["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):o(e.value).then(l,r)}s((i=i.apply(e,t||[])).next())}))},Pn=function(e,t){var n,i,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");while(a&&(a=0,r[0]&&(l=0)),l)try{if(n=1,i&&(o=2&r[0]?i["return"]:r[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,i=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){l.label=r[1];break}if(6===r[0]&&l.label<o[1]){l.label=o[1],o=r;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(r);break}o[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};function Mn(e,t){(0,i._S)().appContext.config.globalProperties;var n={},o=(0,Q.cB)({loading:!1,comments:[],newCommentModel:null,updateCommentModel:null}),a={hasPermission:(0,i.S6)((function(){return{create:C.is.hasAccess("".concat(wn,".create")),index:C.is.hasAccess("".concat(wn,".index")),edit:C.is.hasAccess("".concat(wn,".edit")),destroy:C.is.hasAccess("".concat(wn,".destroy"))}})),disableButton:(0,i.S6)((function(){return null==o.newCommentModel||""==o.newCommentModel})),paramsRequest:(0,i.S6)((function(){return{filter:{commentableType:e.commentableType,commentableId:e.commentableId},include:"userProfile"}})),actions:(0,i.S6)((function(){var e=[],t={icon:"fa-light fa-pencil",name:"edit",label:C._s.tr("isite.cms.label.edit"),action:function(e){l.editComment(e)}},n={icon:"fa-light fa-trash-can",name:"delete",label:C._s.tr("isite.cms.label.delete"),action:function(e){l.deleteComment(e)}};return a.hasPermission.value.edit&&e.push(t),a.hasPermission.value.destroy&&e.push(n),e}))},l={init:function(){a.hasPermission.value.index&&l.getCommentsList()},createdBy:function(e){var t;return(null===e||void 0===e?void 0:e.userProfile)?(null===(t=e.userProfile)||void 0===t?void 0:t.firstName)?"".concat(e.userProfile.firstName," ").concat(e.userProfile.lastName):e.userProfile.email:""},profileImage:function(e){var t,n;return(null===e||void 0===e?void 0:e.userProfile)&&(null===(t=e.userProfile)||void 0===t?void 0:t.mainImage)?null===(n=e.userProfile)||void 0===n?void 0:n.mainImage:Dn()},getCommentsList:function(){o.loading=!0,kn.getCommentsList(!0,a.paramsRequest.value).then((function(e){o.loading=!1,(null===e||void 0===e?void 0:e.data)&&(o.comments=e.data,o.comments.forEach((function(e){e.edit=!1})))})).catch((function(e){o.loading=!1,console.log("error on getCommentsList: ".concat(e))}))},createComment:function(){o.loading=!0;var t={comment:o.newCommentModel,commentableType:e.commentableType,commentableId:e.commentableId};kn.createComment(t).then((function(e){o.loading=!1,(null===e||void 0===e?void 0:e.data)&&(o.newCommentModel=null,l.getCommentsList())})).catch((function(e){o.loading=!1,console.log("error on createComment: ".concat(e))}))},resetEdit:function(){o.updateCommentModel=null,o.comments.forEach((function(e){e.edit=!1}))},editComment:function(e){l.resetEdit(),o.comments.find((function(t){t.id==e.id&&(t.edit=!0,o.updateCommentModel=t.comment)}))},updateComment:function(t){o.loading=!0;var n={comment:o.updateCommentModel,commentableType:e.commentableType,commentableId:e.commentableId};kn.updateComment(t.id,n).then((function(e){(null===e||void 0===e?void 0:e.data)&&(o.updateCommentModel=null,kn.showComment(t.id,a.paramsRequest.value).then((function(e){if(null===e||void 0===e?void 0:e.data){var n=o.comments.findIndex((function(e){return e.id==t.id}));o.comments[n]=e.data,o.comments[n]["edit"]=!1,o.loading=!1}})))})).catch((function(e){o.loading=!1,console.log("error on updateComment: ".concat(e))}))},deleteComment:function(e){var t=this;C.Qb.error({mode:"modal",title:"ID: ".concat(e.id),message:C._s.tr("isite.cms.message.deleteRecord"),actions:[{label:C._s.tr("isite.cms.label.cancel"),color:"grey"},{label:C._s.tr("isite.cms.label.delete"),color:"red",handler:function(){return Cn(t,void 0,void 0,(function(){return Pn(this,(function(t){return o.loading=!0,kn.deleteComment(e.id).then((function(e){l.getCommentsList(),o.loading=!1})),[2]}))}))}}]})}};return(0,i.u2)((function(){l.init()})),xn(xn(xn(xn(xn({},n),(0,Q.kx)(o)),a),l),{store:C.is})}const An=(0,i._M)({props:{commentableId:{type:Number,required:!0},commentableType:{type:String},field:{default:{type:"input",props:{label:""}}}},components:{},setup:function(e,t){var n=t.emit;return Mn(e,n)}});var qn=n(11252);const $n=(0,U.c)(An,[["render",bn]]),Wn=$n;G()(An,"components",{QList:be.c,QItem:ye.c,QItemSection:we.c,QAvatar:qn.c,QItemLabel:ht.c,QBtn:Y.c});const Tn=(0,i._M)({props:{row:{default:{}}},components:{commentsComponent:Wn},computed:{assignedTo:function(){var e,t;return this.row.assignedTo&&((null===(e=this.row.assignedTo)||void 0===e?void 0:e.firstName)||(null===(t=this.row.assignedTo)||void 0===t?void 0:t.lastName))?"".concat(this.row.assignedTo.firstName," ").concat(this.row.assignedTo.lastName):"-"}},methods:{}}),Rn=(0,U.c)(Tn,[["render",rn]]),En=Rn;G()(Tn,"components",{QScrollArea:vt.c,QBtn:Y.c});const Ln="YYYY/MM/DD",Fn={props:{},components:{dynamicList:Je,timeLogsComponent:yt,taskComponent:En},watch:{},mounted(){this.$nextTick((function(){}))},data(){return{selectedRow:{timeLogsModal:!1,showModal:!1,row:null},tabs:[{value:"table",label:"Table"},{value:"backlog",label:"Backlog"}],tabModel:"table",date:{from:ut()().startOf("week").format(Ln),to:ut()().endOf("week").format(Ln),title:this.$tr("itask.cms.week")},dateRangeFilter:{value:{type:"customRange",from:ut()().startOf("week").format(Ln),to:ut()().endOf("week").format(Ln)},type:"dateRange",props:{label:"Date",clearable:!1,removeTime:!0,autoClose:!0}},loading:!1,listConfig:{apiRoute:"apiRoutes.qtask.tasks",permission:"itask.tasks",pageActions:{extraActions:["search","new"]},read:{title:this.$tr("itask.cms.taskManagement"),tableProps:{dense:!0},columns:[{name:"id",label:this.$tr("isite.cms.form.id"),field:"id",style:"",onClick:(e,t)=>this.openShowModal(t)},{name:"title",label:this.$tr("isite.cms.form.title"),field:"title",align:"rigth",style:"max-width: 250px",onClick:(e,t)=>this.openShowModal(t)},{name:"category",label:this.$tr("isite.cms.form.category"),align:"left",field:"category",style:"max-width : 250px",format:e=>e&&e?.title?e.title:"-",dynamicField:{value:null,type:"select",name:"categoryId",props:{label:this.$tr("isite.cms.form.category"),useInput:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.categories",select:{label:"title",id:e=>`${e.id}`}}}},{name:"assignedTo",label:this.$tr("itask.cms.form.assigned"),field:"assignedTo",align:"left",format:e=>e&&(e.firstName||e.lastName)?`${e.firstName} ${e.lastName}`:"-",dynamicField:{value:[],type:"select",name:"assignedToId",props:{label:this.$tr("itask.cms.form.assigned"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.quser.users",select:{label:"email",id:e=>`${e.id}`}}}},{name:"startDate",label:this.$tr("isite.cms.form.startDate"),field:"startDate",align:"center",style:"padding: 0 5px",contentType:e=>({template:"date",props:{date:e.startDate,expirationDate:ut()()}}),dynamicField:{value:"",type:"date",props:{label:this.$tr("isite.cms.form.startDate")}}},{name:"endDate",label:this.$tr("isite.cms.form.endDate"),field:"endDate",align:"center",style:"padding: 0 5px",contentType:e=>({template:"date",props:{date:e.endDate,expirationDate:ut()()}}),dynamicField:{value:"",type:"date",props:{label:this.$tr("isite.cms.form.endDate")}}},{name:"duration",label:this.$tr("itask.cms.duration"),field:"duration",align:"left",format:e=>e||"-"},{name:"status",label:this.$tr("isite.cms.form.status"),field:"status",align:"center",style:"padding: 0 0 0 5px",contentType:e=>({template:"colorCell",props:{label:e.status.title,color:e.status.color,icon:e.status.icon}}),dynamicField:{type:"select",name:"statusId",props:{label:this.$tr("isite.cms.form.status"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.statuses",select:{label:"title",id:e=>`${e.id}`}}}},{name:"priority",label:this.$tr("itask.cms.form.priority"),field:"priority",align:"center",style:"padding: 0 5px 0 0",contentType:e=>({template:"colorCell",props:{label:e.priority.title,color:e.priority.color,icon:e.priority.icon}}),dynamicField:{value:[],type:"select",name:"priorityId",props:{label:this.$tr("itask.cms.form.priority"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.priorities",select:{label:"title",id:e=>`${e.id}`}}}},{name:"estimatedTime",label:this.$tr("itask.cms.form.estimatedTime"),field:"formatedEstimatedTime",align:"left",format:(e,t)=>t?.formatedEstimatedTime?t.formatedEstimatedTime:"-",dynamicField:{value:"",name:"estimatedTime",type:"timeSpent",props:{label:this.$tr("itask.cms.form.estimatedTime"),unit:"minutes"}}},{name:"totalFormatedTimelogsDuration",label:this.$tr("itask.cms.timeLogs.title"),field:"totalFormatedTimelogsDuration",align:"left",format:e=>e||"-",onClick:(e,t)=>{this.openTimeLogsModal(t)}},{name:"actions",label:this.$tr("isite.cms.form.actions"),align:"center"}],requestParams:{include:"category,status,priority,timelogs.creator,assignedTo",filter:{rangeDate:{from:ut()().startOf("week").format(Ln),to:ut()().endOf("week").format(Ln)}}},filters:{assignedToId:{value:[],type:"select",props:{label:this.$tr("itask.cms.form.assigned"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.quser.users",select:{label:"email",id:e=>`${e.id}`},filterByQuery:!0}},categoryId:{value:[],type:"select",props:{label:this.$tr("isite.cms.form.category"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.categories",filterByQuery:!0,select:{label:"title",id:e=>`${e.id}`}}},priorityId:{value:[],type:"select",props:{label:this.$tr("itask.cms.form.priority"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.priorities",select:{label:"title",id:e=>`${e.id}`}}},statusId:{value:[],type:"select",props:{label:this.$tr("isite.cms.form.status"),useInput:!0,clearable:!0,rules:[e=>!!e?.length||this.$tr("isite.cms.message.fieldRequired")]},loadOptions:{apiRoute:"apiRoutes.qtask.statuses",select:{label:"title",id:e=>`${e.id}`}}}},help:{title:this.$tr("itask.cms.taskManagement"),description:this.$tr("itask.cms.taskManagement")}},beforeUpdate:({val:e,row:t})=>new Promise(((n,i)=>{""==t.description&&i(),ut()(t.startDate).format(Ln)>ut()(t.endDate).format(Ln)?(this.$alert.error({message:this.$tr("itask.cms.date.error")}),i()):n(e)})),actions:[{icon:"fa-light fa-timer",name:"addTimelog",label:this.$tr("itask.cms.timeLogs.title"),action:e=>{this.openTimeLogsModal(e)}},{icon:"fa-light fa-eye",name:"edit",label:this.$tr("isite.cms.label.show"),action:e=>{this.openShowModal(e)}},{icon:"fa-light fa-pencil",name:"edit",label:this.$tr("isite.cms.label.edit"),action:e=>{this.onUpdate(e)}},{icon:"fa-light fa-trash-can",name:"delete",label:this.$tr("isite.cms.label.delete"),action:e=>{this.onDelete(e)}}]}}},computed:{dynamicListTitle(){const e=ut()(new Date(this.date.from)).format("MMM Do"),t=ut()(new Date(this.date.to)).format("MMM Do");return`${this.date.title}:  ${e} - ${t}`}},methods:{init(){},setDate(e,t,n){this.date={from:e,to:t,title:n},this.dateRangeFilter.value={type:"customRange",from:e,to:t},this.listConfig.read.requestParams.filter["rangeDate"]=this.date,this.$refs.dynamicList.updateFilter("rangeDate",this.date),this.refreshDynamicList()},refreshDynamicList(){(this.selectedRow.showModal||this.selectedRow.timeLogsModal)&&(this.selectedRow.timeLogsModal=!1,this.selectedRow.showModal=!1,this.selectedRow.row=null),this.$refs.dynamicList.getData({page:1},!0)},goToPrevious(){const e=ut()(new Date(this.date.from)).subtract(1,"weeks").startOf("week").format(Ln),t=ut()(new Date(this.date.from)).subtract(1,"weeks").endOf("week").format(Ln),n=this.$tr("itask.cms.week");this.setDate(e,t,n)},goToNext(){const e=ut()(new Date(this.date.from)).add(1,"weeks").startOf("week").format(Ln),t=ut()(new Date(this.date.to)).add(1,"weeks").endOf("week").format(Ln),n=this.$tr("itask.cms.week");this.setDate(e,t,n)},setDateRange(e){if(null!=e&&e?.from&&e?.to){const t=ut()(new Date(e.from)).format(Ln),n=ut()(new Date(e.to)).format(Ln);t==this.date.from&&n==this.date.to||(this.setDate(t,n,e.label),this.$refs.titleModal.hide())}},openTimeLogsModal(e){this.selectedRow.row=e,this.selectedRow.timeLogsModal=!0},async reloadRow(e){const t=await this.$refs.dynamicList.reloadRow(e);this.selectedRow.row=t},openShowModal(e){this.selectedRow.row=e,this.selectedRow.showModal=!0},onUpdate(e){this.$refs.crudComponent.update(e)},onDelete(e){this.$refs.crudComponent.delete(e)}}};var Sn=n(38788),zn=n(7628);const Vn=(0,U.c)(Fn,[["render",g]]),_n=Vn;G()(Fn,"components",{QTabs:Sn.c,QTab:zn.c,QBtn:Y.c,QTooltip:se.c,QIcon:ke.c,QPopupEdit:N.c})}}]);