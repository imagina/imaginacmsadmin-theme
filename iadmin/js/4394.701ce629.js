"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[4394],{74394:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Ht});var a=l(61758),o=l(58790);const i={id:"productFormPage",ref:"productFormPage"},s={class:"productForm q-mb-lg backend-page row"},r={class:"col-12 col-lg-10 offset-lg-1 relative-position"},d={class:"box box-auto-height q-mb-md"},n={key:0,class:"row justify-center q-col-gutter-x-md"},m={class:"col-12 q-mb-md"},c={key:0,class:"col-12"},u={class:"box"},p={key:0,class:"box-title"},h={key:1},f={class:"box-title text-primary q-mb-xs"},b={class:"text-body2"},g={class:"row q-col-gutter-md q-mb-md"},$=["onClick"],v={class:"relative-position card"},V={class:"box-title text-primary q-mb-sm"},k={class:"text-body2"},y={class:"input-title"},F={class:"relative-position text-right"},I={class:"row q-col-gutter-md q-pa-md"},O={class:"col-12 col-md-6"},q={class:"col-12 col-md-6"},T={class:"row q-col-gutter-xs"},C={class:"col-xs-12 col-sm-4"},w={class:"col-xs-12 col-sm-4"},A={class:"col-xs-12 col-sm-4"},P=(0,a.Lk)("br",null,null,-1),x=(0,a.Lk)("br",null,null,-1),L=(0,a.Lk)("br",null,null,-1),_=(0,a.Lk)("br",null,null,-1),R=(0,a.Lk)("br",null,null,-1),U={class:"q-pa-md"},E={key:0,class:"q-mb-md"},D={class:"q-pa-md"},Q={class:"q-pa-sm"},S={key:1,class:"text-center"},W={class:"q-my-md"},X={class:"full-width"},N={key:0,class:"q-pa-sm"},z={key:1,class:"text-center q-pa-sm"},M={class:"q-my-md"},B={class:"full-width"},Y={key:0,class:"q-pa-sm"},H={key:1,class:"text-center q-pa-sm"},j={class:"q-my-md"},K={class:"full-width"},G={key:0,class:"q-pa-sm"},J={key:1,class:"text-center q-pa-sm"},Z={class:"q-my-md"},ee={class:"text-right"};function te(e,t,te,le,ae,oe){const ie=(0,a.g2)("page-actions"),se=(0,a.g2)("locales"),re=(0,a.g2)("q-icon"),de=(0,a.g2)("q-separator"),ne=(0,a.g2)("q-tab-panel"),me=(0,a.g2)("q-input"),ce=(0,a.g2)("dynamic-field"),ue=(0,a.g2)("ck-editor"),pe=((0,a.g2)("q-editor"),(0,a.g2)("q-field")),he=(0,a.g2)("q-select"),fe=(0,a.g2)("q-toggle"),be=(0,a.g2)("crud"),ge=(0,a.g2)("crud-options"),$e=(0,a.g2)("q-btn"),ve=(0,a.g2)("q-card-section"),Ve=(0,a.g2)("q-card"),ke=(0,a.g2)("q-tab-panels"),ye=(0,a.g2)("q-item"),Fe=(0,a.g2)("q-list"),Ie=(0,a.g2)("q-btn-dropdown"),Oe=(0,a.g2)("q-form"),qe=(0,a.g2)("inner-loading"),Te=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",s,[(0,a.Lk)("div",r,[(0,a.Lk)("div",d,[(0,a.bF)(ie,{title:oe.pageTitle,"exclude-actions":["sync"],onRefresh:oe.initForm},null,8,["title","onRefresh"])]),(0,a.bF)(Oe,{autocorrect:"off",autocomplete:"off",ref:"formContent",onSubmit:t[61]||(t[61]=t=>e.itemId||e.field?oe.updateItem():oe.createItem()),onValidationError:t[62]||(t[62]=t=>e.$alert.error(e.$tr("isite.cms.message.formInvalid")))},{default:(0,a.k6)((()=>[ae.success?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("div",m,[(0,a.bF)(se,{modelValue:ae.locale,"onUpdate:modelValue":t[0]||(t[0]=e=>ae.locale=e),ref:"localeComponent",form:e.$refs.formContent},null,8,["modelValue","form"])]),ae.locale.success?((0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",u,[ae.locale.formTemplate.name?((0,a.uX)(),(0,a.CE)("div",p,[(0,a.bF)(re,{name:"fa-light fa-tags"}),(0,a.eW)(" "+(0,o.v_)(ae.locale.formTemplate.name)+" ",1),(0,a.bF)(de,{class:"q-my-md"})])):(0,a.Q3)("",!0),"home"!=ae.lastPanelOpen?((0,a.uX)(),(0,a.CE)("div",h,[(0,a.Lk)("div",f,(0,o.v_)(e.$tr(ae.modalForms[ae.lastPanelOpen].title)),1),(0,a.Lk)("p",b,(0,o.v_)(e.$tr(ae.modalForms[ae.lastPanelOpen].content)),1),(0,a.bF)(de,{class:"q-my-md",inset:""})])):(0,a.Q3)("",!0),(0,a.bF)(ke,{modelValue:ae.lastPanelOpen,"onUpdate:modelValue":t[54]||(t[54]=e=>ae.lastPanelOpen=e),"keep-alive":"",animated:"",class:"rounded-borders q-pa-none"},{default:(0,a.k6)((()=>[(0,a.bF)(ne,{name:"home"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",g,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(ae.modalForms,((t,l)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:l},["home"===t.type||void 0!=t.vIf&&!t.vIf?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",{key:0,class:"col-12 col-md-6 col-xl-4",onClick:()=>oe.showNewForm(t.type)},[(0,a.Lk)("div",v,[(0,a.bF)(re,{name:"fal fa-edit",color:"primary",class:"absolute-right q-pr-md q-pt-md"}),(0,a.Lk)("div",V,(0,o.v_)(e.$tr(t.title)),1),(0,a.Lk)("p",k,(0,o.v_)(e.$tr(t.content)),1)])],8,$))],64)))),128))])])),_:1}),(0,a.bF)(ne,{name:"content"},{default:(0,a.k6)((()=>[(0,a.bF)(me,{modelValue:ae.locale.formTemplate.name,"onUpdate:modelValue":[t[1]||(t[1]=e=>ae.locale.formTemplate.name=e),t[2]||(t[2]=e=>oe.setSlug())],outlined:"",dense:"","data-testid":"name",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],label:`${e.$tr("isite.cms.form.name")} (${ae.locale.language})*`},null,8,["modelValue","rules","label"]),(0,a.bF)(me,{modelValue:ae.locale.formTemplate.slug,"onUpdate:modelValue":t[3]||(t[3]=e=>ae.locale.formTemplate.slug=e),outlined:"",dense:"","data-testid":"slug",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],label:`${e.$tr("isite.cms.form.slug")} (${ae.locale.language})*`},null,8,["modelValue","rules","label"]),(0,a.bF)(me,{modelValue:ae.locale.formTemplate.summary,"onUpdate:modelValue":t[4]||(t[4]=e=>ae.locale.formTemplate.summary=e),type:"textarea",outlined:"",dense:"","data-testid":"summary",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],label:`${e.$tr("isite.cms.form.summary")} (${ae.locale.language})*`,rows:"3"},null,8,["modelValue","rules","label"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.advancedSummary,"onUpdate:modelValue":t[5]||(t[5]=e=>ae.locale.formTemplate.advancedSummary=e),field:oe.dynamicFields.advancedSummary,"item-id":ae.productId,language:ae.locale.language},null,8,["modelValue","field","item-id","language"]),(0,a.Lk)("div",y,(0,o.v_)(`${e.$tr("isite.cms.form.description")} (${ae.locale.language})*`),1),(0,a.bF)(pe,{modelValue:ae.locale.formTemplate.description,"onUpdate:modelValue":t[8]||(t[8]=e=>ae.locale.formTemplate.description=e),borderless:"",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},{default:(0,a.k6)((()=>[(0,a.bF)(ue,{modelValue:ae.locale.formTemplate.description,"onUpdate:modelValue":t[6]||(t[6]=e=>ae.locale.formTemplate.description=e),"data-testid":"description"},null,8,["modelValue"]),(0,a.Q3)("",!0)])),_:1},8,["modelValue","rules"])])),_:1}),(0,a.bF)(ne,{name:"status"},{default:(0,a.k6)((()=>[(0,a.bF)(he,{clearable:!1,"emit-value":"","map-options":"",outlined:"",dense:"",label:e.$tr("isite.cms.form.status"),options:oe.options.status,modelValue:ae.locale.formTemplate.status,"onUpdate:modelValue":t[9]||(t[9]=e=>ae.locale.formTemplate.status=e),"data-testid":"status"},null,8,["label","options","modelValue"])])),_:1}),(0,a.bF)(ne,{name:"categories"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",F,[(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.categoryId,"onUpdate:modelValue":t[10]||(t[10]=e=>ae.locale.formTemplate.categoryId=e),field:oe.dynamicFields.categoryId},null,8,["modelValue","field"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.categories,"onUpdate:modelValue":t[11]||(t[11]=e=>ae.locale.formTemplate.categories=e),field:oe.dynamicFields.categories},null,8,["modelValue","field"])])])),_:1}),(0,a.bF)(ne,{name:"metaInfo"},{default:(0,a.k6)((()=>[(0,a.bF)(me,{"data-testid":"metaTitle",modelValue:ae.locale.formTemplate.metaTitle,"onUpdate:modelValue":t[12]||(t[12]=e=>ae.locale.formTemplate.metaTitle=e),outlined:"",dense:"",label:`${e.$tr("isite.cms.form.metaTitle")} (${ae.locale.language})`,class:"q-m-b-sm"},null,8,["modelValue","label"]),(0,a.bF)(me,{"data-testid":"metaDescription",modelValue:ae.locale.formTemplate.metaDescription,"onUpdate:modelValue":t[13]||(t[13]=e=>ae.locale.formTemplate.metaDescription=e),type:"textarea",outlined:"",dense:"",label:`${e.$tr("isite.cms.form.metaDescription")} (${ae.locale.language})`,rows:"3"},null,8,["modelValue","label"]),(0,a.bF)(me,{"data-testid":"customUrl",modelValue:ae.locale.formTemplate.customUrl,"onUpdate:modelValue":t[14]||(t[14]=e=>ae.locale.formTemplate.customUrl=e),outlined:"",dense:"",label:`${e.$tr("isite.cms.form.customUrl")}`},null,8,["modelValue","label"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.tags,"onUpdate:modelValue":t[15]||(t[15]=e=>ae.locale.formTemplate.tags=e),field:oe.dynamicFields.tags},null,8,["modelValue","field"])])),_:1}),(0,a.bF)(ne,{name:"data"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",I,[(0,a.Lk)("div",O,[(0,a.bF)(me,{"data-testid":"reference",modelValue:ae.locale.formTemplate.reference,"onUpdate:modelValue":t[16]||(t[16]=e=>ae.locale.formTemplate.reference=e),outlined:"",dense:"",label:e.$tr("isite.cms.form.reference")},null,8,["modelValue","label"]),(0,a.bF)(me,{"data-testid":"sku",outlined:"",dense:"",modelValue:ae.locale.formTemplate.sku,"onUpdate:modelValue":t[17]||(t[17]=e=>ae.locale.formTemplate.sku=e),label:e.$tr("isite.cms.form.sku")},null,8,["modelValue","label"]),(0,a.bF)(me,{"data-testid":"price",outlined:"",dense:"",type:"number",modelValue:ae.locale.formTemplate.price,"onUpdate:modelValue":t[18]||(t[18]=e=>ae.locale.formTemplate.price=e),label:e.$tr("isite.cms.form.price")},null,8,["modelValue","label"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.quantity,"onUpdate:modelValue":t[19]||(t[19]=e=>ae.locale.formTemplate.quantity=e),field:oe.dynamicFields.quantity},null,8,["modelValue","field"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.quantityClassId,"onUpdate:modelValue":t[20]||(t[20]=e=>ae.locale.formTemplate.quantityClassId=e),field:oe.dynamicFields.quantityClassId},null,8,["modelValue","field"]),(0,a.bF)(me,{"data-testid":"minimumOrder",label:e.$tr("icommerce.cms.form.minimumOrder"),outlined:"",dense:"",type:"number",modelValue:ae.locale.formTemplate.minimum,"onUpdate:modelValue":t[21]||(t[21]=e=>ae.locale.formTemplate.minimum=e)},null,8,["label","modelValue"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.stockStatus,"onUpdate:modelValue":t[22]||(t[22]=e=>ae.locale.formTemplate.stockStatus=e),field:oe.dynamicFields?.stockStatus},null,8,["modelValue","field"]),(0,a.bF)(me,{"data-testid":"sortOrder",label:e.$tr("icommerce.cms.form.sortOrder"),outlined:"",dense:"",type:"number",modelValue:ae.locale.formTemplate.sortOrder,"onUpdate:modelValue":t[23]||(t[23]=e=>ae.locale.formTemplate.sortOrder=e)},null,8,["label","modelValue"])]),(0,a.Lk)("div",q,[(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.dateAvailable,"onUpdate:modelValue":t[24]||(t[24]=e=>ae.locale.formTemplate.dateAvailable=e),field:oe.dynamicFields.dateAvailable},null,8,["modelValue","field"]),(0,a.bF)(me,{"data-testid":"points",modelValue:ae.locale.formTemplate.points,"onUpdate:modelValue":t[25]||(t[25]=e=>ae.locale.formTemplate.points=e),outlined:"",dense:"",label:e.$trp("isite.cms.form.point")},null,8,["modelValue","label"]),(0,a.Lk)("div",T,[(0,a.Lk)("div",C,[(0,a.bF)(me,{"data-testid":"length",modelValue:ae.locale.formTemplate.length,"onUpdate:modelValue":t[26]||(t[26]=e=>ae.locale.formTemplate.length=e),label:e.$tr("isite.cms.form.length"),outlined:"",dense:"",type:"number"},null,8,["modelValue","label"])]),(0,a.Lk)("div",w,[(0,a.bF)(me,{"data-testid":"width",modelValue:ae.locale.formTemplate.width,"onUpdate:modelValue":t[27]||(t[27]=e=>ae.locale.formTemplate.width=e),label:e.$tr("isite.cms.form.width"),outlined:"",dense:"",type:"number"},null,8,["modelValue","label"])]),(0,a.Lk)("div",A,[(0,a.bF)(me,{"data-testid":"height",modelValue:ae.locale.formTemplate.height,"onUpdate:modelValue":t[28]||(t[28]=e=>ae.locale.formTemplate.height=e),label:e.$tr("isite.cms.form.height"),outlined:"",dense:"",type:"number"},null,8,["modelValue","label"])])]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.lengthClassId,"onUpdate:modelValue":t[29]||(t[29]=e=>ae.locale.formTemplate.lengthClassId=e),field:oe.dynamicFields.lengthClassId},null,8,["modelValue","field"]),(0,a.bF)(me,{"data-testid":"weight",modelValue:ae.locale.formTemplate.weight,"onUpdate:modelValue":t[30]||(t[30]=e=>ae.locale.formTemplate.weight=e),label:e.$tr("isite.cms.form.weight"),outlined:"",dense:"",type:"number"},null,8,["modelValue","label"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.weightClassId,"onUpdate:modelValue":t[31]||(t[31]=e=>ae.locale.formTemplate.weightClassId=e),field:oe.dynamicFields.weightClassId},null,8,["modelValue","field"]),(0,a.bF)(me,{"data-testid":"orderWeight",label:e.$tr("icommerce.cms.form.orderWeight"),outlined:"",dense:"",modelValue:ae.locale.formTemplate.orderWeight,"onUpdate:modelValue":t[32]||(t[32]=e=>ae.locale.formTemplate.orderWeight=e)},null,8,["label","modelValue"]),(0,a.bF)(me,{"data-testid":"weight",modelValue:ae.locale.formTemplate.volume,"onUpdate:modelValue":t[33]||(t[33]=e=>ae.locale.formTemplate.volume=e),label:e.$tr("icommerce.cms.form.volume"),outlined:"",dense:"",type:"number"},null,8,["modelValue","label"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.volumeClassId,"onUpdate:modelValue":t[34]||(t[34]=e=>ae.locale.formTemplate.volumeClassId=e),field:oe.dynamicFields.volumeClassId},null,8,["modelValue","field"]),(0,a.bF)(fe,{"data-testid":"shipping",modelValue:ae.locale.formTemplate.shipping,"onUpdate:modelValue":t[35]||(t[35]=e=>ae.locale.formTemplate.shipping=e),"true-value":!0,"false-value":!1,label:e.$tr("icommerce.cms.form.requriedShipping"),color:"primary"},null,8,["modelValue","label"]),P,(0,a.bF)(fe,{"data-testid":"freeShipping",modelValue:ae.locale.formTemplate.freeshipping,"onUpdate:modelValue":t[36]||(t[36]=e=>ae.locale.formTemplate.freeshipping=e),"true-value":!0,"false-value":!1,label:e.$tr("icommerce.cms.form.freeShipping"),color:"primary"},null,8,["modelValue","label"]),x,(0,a.bF)(fe,{"data-testid":"subtract",modelValue:ae.locale.formTemplate.subtract,"onUpdate:modelValue":t[37]||(t[37]=e=>ae.locale.formTemplate.subtract=e),"true-value":!0,"false-value":!1,label:e.$tr("icommerce.cms.form.subtractFromStock"),color:"primary"},null,8,["modelValue","label"]),L,(0,a.bF)(fe,{"data-testid":"subtract",modelValue:ae.locale.formTemplate.featured,"onUpdate:modelValue":t[38]||(t[38]=e=>ae.locale.formTemplate.featured=e),"true-value":"1","false-value":"0",label:e.$tr("icommerce.cms.form.featured"),color:"primary"},null,8,["modelValue","label"]),_,(0,a.bF)(fe,{"data-testid":"isCall",modelValue:ae.locale.formTemplate.isCall,"onUpdate:modelValue":t[39]||(t[39]=e=>ae.locale.formTemplate.isCall=e),"true-value":"1","false-value":"0",label:e.$tr("icommerce.cms.form.isCall"),color:"primary"},null,8,["modelValue","label"]),R,(0,a.bF)(fe,{"data-testid":"showPriceIsCall",modelValue:ae.locale.formTemplate.showPriceIsCall,"onUpdate:modelValue":t[40]||(t[40]=e=>ae.locale.formTemplate.showPriceIsCall=e),"true-value":"1","false-value":"0",label:e.$tr("icommerce.cms.form.showPriceIsCall"),color:"primary"},null,8,["modelValue","label"]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(ae.extraFields,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,ref_for:!0,ref:t},[e.isFakeField||e.fakeFieldName?((0,a.uX)(),(0,a.Wv)(ce,{modelValue:ae.locale.formTemplate[e.fakeFieldName||"options"][e.name||t],"onUpdate:modelValue":l=>ae.locale.formTemplate[e.fakeFieldName||"options"][e.name||t]=l,key:t,field:{...e,testId:e.testId||e.name||t},language:ae.locale.language,"item-id":ae.productId,ref_for:!0,ref:`field-${e.name||t}`},null,8,["modelValue","onUpdate:modelValue","field","language","item-id"])):(0,a.Q3)("",!0),e.isFakeField||e.fakeFieldName?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(ce,{modelValue:ae.locale.formTemplate[e.name||t],"onUpdate:modelValue":l=>ae.locale.formTemplate[e.name||t]=l,key:t,field:{...e,testId:e.testId||e.name||t},language:ae.locale.language,"item-id":ae.productId,ref_for:!0,ref:`field-${e.name||t}`},null,8,["modelValue","onUpdate:modelValue","field","language","item-id"]))])))),128))])])])),_:1}),(0,a.bF)(ne,{name:"relations"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",U,[oe.canManageRecordMaster?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.options.masterRecord,"onUpdate:modelValue":t[41]||(t[41]=e=>ae.locale.formTemplate.options.masterRecord=e),field:oe.dynamicFields?.masterRecord},null,8,["modelValue","field"])])):(0,a.Q3)("",!0),(0,a.Q3)("",!0),e.$hasAccess("icommerce.taxclasses.manage")?((0,a.uX)(),(0,a.Wv)(be,{key:2,"crud-data":l.e(4147).then(l.bind(l,44147)),type:"select","crud-props":{label:`${e.$tr("icommerce.cms.form.taxClass")}`,"data-testid":"taxClassId"},modelValue:ae.locale.formTemplate.taxClassId,"onUpdate:modelValue":t[43]||(t[43]=e=>ae.locale.formTemplate.taxClassId=e),config:{options:{label:"name",value:"id"}}},null,8,["crud-data","crud-props","modelValue"])):(0,a.Q3)("",!0),(0,a.bF)(be,{"crud-data":l.e(4791).then(l.bind(l,54791)),type:"select","crud-props":{label:`${e.$tr("icommerce.cms.form.manufacturer")}`,"data-testid":"manufacturerId",clearable:!0},modelValue:ae.locale.formTemplate.manufacturerId,"onUpdate:modelValue":t[44]||(t[44]=e=>ae.locale.formTemplate.manufacturerId=e),config:{options:{label:"name",value:"id"}}},null,8,["crud-data","crud-props","modelValue"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.relatedProducts,"onUpdate:modelValue":t[45]||(t[45]=e=>ae.locale.formTemplate.relatedProducts=e),field:oe.dynamicFields?.relatedProducts},null,8,["modelValue","field"])])])),_:1}),(0,a.bF)(ne,{name:"images"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",D,[(0,a.bF)(me,{"data-testid":"optionsVideo",modelValue:ae.locale.formTemplate.options.video,"onUpdate:modelValue":t[46]||(t[46]=e=>ae.locale.formTemplate.options.video=e),outlined:"",dense:"",label:e.$tr("isite.cms.form.video")},null,8,["modelValue","label"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.mediasSingle,"onUpdate:modelValue":t[47]||(t[47]=e=>ae.locale.formTemplate.mediasSingle=e),field:oe.dynamicFields?.mainImage,"item-id":ae.productId},null,8,["modelValue","field","item-id"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.mediasSingle,"onUpdate:modelValue":t[48]||(t[48]=e=>ae.locale.formTemplate.mediasSingle=e),field:oe.dynamicFields?.sizereference,"item-id":ae.productId},null,8,["modelValue","field","item-id"]),(0,a.bF)(ce,{modelValue:ae.locale.formTemplate.mediasMulti,"onUpdate:modelValue":t[49]||(t[49]=e=>ae.locale.formTemplate.mediasMulti=e),field:oe.dynamicFields.gallery,"item-id":ae.productId},null,8,["modelValue","field","item-id"])])])),_:1}),(0,a.bF)(ne,{name:"options"},{default:(0,a.k6)((()=>[(0,a.bF)(Ve,null,{default:(0,a.k6)((()=>[(0,a.bF)(ve,{class:"q-pa-sm"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",Q,[ae.productId?((0,a.uX)(),(0,a.Wv)(ge,{key:0,productId:ae.productId},null,8,["productId"])):((0,a.uX)(),(0,a.CE)("div",S,[(0,a.Lk)("div",W,[(0,a.bF)(re,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.eW)(" "+(0,o.v_)(`${e.$tr("icommerce.cms.message.warnAddOpt")}...`),1)]),(0,a.bF)($e,{icon:"fas fa-save",label:oe.options.btn.saveAndEdit,rounded:"",unelevated:"",onClick:t[50]||(t[50]=e=>(ae.buttonActions.value=4,oe.createItem())),color:"green"},null,8,["label"])]))])])),_:1})])),_:1})])),_:1}),(0,a.bF)(ne,{name:"discount"},{default:(0,a.k6)((()=>[(0,a.bF)(Ve,null,{default:(0,a.k6)((()=>[(0,a.bF)(ve,{class:"q-pa-sm"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",X,[ae.productId?((0,a.uX)(),(0,a.CE)("div",N,[(0,a.bF)(be,{"crud-data":l.e(8479).then(l.bind(l,8479)),"custom-data":{read:{requestParams:{include:"department",filter:{productId:ae.productId}}},formRight:{productId:{value:ae.productId}}}},null,8,["crud-data","custom-data"])])):((0,a.uX)(),(0,a.CE)("div",z,[(0,a.Lk)("div",M,[(0,a.bF)(re,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.eW)(" "+(0,o.v_)(`${e.$tr("icommerce.cms.message.warnAddDiscount")}...`),1)]),(0,a.bF)($e,{icon:"fas fa-save",label:oe.options.btn.saveAndEdit,rounded:"",unelevated:"",onClick:t[51]||(t[51]=e=>(ae.buttonActions.value=4,oe.createItem())),color:"green"},null,8,["label"])]))])])),_:1})])),_:1})])),_:1}),(0,a.bF)(ne,{name:"productWarehouse"},{default:(0,a.k6)((()=>[(0,a.bF)(Ve,null,{default:(0,a.k6)((()=>[(0,a.bF)(ve,{class:"q-pa-sm"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",B,[ae.productId?((0,a.uX)(),(0,a.CE)("div",Y,[(0,a.bF)(be,{"crud-data":l.e(1088).then(l.bind(l,11088)),"custom-data":oe.customCrudData.productWarehouse,onCreated:oe.getDataProduct,onUpdated:oe.getDataProduct,onDeleted:oe.getDataProduct},null,8,["crud-data","custom-data","onCreated","onUpdated","onDeleted"]),(0,a.bF)(be,{"crud-data":l.e(1542).then(l.bind(l,61542)),"custom-data":oe.customCrudData.productOptValueWarehouse,onCreated:oe.getDataProduct,onUpdated:oe.getDataProduct,onDeleted:oe.getDataProduct},null,8,["crud-data","custom-data","onCreated","onUpdated","onDeleted"])])):((0,a.uX)(),(0,a.CE)("div",H,[(0,a.Lk)("div",j,[(0,a.bF)(re,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.eW)(" "+(0,o.v_)(`${e.$tr("icommerce.cms.message.warnWarehouse")}...`),1)]),(0,a.bF)($e,{icon:"fas fa-save",label:oe.options.btn.saveAndEdit,rounded:"",unelevated:"",onClick:t[52]||(t[52]=e=>(ae.buttonActions.value=4,oe.createItem())),color:"green"},null,8,["label"])]))])])),_:1})])),_:1})])),_:1}),(0,a.bF)(ne,{name:"priceList"},{default:(0,a.k6)((()=>[(0,a.bF)(Ve,null,{default:(0,a.k6)((()=>[(0,a.bF)(ve,{class:"q-pa-sm"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",K,[ae.productId?((0,a.uX)(),(0,a.CE)("div",G,[(0,a.bF)(be,{"crud-data":l.e(2332).then(l.bind(l,42332)),"custom-data":oe.customCrudData.productPriceList},null,8,["crud-data","custom-data"])])):((0,a.uX)(),(0,a.CE)("div",J,[(0,a.Lk)("div",Z,[(0,a.bF)(re,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.eW)(" "+(0,o.v_)(`${e.$tr("icommerce.cms.message.warnPriceList")}...`),1)]),(0,a.bF)($e,{icon:"fas fa-save",label:oe.options.btn.saveAndEdit,rounded:"",unelevated:"",onClick:t[53]||(t[53]=e=>(ae.buttonActions.value=4,oe.createItem())),color:"green"},null,8,["label"])]))])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Lk)("div",ee,["home"!=ae.lastPanelOpen?((0,a.uX)(),(0,a.Wv)($e,{key:0,outline:"",rounded:"",color:"blue-grey",label:e.$tr("isite.cms.label.back"),icon:"fal fa-arrow-left",onClick:t[55]||(t[55]=()=>oe.backHomePanel()),class:"q-mr-sm","no-caps":""},null,8,["label"])):(0,a.Q3)("",!0),ae.productId?((0,a.uX)(),(0,a.Wv)($e,{key:1,rounded:"",unelevated:"",outline:"",color:"green",loading:ae.loading,"no-caps":"",icon:"fal fa-save",label:e.$tr("isite.cms.label.update"),onClick:t[56]||(t[56]=e=>oe.updateItem())},null,8,["loading","label"])):((0,a.uX)(),(0,a.Wv)(Ie,{key:2,label:ae.buttonActions.label,split:"",loading:ae.loading,"content-style":"min-width: 250px !important",unelevated:"",outline:"","no-caps":"",color:"green",icon:"fal fa-save",onClick:t[60]||(t[60]=e=>oe.createItem()),rounded:"",align:"right"},{default:(0,a.k6)((()=>[(0,a.bF)(Fe,{link:""},{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(ye,{onClick:t[57]||(t[57]=e=>ae.buttonActions={label:oe.options.btn.saveAndReturn,value:1})},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(oe.options.btn.saveAndReturn),1)])),_:1})),[[Te]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(ye,{onClick:t[58]||(t[58]=e=>ae.buttonActions={label:oe.options.btn.saveAndEdit,value:2})},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(oe.options.btn.saveAndEdit),1)])),_:1})),[[Te]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(ye,{onClick:t[59]||(t[59]=e=>ae.buttonActions={label:oe.options.btn.saveAndCreate,value:3})},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(oe.options.btn.saveAndCreate),1)])),_:1})),[[Te]])])),_:1})])),_:1},8,["label","loading"]))])])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])),_:1},512),(0,a.bF)(qe,{visible:ae.loading},null,8,["visible"])])])],512)}l(10239);var le=l(44363);const ae={id:"crudOptions",class:"relative-position"},oe={class:"row q-col-gutter-sm"},ie={class:"col-12 col-md-4"},se={class:"border q-pa-sm"},re={class:"q-mb-sm"},de={class:"q-py-sm"},ne={key:0,class:"text-grey-8"},me={class:"text-right q-mt-md"},ce={class:"col-12 col-md-8"},ue={key:0,class:"q-pa-lg"},pe={key:1},he={class:"inline-block"},fe={class:"input-title capitalize"},be={class:"inline-block q-ml-lg"},ge={class:"input-title capitalize"},$e={key:0,class:"inline-block q-ml-lg"},ve=(0,a.Lk)("div",{class:"input-title"},"Parent",-1),Ve={class:"inline-block q-ml-lg"},ke={class:"input-title capitalize"},ye={class:"row q-col-gutter-sm q-mt-sm"},Fe={key:0,class:"col-12 col-md-4"},Ie={class:"input-title"},Oe={key:1,class:"col-12 col-md-4"},qe={key:2,class:"col-12 q-mt-md"},Te=(0,a.Lk)("label",null,"Nueva opción de producto",-1),Ce={class:"relative-position q-pa-md"},we={key:0,class:"q-mb-md"},Ae=(0,a.Lk)("div",{class:"input-title"},"Parent",-1),Pe={class:"text-right q-mt-md"};function xe(e,t,i,s,r,d){const n=(0,a.g2)("recursive-options"),m=(0,a.g2)("q-btn"),c=(0,a.g2)("q-icon"),u=(0,a.g2)("q-toggle"),p=(0,a.g2)("tree-select"),h=(0,a.g2)("q-input"),f=(0,a.g2)("crud-option-values"),b=(0,a.g2)("inner-loading"),g=(0,a.g2)("q-toolbar-title"),$=(0,a.g2)("q-toolbar"),v=(0,a.g2)("crud"),V=(0,a.g2)("q-card"),k=(0,a.g2)("q-dialog"),y=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",ae,[(0,a.Lk)("div",oe,[(0,a.Lk)("div",ie,[(0,a.Lk)("div",se,[(0,a.Lk)("div",re,[(0,a.Lk)("div",de,(0,o.v_)(e.$tr("icommerce.cms.productOptions")),1)]),r.productOptions.length?((0,a.uX)(),(0,a.Wv)(n,{key:1,modelValue:r.template.currentOption,"onUpdate:modelValue":[t[0]||(t[0]=e=>r.template.currentOption=e),t[1]||(t[1]=e=>d.setDataOption())],"list-items":r.productOptions,ref:"optionList",onAdd:t[2]||(t[2]=e=>d.addOption(r.template.currentOption)),onDelete:t[3]||(t[3]=e=>d.deleteOption(r.template.currentOption))},null,8,["modelValue","list-items"])):((0,a.uX)(),(0,a.CE)("div",ne,(0,o.v_)(`${e.$tr("icommerce.cms.message.noOptions")}...`),1)),(0,a.Lk)("div",me,[(0,a.bF)(m,{label:e.$tr("isite.cms.label.add"),rounded:"",outline:"",color:"green",onClick:t[4]||(t[4]=e=>r.modal.show=!0)},null,8,["label"])])])]),(0,a.Lk)("div",ce,[null==r.template.currentOption?((0,a.uX)(),(0,a.CE)("div",ue,[(0,a.bF)(c,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.eW)(" "+(0,o.v_)(`${e.$tr("icommerce.cms.message.selectProduct")}...`),1)])):((0,a.uX)(),(0,a.CE)("div",pe,[(0,a.Lk)("div",he,[(0,a.Lk)("div",fe,(0,o.v_)(e.$tr("isite.cms.form.option")),1),(0,a.bF)(c,{color:"primary",name:"fas fa-caret-right"}),(0,a.eW)(" "+(0,o.v_)(d.findOption(r.template.form.id).description),1)]),(0,a.Lk)("div",be,[(0,a.Lk)("div",ge,(0,o.v_)(e.$tr("isite.cms.form.type")),1),(0,a.bF)(c,{color:"primary",name:"fas fa-caret-right"}),(0,a.eW)(" "+(0,o.v_)(d.findOption(r.template.form.id).type),1)]),parseInt(r.template.form.parentId)?((0,a.uX)(),(0,a.CE)("div",$e,[ve,(0,a.bF)(c,{color:"primary",name:"fas fa-caret-right"}),(0,a.eW)(" "+(0,o.v_)(d.findOption(r.template.form.parentId).description),1)])):(0,a.Q3)("",!0),(0,a.Lk)("div",Ve,[(0,a.Lk)("div",ke,(0,o.v_)(e.$tr("isite.cms.form.required")),1),(0,a.bF)(u,{modelValue:r.template.form.required,"onUpdate:modelValue":[t[5]||(t[5]=e=>r.template.form.required=e),t[6]||(t[6]=e=>d.updateProductOption())]},null,8,["modelValue"])]),(0,a.Lk)("div",ye,[d.showFieldForm&&parseInt(r.template.form.parentId)&&r.template.parentValues.length?((0,a.uX)(),(0,a.CE)("div",Fe,[(0,a.Lk)("div",Ie,(0,o.v_)(`${e.$tr("icommerce.cms.form.parentOptionValue")} *`),1),(0,a.bF)(p,{modelValue:r.template.form.parentOptionValueId,"onUpdate:modelValue":[t[7]||(t[7]=e=>r.template.form.parentOptionValueId=e),t[8]||(t[8]=e=>d.updateProductOption())],clearable:!1,options:r.template.parentValues,placeholder:"Select opion value..."},null,8,["modelValue","options"])])):(0,a.Q3)("",!0),d.showFieldForm?((0,a.uX)(),(0,a.CE)("div",Oe,[(0,a.bF)(h,{modelValue:r.template.form.value,"onUpdate:modelValue":t[9]||(t[9]=e=>r.template.form.value=e),label:`${e.$tr("icommerce.cms.form.optionValue")} *`,onBlur:t[10]||(t[10]=e=>d.updateProductOption())},null,8,["modelValue","label"])])):(0,a.Q3)("",!0),d.showFieldForm?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",qe,[(0,a.bF)(f,{"product-option":r.template.form},null,8,["product-option"])]))])]))])]),(0,a.bF)(b,{visible:r.loading},null,8,["visible"]),(0,a.bF)(k,{modelValue:r.modal.show,"onUpdate:modelValue":t[13]||(t[13]=e=>r.modal.show=e),class:"backend-page"},{default:(0,a.k6)((()=>[(0,a.bF)(V,null,{default:(0,a.k6)((()=>[(0,a.bF)($,{class:"bg-primary text-white"},{default:(0,a.k6)((()=>[(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(c,{name:"fa fa-folder",class:"q-mr-sm"}),Te])),_:1}),(0,a.bo)((0,a.bF)(m,{flat:"",icon:"fas fa-times"},null,512),[[y]])])),_:1}),(0,a.Lk)("div",Ce,[r.modal.parentOption?((0,a.uX)(),(0,a.CE)("div",we,[Ae,(0,a.bF)(c,{color:"primary",name:"fas fa-caret-right"}),(0,a.eW)(" "+(0,o.v_)(r.modal.parentOption.description),1)])):(0,a.Q3)("",!0),(0,a.bF)(v,{"crud-data":l.e(7986).then(l.bind(l,97986)),modelValue:r.modal.optionSelected,"onUpdate:modelValue":t[11]||(t[11]=e=>r.modal.optionSelected=e),type:"select",onCreated:d.getOptions,"crud-props":{label:`${e.$tr("isite.cms.form.option")} *`},config:{options:{label:"description",value:"id"}}},null,8,["crud-data","modelValue","onCreated","crud-props"]),(0,a.Lk)("div",Pe,[(0,a.bF)(m,{label:e.$tr("isite.cms.label.save"),color:"green",rounded:"",unelevated:"",onClick:t[12]||(t[12]=e=>d.createProductOption())},null,8,["label"])]),(0,a.bF)(b,{visible:r.modal.loading},null,8,["visible"])])])),_:1})])),_:1},8,["modelValue"])])}function Le(e,t,l,i,s,r){const d=(0,a.g2)("q-radio"),n=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-tooltip"),c=(0,a.g2)("q-btn"),u=(0,a.g2)("recursive-options-list",!0),p=(0,a.g2)("q-expansion-item"),h=(0,a.g2)("draggable"),f=(0,a.g2)("q-list");return s.loading?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(f,{key:0,"no-border":"",separator:"",link:"",id:"listOptionsCommerce",class:"q-pa-none"},{default:(0,a.k6)((()=>[!s.productOptions.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(h,(0,a.v6)({key:0,tag:"div"},r.dragOptions,{list:s.productOptions,group:{name:"g1"},onChange:r.vEmit,"item-key":"id"}),{item:(0,a.k6)((({element:l})=>[(0,a.bF)(p,{"expand-icon-class":"hidden"},{header:(0,a.k6)((()=>[(0,a.bF)(d,{modelValue:s.optionSelected,"onUpdate:modelValue":[t[0]||(t[0]=e=>s.optionSelected=e),t[1]||(t[1]=e=>r.vEmit())],val:l.id},null,8,["modelValue","val"]),(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(l.description),1)])),_:2},1024),(0,a.bF)(n,{side:""},{default:(0,a.k6)((()=>[(0,a.Lk)("div",null,[r.permitChildren(l)?((0,a.uX)(),(0,a.Wv)(c,{key:0,icon:"fas fa-plus",color:"positive",size:"xs",onClick:e=>r.vEmitAddOption(l.id),round:"",outline:""},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(`${e.$tr("isite.cms.label.add")} ${e.$tr("isite.cms.label.option")}`),1)])),_:1})])),_:2},1032,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(c,{icon:"far fa-trash-alt",color:"red",round:"",outline:"",class:"q-ml-xs",size:"xs",onClick:e=>r.vEmitDelete(l.id)},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(`${e.$tr("isite.cms.label.delete")}`),1)])),_:1})])),_:2},1032,["onClick"])])])),_:2},1024)])),default:(0,a.k6)((()=>[l.children?((0,a.uX)(),(0,a.Wv)(u,{key:0,"list-items":l.children,"parent-id":l.id,modelValue:s.optionSelected,"onUpdate:modelValue":[t[2]||(t[2]=e=>s.optionSelected=e),r.vEmit],onAdd:t[3]||(t[3]=e=>r.vEmitAddOption(s.optionSelected)),onDelete:t[4]||(t[4]=e=>r.vEmitDelete(s.optionSelected))},null,8,["list-items","parent-id","modelValue","onUpdate:modelValue"])):(0,a.Q3)("",!0)])),_:2},1024)])),_:1},16,["list","onChange"]))])),_:1}))}var _e=l(10057),Re=l.n(_e);const Ue={name:"recursiveOptionsList",components:{draggable:Re()},props:{listItems:{default:!1},parentId:{default:0},modelValue:{default:null}},emits:["update:modelValue","add","delete"],watch:{listItems(){this.init()},modelValue(){this.optionSelected=this.modelValue}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{loading:!1,productOptions:[],optionSelected:null}},methods:{init(){this.loading=!0,this.productOptions=this.$clone(this.$array.builTree(this.listItems,this.parentId)),this.loading=!1},permitChildren(e){let t=["select","radio"],l=t.indexOf(e.type);return-1!=l},vEmit(){this.$emit("update:modelValue",this.optionSelected)},vEmitAddOption(e){this.optionSelected=e,this.vEmit(),this.$emit("add")},vEmitDelete(e){this.optionSelected=e,this.vEmit(),this.$emit("delete")},vRefresh(){this.init()}},computed:{dragOptions(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}}};var Ee=l(12807),De=l(54514),Qe=l(76986),Se=l(36883),We=l(63418),Xe=l(69001),Ne=l(78151),ze=l(75329),Me=l(98582),Be=l.n(Me);const Ye=(0,Ee.A)(Ue,[["render",Le]]),He=Ye;Be()(Ue,"components",{QList:De.A,QExpansionItem:Qe.A,QRadio:Se.A,QItemSection:We.A,QBtn:Xe.A,QTooltip:Ne.A,QItem:ze.A});const je={id:"crudOptionValues",class:"relative-position backend-page"},Ke={class:"input-title"},Ge={class:"row q-col-gutter-x-md"},Je={class:"col-12 col-md-6"},Ze={class:"input-title relative-position q-mb-md"},et={key:0},tt={class:"input-title"},lt={class:"input-title"},at={class:"col-12 col-md-6"},ot={class:"content-prefix row"},it={class:"input-title col-12"},st={class:"col-2"},rt={class:"col-10 q-pl-sm"},dt={class:"content-prefix row"},nt={class:"input-title col-12"},mt={class:"col-2"},ct={class:"col-10 q-pl-sm"},ut={class:"content-prefix row"},pt={class:"input-title col-12"},ht={class:"col-2"},ft={class:"col-10 q-pl-sm"};function bt(e,t,i,s,r,d){const n=(0,a.g2)("q-btn"),m=(0,a.g2)("q-tooltip"),c=(0,a.g2)("q-td"),u=(0,a.g2)("q-table"),p=(0,a.g2)("q-toolbar-title"),h=(0,a.g2)("q-toolbar"),f=(0,a.g2)("crud"),b=(0,a.g2)("tree-select"),g=(0,a.g2)("q-field"),$=(0,a.g2)("dynamic-field"),v=(0,a.g2)("q-input"),V=(0,a.g2)("inner-loading"),k=(0,a.g2)("q-form"),y=(0,a.g2)("q-card"),F=(0,a.g2)("q-dialog"),I=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",je,[(0,a.bF)(u,{rows:r.table.data,columns:d.columns,"row-key":"name"},{"top-left":(0,a.k6)((()=>[(0,a.Lk)("span",Ke,(0,o.v_)(e.$tr("icommerce.cms.form.productOptionValues")),1)])),"top-right":(0,a.k6)((()=>[(0,a.bF)(n,{icon:"fas fa-edit",color:"green",label:e.$tr("icommerce.cms.newOptionValue"),onClick:t[0]||(t[0]=e=>{r.modal.itemId=!1,r.modal.show=!0}),class:"btn-small",outline:"",rounded:""},null,8,["label"])])),"body-cell-actions":(0,a.k6)((t=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(n,{color:"green",icon:"fas fa-pen",size:"xs",outline:"",round:"",onClick:e=>{r.modal.itemId=t.row.id,d.setItemUpdate()},padding:"sm"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{delay:300},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.$tr("isite.cms.label.edit")),1)])),_:1})])),_:2},1032,["onClick"]),(0,a.bF)(n,{color:"red",icon:"fas fa-trash-alt",size:"xs",class:"q-ml-xs",onClick:e=>d.deleteItem(t.row.id),outline:"",round:"",padding:"sm"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{delay:300},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.$tr("isite.cms.label.delete")),1)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:1},8,["rows","columns"]),r.success?((0,a.uX)(),(0,a.Wv)(F,{key:0,id:"formCategory",class:"modal-form",modelValue:r.modal.show,"onUpdate:modelValue":t[18]||(t[18]=e=>r.modal.show=e),"no-esc-dismiss":"","no-backdrop-dismiss":""},{default:(0,a.k6)((()=>[(0,a.bF)(y,{style:{"max-width":"1245px"},class:"bg-white backend-page"},{default:(0,a.k6)((()=>[(0,a.bF)(h,{class:"bg-primary text-white"},{default:(0,a.k6)((()=>[r.modal.itemId?((0,a.uX)(),(0,a.Wv)(p,{key:1},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(`${e.$tr("icommerce.cms.updateProductOptionValue")} ID: ${r.modal.itemId}`),1)])),_:1})):((0,a.uX)(),(0,a.Wv)(p,{key:0},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.$tr("icommerce.cms.newProductOptionValue")),1)])),_:1})),(0,a.bo)((0,a.bF)(n,{flat:"",icon:"fas fa-times"},null,512),[[I]])])),_:1}),(0,a.bF)(k,{onSubmit:t[14]||(t[14]=e=>r.modal.itemId?d.updateItem():d.createItem()),ref:"formContent",onValidationError:t[15]||(t[15]=t=>e.$alert.error(e.$tr("isite.cms.message.formInvalid"))),class:"q-pa-md",autocomplete:"off"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",Ge,[(0,a.Lk)("div",Je,[(0,a.Lk)("div",Ze,[(0,a.eW)((0,o.v_)(`${e.$tr("icommerce.cms.form.optionValue")} *`)+" ",1),(0,a.bF)(f,{"crud-data":l.e(5384).then(l.bind(l,5384)),type:"button-create",onCreated:d.getOptionValues,class:"absolute-right","custom-data":{read:{requestParams:{filter:{optionId:r.form.optionId}}},formLeft:{optionId:{value:r.form.optionId}}}},null,8,["crud-data","onCreated","custom-data"])]),(0,a.bF)(g,{modelValue:r.form.optionValueId,"onUpdate:modelValue":t[2]||(t[2]=e=>r.form.optionValueId=e),borderless:"",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},{default:(0,a.k6)((()=>[(0,a.bF)(b,{clearable:!1,options:r.options.values,"value-consists-of":"BRANCH_PRIORITY",modelValue:r.form.optionValueId,"onUpdate:modelValue":t[1]||(t[1]=e=>r.form.optionValueId=e),placeholder:""},null,8,["options","modelValue"])])),_:1},8,["modelValue","rules"]),r.options.parentValues.length?((0,a.uX)(),(0,a.CE)("div",et,[(0,a.bF)($,{modelValue:r.form.parentOptionValueId,"onUpdate:modelValue":t[3]||(t[3]=e=>r.form.parentOptionValueId=e),field:{type:"select",required:!0,props:{label:`${e.$tr("icommerce.cms.form.parentOptionValue")} *`,options:r.options.parentValues}}},null,8,["modelValue","field"])])):(0,a.Q3)("",!0),(0,a.bF)(v,{modelValue:r.form.quantity,"onUpdate:modelValue":t[4]||(t[4]=e=>r.form.quantity=e),type:"number",outlined:"",dense:"",label:`${e.$tr("isite.cms.form.quantity")} *`,rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","label","rules"]),(0,a.Lk)("div",tt,(0,o.v_)(e.$tr("isite.cms.form.stock")),1),(0,a.bF)(b,{modelValue:r.form.stockStatus,"onUpdate:modelValue":t[5]||(t[5]=e=>r.form.stockStatus=e),options:[{label:this.$tr("isite.cms.label.available"),id:1},{label:this.$tr("isite.cms.label.soldOut"),id:0}],"data-testid":"stockStatus",clearable:!1,"value-consists-of":"BRANCH_PRIORITY",class:"q-mb-md"},null,8,["modelValue","options"]),(0,a.Lk)("div",lt,(0,o.v_)(`${e.$tr("icommerce.cms.form.subtractFromStock")}`),1),(0,a.bF)(g,{modelValue:r.form.subtract,"onUpdate:modelValue":t[7]||(t[7]=e=>r.form.subtract=e),borderless:""},{default:(0,a.k6)((()=>[(0,a.bF)(b,{clearable:!1,options:r.options.subtract,"value-consists-of":"BRANCH_PRIORITY",modelValue:r.form.subtract,"onUpdate:modelValue":t[6]||(t[6]=e=>r.form.subtract=e),placeholder:"",class:"q-mb-md"},null,8,["options","modelValue"])])),_:1},8,["modelValue"])]),(0,a.Lk)("div",at,[(0,a.Lk)("div",ot,[(0,a.Lk)("div",it,(0,o.v_)(`${e.$tr("isite.cms.form.price")} *`),1),(0,a.Lk)("div",st,[(0,a.bF)(b,{clearable:!1,options:r.options.prefix,modelValue:r.form.pricePrefix,"onUpdate:modelValue":t[8]||(t[8]=e=>r.form.pricePrefix=e),placeholder:""},null,8,["options","modelValue"])]),(0,a.Lk)("div",rt,[(0,a.bF)(v,{modelValue:r.form.price,"onUpdate:modelValue":t[9]||(t[9]=e=>r.form.price=e),style:{padding:"0px"},outlined:"",dense:"",type:"number",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","rules"])])]),(0,a.Lk)("div",dt,[(0,a.Lk)("div",nt,(0,o.v_)(`${e.$trp("isite.cms.form.point")} *`),1),(0,a.Lk)("div",mt,[(0,a.bF)(b,{clearable:!1,options:r.options.prefix,modelValue:r.form.pointsPrefix,"onUpdate:modelValue":t[10]||(t[10]=e=>r.form.pointsPrefix=e),placeholder:""},null,8,["options","modelValue"])]),(0,a.Lk)("div",ct,[(0,a.bF)(v,{modelValue:r.form.points,"onUpdate:modelValue":t[11]||(t[11]=e=>r.form.points=e),style:{padding:"0px"},outlined:"",dense:"",type:"number",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","rules"])])]),(0,a.Lk)("div",ut,[(0,a.Lk)("div",pt,(0,o.v_)(`${e.$tr("isite.cms.form.weight")} *`),1),(0,a.Lk)("div",ht,[(0,a.bF)(b,{clearable:!1,options:r.options.prefix,modelValue:r.form.weightPrefix,"onUpdate:modelValue":t[12]||(t[12]=e=>r.form.weightPrefix=e),placeholder:""},null,8,["options","modelValue"])]),(0,a.Lk)("div",ft,[(0,a.bF)(v,{modelValue:r.form.weight,"onUpdate:modelValue":t[13]||(t[13]=e=>r.form.weight=e),style:{padding:"0px"},outlined:"",dense:"",type:"number",rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","rules"])])])])]),(0,a.bF)(V,{visible:r.loading},null,8,["visible"])])),_:1},512),(0,a.bF)(h,{class:"bg-white"},{default:(0,a.k6)((()=>[(0,a.bF)(p),r.modal.itemId?((0,a.uX)(),(0,a.Wv)(n,{key:1,label:e.$tr("isite.cms.label.update"),icon:"fas fa-pen",color:"green",loading:r.loading,onClick:t[17]||(t[17]=t=>e.$refs.formContent.submit())},null,8,["label","loading"])):((0,a.uX)(),(0,a.Wv)(n,{key:0,icon:"fas fa-save",color:"green",label:e.$tr("isite.cms.label.save"),loading:r.loading,onClick:t[16]||(t[16]=t=>e.$refs.formContent.submit())},null,8,["label","loading"]))])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,a.Q3)("",!0),(0,a.bF)(V,{visible:r.loading},null,8,["visible"])])}const gt={props:{productOption:{defalt:!1}},watch:{productOption:{deep:!0,handler:function(e){this.initForm()}},"modal.itemId":{deep:!0,handler:function(e){e||this.resetform()}}},mounted(){this.$nextTick((function(){this.initForm()}))},data(){return{loading:!1,success:!1,optionId:null,table:{data:[]},modal:{show:!1,itemId:!1,formOptionValue:!1},form:{},options:{}}},computed:{dataForm(){return{productOptionId:null,productId:null,optionId:null,optionValueId:null,parentOptionValueId:null,quantity:null,stockStatus:1,subtract:1,price:null,pricePrefix:"+",points:null,pointsPrefix:"+",weight:null,weightPrefix:"+"}},dataOptions(){return{values:[],parentValues:[],subtract:[{label:this.$tr("isite.cms.label.yes"),id:1},{label:this.$tr("isite.cms.label.no"),id:0}],prefix:[{label:"+",id:"+"},{label:"-",id:"-"}]}},columns(){return[{name:"id",label:this.$tr("isite.cms.form.id"),field:"id"},{name:"optionValue",label:this.$tr("icommerce.cms.form.optionValue"),field:"optionValue",align:"left"},{name:"parentOptionValue",label:this.$tr("icommerce.cms.form.parentOptionValue"),field:"parentOptionValue",align:"left"},{name:"quantity",label:this.$tr("isite.cms.form.quantity"),field:"quantity"},{name:"price",label:this.$tr("isite.cms.form.price"),field:"price"},{name:"points",label:this.$trp("isite.cms.form.point"),field:"points"},{name:"weight",label:this.$trp("isite.cms.form.weight"),field:"weight"},{name:"actions",label:this.$trp("isite.cms.form.actions")}]}},methods:{async initForm(){this.loading=!0,this.success=!1,this.modal.show=!1,await this.resetform(),await this.getData(),this.success=!0,this.loading=!1},async resetform(){this.form=this.$clone(this.dataForm),this.options=this.$clone(this.dataOptions),this.productOption&&(this.form.productOptionId=this.productOption.id,this.form.productId=this.productOption.productId,this.form.optionId=this.productOption.optionId),this.getOptionValues()},getData(){return new Promise(((e,t)=>{let l="apiRoutes.qcommerce.productOptionValues",a={refresh:!0,params:{include:"",filter:{productOptionId:this.productOption.id}}};this.$crud.index(l,a).then((t=>{this.table.data=t.data,e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),this.loading=!1,t(e)}))}))}))},createItem(){let e=this.$clone(this.form);if(e.parentOptionValueId){let t=this.options.parentValuesData.find((t=>t.optionValueId==e.parentOptionValueId));e.parentProdOptValId=t.id}this.loading=!0;let t="apiRoutes.qcommerce.productOptionValues";this.$crud.create(t,e).then((e=>{this.$alert.success({message:this.$tr("isite.cms.message.recordCreated")}),this.initForm(),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoCreated")}),this.loading=!1}))},updateItem(){this.loading=!0;let e="apiRoutes.qcommerce.productOptionValues";this.$crud.update(e,this.modal.itemId,this.form).then((e=>{this.$alert.success({message:this.$tr("isite.cms.message.recordUpdated")}),this.initForm(),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated")}),this.loading=!1}))},deleteItem(e){this.loading=!0;let t="apiRoutes.qcommerce.productOptionValues";this.$crud.delete(t,e).then((e=>{this.$alert.success({message:this.$tr("isite.cms.message.recordDeleted")}),this.initForm(),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoDeleted")}),this.loading=!1}))},setItemUpdate(){const e=this.$clone(this.modal.itemId),t=this.table.data.find((t=>t.id==e));this.form=Object.assign({},this.form,t),this.modal.show=!0},async getOptionValues(){this.loading=!0,await Promise.all([new Promise(((e,t)=>{this.options.values=[];let l={refresh:!0,params:{filter:{optionId:this.productOption.optionId}}};this.$crud.index("apiRoutes.qcommerce.optionValues",l).then((t=>{this.options.values=t.data.map((e=>({label:e.description,id:e.id}))),e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{t(e)}))}))})),new Promise(((e,t)=>{if(this.options.parentValues=[],this.options.parentValuesData=[],!this.productOption.parentOptionId)return e(!0);let l={refresh:!0,params:{filter:{productOptionId:this.productOption.parentId}}};this.$crud.index("apiRoutes.qcommerce.productOptionValues",l).then((t=>{this.options.parentValuesData=this.$clone(t.data),this.options.parentValues=t.data.map((e=>({label:e.optionValue,value:e.optionValueId}))),e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{t(e)}))}))}))]),this.loading=!1}}};var $t=l(18383),vt=l(77109),Vt=l(57201),kt=l(97569),yt=l(79351),Ft=l(56769),It=l(21565),Ot=l(51225),qt=l(78020),Tt=l(62769);const Ct=(0,Ee.A)(gt,[["render",bt]]),wt=Ct;Be()(gt,"components",{QTable:$t.A,QBtn:Xe.A,QTd:vt.A,QTooltip:Ne.A,QDialog:Vt.A,QCard:kt.A,QToolbar:yt.A,QToolbarTitle:Ft.A,QForm:It.A,QField:Ot.A,QInput:qt.A}),Be()(gt,"directives",{ClosePopup:Tt.A});const At={props:{productId:{default:!1}},components:{recursiveOptions:He,crudOptionValues:wt},watch:{},mounted(){this.$nextTick((function(){this.init()}))},data(){return{loading:!1,loadingOptions:!1,modal:{show:!1,optionData:!1,parentOption:0,optionSelected:null,loading:!1,formOption:!1},productOptions:[],productOptionsRoot:[],productOptionValues:[],template:{optionSelected:null,parentOptions:[],currentOption:null,options:[],form:{},values:[],parentValues:[]}}},computed:{showFieldForm(){let e=["text","textarea"],t=e.indexOf(this.template.form.type);return-1!=t}},methods:{async init(){this.loading=!0,await this.getData(),this.getOptions(),this.loading=!1},getData(){return new Promise(((e,t)=>{this.loading=!0;let l="apiRoutes.qcommerce.products",a={refresh:!0,params:{include:"productOptions",fields:"id"}};this.$crud.show(l,this.productId,a).then((t=>{this.productOptions=this.$clone(this.arrayToTree(t.data.productOptions)),this.productOptionsRoot=this.$clone(t.data.productOptions),this.productOptionsRoot.forEach((e=>{e.hasOwnProperty("required")||(e.required=!1)})),this.productOptionValues=this.$clone(t.data.optionValues),this.loading=!1,e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),t(!1)}))}))}))},getOptionValues(e,t="values"){this.loading=!0;let l="apiRoutes.qcommerce.optionValues",a={params:{filter:{optionId:e}}};this.$crud.index(l,a).then((e=>{this.template[t]=[],e.data.forEach((e=>{this.template[t].push({label:e.description,id:e.id})})),this.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),this.loading=!1}))}))},addOption(e=!1){this.modal.parentOption=e?this.findOption(e):0,this.modal.show=!0},createProductOption(){if(this.modal.optionSelected){this.modal.loading=!0;let e="apiRoutes.qcommerce.productOptions",t={productId:this.productId,optionId:this.$clone(this.modal.optionSelected.toString()),parentId:this.modal.parentOption.id||0,required:0};this.$crud.create(e,t).then((async e=>{for(var t of(this.$alert.success({message:this.$tr("isite.cms.message.recordCreated")}),await this.getData(),this.modal.optionSelected=null,this.productOptions)){let e=this.$clone(this.template.currentOption);t.id>=e&&(this.template.currentOption=t.id)}this.setDataOption(),this.$refs.optionList.vRefresh(),this.modal.loading=!1,this.modal.show=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoCreated")}),this.modal.show=!1,this.modal.loading=!1,this.modal.optionSelected=null}))}},updateProductOption(){this.loading=!0;let e="apiRoutes.qcommerce.productOptions",t=this.$clone(this.template.form);t.parentId||(t.parentId=0),t.parentOptionValueId||(t.parentOptionValueId=null),this.productOptionsRoot.find((e=>{e.id==this.template.currentOption&&void 0!=this.template.form?.required&&(e.required=this.template.form.required)})),this.$crud.update(e,t.id,t).then((e=>{this.$alert.success({message:this.$tr("isite.cms.message.recordUpdated")}),this.setDataOption(),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated")}),this.loading=!1}))},deleteOption(e){if(this.checkToDeleteOption(e)){const t=this.findOption(e);this.$q.dialog({title:t.keyDescription,preventClose:!0,message:this.$tr("isite.cms.message.deleteRecord"),color:"red",ok:this.$tr("isite.cms.label.delete"),cancel:this.$tr("isite.cms.label.cancel")}).onOk((t=>{this.loading=!0;let l="apiRoutes.qcommerce.productOptions";this.$crud.delete(l,e,{params:{}}).then((async e=>{this.template.currentOption=null,this.$alert.success({message:this.$tr("isite.cms.message.recordDeleted")}),await this.getData(),this.$refs.optionList.vRefresh(),this.loading=!1})).catch((e=>{this.$alert.error({message:this.$tr("isite.cms.message.recordNoDeleted")}),this.loading=!1}))})).onCancel((e=>{}))}},checkToDeleteOption(e){const t=this.$clone(this.template.currentOption);this.template.currentOption=e,t!=e&&this.setDataOption();const l=this.findOption(e,"parentId");if(!l)return!0;this.$q.dialog({message:this.$tr("icommerce.cms.message.noDeleteOption",{name:l.keyDescription}),title:this.$tr("isite.cms.label.warning"),color:"red"}).then((e=>!1)).catch((e=>{}))},setDataOption(){const e=this.$clone(this.template.currentOption),t=this.$clone(this.template.form);if(t.id)for(var l in this.productOptions)this.productOptions[l].id==t.id&&(this.productOptions[l]=t);if(e){this.setParentOptions();const t=this.findOption(e);this.template.form=this.$clone(t),this.getOptionValues(t.optionId),this.setParentValues()}this.$refs.optionList.vRefresh(),this.updateOrder()},setParentOptions(){this.template.parentOptions=[];const e=this.$clone(this.template.currentOption);this.productOptions.forEach(((t,l)=>{t.id!=e&&this.template.parentOptions.push({label:t.description,id:t.id})}))},setParentValues(){const e=this.$clone(this.template.form.parentId);if(e){const t=this.findOption(e);this.template.form.parentOptionId=t.optionId,this.getOptionValues(t.optionId,"parentValues")}else this.template.form.parentOptionId=null,this.template.parentValues=[],this.template.form.parentOptionValueId=null},getOptions(){this.loadingOptions=!0;let e="apiRoutes.qcommerce.options",t={refresh:!0,params:{}};this.$crud.index(e,t).then((e=>{let t=[];e.data.forEach((e=>{t.push({label:e.description,id:e.id})})),this.template.options=this.$clone(t),this.loadingOptions=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),this.loading=!1}))}))},findOption(e,t="id"){const l=this.$clone(this.productOptionsRoot);let a=!1,o=l.findIndex((l=>l[t]==e));return o>=0&&(a=l[o],a.keyDescription=o+1+"."+l[o].description),a},updateOrder(){return!1},arrayToTree(e,t=0){return e.filter((l=>{if((l.parentId||0)==t)return l["children"]=this.arrayToTree(e,l.id)}))},treeToArray(e,t,l=null){let a=[...e];a.forEach(((e,a)=>{e.position=a,e.parentId=l,t.push(e),e.children.length&&this.treeToArray(e.children,t,e.id)}))}}};var Pt=l(24609),xt=l(90449);const Lt=(0,Ee.A)(At,[["render",xe]]),_t=Lt;Be()(At,"components",{QBtn:Xe.A,QIcon:Pt.A,QToggle:xt.A,QInput:qt.A,QDialog:Vt.A,QCard:kt.A,QToolbar:yt.A,QToolbarTitle:Ft.A}),Be()(At,"directives",{ClosePopup:Tt.A});var Rt=l(65439),Ut=l(85401);const{hD:Et,setScrollPosition:Dt}=Ut.Ay,Qt={components:{crudOptions:_t,recursiveList:le.A,ckEditor:Rt.A},watch:{$route(e,t){this.initForm()},"locale.formTemplate.categoryId"(e){setTimeout((()=>{if(this.locale.formTemplate&&this.locale.formTemplate.categories&&e){let t=this.$clone(this.locale.formTemplate.categories);-1==t.indexOf(e.toString())&&-1==t.indexOf(e)&&t.push(this.$clone(e)),this.locale.formTemplate.categories=this.$clone(t)}}),500)},"locale.formTemplate.slug"(e){if(e){let t=this.$clone(this.$helper.getSlug(e));e!=t&&(this.locale.formTemplate.slug=this.$clone(t))}}},mounted(){this.$nextTick((function(){this.initForm();const e=this.$route.path.split("/"),t=e[e.length-2];"create"===t&&(this.isCreateMode=!0)}))},data(){return{isCreateMode:!1,locale:{},vTab:"tab-data",loading:!1,loadingCategory:!1,success:!1,productId:!1,editorText:{toolbar:[["bold","italic","strike","underline","removeFormat"],["link"],[{label:"Font Size",icon:"format_size",fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]}],["quote","unordered","ordered"],["fullscreen"]]},optionsTemplate:{categories:[],products:[],relatedProducts:[]},buttonActions:{label:"",value:1},modalShow:{category:!1},extraFields:[],modalForms:{content:{show:!1,type:"content",title:this.$tr("icommerce.cms.form.content"),content:this.$tr("icommerce.cms.form.formContent")},status:{show:!1,type:"status",title:this.$tr("icommerce.cms.form.status"),content:this.$tr("icommerce.cms.form.statusContent")},categories:{show:!1,type:"categories",title:this.$tr("icommerce.cms.form.categories"),content:this.$tr("icommerce.cms.form.categoriesContent")},metaInfo:{show:!1,type:"metaInfo",title:this.$tr("icommerce.cms.form.metaInfo"),content:this.$tr("icommerce.cms.form.metaInfoContent")},data:{show:!1,type:"data",title:this.$tr("icommerce.cms.form.data"),content:this.$tr("icommerce.cms.form.dataContent")},relations:{show:!1,type:"relations",title:this.$tr("icommerce.cms.form.link"),content:this.$tr("icommerce.cms.form.relationsContent")},images:{show:!1,type:"images",title:this.$tr("icommerce.cms.form.images"),content:this.$tr("icommerce.cms.form.imagesContent")},options:{show:!1,type:"options",title:this.$tr("icommerce.cms.form.options"),content:this.$tr("icommerce.cms.form.optionsContent")},discount:{show:!1,type:"discount",title:this.$tr("icommerce.cms.form.discount"),content:this.$tr("icommerce.cms.form.discountContent")},productWarehouse:{show:!1,type:"productWarehouse",title:this.$tr("icommerce.cms.form.productWarehouse"),content:this.$tr("icommerce.cms.form.productWarehouseContent"),vIf:this.$getSetting("icommerce::warehouseFunctionability")},priceList:{show:!1,type:"priceList",title:this.$tr("icommerce.cms.form.priceLists"),content:this.$tr("icommercepricelist.cms.form.productPriceListContent"),vIf:!!this.$hasAccess("icommercepricelist.productlist.manage")},home:{show:!1,type:"home",title:"",content:""}},lastPanelOpen:"home"}},computed:{modalTemplatesAttributes(){return{customPosition:!0,title:`${this.modalForms[this.lastPanelOpen].title}`,actions:[{props:{label:this.$tr("isite.cms.label.close"),color:"green",rounded:!0,icon:"fal fa-fill-drip"},action:()=>{this.modalForms[this.lastPanelOpen].show=!1}}]}},pageTitle(){return this.$tr(this.$route.meta.title)},dataLocale(){return{fields:{parentId:"",status:1,categoryId:0,categories:[],addedById:this.$store.state.quserAuth.userId,sku:0,quantity:1,stockStatus:1,price:0,dateAvailable:null,weight:0,length:0,width:0,height:0,volume:0,minimum:1,reference:"",shipping:!1,showPriceIsCall:!1,subtract:!1,freeshipping:!1,orderWeight:0,rating:3,points:0,relatedProducts:[],tags:[],productOptions:[],discounts:[],mediasSingle:{},mediasMulti:{},options:{masterRecord:0,video:null},taxClassId:null,weightClassId:null,lengthClassId:null,volumeClassId:null,quantityClassId:null,manufacturerId:null,metaTitle:"",metaDescription:"",featured:"0",isCall:"0",sortOrder:"0",itemTypeId:1,customUrl:""},fieldsTranslatable:{name:"",slug:"",summary:"",description:"",metaTitle:"",metaDescription:"",advancedSummary:""}}},updateOptions(){this.$route.params.editOptions&&setTimeout((()=>{this.vTab="tab-options";let e=Et(this.$refs.productFormPage),t=this.$refs.productFormPage.scrollHeight;Dt(e,t,1e3)}),500)},options(){return{status:[{label:this.$tr("isite.cms.label.enabled"),value:1},{label:this.$tr("isite.cms.label.disabled"),value:0}],btn:{saveAndReturn:this.$tr("isite.cms.message.saveAndReturn"),saveAndEdit:this.$tr("isite.cms.message.saveAndEdit"),saveAndCreate:this.$tr("isite.cms.message.saveAndCreate")}}},canManageRecordMaster(){let e=!0;if(this.productId&&!this.$hasAccess("isite.master.records.edit")){e=!1;let t=this.locale.formTemplate;t&&t.options&&parseInt(t.options.masterRecord)&&this.$router.push({name:"app.home"})}return this.productId||this.$hasAccess("isite.master.records.create")||(e=!1),e},dynamicFields(){return{quantity:{value:0,type:"input",help:this.settings.isWarehouseEnable?{description:this.$tr("icommerce.cms.fieldEditableOnlyWarehouse")}:{},props:{outlined:!0,dense:!0,label:this.$tr("isite.cms.form.quantity"),type:"number",readonly:this.settings.isWarehouseEnable}},discounts:{value:null,type:"select",testId:"discounts",props:{label:this.$tr("icommerce.cms.form.discount")+"*",rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")],clearable:!0,multiple:!0},loadOptions:{apiRoute:"apiRoutes.qdiscountable.discounts",select:{label:"name",id:"id"}}},tags:{value:[],type:"select",props:{label:this.$trp("isite.cms.form.tag"),useInput:!0,useChips:!0,multiple:!0,hideDropdownIcon:!0,inputDebounce:"0",newValueMode:"add-unique"}},categoryId:{value:null,type:"crud",props:{crudType:"select",crudData:l.e(1047).then(l.bind(l,61047)),customData:{read:{requestParams:{include:"parent",refresh:!0}}},crudProps:{label:`${this.$tr("isite.cms.form.category")}*`,rules:[e=>!!e||this.$tr("isite.cms.message.fieldRequired")]},config:{filterByQuery:!0,options:{id:"id",label:"title",sublabel:e=>e.parent?.title||null}}}},categories:{value:[],type:"crud",props:{crudType:"select",crudData:l.e(1047).then(l.bind(l,61047)),customData:{read:{requestParams:{include:"parent",refresh:!0}}},crudProps:{label:this.$trp("isite.cms.form.category")+"*",multiple:!0,useChips:!0,rules:[e=>e.length||this.$tr("isite.cms.message.fieldRequired")]},config:{filterByQuery:!0,options:{id:"id",label:"title",sublabel:e=>e.parent?.title||null}}}},quantityClassId:{value:null,type:"crud",props:{crudType:"select",crudData:l.e(7876).then(l.bind(l,27876)),crudProps:{label:`${this.$tr("icommerce.cms.sidebar.quantityClasses")}`}}},weightClassId:{value:null,type:"crud",props:{crudType:"select",crudData:l.e(3768).then(l.bind(l,63768)),crudProps:{label:`${this.$tr("icommerce.cms.sidebar.weightClasses")}`}}},lengthClassId:{value:null,type:"crud",props:{crudType:"select",crudData:l.e(7922).then(l.bind(l,67922)),crudProps:{label:`${this.$tr("icommerce.cms.sidebar.lengthClasses")}`}}},volumeClassId:{value:null,type:"crud",props:{crudType:"select",crudData:l.e(9034).then(l.bind(l,59034)),crudProps:{label:`${this.$tr("icommerce.cms.sidebar.volumeClasses")}`}}},mainImage:{type:"media",props:{label:this.$tr("isite.cms.form.image"),zone:"mainimage",entity:"Modules\\Icommerce\\Entities\\Product",entityId:this.productId?this.productId:null}},gallery:{type:"media",props:{label:this.$tr("isite.cms.form.gallery"),zone:"gallery",entity:"Modules\\Icommerce\\Entities\\Product",entityId:this.productId?this.productId:null}},sizereference:{type:"media",props:{label:this.$tr("icommerce.cms.label.dataSheet"),zone:"sizereference",entity:"Modules\\Icommerce\\Entities\\Product",entityId:this.productId?this.productId:null}},dateAvailable:{value:this.$moment().format("YYYY/MM/DD"),type:"date",props:{label:this.$tr("icommerce.cms.form.availableDate")}},advancedSummary:{value:"",type:"html",isTranslatable:!0,help:{description:this.$tr("icommerce.cms.form.advancedSummaryHelp")},props:{label:`${this.$tr("icommerce.cms.advancedSummary")}`}},stockStatus:{type:"select",props:{label:this.$tr("isite.cms.form.stock"),clearable:!1,options:[{label:this.$tr("isite.cms.label.available"),value:1},{label:this.$tr("isite.cms.label.soldOut"),value:0}]}},masterRecord:{type:"select",props:{label:this.$tr("isite.cms.form.masterRecord"),clearable:!1,options:[{label:this.$tr("isite.cms.label.yes"),value:1},{label:this.$tr("isite.cms.label.no"),value:0}]}},relatedProducts:{type:"select",props:{label:this.$tr("icommerce.cms.form.relatedProducts"),useInput:!0,useChips:!0,multiple:!0},loadOptions:{apiRoute:"apiRoutes.qcommerce.products",filterByQuery:!0,select:{label:"name",id:"id"}}}}},customCrudData(){return{productWarehouse:{read:{title:this.$tr("icommerce.cms.form.generalWarehouse"),excludeActions:["sync","recommendations"],requestParams:{include:"product,warehouse",filter:{productId:this.productId}}},formLeft:{productId:{value:this.productId,type:"select",required:!0,props:{label:`${this.$tr("isite.cms.form.product")}*`,readonly:!0},loadOptions:{apiRoute:"apiRoutes.qcommerce.products",select:{label:"name",id:"id"}}}}},productOptValueWarehouse:{read:{title:this.$tr("icommerce.cms.form.warehouseByOptions"),excludeActions:["sync","recommendations"],requestParams:{include:"warehouse,productOptionValue.option,productOptionValue.optionValue",filter:{include:"product,warehouse",productId:this.productId}}},formLeft:{productId:{value:this.productId,type:"select",required:!0,props:{label:`${this.$tr("isite.cms.form.product")}*`,readonly:!0},loadOptions:{apiRoute:"apiRoutes.qcommerce.products",select:{label:"name",id:"id"}}}}},productPriceList:{read:{title:this.$tr("icommerce.cms.form.priceLists"),excludeActions:["sync","recommendations"],requestParams:{include:"product,priceList",filter:{productId:this.productId}}},formLeft:{productId:{value:this.productId,type:"select",required:!0,props:{label:`${this.$tr("isite.cms.form.product")}*`,readonly:!0},loadOptions:{apiRoute:"apiRoutes.qcommerce.products",select:{label:"name",id:"id"}}},productPrice:{value:this.locale.formTemplate.price,type:"input",fakeFieldName:"product",props:{label:`${this.$tr("isite.cms.form.product")}*`,vIf:!1}}}}}},settings(){return{isWarehouseEnable:"1"==this.$getSetting("icommerce::warehouseFunctionality")}}},methods:{validateFieldsHomeTab(){const e=this.locale.formTemplate;let t=null,l=!0;if(["name","slug","summary","description"].forEach((a=>{e[a]&&e[a].length||(l=!1,t="content")})),e.categoryId&&e.categories.length||(l=!1,t="categories"),l)return l;this.showNewForm(t),setTimeout((()=>this.$refs.localeComponent.validateForm()),800)},async backHomePanel(){await this.$refs.localeComponent.validateForm()&&(this.lastPanelOpen="home")},showNewForm(e){this.lastPanelOpen=e,this.modalForms[e].show=!0},async initForm(){this.loading=!0,this.success=!1,this.vTab="tab-data",this.buttonActions={label:this.options.btn.saveAndReturn,value:1},await this.orderFields(),this.productId=this.$route.params.id,this.locale.success&&this.$refs.localeComponent.vReset(),await this.getData(),this.success=!0,this.updateOptions,this.loading=!1},getCategories(){return new Promise(((e,t)=>{this.loadingCategory=!0;let l="apiRoutes.qcommerce.categories",a={refresh:!0,params:{include:"parent"}};this.$crud.index(l,a).then((t=>{this.optionsTemplate.categories=this.$array.tree(t.data),this.loadingCategory=!1,e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),this.loadingCategory=!1,t(!0)}))}))}))},getData(){return new Promise(((e,t)=>{const l=this.$clone(this.productId);if(l){let a="apiRoutes.qcommerce.products",o={refresh:!0,params:{include:"relatedProducts,categories,category,parent,discounts,manufacturer",filter:{allTranslations:!0}}};this.$crud.show(a,l,o).then((t=>{this.orderDataItemToLocale(t.data),e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),console.error(e),this.loading=!1,t(!1)}))}))}else e(!0)}))},orderDataItemToLocale(e){let t=this.$clone(e);e.parent&&(this.optionsTemplate.products=this.$array.tree([e.parent],{label:"name",id:"id"})),t.categories.forEach(((e,l)=>{t.categories[l]=e.id})),t.relatedProducts.forEach(((e,l)=>{t.relatedProducts[l]=e.id})),e.relatedProducts&&e.relatedProducts.length&&(this.optionsTemplate.relatedProducts=this.$array.tree(e.relatedProducts,{label:"name",id:"id"})),this.locale.form=this.$clone({...t,dateAvailable:t.dateAvailable?t.dateAvailable.replaceAll("-","/"):this.$moment().format("YYYY/MM/DD")}),setTimeout((()=>{}),3e3)},async createItem(){if(this.validateFieldsHomeTab()){this.loading=!0;let e="apiRoutes.qcommerce.products";this.$crud.create(e,this.getDataForm()).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordCreated")} ID: ${e.data.id}`}),this.actionAfterCreated(e.data.id)})).catch((e=>{this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.recordNoCreated"),pos:"bottom"})}))}},async updateItem(){if(this.validateFieldsHomeTab()){this.loading=!0;let e="apiRoutes.qcommerce.products",t={...this.getDataForm(),id:this.productId};this.$crud.update(e,this.productId,t).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordUpdated")}`}),this.$router.push({name:"qcommerce.admin.products.index"}),this.initForm()})).catch((e=>{this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated"),pos:"bottom"})}))}},getDataForm(){let e=this.$clone(this.locale.form);for(var t in e){let l=e[t];null!=l&&void 0!=l||delete e[t]}return delete e.productOptions,{...e,manufacturerId:this.locale.form.manufacturerId||null}},actionAfterCreated(e){setTimeout((()=>{let t=this.buttonActions.value;switch(t){case 1:this.$router.push({name:"qcommerce.admin.products.index"});break;case 2:this.$router.push({name:"qcommerce.admin.products.edit",params:{id:e}}),this.loading=!1;break;case 3:this.$refs.localeComponent.vReset(),this.loading=!1;break;case 4:this.$router.push({name:"qcommerce.admin.products.edit",params:{id:e,editOptions:1}}),this.loading=!1;break}}),2e3)},setSlug(){if(!this.productId){let e=this.$clone(this.locale.formTemplate.name);this.locale.formTemplate.slug=this.$clone(this.$helper.getSlug(e))}},getExtraFields(){return new Promise(((e,t)=>{let l={refresh:!0,params:{filter:{configName:"icommerce.crud-fields.products"}}};this.$crud.index("apiRoutes.qsite.configs",l).then((t=>{t.data&&Object.keys(t.data).length&&(this.extraFields=this.$clone(t.data)),e(t.data)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{t(e)}))}))}))},orderFields(){return new Promise((async e=>{let t=this.$clone(this.dataLocale);return await this.getExtraFields(),Object.keys(this.extraFields).forEach((e=>{let l=this.extraFields[e];l.permission&&!this.$hasAccess(l.permission)||(l.isTranslatable?t.fieldsTranslatable[l.name||e]=l.value:l.isFakeField?t.fields.options[l.name||e]=l.value:l.fakeFieldName?(t.fields[l.fakeFieldName]||(t.fields[l.fakeFieldName]={}),t.fields[l.fakeFieldName][l.name||e]=l.value):t.fields[l.name||e]=l.value)})),this.locale=this.$clone(t),e(!0)}))},getDataProduct(){this.loading=!0;const e=this.$clone(this.productId);if(e){let t="apiRoutes.qcommerce.products",l={refresh:!0};this.$crud.show(t,e,l).then((e=>{this.locale.formTemplate.quantity=e.data.quantity,this.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest"),pos:"bottom"}),console.error(e),this.loading=!1}))}))}else this.loading=!1}}};var St=l(37015),Wt=l(64082),Xt=l(63815),Nt=l(94192),zt=l(833),Mt=l(27066),Bt=l(74434);const Yt=(0,Ee.A)(Qt,[["render",te]]),Ht=Yt;Be()(Qt,"components",{QForm:It.A,QIcon:Pt.A,QSeparator:St.A,QTabPanels:Wt.A,QTabPanel:Xt.A,QInput:qt.A,QField:Ot.A,QEditor:Nt.A,QSelect:zt.A,QToggle:xt.A,QCard:kt.A,QCardSection:Mt.A,QBtn:Xe.A,QBtnDropdown:Bt.A,QList:De.A,QItem:ze.A}),Be()(Qt,"directives",{ClosePopup:Tt.A})}}]);