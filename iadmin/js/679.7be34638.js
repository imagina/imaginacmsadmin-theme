"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[679],{69258:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Js});var a=i(61758),s=i(58790);const o={id:"subContent",class:"row justify-between items-center"},n={class:"row items-center"},r={key:2,id:"fakeRouteInformationContent",class:"q-hide q-md-show"},l={id:"routerPageContent",class:"layout-padding"};function c(e,t,i,c,d,m){const u=(0,a.g2)("bannerAlert"),h=(0,a.g2)("q-tooltip"),p=(0,a.g2)("q-btn"),f=(0,a.g2)("q-breadcrumbs-el"),g=(0,a.g2)("q-breadcrumbs"),b=(0,a.g2)("activities"),v=(0,a.g2)("router-view"),k=(0,a.g2)("Alert"),w=(0,a.g2)("q-page-container"),A=(0,a.g2)("cropper-component"),y=(0,a.g2)("activities-actions"),q=(0,a.g2)("notification-dialog"),$=(0,a.g2)("q-layout");return(0,a.uX)(),(0,a.Wv)($,{id:"layoutMaster",view:"iadmin"==d.appConfig.mode?"lHh LpR lFf":"lHr LpR lFf"},{default:(0,a.k6)((()=>[((0,a.uX)(),(0,a.Wv)((0,a.$y)(m.components.header))),((0,a.uX)(),(0,a.Wv)((0,a.$y)(m.components.drawer))),(0,a.bF)(w,null,{default:(0,a.k6)((()=>[m.isAppOffline||m.isWarning?((0,a.uX)(),(0,a.Wv)(u,(0,s._B)((0,a.v6)({key:0},m.configBanner())),null,16)):(0,a.Q3)("",!0),"iadmin"==d.appConfig.mode?((0,a.uX)(),(0,a.CE)("div",{key:1,id:"routeInformationContent",class:(0,s.C4)("q-hide q-md-show "+(1==m.iadminTheme?"bg-primary":"bg-white"))},[(0,a.Lk)("div",o,[(0,a.Lk)("div",n,[(0,a.bF)(p,{icon:"fas fa-arrow-left",unelevated:"",round:"",color:"primary",dense:"",class:"btn-small q-mr-md",onClick:t[0]||(t[0]=t=>e.$helper.backHistory())},{default:(0,a.k6)((()=>[(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("isite.cms.label.back")),1)])),_:1})])),_:1}),(0,a.bF)(g,{class:"text-blue-grey"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(m.breadcrumbs,((e,t)=>((0,a.uX)(),(0,a.Wv)(f,{key:t,label:e.label,icon:e.icon,to:!!e.to&&{name:e.to}},null,8,["label","icon","to"])))),128))])),_:1})]),(0,a.bF)(b,(0,s._B)((0,a.Ng)(m.globalActivities.helpCenter)),null,16)])],2)):(0,a.Q3)("",!0),"iadmin"==d.appConfig.mode?((0,a.uX)(),(0,a.CE)("div",r)):(0,a.Q3)("",!0),(0,a.Lk)("div",l,[m.appState.loadPage?((0,a.uX)(),(0,a.Wv)(v,{key:0})):(0,a.Q3)("",!0),(0,a.bF)(k)])])),_:1}),(0,a.bF)(A,{ref:"cropperComponent"},null,512),(0,a.bF)(b,(0,s._B)((0,a.Ng)(m.globalActivities.adminPopup)),null,16),(0,a.bF)(y),((0,a.uX)(),(0,a.Wv)((0,a.$y)(m.components.footer))),(0,a.bF)(q)])),_:1},8,["view"])}i(10239);var d=i(17085);const m={id:"masterAdminHeader"},u={class:(0,s.C4)("q-hide q-md-show bg-primary")};function h(e,t,i,s,o,n){const r=(0,a.g2)("q-toolbar-title"),l=(0,a.g2)("site-actions"),c=(0,a.g2)("q-toolbar"),d=(0,a.g2)("q-header");return(0,a.uX)(),(0,a.CE)("div",m,[(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",u,[(0,a.bF)(c,{id:"toolbarTop",color:"primary"},{default:(0,a.k6)((()=>[(0,a.bF)(r),(0,a.bF)(l)])),_:1})])])),_:1})])}const p={id:"siteActionscomponent"},f={class:"q-py-sm q-px-md"},g={class:"text-subtitle1 text-primary"},b={class:"text-caption text-blue-grey"},v={class:"q-ml-xs q-mr-sm text-blue-grey"},k={class:"row no-wrap q-pa-md"},w={class:"column"},A={style:{"max-width":"110px"}},y={class:"text-center"},q=["src"],$={class:"text-subtitle1 ellipsis q-mt-md"},x={class:"ellipsis text-caption"},_={class:"column text-left"};function F(e,t,i,o,n,r){const l=(0,a.g2)("q-separator"),c=(0,a.g2)("q-icon"),d=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-item"),u=(0,a.g2)("q-list"),h=(0,a.g2)("q-menu"),F=(0,a.g2)("q-tooltip"),C=(0,a.g2)("q-badge"),L=(0,a.g2)("q-btn"),S=(0,a.g2)("q-avatar"),Q=(0,a.gN)("ripple"),I=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",p,[(0,a.Lk)("div",{class:(0,s.C4)(`row q-gutter-${i.gutter}`)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.actions.buttons,((t,i)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[void 0==t?.vIf||t.vIf?((0,a.uX)(),(0,a.Wv)(L,(0,a.v6)({key:i},t.props,{onClick:e=>void 0!=t.action?t.action():null}),{default:(0,a.k6)((()=>[t.menu?((0,a.uX)(),(0,a.Wv)(h,{key:0,fit:""},{default:(0,a.k6)((()=>[(0,a.Lk)("div",f,[(0,a.Lk)("div",g,(0,s.v_)(t.label),1),(0,a.bF)(l,{class:"q-my-sm"}),(0,a.Lk)("div",b,(0,s.v_)(e.$tr("isite.cms.message.descriptionHelpCenter"))+".",1),(0,a.bF)(u,{separator:"",class:"no-shadow",style:{"min-width":"260px"}},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.menu.actions,((e,t)=>(0,a.bo)(((0,a.uX)(),(0,a.Wv)(m,{key:t,clickable:"",onClick:t=>void 0!=e.action?e.action():null},{default:(0,a.k6)((()=>[(0,a.bF)(d,{class:"text-blue-grey"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:e.icon,class:"q-mr-sm",color:"primary",size:"xs"},null,8,["name"]),(0,a.eW)(" "+(0,s.v_)(e.label),1)])])),_:2},1024),(0,a.bF)(d,{side:""},{default:(0,a.k6)((()=>[(0,a.bF)(c,{name:"fa-light fa-chevron-right",size:"12px"})])),_:1})])),_:2},1032,["onClick"])),[[Q],[I]]))),128))])),_:2},1024)])])),_:2},1024)):(0,a.Q3)("",!0),(0,a.bF)(F,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(t.label),1)])),_:2},1024),t.badgeLabel||t.badge?((0,a.uX)(),(0,a.Wv)(C,{key:1,color:t.badgeColor||"orange",rounded:"",floating:""},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(t.badgeLabel),1)])),_:2},1032,["color"])):(0,a.Q3)("",!0)])),_:2},1040,["onClick"])):(0,a.Q3)("",!0)],64)))),256)),r.quserState.authenticated&&"iadmin"==n.configMode?((0,a.uX)(),(0,a.Wv)(L,{key:0,id:"profileButton",rounded:"","no-caps":"",padding:"2px 8px",color:"white",unelevated:""},{default:(0,a.k6)((()=>[(0,a.Lk)("div",{id:"profileImage",class:"img-as-bg",style:(0,s.Tr)(`background-image: url('${r.profileImage.smallThumb}')`)},null,4),(0,a.Lk)("div",v,(0,s.v_)(r.quserState.userData.firstName),1),(0,a.bF)(c,{name:"fas fa-chevron-down",size:"14px",color:"blue-grey"}),(0,a.bF)(h,{anchor:"bottom right",self:"top right"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",k,[(0,a.Lk)("div",w,[(0,a.Lk)("div",A,[(0,a.Lk)("div",y,[(0,a.bF)(S,{size:"72px",class:"q-mx-auto"},{default:(0,a.k6)((()=>[(0,a.Lk)("img",{src:r.profileImage.mediumThumb},null,8,q)])),_:1})]),(0,a.Lk)("div",$,(0,s.v_)(r.quserState.userData.fullName),1),(0,a.Lk)("div",x,(0,s.v_)(r.quserState.userData.roles.map((e=>e.name)).join(", ")),1)])]),(0,a.bF)(l,{vertical:"",inset:"",class:"q-ml-lg q-mr-sm"}),(0,a.Lk)("div",_,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.actions.menu,((e,t)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[void 0==e?.vIf||e.vIf?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(L,(0,a.v6)({key:t},e.props,{padding:"xs md",onClick:t=>void 0!=e.action?e.action():null}),null,16,["onClick"])),[[I]]):(0,a.Q3)("",!0)],64)))),256))])])])),_:1})])),_:1})):(0,a.Q3)("",!0)],2)])}var C=i(71915),L=i(99526)["A"];const S={beforeUnmount(){C.Bt.off("header.badge.manage")},props:{gutter:{type:String,default:"sm"},size:{type:String,default:"small"}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{configMode:L("app.mode"),badge:{chat:!1,notification:!1},defaultButtonProps:{round:!0,dense:!0,color:"white",unelevated:!0,class:"btn-small",textColor:"blue-grey",noCaps:!0}}},computed:{isAppOffline(){return this.$store.state.qofflineMaster.isAppOffline},quserState(){return this.$store.state.quserAuth},theme(){return parseInt(this.$getSetting("isite::iadminTheme"))},params(){return this.$clone(this.$route.meta.subHeader||{})},showGoToSiteButton(){return this.$getSetting("isite::showGoToSiteButton")||!1},actions(){let e=this.$store.state.qsiteApp.baseUrl;if(this.quserState.organizationId){let t=this.quserState.organizations.find((e=>e.id==this.quserState.organizationId));t&&(e=t.url)}return{buttons:[{vIf:this.$getSetting("isite::offline"),name:"offline",label:this.$tr("isite.cms.label.offline"),badgeColor:"orange",badgeLabel:this.$store.state.qofflineMaster.totalRequests,props:{...this.defaultButtonProps,icon:"fa-light fa-cloud-slash",class:"btn-small"},action:()=>C.Bt.emit("toggleMasterDrawer","offline")},{vIf:this.showGoToSiteButton,name:"goToSite",label:this.$tr("isite.cms.configList.goToSite"),props:{...this.defaultButtonProps,label:this.$tr("isite.cms.showSite"),type:"a",id:"siteActionGoToSite",href:e,target:"_blank",round:!1,rounded:!0,padding:"xs md"}},{name:"checking",vIf:"ipanel"==L("app.mode")&&this.$hasAccess("icheckin.shifts.create"),label:this.$tr("icheckin.cms.sidebar.checkin"),props:{...this.defaultButtonProps,icon:"fas fa-stopwatch",round:!0},action:()=>C.Bt.emit("toggleMasterDrawer","checkin")},{name:"chat",label:"Chat",vIf:"iadmin"==L("app.mode")&&this.$hasAccess("ichat.conversations.index"),badge:this.badge.chat,props:{...this.defaultButtonProps,icon:"fa-light fa-message-lines",class:"btn-small"},action:()=>C.Bt.emit("toggleMasterDrawer","chat")},{name:"notifications",label:this.$trp("isite.cms.label.notification"),badge:this.badge.notification,props:{...this.defaultButtonProps,icon:"fa-light fa-bell",class:"btn-small"},action:()=>C.Bt.emit("toggleMasterDrawer","notification")},{name:"helpCenter",label:this.$trp("isite.cms.label.helpCenter"),vIf:parseInt(this.$getSetting("isite::hcStatus")||"0"),props:{id:"siteActionHelpCenter",...this.defaultButtonProps,icon:"fal fa-question-circle"},menu:{actions:[{icon:"fa-light fa-question-circle",label:"FAQ",action:()=>C.Bt.emit("toggleHelpSection",{sectionName:"faq"})}]}},{name:"clearCache",label:this.$tr("isite.cms.configList.clearCache"),props:{...this.defaultButtonProps,icon:"fa-light fa-broom"},action:()=>this.$router.push({name:"app.update.app",query:{fromCache:1}})}],menu:[{name:"profile",props:{...this.defaultButtonProps,label:this.$tr("iprofile.cms.sidebar.panelProfile"),icon:"fa-light fa-circle-user",round:!1,rounded:!0,align:"left",id:"profileButton"},action:()=>"user.profile.me"!=this.$route.name?this.$router.push({name:"user.profile.me"}):null},{name:"settings",vIf:"iadmin"==L("app.mode"),props:{...this.defaultButtonProps,label:this.$trp("isite.cms.label.setting"),icon:"fa-light fa-folder-gear",round:!1,rounded:!0,align:"left"},action:()=>C.Bt.emit("toggleMasterDrawer","config")},{name:"settings",vIf:"iadmin"==L("app.mode")&&!this.isAppOffline,props:{...this.defaultButtonProps,label:this.$tr("isite.cms.configList.signOut"),icon:"fa-light fa-right-from-bracket",round:!1,rounded:!0,align:"left"},action:this.logout}]}},profileImage(){return this.$store.getters["quserAuth/profileImage"]}},methods:{init(){C.Bt.on("header.badge.manage",(e=>{Object.keys(e).forEach((t=>this.badge[t]=e[t]))}))},logout(){this.$router.push({name:"auth.logout"})}}};var Q=i(12807),I=i(69001),M=i(66929),W=i(37015),E=i(54514),B=i(75329),T=i(63418),X=i(24609),D=i(78151),z=i(44031),R=i(53581),P=i(44029),V=i(62769),H=i(98582),N=i.n(H);const U=(0,Q.A)(S,[["render",F]]),O=U;N()(S,"components",{QBtn:I.A,QMenu:M.A,QSeparator:W.A,QList:E.A,QItem:B.A,QItemSection:T.A,QIcon:X.A,QTooltip:D.A,QBadge:z.A,QAvatar:R.A}),N()(S,"directives",{Ripple:P.A,ClosePopup:V.A});var j=i(99526)["A"];const K={props:{},components:{siteActions:O},mounted(){this.$nextTick((function(){this.init()}))},data(){return{projectName:this.$getSetting("core::site-name"),logo:this.$store.state.qsiteApp.logo,appConfig:j("app"),loadHeaderIpanel:!1}},computed:{quserState(){return this.$store.state.quserAuth}},methods:{init(){},getHeaderIpanel(){"ipanel"==j("app.mode")&&this.$remember.async({key:"headerIpanelHTML",seconds:10800,refresh:!1,callBack:()=>new Promise(((e,t)=>{let i=this.$store.state.qsiteApp.baseUrl;this.$axios.get(i+"/isite/header").then((t=>{e(t)})).catch((e=>{console.error("[HEADER-IPANEL]",e.response),t(e.response)}))}))}).then((e=>{var t=document.createElement("template");t.innerHTML=e.data,window.customElements.define("embedded-header-ipanel",class extends HTMLElement{connectedCallback(){const e=this.attachShadow({mode:"closed"});e.appendChild(document.importNode(t.content,!0))}}),this.loadHeaderIpanel=!0})).catch((e=>{console.error("[HEADER-IPANEL]",e)}))}}};var G=i(60133),J=i(79351),Y=i(56769);const Z=(0,Q.A)(K,[["render",h]]),ee=Z;N()(K,"components",{QHeader:G.A,QToolbar:J.A,QToolbarTitle:Y.A});const te={id:"masterAdminHeader"},ie={class:(0,s.C4)("q-hide q-md-show")};function ae(e,t,i,s,o,n){const r=(0,a.g2)("q-btn"),l=(0,a.g2)("q-toolbar-title"),c=(0,a.g2)("site-actions"),d=(0,a.g2)("q-toolbar"),m=(0,a.g2)("q-header");return(0,a.uX)(),(0,a.CE)("div",te,[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",ie,[(0,a.bF)(d,{id:"toolbarTop"},{default:(0,a.k6)((()=>["iadmin"===o.appConfig.mode?((0,a.uX)(),(0,a.Wv)(r,{key:0,icon:"fas fa-bars",unelevated:"",class:"text-primary buttonToogleMenuClose",onClick:t[0]||(t[0]=e=>o.eventBus.emit("toggleMasterDrawer","menu"))})):(0,a.Q3)("",!0),(0,a.bF)(l),(0,a.bF)(c)])),_:1})])])),_:1})])}var se=i(99526)["A"];const oe={components:{siteActions:O},mounted(){this.$nextTick((function(){this.init()}))},data(){return{projectName:this.$getSetting("core::site-name"),logo:this.$store.state.qsiteApp.logo,appConfig:se("app"),loadHeaderIpanel:!1,eventBus:C.Bt}},computed:{quserState(){return this.$store.state.quserAuth}},methods:{init(){},getHeaderIpanel(){"ipanel"==se("app.mode")&&this.$remember.async({key:"headerIpanelHTML",seconds:10800,refresh:!1,callBack:()=>new Promise(((e,t)=>{let i=this.$store.state.qsiteApp.baseUrl;this.$axios.get(i+"/isite/header").then((t=>{e(t)})).catch((e=>{console.error("[HEADER-IPANEL]",e.response),t(e.response)}))}))}).then((e=>{var t=document.createElement("template");t.innerHTML=e.data,window.customElements.define("embedded-header-ipanel",class extends HTMLElement{connectedCallback(){const e=this.attachShadow({mode:"closed"});e.appendChild(document.importNode(t.content,!0))}}),this.loadHeaderIpanel=!0})).catch((e=>{console.error("[HEADER-IPANEL]",e)}))}}},ne=(0,Q.A)(oe,[["render",ae]]),re=ne;N()(oe,"components",{QHeader:G.A,QToolbar:J.A,QBtn:I.A,QToolbarTitle:Y.A});const le={id:"masterDrawers1"},ce={id:"logoSite",class:"relative-position"},de={id:"versionContent",class:"absolute absolute-bottom-right text-white"};function me(e,t,i,o,n,r){const l=(0,a.g2)("q-img"),c=(0,a.g2)("q-icon"),d=(0,a.g2)("menu-list"),m=(0,a.g2)("q-scroll-area"),u=(0,a.g2)("q-drawer"),h=(0,a.g2)("config-list"),p=(0,a.g2)("chat-list"),f=(0,a.g2)("master-recommendation"),g=(0,a.g2)("master-notifications"),b=(0,a.g2)("offline");return(0,a.uX)(),(0,a.CE)("div",le,[(0,a.bF)(u,{id:"menuMaster",class:"no-shadow",modelValue:n.drawer.menu,"onUpdate:modelValue":t[0]||(t[0]=e=>n.drawer.menu=e),ref:"menuMaster",onClickCapture:t[1]||(t[1]=e=>n.miniState?n.eventBus.emit("toggleMasterDrawer","menu"):null)},{default:(0,a.k6)((()=>[(0,a.Lk)("div",ce,[(0,a.bF)(l,{fit:"contain",src:r.logo,style:{height:"80px","min-height":"80px"}},null,8,["src"]),(0,a.Lk)("div",de,[(0,a.bF)(c,{name:"fas fa-code-branch",class:"q-mr-xs"}),(0,a.eW)(" "+(0,s.v_)(r.versionText),1)])]),(0,a.bF)(m,{id:"adminMenu",style:(0,s.Tr)("height: calc(100vh - 146px")},{default:(0,a.k6)((()=>[(0,a.bF)(d,{ref:"menuList",group:"",translatable:e.menuTranslatable,menu:e.menuSelect},null,8,["translatable","menu"])])),_:1},8,["style"])])),_:1},8,["modelValue"]),(0,a.bF)(u,{bordered:"",id:"configMaster",overlay:"",modelValue:n.drawer.config,"onUpdate:modelValue":t[2]||(t[2]=e=>n.drawer.config=e),side:"right"},{default:(0,a.k6)((()=>[(0,a.bF)(h)])),_:1},8,["modelValue"]),e.$hasAccess("ichat.conversations.index")?((0,a.uX)(),(0,a.Wv)(u,{key:0,bordered:"",id:"chatMaster",overlay:"",modelValue:n.drawer.chat,"onUpdate:modelValue":t[3]||(t[3]=e=>n.drawer.chat=e),side:"right"},{default:(0,a.k6)((()=>[(0,a.bF)(p)])),_:1},8,["modelValue"])):(0,a.Q3)("",!0),!r.routeSubHeader.recommendations?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(u,{key:1,id:"drawerRecommendationMaster",modelValue:n.drawer.recommendation,"onUpdate:modelValue":t[4]||(t[4]=e=>n.drawer.recommendation=e),side:"right",behavior:"mobile",overlay:!0},{default:(0,a.k6)((()=>[(0,a.bF)(f)])),_:1},8,["modelValue"])),(0,a.bF)(g,{"is-open":n.drawer.notification,isMobile:"mobile"==this.windowSize},null,8,["is-open","isMobile"]),e.$getSetting("isite::offline")?((0,a.uX)(),(0,a.Wv)(u,{key:2,bordered:"",id:"drawerOfflineMaster",modelValue:n.drawer.offline,"onUpdate:modelValue":t[5]||(t[5]=e=>n.drawer.offline=e),side:"right",overlay:""},{default:(0,a.k6)((()=>[(0,a.bF)(b)])),_:1},8,["modelValue"])):(0,a.Q3)("",!0)])}var ue=i(96230);const he={id:"configList",class:"q-pa-md"},pe={class:"row justify-between items-center"},fe={class:"text-subtitle1 row items-center"},ge={key:0},be={class:"title-block q-mb-sm"},ve={key:0,class:"q-py-none"},ke={class:"full-width text-primary"},we={key:0,class:"q-mt-xs"},Ae={key:1,class:"q-py-sm"},ye={class:"row items-center"},qe={key:0},$e={key:1,class:"q-py-sm"},xe={key:2,color:"grey-10",style:{"text-decoration":"none"}},_e={class:"title-block"},Fe={class:"q-mt-xs q-px-sm"},Ce={class:"text-primary"},Le={class:"block text-grey-8",style:{"line-height":"1.4"}},Se={class:"q-mt-xs q-px-sm"},Qe={class:"text-primary"},Ie={class:"block text-grey-8",style:{"line-height":"1.4"}},Me={class:"title-block q-mb-sm"},We={key:1,class:"q-px-sm text-grey-7",style:{"line-height":"1.2"}},Ee={class:"title-block"},Be={class:"q-mt-xs q-px-sm"},Te={class:"text-primary"},Xe={key:1,class:"block ellipsis"},De={class:"title-block"},ze=["onClick"],Re={class:"title-block"},Pe={class:"text-subtitle2 fixed fixed-bottom text-blue-grey q-px-md q-py-sm text-right"};function Ve(e,t,i,o,n,r){const l=(0,a.g2)("q-icon"),c=(0,a.g2)("q-separator"),d=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-item"),u=(0,a.g2)("q-select"),h=(0,a.g2)("q-spinner"),p=(0,a.g2)("q-no-ssr"),f=(0,a.g2)("dynamic-field");return(0,a.uX)(),(0,a.CE)("div",he,[(0,a.Lk)("div",pe,[(0,a.Lk)("div",fe,[(0,a.bF)(l,{name:"fas fa-cog",color:"primary",size:"20px",class:"q-mr-sm"}),(0,a.Lk)("label",null,(0,s.v_)(e.$tr("isite.cms.label.configuration",{capitalize:!0})),1)]),(0,a.bF)(l,{name:"fas fa-times",color:"blue-grey",size:"20px",class:"cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","config"))})]),(0,a.bF)(c,{class:"q-my-md"}),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[e.$hasAccess("profile.user.impersonate")||r.quserState.impersonating?((0,a.uX)(),(0,a.CE)("div",ge,[(0,a.Lk)("div",be,(0,s.v_)(e.$tr("isite.cms.label.impersonate")),1),r.quserState.impersonating?((0,a.uX)(),(0,a.Wv)(m,{key:1,tag:"label",link:"",onClick:r.impersonate},{default:(0,a.k6)((()=>[(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",ye,[n.loadingImpersonate?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",qe,[(0,a.bF)(l,{color:"red",class:"q-mr-sm",name:"fas fa-sign-out-alt",size:"20px"})])),n.loadingImpersonate?((0,a.uX)(),(0,a.CE)("div",$e,[(0,a.bF)(h,{class:"q-mr-sm"}),(0,a.eW)(" "+(0,s.v_)(`${e.$tr("isite.cms.label.loading")}...`),1)])):(0,a.Q3)("",!0),n.loadingImpersonate?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",xe,(0,s.v_)(e.$t("isite.cms.configList.leaveImpersonating",{capitalize:!0})),1))])])),_:1})])),_:1},8,["onClick"])):((0,a.uX)(),(0,a.CE)("div",ve,[(0,a.Lk)("div",ke,[n.loadingImpersonate?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",we,[(0,a.bF)(u,{outlined:"",dense:"",modelValue:n.userToImpersonate,"onUpdate:modelValue":[t[1]||(t[1]=e=>n.userToImpersonate=e),t[2]||(t[2]=e=>r.impersonate())],"use-input":"","hide-selected":"","emit-value":"","map-options":"","input-debounce":"800",options:n.userList,onFilter:r.getUsers,placeholder:`${e.$tr("isite.cms.label.find")} ${e.$tr("isite.cms.label.user")}...`,style:{width:"100%"}},{"no-option":(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{class:"text-grey"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("isite.cms.message.searchNotFound")),1)])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","placeholder"])])),n.loadingImpersonate?((0,a.uX)(),(0,a.CE)("div",Ae,[(0,a.bF)(h,{class:"q-mr-sm"}),(0,a.eW)(" "+(0,s.v_)(`${e.$tr("isite.cms.label.loading")}...`),1)])):(0,a.Q3)("",!0)])]))])):(0,a.Q3)("",!0)])),_:1}),e.$hasAccess("profile.user.impersonate")||r.quserState.impersonating?((0,a.uX)(),(0,a.Wv)(c,{key:0,class:"q-my-md"})):(0,a.Q3)("",!0),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",_e,(0,s.v_)(e.$tr("isite.cms.label.session",{capitalize:!0})),1),(0,a.Lk)("div",Fe,[(0,a.Lk)("div",Ce,[(0,a.bF)(l,{name:"fas fa-user-circle"}),(0,a.eW)(" "+(0,s.v_)(e.$trp("isite.cms.label.role")),1)]),(0,a.Lk)("label",Le,(0,s.v_)(r.quserState.userData.roles.map((e=>e.name)).join(", ")),1)]),(0,a.Lk)("div",Se,[(0,a.Lk)("div",Qe,[(0,a.bF)(l,{name:"fas fa-people-arrows"}),(0,a.eW)(" "+(0,s.v_)(this.$trp("iprofile.cms.label.userGroup")),1)]),(0,a.Lk)("label",Ie,(0,s.v_)(r.quserState.userData.departments.map((e=>e.title)).join(", ")),1)])])),_:1}),e.$hasAccess("profile.user.impersonate")||r.quserState.impersonating?((0,a.uX)(),(0,a.Wv)(c,{key:1,class:"q-my-md"})):(0,a.Q3)("",!0),r.organizationField?((0,a.uX)(),(0,a.Wv)(p,{key:2},{default:(0,a.k6)((()=>[(0,a.Lk)("div",Me,(0,s.v_)(e.$tr("isite.cms.label.organization")),1),r.organizationField?((0,a.uX)(),(0,a.Wv)(f,{key:0,modelValue:n.organizationId,"onUpdate:modelValue":[t[3]||(t[3]=e=>n.organizationId=e),r.setOrganization],field:r.organizationField},null,8,["modelValue","field","onUpdate:modelValue"])):((0,a.uX)(),(0,a.CE)("div",We,(0,s.v_)(e.$tr("isite.cms.messages.noOrganization"))+"... ",1))])),_:1})):(0,a.Q3)("",!0),(0,a.bF)(c,{class:"q-my-md"}),(0,a.Lk)("div",null,[(0,a.Lk)("div",Ee,(0,s.v_)(e.$tr("isite.cms.label.language",{capitalize:!0})),1),(0,a.Lk)("div",Be,[(0,a.Lk)("div",Te,[(0,a.bF)(l,{name:"fas fa-language"}),(0,a.eW)(" "+(0,s.v_)(e.$tr("isite.cms.label.language",{capitalize:!0})),1)]),n.show.locales?((0,a.uX)(),(0,a.Wv)(u,{key:0,options:n.options.locales,dense:"",outlined:"","emit-value":"","map-options":"",filter:"","hide-underline":"","onUpdate:modelValue":[r.updateLocale,t[4]||(t[4]=e=>n.locale=e)],modelValue:n.locale,class:"full-width q-if-focused q-if-focusable"},null,8,["options","onUpdate:modelValue","modelValue"])):((0,a.uX)(),(0,a.CE)("label",Xe,(0,s.v_)(n.options.locales[0].label),1))])]),(0,a.bF)(c,{class:"q-my-md"}),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.customConfigs,(t=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",De,(0,s.v_)(e.$trp(t.moduleTitle,{capitalize:!0})),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.configList,(t=>((0,a.uX)(),(0,a.CE)("div",{class:"q-px-sm cursor-pointer q-pt-md",onClick:e=>t.action()},[(0,a.bF)(l,{color:"primary",size:"18px",name:t.icon,class:"q-mr-sm"},null,8,["name"]),(0,a.eW)(" "+(0,s.v_)(e.$t(t.title,{capitalize:!0})),1)],8,ze)))),256))])))),256)),(0,a.bF)(c,{class:"q-my-md"}),(0,a.Lk)("div",null,[(0,a.Lk)("div",Re,(0,s.v_)(e.$trp("isite.cms.label.action",{capitalize:!0})),1),(0,a.Lk)("div",{class:"q-px-sm cursor-pointer q-pt-md",onClick:t[5]||(t[5]=t=>e.$router.push({name:"app.update.app",query:{fromCache:1}}))},[(0,a.bF)(l,{color:"primary",size:"18px",name:"fas fa-broom",class:"q-mr-sm"}),(0,a.eW)(" "+(0,s.v_)(e.$t("isite.cms.configList.clearCache",{capitalize:!0})),1)]),(0,a.Lk)("div",{class:"q-px-sm cursor-pointer q-pt-md",onClick:t[6]||(t[6]=e=>r.toggleFullscreen())},[(0,a.bF)(l,{color:"primary",size:"18px",name:"fas fa-expand",class:"q-mr-sm"}),(0,a.eW)(" "+(0,s.v_)(e.$t("isite.cms.configList.fullScreen",{capitalize:!0})),1)]),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[r.quserState.authenticated?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"q-px-sm cursor-pointer q-pt-md",onClick:t[7]||(t[7]=t=>e.$router.push({name:"auth.logout"}))},[(0,a.bF)(l,{color:"red",size:"18px",name:"fas fa-sign-out-alt",class:"q-mr-sm"}),(0,a.eW)(" "+(0,s.v_)(e.$t("isite.cms.configList.signOut",{capitalize:!0})),1)])):(0,a.Q3)("",!0)])),_:1})]),(0,a.Lk)("div",Pe,[(0,a.bF)(l,{name:"fas fa-code-branch",class:"q-mr-xs"}),(0,a.eW)(" "+(0,s.v_)(r.versionText),1)])])}var He=i(99526)["A"];const Ne={mounted(){this.$nextTick((async function(){this.setOptions()}))},data(){return{valueConsistsOf:"BRANCH_PRIORITY",organizationId:this.$clone(this.$store.state.quserAuth.organizationId),roleId:!1,departmentId:!1,locale:this.$store.state.qsiteApp.defaultLocale,options:{roles:this.$store.getters["quserAuth/userRolesSelect"],departments:this.$store.getters["quserAuth/userDepartmentsSelect"],locales:this.$store.getters["qsiteApp/getSelectedLocalesSelect"]},show:{roles:!1,departments:!1,locales:!1},fullScreen:this.$q?.fullscreen?.isActive,userToImpersonate:null,loadingImpersonate:!1,userList:[],loadingCacheClear:!1,eventBus:C.Bt}},computed:{isAppOffline(){return this.$store.state.qofflineMaster.isAppOffline},customConfigs(){const e=Object.values(He("main")).map((e=>e.configList?{moduleTitle:e.moduleTitle,configList:e.configList}:{moduleTitle:e.moduleTitle,configList:[]}));return e.filter((e=>e.configList.length>0))},versionText(){return"v"+He("app.version")},quserState(){return this.$store.state.quserAuth},forceRoleAndDepartment(){return He("app.forceRoleAndDepartment")},organizationField(){let e=this.$store.state.quserAuth.organizations||[];return!!e.length&&{value:null,type:"select",props:{label:this.$tr("isite.cms.label.organization"),options:e.map((e=>({label:e.title,value:e.id}))),readonly:1==e.length}}}},methods:{toggleFullscreen(){this.$q?.fullscreen?.toggle()},async setOptions(){let e=await this.$cache.get.item("auth.role.id"),t=await this.$cache.get.item("auth.department.id");this.roleId=e,this.departmentId=t,this.options.roles.length>=2&&(this.show.roles=!0),this.options.departments.length>=2&&(this.show.departments=!0),1==this.options.departments.length&&this.options.departments[0].children&&(this.show.departments=!0),this.options.locales.length>=2&&(this.show.locales=!0)},async updateDepRolUser(e=!1){if(this.forceRoleAndDepartment){const e=await this.$cache.get.item("auth.department.id"),t=await this.$cache.get.item("auth.role.id");e==this.departmentId&&t==this.roleId||(await this.$cache.set("auth.department.id",this.departmentId),await this.$cache.set("auth.role.id",this.roleId),this.$store.dispatch("qsiteApp/REFRESH_PAGE"))}},async updateLocale(){this.$store.dispatch("qsiteApp/SET_LOCALE",{locale:this.locale,vue:this}).then((e=>{this.$store.dispatch("qsiteApp/REFRESH_PAGE")})).catch((e=>console.error(e)))},getUsers(e,t,i){if(e.length<2)return i();let a={params:{take:100,filter:{search:e}}};this.$crud.index("apiRoutes.quser.users",a).then((e=>{t((()=>{let t=this.$store.state.quserAuth.userId,i=[];e.data.forEach((e=>{e.id!=t&&i.push({label:e.fullName,value:e.id})})),this.userList=this.$clone(i)}))})).catch((e=>{this.$apiResponse.handleError(e,(()=>{t((()=>{this.userList=[]}))}))}))},async impersonate(){this.loadingImpersonate=!0,this.quserState.impersonating?await this.$store.dispatch("quserAuth/USER_LEAVE_IMPERSONATE"):this.userToImpersonate&&await this.$store.dispatch("quserAuth/USER_IMPERSONATE",this.userToImpersonate),this.loadingImpersonate=!1},async setOrganization(e){await this.$store.dispatch("quserAuth/SET_ORGANIZATION",{organizationId:e}),this.$store.dispatch("qsiteApp/REFRESH_PAGE")}}};var Ue=i(13430),Oe=i(833),je=i(11895);const Ke=(0,Q.A)(Ne,[["render",Ve]]),Ge=Ke;N()(Ne,"components",{QIcon:X.A,QSeparator:W.A,QNoSsr:Ue.A,QSelect:Oe.A,QItem:B.A,QItemSection:T.A,QSpinner:je.A});var Je=i(29104);const Ye={key:0,id:"drawerChatComponent",class:"q-pa-md"},Ze={class:"row justify-between items-center"},et={class:"text-subtitle1 row items-center"},tt={class:"relative-position"},it={id:"userListcontent",class:"relative-position"},at=["src"],st=["src"],ot={id:"chatBodyContent",ref:"chatBodyContent"},nt={key:0,class:"text-center q-py-xs"},rt={style:{width:"100%"},class:"q-py-sm q-px-md"},lt={key:0,class:"text-center text-grey-7 q-mt-md"},ct={id:"inputChatContent",class:"q-pa-sm"};function dt(e,t,i,o,n,r){const l=(0,a.g2)("q-icon"),c=(0,a.g2)("q-separator"),d=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-item"),u=(0,a.g2)("q-select"),h=(0,a.g2)("inner-loading"),p=(0,a.g2)("not-result"),f=(0,a.g2)("q-avatar"),g=(0,a.g2)("q-list"),b=(0,a.g2)("q-toolbar-title"),v=(0,a.g2)("q-btn"),k=(0,a.g2)("q-toolbar"),w=(0,a.g2)("q-spinner-dots"),A=(0,a.g2)("q-chat-message"),y=(0,a.g2)("q-infinite-scroll"),q=(0,a.g2)("q-input"),$=(0,a.g2)("q-card"),x=(0,a.g2)("q-dialog"),_=(0,a.gN)("close-popup");return e.$hasAccess("ichat.conversations.index")?((0,a.uX)(),(0,a.CE)("div",Ye,[(0,a.Lk)("div",Ze,[(0,a.Lk)("div",et,[(0,a.bF)(l,{name:"fa-light fa-message",color:"primary",size:"20px",class:"q-mr-sm"}),(0,a.Lk)("label",null,(0,s.v_)(e.$tr("isite.cms.label.chat",{capitalize:!0})),1)]),(0,a.bF)(l,{name:"fas fa-times",color:"blue-grey",size:"20px",class:"cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","chat"))})]),(0,a.bF)(c,{class:"q-my-md"}),(0,a.Lk)("div",tt,[(0,a.bF)(u,{outlined:"",dense:"",modelValue:n.search.userId,"onUpdate:modelValue":[t[1]||(t[1]=e=>n.search.userId=e),r.createConversation],"use-input":"","hide-selected":"","emit-value":"","map-options":"","input-debounce":"800",options:n.search.userList,onFilter:r.searchUsers,placeholder:`${e.$tr("isite.cms.label.find")} ${e.$tr("isite.cms.label.user")}...`,style:{width:"100%"},class:"q-mb-sm"},{"no-option":(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{class:"text-grey"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("isite.cms.message.searchNotFound")),1)])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","placeholder","onUpdate:modelValue"]),(0,a.Lk)("div",it,[(0,a.bF)(h,{visible:n.conversations.loading},null,8,["visible"]),n.conversations.loading||n.conversations.list.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(p,{key:0,class:"q-my-lg"})),!n.conversations.loading&&n.conversations.list.length?((0,a.uX)(),(0,a.Wv)(g,{key:1},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.conversationsList,((e,t)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:t},[e.userData?((0,a.uX)(),(0,a.Wv)(m,{key:0,clickable:"",class:"q-px-xs",onClick:t=>r.openChat(e)},{default:(0,a.k6)((()=>[(0,a.bF)(d,{avatar:""},{default:(0,a.k6)((()=>[!e.userData||!e.userData?.mainImage?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(f,{key:0},{default:(0,a.k6)((()=>[(0,a.Lk)("img",{src:e.userData?.mainImage},null,8,at)])),_:2},1024))])),_:2},1024),(0,a.bF)(d,{class:"ellipsis text-capitalize"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.userData.fullName.toLowerCase()),1)])),_:2},1024),e.unReadMessages?((0,a.uX)(),(0,a.Wv)(d,{key:0,side:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{name:"fas fa-circle",color:"teal",size:"14px"})])),_:1})):(0,a.Q3)("",!0)])),_:2},1032,["onClick"])):(0,a.Q3)("",!0)],64)))),128))])),_:1})):(0,a.Q3)("",!0)])]),(0,a.bF)(x,{id:"personalChatContent",modelValue:n.chat.open,"onUpdate:modelValue":t[3]||(t[3]=e=>n.chat.open=e),seamless:"",position:"bottom"},{default:(0,a.k6)((()=>[n.chat.conversation?((0,a.uX)(),(0,a.Wv)($,{key:0,style:{width:"350px"}},{default:(0,a.k6)((()=>[(0,a.bF)(k,null,{default:(0,a.k6)((()=>[(0,a.bF)(f,null,{default:(0,a.k6)((()=>[(0,a.Lk)("img",{src:n.chat?.conversation?.userData?.mainImage},null,8,st)])),_:1}),(0,a.bF)(b,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(n.chat.conversation.userData.fullName),1)])),_:1}),(0,a.bo)((0,a.bF)(v,{flat:"",round:"",dense:"",icon:"fa fa-close"},null,512),[[_]])])),_:1}),(0,a.bF)(c),(0,a.Lk)("div",ot,[n.chat.open?((0,a.uX)(),(0,a.Wv)(y,{key:0,ref:"chatInfiniteSroll",onLoad:r.getMessages,reverse:"","scroll-target":"#chatBodyContent",offset:100},{default:(0,a.k6)((()=>[n.chat.loading?((0,a.uX)(),(0,a.CE)("div",nt,[(0,a.bF)(w,{color:"primary",size:"2em"})])):(0,a.Q3)("",!0),(0,a.Lk)("div",rt,[n.chat.loading||r.messageList.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",lt,(0,s.v_)(e.$tr("ichat.cms.message.noMessages")),1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.messageList,((e,t)=>((0,a.uX)(),(0,a.Wv)(A,{key:t,sent:!!e.sent,text:[e.text],stamp:e.stamp,"bg-color":e.color},null,8,["sent","text","stamp","bg-color"])))),128))])])),_:1},8,["onLoad"])):(0,a.Q3)("",!0)],512),(0,a.Lk)("div",ct,[(0,a.bF)(q,{dense:"",outlined:"",modelValue:n.chat.textMessage,"onUpdate:modelValue":t[2]||(t[2]=e=>n.chat.textMessage=e),ref:"inputChat",placeholder:e.$tr("ichat.cms.label.sendMessage"),color:"grey-8",onKeyup:(0,Je.jR)(r.sendMessage,["enter"])},{append:(0,a.k6)((()=>[(0,a.bF)(v,{unelevated:"",icon:"fas fa-paper-plane",onClick:r.sendMessage,padding:"sm"},null,8,["onClick"])])),_:1},8,["modelValue","placeholder","onKeyup"])])])),_:1})):(0,a.Q3)("",!0)])),_:1},8,["modelValue"])])):(0,a.Q3)("",!0)}const mt={beforeUnmount(){C.Bt.off("inotification.chat.message")},props:{},components:{},mounted(){this.$nextTick((async function(){this.init()}))},data(){return{search:{userId:null,userList:[]},conversations:{loading:!1,list:[]},chat:{loading:!1,open:!1,conversation:!1,pagination:{perPage:20,page:0,lastPage:5},messages:[],scrollInfo:!1,textMessage:""},eventBus:C.Bt}},computed:{conversationsList(){let e=!1,t=this.$clone(this.conversations.list);return t.forEach((t=>{let i=t.users.find((e=>e.id!=this.$store.state.quserAuth.userId));i&&(t.userData={id:i.id,mainImage:i?.mainImage,fullName:i.fullName}),t.unReadMessages&&(e=!0)})),C.Bt.emit("header.badge.manage",{chat:e}),t},chatContentStyle(){return{thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#aaadba",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#c2c5c6",width:"9px",opacity:.2}}},messageList(){let e=this.$clone(this.chat.messages).reverse();return e.forEach((e=>{e.text=e.body,e.sent=e.userId==this.$store.state.quserAuth.userId,e.stamp=this.$trd(e.createdAt,{type:"time"}),e.color=e.sent?"grey-4":"indigo-2"})),e}},methods:{init(){this.getConversations(!0),this.listenPusher()},listenPusher(){C.Bt.on("inotification.chat.message",(e=>{if(e.data){let t=e.data;if(this.chat.open&&this.chat.conversation.id==t.conversationId)this.pushMessage(t);else{let e=this.conversations.list.findIndex((e=>e.id==t.conversationId));-1!=e?this.conversations.list[e].unReadMessages=!0:this.getConversations(!0)}}}))},searchUsers(e,t,i){if(e.length<2)return i();let a={params:{take:20,filter:{search:e}}};this.$crud.index("apiRoutes.quser.users",a).then((e=>{t((()=>{let t=this.$store.state.quserAuth.userId,i=[];e.data.forEach((e=>{e.id!=t&&i.push({label:e.fullName,value:e.id})})),this.search.userList=this.$clone(i)}))})).catch((e=>{this.$apiResponse.handleError(e,(()=>{t((()=>{this.search.userList=[]}))}))}))},getConversations(e=!1){return new Promise(((t,i)=>{this.conversations.loading=!0;let a={refresh:e,params:{include:"users,lastMessage"}};this.$crud.index("apiRoutes.qchat.conversations",a).then((e=>{this.conversations.list=e.data,this.conversations.loading=!1})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.conversations.loading=!1}))}))}))},createConversation(e){return new Promise((t=>{let i=!1,a=[e,this.$store.state.quserAuth.userId];this.search.userId=null,this.conversationsList.forEach((e=>{let t=e.users.map((e=>e.id));-1!=t.indexOf(a[0])&&-1!=t.indexOf(a[1])&&(i=e)})),i?this.openChat(i):(this.conversations.loading=!0,this.$crud.create("apiRoutes.qchat.conversations",{users:a}).then((async e=>{this.conversations.list.push(e.data),this.openChat(this.conversationsList.find((t=>t.id==e.data.id))),this.conversations.loading=!1})).catch((e=>{this.conversations.loading=!1})))}))},openChat(e){const t=()=>{setTimeout((()=>{this.$refs.chatInfiniteSroll.reset(),this.$refs.chatInfiniteSroll.updateScrollTarget(),this.$refs.chatInfiniteSroll.poll(),this.$refs.inputChat.focus()}),100),this.chat.conversation=e,this.chat.open=!0,this.chat.messages=[],this.chat.pagination.page=0;let t=this.conversations.list.findIndex((t=>t.id==e.id));this.conversations.list[t].unReadMessages=!1};this.chat.open&&this.chat.conversation.id==e.id||(this.chat.open?(this.chat.open=!1,setTimeout((()=>t()),300)):t()),C.Bt.emit("toggleMasterDrawer","chat")},getMessages(e,t){return new Promise(((e,i)=>{if(this.chat.pagination.page+=1,this.chat.pagination.page<=this.chat.pagination.lastPage){1==this.chat.pagination.page&&(this.chat.messages=[]),this.chat.loading=!0;let e={refresh:!0,params:{page:this.chat.pagination.page,take:this.chat.pagination.perPage,filter:{conversationId:this.chat.conversation.id}}};this.$crud.index("apiRoutes.qchat.messages",e).then((e=>{this.chat.messages=this.chat.messages.concat(e.data),this.chat.pagination.lastPage=e.meta.page.lastPage,this.chat.loading=!1,t()})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.chat.loading=!1}))}))}else this.$refs.chatInfiniteSroll.stop(),t&&t()}))},setEmoji(e){let t=this.$clone(this.chat.textMessage),i=this.$refs.inputChat.$refs.input,a=i.selectionStart,s=t.substring(0,a),o=t.substring(a,t.length);this.chat.textMessage=s+e+o},sendMessage(){return new Promise(((e,t)=>{if(this.chat.textMessage.length){let e={conversationId:this.chat.conversation.id,body:this.chat.textMessage,userId:this.$store.state.quserAuth.userId};this.$crud.create("apiRoutes.qchat.messages",e),this.pushMessage(e)}}))},pushMessage(e){this.chat.messages.unshift({createdAt:this.$moment().format(),...e}),this.chat.textMessage="",setTimeout((()=>{this.$refs.chatBodyContent.scrollTo(0,this.$refs.chatBodyContent.scrollHeight)}),100)}}};var ut=i(57201),ht=i(97569),pt=i(55530),ft=i(90211),gt=i(77002),bt=i(78020),vt=i(51225);const kt=(0,Q.A)(mt,[["render",dt]]),wt=kt;N()(mt,"components",{QIcon:X.A,QSeparator:W.A,QSelect:Oe.A,QItem:B.A,QItemSection:T.A,QList:E.A,QAvatar:R.A,QDialog:ut.A,QCard:ht.A,QToolbar:J.A,QToolbarTitle:Y.A,QBtn:I.A,QInfiniteScroll:pt.A,QSpinnerDots:ft.A,QChatMessage:gt.A,QInput:bt.A,QField:vt.A}),N()(mt,"directives",{ClosePopup:V.A});const At={id:"listMenu"};function yt(e,t,i,o,n,r){const l=(0,a.g2)("q-tooltip"),c=(0,a.g2)("q-icon"),d=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-item"),u=(0,a.g2)("recursive-menu"),h=(0,a.g2)("q-expansion-item"),p=(0,a.g2)("q-no-ssr");return(0,a.bo)(((0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",At,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.menuData,((t,o)=>((0,a.uX)(),(0,a.Wv)(p,{key:o,class:(0,s.C4)("content-item "+(i.inLine?"inline-block":""))},{default:(0,a.k6)((()=>[i.withTooltip?((0,a.uX)(),(0,a.Wv)(l,(0,s._B)((0,a.v6)({key:0},i.tooltipProps||{})),{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(i.translatable?e.$tr(t.title):t.title),1)])),_:2},1040)):(0,a.Q3)("",!0),void 0==t.itemProps?.vIf||t.itemProps?.vIf?((0,a.uX)(),(0,a.Wv)(m,(0,a.v6)({key:1,id:`menuItem-${r.parseIdItem(t.name)}`||`menuItem-${o}`},t.itemProps),{default:(0,a.k6)((()=>[t.icon&&i.showIcons?((0,a.uX)(),(0,a.Wv)(d,{key:0,avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(c,{name:t.icon},null,8,["name"])])),_:2},1024)):(0,a.Q3)("",!0),(0,a.bF)(d,{class:"text-capitalize"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(i.translatable?e.$tr(t.title):t.title),1)])),_:2},1024)])),_:2},1040,["id"])):r.checkItemMultiple(t)?((0,a.uX)(),(0,a.Wv)(h,(0,a.v6)({icon:t.icon,key:o,label:i.translatable?e.$tr(t.title):t.title},i.group?{group:n.listUid}:{},{"header-class":r.selectedChildren(t),"default-opened":!!r.selectedChildren(t),class:r.selectedChildren(t)?"expansion-selected":""}),{default:(0,a.k6)((()=>[((0,a.uX)(),(0,a.Wv)(u,{translatable:i.translatable,"show-icons":i.showIcons,key:o,menu:t.children,group:i.group},null,8,["translatable","show-icons","menu","group"]))])),_:2},1040,["icon","label","header-class","default-opened","class"])):(0,a.Q3)("",!0)])),_:2},1032,["class"])))),128))])],512)),[[Je.aG,n.showMenu]])}const qt={name:"recursiveMenu",components:{},props:{withTooltip:{type:Boolean,default:!1},menu:{default:!1},showIcons:{type:Boolean,default:!0},translatable:{type:Boolean,default:!0},inLine:{type:Boolean,default:!1},group:{type:Boolean,defualt:!1},tooltipProps:{type:Object,default:null}},watch:{menu(){this.init()}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{showMenu:!1,listUid:this.$uid().toString(),props:{}}},computed:{menuData(){let e=this.$props.menu.map((e=>(e.itemProps={class:this.getClassItem(e),tag:"a",key:this.$uid(),vIf:this.checkItemSingle(e),clickable:!0},e.toRoute?e.itemProps.href=e.toRoute:e.itemProps.to={name:e.name,params:e.params||{}},e)));return e}},methods:{init(){this.props=this.$clone(this.$props),setTimeout((()=>{this.checkCollapsibles(),this.showMenu=!0}),300)},parseIdItem(e){return e.replaceAll(".","")},checkItemSingle(e){let t=!0;return e.activated||(t=!1),e.children&&(t=!1),e.name||(t=!1),e.permission&&!this.$hasAccess(e.permission)&&(t=!1),t},checkItemMultiple(e){let t=!0;return e.children||(t=!1),e.children&&!e.children.length&&(t=!1),e.permission&&!this.$hasAccess(e.permission)&&(t=!1),t},checkCollapsibles(){let e=this.$el.getElementsByClassName("q-expansion-item");for(let t of e){let e=t.getElementsByClassName("single-item");e.length||(t.style.display="none")}},redirectTo(e){e.linkType&&"external"==e.linkType?window.open(`https://${e.url}`,e.target):e.name&&this.$router.push({name:e.name,params:e.params||{}})},selectedChildren(e){let t="",i=e=>{let t=this.$route.name,a=!1;return e&&e.forEach((e=>{e.name==t&&(a=!0),e.children&&i(e.children)&&(a=!0)})),a};return e.children&&i(e.children)&&(t=" item-is-active"),t},getClassItem(e){let t="single-item";return this.$route.name==e.name&&JSON.stringify(this.$route.params)==JSON.stringify(e.params||{})&&(t+=" item-is-active"),t}}};var $t=i(76986);const xt=(0,Q.A)(qt,[["render",yt]]),_t=xt;N()(qt,"components",{QNoSsr:Ue.A,QTooltip:D.A,QItem:B.A,QItemSection:T.A,QIcon:X.A,QExpansionItem:$t.A});const Ft={id:"checkinComponent"},Ct={class:"row justify-between items-center q-pa-md"},Lt={class:"text-subtitle1 row items-center"},St={key:1,style:{height:"200px",padding:"22px 0"},class:"blue-grey text-center"},Qt={class:"q-px-md"},It={class:"q-mt-md"},Mt={id:"chronometerContent"},Wt={class:"text-center"},Et={class:"cursor-pointer",style:{"font-size":"12px"}},Bt={key:0},Tt={id:"timer",class:"q-box blue-grey text-center text-blue-grey"},Xt={class:"q-body-1"},Dt={id:"screen",class:"q-display-2 q-mb-sm"},zt={class:"q-caption"},Rt={key:2},Pt={class:"q-pa-md"},Vt={class:"text-center absolute-bottom q-my-md"};function Ht(e,t,i,o,n,r){const l=(0,a.g2)("q-icon"),c=(0,a.g2)("q-separator"),d=(0,a.g2)("open-map"),m=(0,a.g2)("q-btn"),u=(0,a.g2)("dynamic-field");return(0,a.uX)(),(0,a.CE)("div",Ft,[(0,a.Lk)("div",Ct,[(0,a.Lk)("div",Lt,[(0,a.bF)(l,{name:"fas fa-clock",color:"primary",size:"20px",class:"q-mr-sm"}),(0,a.Lk)("label",null,(0,s.v_)(e.$tr("icheckin.cms.sidebar.checkin",{capitalize:!0})),1)]),(0,a.bF)(l,{name:"fas fa-times",color:"blue-grey",size:"20px",class:"cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","checkin"))})]),(0,a.bF)(c,{class:"q-my-sm"}),n.currentLocation?((0,a.uX)(),(0,a.Wv)(d,{key:0,modelValue:n.mapMarket,"onUpdate:modelValue":t[1]||(t[1]=e=>n.mapMarket=e),"read-only":"",height:"200px"},null,8,["modelValue"])):((0,a.uX)(),(0,a.CE)("div",St,[(0,a.Lk)("div",Qt,[(0,a.bF)(l,{color:"grey-6",name:"fas fa-map-marked-alt",size:"80px"}),(0,a.Lk)("div",It,[(0,a.bF)(l,{name:"fas fa-exclamation-triangle",color:"warning"}),(0,a.eW)(" "+(0,s.v_)(this.$tr("icheckin.cms.sidebar.locationAddress")),1)])])])),(0,a.Lk)("div",Mt,[(0,a.Lk)("div",Wt,[n.activeShift?((0,a.uX)(),(0,a.Wv)(m,{key:1,color:"red",class:"q-mx-xs",size:"28px",round:"",loading:n.loading,onClick:r.endShift},{default:(0,a.k6)((()=>[(0,a.bF)(l,{id:"iconButton",name:"fas fa-stop",size:"25px",class:"q-pa-xs q-mb-xs full-width"}),(0,a.Lk)("label",Et,(0,s.v_)(this.$tr("isite.cms.label.close")),1)])),_:1},8,["loading","onClick"])):((0,a.uX)(),(0,a.Wv)(m,{key:0,loading:n.loading,onClick:r.createShift,round:"",color:"green",size:"23px",icon:"fas fa-play",class:"cursor-pointer q-pa-xs"},null,8,["loading","onClick"]))]),r.startChronometer?((0,a.uX)(),(0,a.CE)("div",Bt,[(0,a.Lk)("div",Tt,[(0,a.Lk)("div",Xt,(0,s.v_)(n.activeShift.checkinAt?e.$trd(n.activeShift.checkinAt,{type:"long"}):""),1),(0,a.Lk)("div",Dt,(0,s.v_)(n.time.text),1),(0,a.bF)(c,{size:"1px",color:"blue-grey",class:"q-my-xs"}),(0,a.Lk)("div",zt,[(0,a.bF)(l,{name:"fas fa-map-marker-alt",class:"q-mr-xs"}),(0,a.Lk)("b",null,(0,s.v_)(r.locationDescription),1)])])])):(0,a.Q3)("",!0)]),n.activeShift?((0,a.uX)(),(0,a.CE)("div",Rt,[(0,a.Lk)("div",Pt,[(0,a.bF)(u,{modelValue:n.comment.text,"onUpdate:modelValue":[t[2]||(t[2]=e=>n.comment.text=e),r.sendComment],field:r.fields.comments},null,8,["modelValue","field","onUpdate:modelValue"])])])):(0,a.Q3)("",!0),(0,a.Lk)("div",Vt,[(0,a.bF)(m,{unelevated:"",color:"green",rounded:"","no-caps":"",label:e.$tr("icheckin.cms.sidebar.Shifts"),icon:"fas fa-user-clock",to:{name:"qcheckin.main.shifts.index"}},null,8,["label","to"])])])}var Nt=i(75353);const Ut={beforeUnmount(){C.Bt.off("qcheckin.checkout")},props:{},emits:["checkin","checkout"],components:{openMap:Nt.A},watch:{},mounted(){this.$nextTick((function(){this.init()}))},beforeRouteLeave(e,t,i){this.control&&clearInterval(this.control),i()},data(){return{loading:!1,currentLocation:!1,mapMarket:!1,activeShift:!1,time:{text:"00:00:00",hh:0,mm:0,ss:0},control:!1,comment:{loading:!1,text:null},eventBus:C.Bt}},computed:{fields(){return{comments:{value:"",type:"input",props:{label:`${this.$tr("isite.cms.form.comment")}`,type:"textarea",rows:"3",icon:"fas fa-comment-dots",debounce:1500}}}},locationDescription(){return this.currentLocation?`Lat: ${this.currentLocation.latitude}, Lng: ${this.currentLocation.longitude}`:this.$tr("icheckin.cms.sidebar.noLocation")}},methods:{init(){this.getActiveShift(),this.getCurrentLocation(),C.Bt.on("qcheckin.checkout",(e=>{e.id==this.activeShift.id&&this.endShift()}))},async getCurrentLocation(){let e=await this.$helper.getCurrentPosition();e&&(this.currentLocation={latitude:e.coords.latitude,longitude:e.coords.longitude},this.mapMarket={lat:e.coords.latitude,lng:e.coords.longitude})},getActiveShift(){return new Promise(((e,t)=>{this.loading=!0;let i={refresh:!0,params:{filter:{noCheckout:!0,field:"checkin_by"}}},a=this.$store.state.quserAuth.userId;this.$crud.show("apiRoutes.qcheckin.shifts",a,i).then((t=>{"object"==typeof t.data&&(this.activeShift={...this.$clone(t.data),checkinAt:this.$moment().format(t.data.checkinAt)},this.comment.text=t.data.options.comment||null,this.startChronometer()),this.loading=!1,e(t.data)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.loading=!1,t(e)}))}))}))},async createShift(){this.loading=!0;let e={options:{},geoLocation:{}};this.currentLocation&&(e.geoLocation={checkin:this.$clone(this.currentLocation)}),this.$crud.create("apiRoutes.qcheckin.checkin",e).then((e=>{this.activeShift=this.$clone(e.data),this.startChronometer(),this.loading=!1})).catch((e=>{this.loading=!1}))},startChronometer(){this.activeShift&&(this.time.ss=this.$clone(this.activeShift.diff.s),this.time.mm=this.$clone(this.activeShift.diff.i),this.time.hh=this.$clone(this.activeShift.diff.h),this.time.text=(0==this.time.hh?"00":this.time.hh<10?"0"+this.time.hh:this.time.hh)+":"+(0==this.time.mm?"00":this.time.mm<10?"0"+this.time.mm:this.time.mm)+":"+(0==this.time.ss?"00":this.time.ss<10?"0"+this.time.ss:this.time.ss),this.control=setInterval(this.timer,1e3),this.$emit("checkin"))},timer(){let e,t,i;this.activeShift.diff.s++,60==this.activeShift.diff.s&&(this.activeShift.diff.s=0,this.activeShift.diff.i++),60==this.activeShift.diff.i&&(this.activeShift.diff.i=0,this.activeShift.diff.h++),e=this.$clone(this.activeShift.diff.s),t=this.$clone(this.activeShift.diff.i),i=this.$clone(this.activeShift.diff.h),this.activeShift.diff.s<10&&(e="0"+e),t<10&&(t="0"+t),i<10&&(i="0"+i),this.time.text=i+":"+t+":"+e},sendComment(){if(this.activeShift){this.loading=!0;let e={options:{...this.activeShift.options,comment:this.comment.text||"No comments"}};this.$crud.update("apiRoutes.qcheckin.shifts",this.activeShift.id,e).then((e=>{this.loading=!1})).catch((e=>this.loading=!1))}},async endShift(){this.loading=!0;let e={params:{filter:{checkout:!0}}},t=this.$clone(this.activeShift);this.currentLocation&&(t.geoLocation.checkout=this.$clone(this.currentLocation)),this.$crud.update("apiRoutes.qcheckin.checkout",t.id,t,e).then((e=>{this.activeShift=!1,clearInterval(this.control),this.$emit("checkout"),this.comment.text=null,this.loading=!1})).catch((e=>this.loading=!1))}}},Ot=(0,Q.A)(Ut,[["render",Ht]]),jt=Ot;N()(Ut,"components",{QIcon:X.A,QSeparator:W.A,QBtn:I.A});const Kt={id:"recommendationsComponent"},Gt={key:0,class:"relative-position"},Jt={class:"box row justify-between items-center"},Yt={class:"text-ellipsis text-subtitle1 row items-center"},Zt={class:"ellipsis relative-position"},ei={class:"text-subtitle2 q-pr-lg"},ti={class:"ellipsis"},ii={class:"row items-center"},ai={class:"text-caption text-justify"},si={key:1,class:"box item q-px-none q-py-md"};function oi(e,t,i,o,n,r){const l=(0,a.g2)("crud"),c=(0,a.g2)("q-icon"),d=(0,a.g2)("q-tooltip"),m=(0,a.g2)("q-btn"),u=(0,a.g2)("q-separator"),h=(0,a.g2)("q-item-section"),p=(0,a.g2)("q-item"),f=(0,a.g2)("q-list"),g=(0,a.g2)("q-menu"),b=(0,a.g2)("q-scroll-area"),v=(0,a.g2)("inner-loading"),k=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",Kt,[(0,a.bF)(l,(0,a.v6)(r.crudRecommendationParams,{onCreated:t[0]||(t[0]=e=>r.getData()),onUpdated:t[1]||(t[1]=e=>r.getData()),onDeleted:t[2]||(t[2]=e=>r.getData())}),null,16),n.recommendationName?((0,a.uX)(),(0,a.CE)("div",Gt,[(0,a.Lk)("div",Jt,[(0,a.Lk)("div",Yt,[(0,a.bF)(c,{class:"q-mr-sm",size:"20px",color:"primary",name:"fas fa-hat-wizard"}),(0,a.eW)(" "+(0,s.v_)(e.$trp("isite.cms.label.recommendation")),1)]),e.$hasAccess("isite.recommendations.create")&&"ipanel"!=n.appConfig.mode?((0,a.uX)(),(0,a.Wv)(m,{key:0,icon:"fas fa-plus",round:"",unelevated:"",size:"10px",color:"green",onClick:t[3]||(t[3]=t=>e.$refs.recommendations.create())},{default:(0,a.k6)((()=>[(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("isite.cms.label.add")),1)])),_:1})])),_:1})):(0,a.Q3)("",!0)]),(0,a.bF)(u,{class:"q-my-sm"}),n.items.length?((0,a.uX)(),(0,a.Wv)(b,{key:0,"thumb-style":n.thumbStyle,style:{height:"calc(100vh - 167px)"}},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.items,(t=>((0,a.uX)(),(0,a.CE)("div",{class:"box item q-px-none q-py-md",key:t.id},[(0,a.Lk)("div",Zt,[(0,a.Lk)("div",ei,[(0,a.bF)(c,{size:"20px",class:"q-mr-sm",color:"primary",name:"fas fa-magic"}),(0,a.Lk)("div",ti,(0,s.v_)(t.title),1),(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(t.title),1)])),_:2},1024)]),e.$hasAccess("isite.recommendations.manage")&&"ipanel"!=n.appConfig.mode?((0,a.uX)(),(0,a.Wv)(m,{key:0,class:"file-card__bottom_actions absolute-right",icon:"fas fa-ellipsis-v",unelevated:"",round:"",size:"sm",color:"blue-grey",flat:"",padding:"sm"},{default:(0,a.k6)((()=>[(0,a.bF)(g,{anchor:"bottom left",self:"bottom end"},{default:(0,a.k6)((()=>[(0,a.bF)(f,{style:{"min-width":"100px"}},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.fileActions,((e,i)=>(0,a.bo)(((0,a.uX)(),(0,a.Wv)(p,{clickable:"",key:i,onClick:i=>e.action(t)},{default:(0,a.k6)((()=>[(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",ii,[(0,a.bF)(c,{name:e.icon,class:"q-mr-sm",color:"blue-grey",size:"18px"},null,8,["name"]),(0,a.eW)(" "+(0,s.v_)(e.label),1)])])),_:2},1024)])),_:2},1032,["onClick"])),[[k]]))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024)):(0,a.Q3)("",!0)]),(0,a.bF)(u,{class:"q-my-xs"}),(0,a.Lk)("div",ai,(0,s.v_)(t.description),1)])))),128))])),_:1},8,["thumb-style"])):((0,a.uX)(),(0,a.CE)("div",si,(0,s.v_)(e.$trp("isite.cms.message.notFound")),1)),(0,a.bF)(v,{visible:n.loading},null,8,["visible"])])):(0,a.Q3)("",!0)])}var ni=i(99526)["A"];const ri={props:{},components:{},watch:{"$route.name":{deep:!0,handler:function(e){this.init()}}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{loading:!1,recommendationName:!1,items:!1,windowWith:window.innerWidth,appConfig:ni("app"),thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"$custom-accent-color",width:"5px",opacity:.1}}},computed:{crudRecommendationParams(){return{crudData:i.e(9226).then(i.bind(i,79226)),type:"only-create",ref:"recommendations",customData:{formLeft:{name:{value:this.recommendationName}}}}},fileActions(){return[{label:this.$tr("isite.cms.label.edit"),icon:"fas fa-pen",color:"green",action:e=>{this.$refs.recommendations.update(e)}},{label:this.$tr("isite.cms.label.delete"),icon:"fas fa-trash",color:"red",action:e=>{this.$refs.recommendations.delete(e)}}]},windowSize(){return this.windowWith>="992"?"desktop":"mobile"}},methods:{init(){this.resetData(),this.getData(),window.addEventListener("resize",(()=>{this.windowWith=window.innerWidth}))},resetData(){this.$route.meta.subHeader&&this.$route.meta.subHeader.recommendations?this.recommendationName=this.$route.meta.subHeader.recommendations.name:this.recommendationName=!1,this.items=!1},getData(){return new Promise(((e,t)=>{if(!this.recommendationName)return t(!1);this.loading=!0;let i={refresh:!0,params:{filter:{name:this.recommendationName}}};this.$crud.index("apiRoutes.qsite.recommendations",i).then((t=>{this.loading=!1,this.items=t.data,e(t.data)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.loading=!1}))}))}))}}};var li=i(19600);const ci=(0,Q.A)(ri,[["render",oi]]),di=ci;N()(ri,"components",{QIcon:X.A,QBtn:I.A,QTooltip:D.A,QSeparator:W.A,QScrollArea:li.A,QMenu:M.A,QList:E.A,QItem:B.A,QItemSection:T.A}),N()(ri,"directives",{ClosePopup:V.A});const mi={class:"row col justify-between items-center tw-p-5"},ui={class:"tw-text-xl tw-leading-5 text-weight-bold"},hi={class:"tw-flex tw-justify-end tw-content-center tw-items-center tw-gap-x-4"},pi={class:"full-width tw-px-5 tw-pt-[15px]"},fi={class:"flex justify-end"},gi={key:0};function bi(e,t,i,o,n,r){const l=(0,a.g2)("q-icon"),c=(0,a.g2)("q-btn"),d=(0,a.g2)("q-separator"),m=(0,a.g2)("notification-card"),u=(0,a.g2)("q-virtual-scroll"),h=(0,a.g2)("inner-loading"),p=(0,a.g2)("not-result"),f=(0,a.g2)("q-dialog"),g=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(f,{modelValue:n.openDialog,"onUpdate:modelValue":t[3]||(t[3]=e=>n.openDialog=e),posititon:"right","transition-hide":"slide-up","transition-show":"slide-down",onShow:r.getData,onHide:r.hideModal},{default:(0,a.k6)((()=>[(0,a.Lk)("div",{id:"drawerNotificationsComponent",style:(0,s.Tr)(r.style)},[(0,a.Lk)("div",mi,[(0,a.Lk)("label",ui,(0,s.v_)(e.$tr("notification.cms.sidebar.adminGroup")),1),(0,a.Lk)("div",hi,[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(c,{unelevated:"",rounded:"",dense:"",padding:"none",size:"xs"},{default:(0,a.k6)((()=>[(0,a.bF)(l,{name:"fa-regular fa-times",color:"grey-7",size:"22px",class:"cursor-pointer"})])),_:1})),[[g]])])]),(0,a.bF)(d),(0,a.Lk)("div",pi,[(0,a.bo)((0,a.Lk)("div",fi,[(0,a.bF)(c,{class:"tw-text-sm tw-leading-[18px] tw-font-semibold",flat:"",dense:"",unelevated:"","no-caps":"",padding:"none",label:e.$tr("notification.cms.markAllAsRead"),onClick:t[0]||(t[0]=e=>r.markAllAsRead())},null,8,["label"])],512),[[Je.aG,r.notificationsData.length&&!n.loading]]),(0,a.bF)(u,{class:"max-height-scroll",separator:"",items:r.notificationsData.slice(0,5)},{default:(0,a.k6)((({item:e,index:i})=>[((0,a.uX)(),(0,a.Wv)(m,{key:e.id,"item-notification":e,"source-settings":n.sourceSettings,onOpenModal:t[1]||(t[1]=e=>r.openModal(e))},null,8,["item-notification","source-settings"]))])),_:1},8,["items"]),(0,a.bF)(h,{visible:n.loading},null,8,["visible"]),r.notificationsData.length&&!n.loading?((0,a.uX)(),(0,a.CE)("div",gi,[(0,a.bF)(c,{unelevated:"",dense:"","no-caps":"",class:"full-width tw-mt-4 tw-mb-6 tw-rounded-lg",color:"grey-3","text-color":"grey-8",onClick:t[2]||(t[2]=e=>r.gotoNotifications()),label:e.$tr("notification.cms.seeAll",{capitalize:!0})},null,8,["label"])])):n.loading?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(p,{key:1,class:"tw-mt-4 tw-pl-5"}))])],4)])),_:1},8,["modelValue","onShow","onHide"])}var vi=i(38932),ki=i(11743),wi=i(53446);const Ai={beforeUnmount(){C.Bt.off("inotification.notifications.new"),wi.A.removeEvent()},props:{isMobile:!1,isOpen:!1},components:{notificationCard:ki.A},mounted(){this.$nextTick((function(){this.init()}))},watch:{notificationFirebase:{deep:!0,handler:function(e,t){this.notifications.unshift(e)}},isOpen(e){this.openDialog=this.$clone(e)}},data(){return{loading:!1,openDialog:!1,notifications:[],thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"$custom-accent-color",width:"5px",opacity:.1},refScrollArea:null,pagination:{page:1,perPage:5,lastPage:-1},sourceSettings:null,eventBus:C.Bt}},computed:{notificationFirebase(){return wi.A.notification},style(){return this.isMobile?"margin: 0px;":"margin: 50px 10px 0px 0px;"},notificationsData(){let e=[],t=this.$clone(this.notifications);return C.Bt.emit("header.badge.manage",{notification:!1}),t&&t.length&&t.forEach((t=>{t.id||this.$uid(),t.title,t.message,t.icon,t.createdAt||this.$moment(),t.isRead,t.link,!(!t.options||!t.options.isImportant)&&t.options.isImportant;t.isRead||C.Bt.emit("header.badge.manage",{notification:!0}),e.push(t)})),e}},methods:{async init(){wi.A.addEvent(),this.listenEvents(),await this.getSources(),wi.A.icon=this.$store.state.qsiteApp.logo},listenEvents(){C.Bt.on("inotification.notifications.new",(e=>{this.notifications.unshift(e),this.$alert.info({message:`${e.title.substr(0,30)}...`,icon:"fas fa-bell",actions:[{label:this.$tr("isite.cms.label.show"),color:"white",handler:()=>C.Bt.emit("openMasterDrawer","notification")}]}),this.$helper.playSound({url:`${this.$store.state.qsiteApp.baseUrl}/modules/notification/audio/sound_notification.mp3`})}))},getData(){return new Promise(((e,t)=>{this.loading=!0;let i={refresh:!0,params:{take:this.pagination.perPage,page:this.pagination.page,filter:{me:!0,type:"broadcast"}}};vi.A.getNotifications(i).then((t=>{this.notifications=[...this.notifications,...t.data],this.pagination.lastPage=t.meta.page.lastPage,this.pagination.page=t.meta.page.currentPage,this.loading=!1,e(t.data)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.loading=!1}))}))}))},gotoNotifications(){"notification.admin.notificationIndex"!=this.$route.name&&this.$router.push({name:"notification.admin.notificationIndex"})},getSources(){this.loading=!0,vi.A.getSources().then((e=>{this.sourceSettings=e}))},lastItem(e){const t=this.notifications[this.notifications.length-1];return t.id==e.id},markAsRead(e){this.notifications.find((t=>{t.id==e.id&&(t.isRead=!0)}))},markAllAsRead(){this.notifications=this.notifications.map((e=>({...e,isRead:!0}))),vi.A.markAllAsRead()},openModal(e){C.Bt.emit("imagina.notification.open",e)},hideModal(){this.notifications=[],C.Bt.emit("toggleMasterDrawer","notification")}}};var yi=i(13117);const qi=(0,Q.A)(Ai,[["render",bi],["__scopeId","data-v-76486251"]]),$i=qi;N()(Ai,"components",{QDialog:ut.A,QBtn:I.A,QIcon:X.A,QSeparator:W.A,QVirtualScroll:yi.A}),N()(Ai,"directives",{ClosePopup:V.A});const xi={id:"drawerOffline",class:"q-pa-md"},_i={class:"row justify-between items-center"},Fi={class:"text-subtitle1 row items-center"};function Ci(e,t,i,o,n,r){const l=(0,a.g2)("q-icon"),c=(0,a.g2)("q-separator"),d=(0,a.g2)("q-item-label"),m=(0,a.g2)("q-item-section"),u=(0,a.g2)("q-item"),h=(0,a.g2)("q-list");return(0,a.uX)(),(0,a.CE)("div",xi,[(0,a.Lk)("div",_i,[(0,a.Lk)("div",Fi,[(0,a.bF)(l,{name:"fa fa-cloud-upload",color:"primary",size:"20px",class:"q-mr-sm"}),(0,a.Lk)("label",null,(0,s.v_)(e.$tr("isite.cms.label.offlineRequests",{capitalize:!0})),1)]),(0,a.bF)(l,{name:"fas fa-times",color:"blue-grey",size:"20px",class:"cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","offline"))})]),(0,a.bF)(c,{class:"q-my-md"}),(0,a.bF)(h,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.requests,(t=>((0,a.uX)(),(0,a.CE)("div",{key:t?.id},[(0,a.bF)(u,{class:"tw-flex-col tw-py-5 tw-rounded-lg tw-bg-white tw-shadow-lg tw-mb-4"},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{class:"tw-text-sm tw-text-gray-400"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(r.getTitle(t)?.titleOffline),1)])),_:2},1024),r.getTitle(t)?.id?((0,a.uX)(),(0,a.Wv)(d,{key:0,class:"tw-font-bold tw-text-base"},{default:(0,a.k6)((()=>[(0,a.eW)(" ID: "+(0,s.v_)(r.getTitle(t)?.id),1)])),_:2},1024)):(0,a.Q3)("",!0)])),_:2},1024),(0,a.bF)(m,{class:"tw-flex-row tw-justify-between tw-items-center tw-mt-2 tw-text-gray-400",style:{"margin-left":"0"}},{default:(0,a.k6)((()=>[(0,a.bF)(d,{class:"tw-font-semibold"},{default:(0,a.k6)((()=>[(0,a.bF)(l,{name:n.actions[t?.requestData?.method].icon,color:n.actions[t?.requestData?.method].color,size:"14px",class:"q-mr-sm"},null,8,["name","color"]),(0,a.eW)(" "+(0,s.v_)(n.actions[t?.requestData?.method].action),1)])),_:2},1024),(0,a.bF)(d,{class:"tw-text-sm"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$moment(t?.timestamp).fromNow()),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])}var Li=i(68863);const Si={name:"drawerOffline",props:{},components:{},watch:{},beforeUnmount(){C.Bt.off("header.badge.manage")},mounted(){this.$nextTick((async()=>{this.$store.dispatch("qofflineMaster/OFFLINE_REQUESTS",{userId:this.$store.state.quserAuth.userId}),await(0,Li.g)()}))},computed:{requests(){return this.$store.state.qofflineMaster.requestsReversed}},data(){return{refreshIntervalId:null,eventBus:C.Bt,actions:{POST:{icon:"fa-solid fa-square-plus",action:"Create",color:"secondary"},PUT:{icon:"fa-solid fa-arrows-rotate",action:"Update",color:"warning"},DELETE:{icon:"fa-solid fa-trash",action:"Delete",color:"negative"}}}},methods:{decode(e){try{if(!e)return;const t=new TextDecoder("utf-8"),i=t.decode(e);return i?JSON.parse(i):{}}catch(t){console.error("Error decoding data",t)}},getTitle(e){if(e?.requestData?.body){const t=this.decode(e.requestData.body),i=t?.attributes;return{id:i?.id||"",titleOffline:i?.titleOffline||i?.title_offline||""}}}}};var Qi=i(35779);const Ii=(0,Q.A)(Si,[["render",Ci]]),Mi=Ii;N()(Si,"components",{QIcon:X.A,QSeparator:W.A,QList:E.A,QItem:B.A,QItemSection:T.A,QItemLabel:Qi.A});var Wi=i(99526)["A"];const Ei={beforeUnmount(){C.Bt.off("toggleMasterDrawer"),C.Bt.off("openMasterDrawer")},mixins:[ue.A],props:{},components:{menuList:_t,configList:Ge,chatList:wt,checkin:jt,masterRecommendation:di,masterNotifications:$i,offline:Mi},mounted(){this.$nextTick((function(){this.init()}))},data(){return{windowHeight:window.innerHeight,windowWith:window.innerWidth,projectName:this.$getSetting("core::site-name"),miniState:"mobile"!=this.windowSize,drawer:{menu:!this.$q.platform.is.mobile,config:!1,chat:!1,checkin:!1,recommendation:!1,notification:!1,offline:!1},appConfig:Wi("app"),eventBus:C.Bt}},computed:{windowSize(){return this.windowWith>="992"?"desktop":"mobile"},routeSubHeader(){return this.drawer.recommendation=!1,this.$route.meta.subHeader||{}},versionText(){return"v"+Wi("app.version")},logo(){return this.$store.state.qsiteApp.logo}},methods:{init(){this.handlerEvent(),window.addEventListener("resize",(()=>{this.windowHeight=window.innerHeight,this.windowWith=window.innerWidth}))},handlerEvent(){C.Bt.on("toggleMasterDrawer",(e=>this.toggleDrawer(e))),C.Bt.on("openMasterDrawer",(e=>this.drawer[e]=!0))},toggleDrawer(e){for(var t in this.drawer)t!=e&&("menu"==t&&"mobile"!=this.windowSize?this.miniState=!0:this.drawer[t]=!1);"menu"==e?"mobile"==this.windowSize?(this.miniState=!1,this.drawer.menu=!this.drawer.menu):(this.drawer.menu=!0,this.miniState=!this.miniState):this.drawer[e]=!this.drawer[e]}}};var Bi=i(22701),Ti=i(65287);const Xi=(0,Q.A)(Ei,[["render",me]]),Di=Xi;N()(Ei,"components",{QDrawer:Bi.A,QImg:Ti.A,QIcon:X.A,QScrollArea:li.A,QExpansionItem:$t.A,QItem:B.A});const zi={id:"masterDrawers2"},Ri={id:"logoSite2",class:"relative-position"},Pi={key:0,id:"miniLogoSite"};function Vi(e,t,i,o,n,r){const l=(0,a.g2)("q-img"),c=(0,a.g2)("menu-list"),d=(0,a.g2)("q-scroll-area"),m=(0,a.g2)("q-drawer"),u=(0,a.g2)("config-list"),h=(0,a.g2)("chat-list"),p=(0,a.g2)("master-recommendation"),f=(0,a.g2)("master-notifications"),g=(0,a.g2)("offline");return(0,a.uX)(),(0,a.CE)("div",zi,[(0,a.bF)(m,{id:"menuMaster2",class:"no-shadow",modelValue:n.drawer.menu,"onUpdate:modelValue":t[0]||(t[0]=e=>n.drawer.menu=e),ref:"menuMaster",mini:n.miniState,onClickCapture:t[1]||(t[1]=e=>n.miniState?n.eventBus.emit("toggleMasterDrawer","menu"):null)},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.Lk)("div",Ri,[(0,a.bF)(l,{fit:"contain",src:n.logo,style:{height:"80px","min-height":"80px"}},null,8,["src"])],512),[[Je.aG,!n.miniState]]),n.miniState?((0,a.uX)(),(0,a.CE)("div",Pi,[(0,a.bF)(l,{fit:"contain",src:r.minilogo},null,8,["src"])])):(0,a.Q3)("",!0),(0,a.bF)(d,{id:"adminMenu",class:"bg-primary",style:(0,s.Tr)("height: calc(100vh - 146px")},{default:(0,a.k6)((()=>[(0,a.bF)(c,{ref:"menuList",group:"",translatable:e.menuTranslatable,menu:e.menuSelect,"with-tooltip":n.miniState,"tooltip-props":{anchor:"center right"}},null,8,["translatable","menu","with-tooltip"])])),_:1},8,["style"])])),_:1},8,["modelValue","mini"]),(0,a.bF)(m,{bordered:"",id:"configMaster",overlay:"",modelValue:n.drawer.config,"onUpdate:modelValue":t[2]||(t[2]=e=>n.drawer.config=e),side:"right"},{default:(0,a.k6)((()=>[(0,a.bF)(u)])),_:1},8,["modelValue"]),e.$hasAccess("ichat.conversations.index")?((0,a.uX)(),(0,a.Wv)(m,{key:0,bordered:"",id:"chatMaster",overlay:"",modelValue:n.drawer.chat,"onUpdate:modelValue":t[3]||(t[3]=e=>n.drawer.chat=e),side:"right"},{default:(0,a.k6)((()=>[(0,a.bF)(h)])),_:1},8,["modelValue"])):(0,a.Q3)("",!0),!r.routeSubHeader.recommendations?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(m,{key:1,id:"drawerRecommendationMaster",modelValue:n.drawer.recommendation,"onUpdate:modelValue":t[4]||(t[4]=e=>n.drawer.recommendation=e),side:"right",overlay:!1},{default:(0,a.k6)((()=>[(0,a.bF)(p)])),_:1},8,["modelValue"])),(0,a.bF)(f,{"is-open":n.drawer.notification,isMobile:"mobile"==this.windowSize},null,8,["is-open","isMobile"]),r.offlineDrawer?((0,a.uX)(),(0,a.Wv)(m,{key:2,class:"tw-bg-gray-100",id:"drawerOfflineMaster",modelValue:n.drawer.offline,"onUpdate:modelValue":t[5]||(t[5]=e=>n.drawer.offline=e),side:"right",overlay:""},{default:(0,a.k6)((()=>[(0,a.bF)(g)])),_:1},8,["modelValue"])):(0,a.Q3)("",!0)])}var Hi=i(99526)["A"];const Ni={beforeUnmount(){C.Bt.off("toggleMasterDrawer"),C.Bt.off("openMasterDrawer")},mixins:[ue.A],props:{},components:{menuList:_t,configList:Ge,chatList:wt,checkin:jt,masterRecommendation:di,masterNotifications:$i,offline:Mi},mounted(){this.$nextTick((function(){this.init()}))},data(){return{windowHeight:window.innerHeight,windowWith:window.innerWidth,projectName:this.$getSetting("core::site-name"),logo:this.$store.state.qsiteApp.logo,miniState:"mobile"!=this.windowSize,drawer:{menu:!1,config:!1,chat:!1,checkin:!1,recommendation:!1,notification:!1,offline:!1},appConfig:Hi("app"),eventBus:C.Bt}},computed:{offlineDrawer(){return this.$getSetting("isite::offline")},windowSize(){return this.windowWith>="992"?"desktop":"mobile"},primaryContrast(){return this.$getSetting("isite::primaryContrast")},secondaryContrast(){return this.$getSetting("isite::secondaryContrast")},minilogo(){return this.$getMediaSetting("isite::logoIadminSM")["path"]},routeSubHeader(){return this.drawer.recommendation=!1,this.$route.meta.subHeader||{}},versionText(){return"v"+Hi("app.version")},openMenu:{get(){return this.drawer.menu},set(e){this.drawer.menu=e}}},methods:{init(){this.handlerEvent(),this.contrast(),window.addEventListener("resize",(()=>{this.windowHeight=window.innerHeight,this.windowWith=window.innerWidth})),this.openMenu="mobile"!=this.windowSize},contrast(){const e=document.querySelector("#masterDrawers2");if(!e)return"#000000";const t=getComputedStyle(e).getPropertyValue("--q-primary"),i=this.$helper.pickTextColor(t),a=getComputedStyle(e).getPropertyValue("--q-secondary"),s=this.$helper.pickTextColor(a);return this.primaryContrast?e.style.setProperty("--q-color-contrast",this.primaryContrast):e.style.setProperty("--q-color-contrast",i),this.secondaryContrast?e.style.setProperty("--q-color-contrast-two",this.secondaryContrast):e.style.setProperty("--q-color-contrast-two",s),this.primaryContrast?this.primaryContrast:i},handlerEvent(){C.Bt.on("toggleMasterDrawer",(e=>this.toggleDrawer(e))),C.Bt.on("openMasterDrawer",(e=>this.drawer[e]=!0))},toggleDrawer(e){for(var t in this.drawer)t!=e&&("menu"==t&&"mobile"!=this.windowSize?this.miniState=!0:this.drawer[t]=!1);"menu"==e?"mobile"==this.windowSize?(this.miniState=!1,this.drawer.menu=!this.drawer.menu):(this.drawer.menu=!0,this.miniState=!this.miniState):this.drawer[e]=!this.drawer[e]}}};var Ui=i(71339);const Oi=(0,Q.A)(Ni,[["render",Vi]]),ji=Oi;N()(Ni,"components",{QDrawer:Bi.A,QImg:Ti.A,QScrollArea:li.A,QColor:Ui.A,QItem:B.A,QIcon:X.A,QExpansionItem:$t.A});const Ki={id:"masterFooter"},Gi={key:0,id:"footerContent",class:"row q-md-hide items-center"},Ji=(0,a.Lk)("div",null,"Menu",-1),Yi={id:"footerMobileProfile",class:"item-footer col cursor-pointer"},Zi=["src"],ea={id:"item-main",class:(0,s.C4)("cursor-pointer row items-center justify-center bg-white")};function ta(e,t,i,o,n,r){const l=(0,a.g2)("q-icon"),c=(0,a.g2)("q-avatar"),d=(0,a.g2)("q-btn"),m=(0,a.g2)("q-footer"),u=(0,a.g2)("q-toolbar-title"),h=(0,a.g2)("q-toolbar"),p=(0,a.g2)("q-separator"),f=(0,a.g2)("q-item-section"),g=(0,a.g2)("q-item"),b=(0,a.g2)("q-list"),v=(0,a.g2)("q-card-section"),k=(0,a.g2)("q-card"),w=(0,a.g2)("q-dialog"),A=(0,a.gN)("close-popup"),y=(0,a.gN)("ripple");return(0,a.uX)(),(0,a.CE)("div",Ki,[(0,a.bF)(m,{class:"bg-primary shadow-2"},{default:(0,a.k6)((()=>["iadmin"==n.appConfig.mode?((0,a.uX)(),(0,a.CE)("div",Gi,[(0,a.Lk)("div",{id:"footerMobileMenu",class:"item-footer col cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","menu"))},[(0,a.bF)(l,{class:"item-icon",name:"fas fa-bars"}),Ji]),(0,a.Lk)("div",Yi,[r.quserState.authenticated?((0,a.uX)(),(0,a.Wv)(d,{key:0,to:{name:"user.profile.me"},flat:"","no-caps":"",class:"item-icon",padding:"none"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{size:"20px"},{default:(0,a.k6)((()=>[(0,a.Lk)("img",{src:r.quserState?.userData?.mainImage},null,8,Zi)])),_:1})])),_:1},8,["to"])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,(0,s.v_)(e.$tr("isite.cms.label.profile")),1)]),(0,a.Lk)("div",{id:"footerMobileMain",class:"col",onClick:t[1]||(t[1]=e=>r.doMainAction())},[(0,a.Lk)("div",ea,[(0,a.bF)(l,{class:"item-icon",color:"primary",name:n.mainAction.icon},null,8,["name"])])]),(0,a.Lk)("div",{id:"footerMobileGoToSite",class:"item-footer col cursor-pointer bg",onClick:t[2]||(t[2]=t=>e.$helper.openExternalURL(e.$store.state.qsiteApp.baseUrl))},[(0,a.bF)(l,{class:"item-icon",name:"fa-light fa-eye"}),(0,a.Lk)("div",null,(0,s.v_)(e.$tr("isite.cms.configList.goToSite")),1)]),(0,a.Lk)("div",{id:"footerMobileOthers",class:"item-footer col cursor-pointer",onClick:t[3]||(t[3]=e=>n.modal.show=!0)},[(0,a.bF)(l,{class:"item-icon",name:"fas fa-ellipsis-h"}),(0,a.Lk)("div",null,(0,s.v_)(e.$trp("isite.cms.label.other")),1)])])):(0,a.Q3)("",!0)])),_:1}),"iadmin"==n.appConfig.mode?((0,a.uX)(),(0,a.Wv)(w,{key:0,modelValue:n.modal.show,"onUpdate:modelValue":t[10]||(t[10]=e=>n.modal.show=e),position:"bottom"},{default:(0,a.k6)((()=>[(0,a.bF)(k,{style:{width:"350px"}},{default:(0,a.k6)((()=>[(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(l,{class:"item-icon",name:"fas fa-ellipsis-v"}),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$trp("isite.cms.label.other")),1)])),_:1}),(0,a.bo)((0,a.bF)(d,{flat:"",round:"",dense:"",icon:"fa fa-close"},null,512),[[A]])])),_:1}),(0,a.bF)(p),(0,a.bF)(v,{class:"row items-center no-wrap q-pa-none"},{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(b,{separator:"",class:"full-width"},{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:t[4]||(t[4]=e=>n.eventBus.emit("toggleMasterDrawer","config"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fa-light fa-folder-gear"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("isite.cms.label.setting")),1)])),_:1})])),_:1})),[[y]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:t[5]||(t[5]=e=>n.eventBus.emit("toggleMasterDrawer","offline"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fa-light fa-wifi-slash"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("isite.cms.label.offlineRequests")),1)])),_:1})])),_:1})),[[y]]),e.$hasAccess("ichat.conversations.index")?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:0,clickable:"",onClick:t[6]||(t[6]=e=>n.eventBus.emit("toggleMasterDrawer","chat"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fa-light fa-message"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)("Chat")])),_:1})])),_:1})),[[y]]):(0,a.Q3)("",!0),e.$hasAccess("icheckin.shifts.create")?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:1,clickable:"",onClick:t[7]||(t[7]=e=>n.eventBus.emit("toggleMasterDrawer","checkin"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fas fa-stopwatch"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("icheckin.cms.sidebar.checkin")),1)])),_:1})])),_:1})),[[y]]):(0,a.Q3)("",!0),!r.params.recommendations?(0,a.Q3)("",!0):(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:2,clickable:"",onClick:t[8]||(t[8]=e=>n.eventBus.emit("toggleMasterDrawer","recommendation"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fas fa-hat-wizard"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$trp("isite.cms.label.recommendation")),1)])),_:1})])),_:1})),[[y]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:t[9]||(t[9]=e=>n.eventBus.emit("toggleMasterDrawer","notification"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fa-light fa-bell"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$trp("isite.cms.label.notification")),1)])),_:1})])),_:1})),[[y]])])),_:1})),[[A]])])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,a.Q3)("",!0)])}var ia=i(99526)["A"];const aa={beforeUnmount(){C.Bt.off("setMobileMainAction")},props:{},components:{},watch:{$route:{deep:!0,handler:function(e){this.mainAction=ia("app.mobilMainAction")}}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{mainAction:ia("app.mobilMainAction"),appConfig:ia("app"),modal:{show:!1},eventBus:C.Bt}},computed:{quserState(){return this.$store.state.quserAuth},routeSubHeader(){return this.$route.meta.subHeader||{}},currentRoute(){return this.$route},params(){return this.currentRoute.meta.subHeader||{}}},methods:{init(){C.Bt.on("setMobileMainAction",(e=>{this.mainAction={...this.mainAction,...e}}))},doMainAction(){this.mainAction.callBack?this.mainAction.callBack():this.mainAction.route&&this.$route.name!=this.mainAction.route&&this.$router.push({name:this.mainAction.route})}}};var sa=i(48889),oa=i(27066);const na=(0,Q.A)(aa,[["render",ta]]),ra=na;N()(aa,"components",{QFooter:sa.A,QIcon:X.A,QBtn:I.A,QAvatar:R.A,QDialog:ut.A,QCard:ht.A,QToolbar:J.A,QToolbarTitle:Y.A,QSeparator:W.A,QCardSection:oa.A,QList:E.A,QItem:B.A,QItemSection:T.A}),N()(aa,"directives",{ClosePopup:V.A,Ripple:P.A});const la={id:"masterFooter"},ca={key:0,id:"footerContent",class:"row q-md-hide items-center"},da=(0,a.Lk)("div",null,"Menu",-1),ma={id:"footerMobileProfile",class:"item-footer col cursor-pointer"},ua=["src"],ha={id:"item-main",class:(0,s.C4)("cursor-pointer row items-center justify-center bg-white")};function pa(e,t,i,o,n,r){const l=(0,a.g2)("q-icon"),c=(0,a.g2)("q-avatar"),d=(0,a.g2)("q-btn"),m=(0,a.g2)("q-footer"),u=(0,a.g2)("q-toolbar-title"),h=(0,a.g2)("q-toolbar"),p=(0,a.g2)("q-separator"),f=(0,a.g2)("q-item-section"),g=(0,a.g2)("q-item"),b=(0,a.g2)("q-list"),v=(0,a.g2)("q-card-section"),k=(0,a.g2)("q-card"),w=(0,a.g2)("q-dialog"),A=(0,a.gN)("close-popup"),y=(0,a.gN)("ripple");return(0,a.uX)(),(0,a.CE)("div",la,[(0,a.bF)(m,{class:"bg-primary shadow-2"},{default:(0,a.k6)((()=>["iadmin"==n.appConfig.mode?((0,a.uX)(),(0,a.CE)("div",ca,[(0,a.Lk)("div",{id:"footerMobileMenu",class:"item-footer col cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","menu"))},[(0,a.bF)(l,{class:"item-icon",name:"fas fa-bars"}),da]),(0,a.Lk)("div",ma,[r.quserState.authenticated?((0,a.uX)(),(0,a.Wv)(d,{key:0,to:{name:"user.profile.me"},flat:"","no-caps":"",class:"item-icon",padding:"none"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{size:"20px"},{default:(0,a.k6)((()=>[(0,a.Lk)("img",{src:r.quserState?.userData?.mainImage},null,8,ua)])),_:1})])),_:1},8,["to"])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,(0,s.v_)(e.$tr("isite.cms.label.profile")),1)]),(0,a.Lk)("div",{id:"footerMobileMain",class:"col",onClick:t[1]||(t[1]=e=>r.doMainAction())},[(0,a.Lk)("div",ha,[(0,a.bF)(l,{class:"item-icon",color:"primary",name:n.mainAction.icon},null,8,["name"])])]),(0,a.Lk)("div",{class:"item-footer col cursor-pointer",onClick:t[2]||(t[2]=t=>e.$eventBus.emit("toggleMasterDrawer","config"))},[(0,a.bF)(l,{class:"item-icon",name:"fas fa-cog"}),(0,a.Lk)("div",null,(0,s.v_)(e.$tr("isite.cms.label.setting")),1)]),(0,a.Lk)("div",{id:"footerMobileOthers",class:"item-footer col cursor-pointer",onClick:t[3]||(t[3]=e=>n.modal.show=!0)},[(0,a.bF)(l,{class:"item-icon",name:"fas fa-ellipsis-h"}),(0,a.Lk)("div",null,(0,s.v_)(e.$trp("isite.cms.label.other")),1)])])):(0,a.Q3)("",!0)])),_:1}),"iadmin"==n.appConfig.mode?((0,a.uX)(),(0,a.Wv)(w,{key:0,modelValue:n.modal.show,"onUpdate:modelValue":t[11]||(t[11]=e=>n.modal.show=e),position:"bottom"},{default:(0,a.k6)((()=>[(0,a.bF)(k,{style:{width:"350px"}},{default:(0,a.k6)((()=>[(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(l,{class:"item-icon",name:"fas fa-ellipsis-v"}),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$trp("isite.cms.label.other")),1)])),_:1}),(0,a.bo)((0,a.bF)(d,{flat:"",round:"",dense:"",icon:"fa fa-close"},null,512),[[A]])])),_:1}),(0,a.bF)(p),(0,a.bF)(v,{class:"row items-center no-wrap q-pa-none"},{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(b,{separator:"",class:"full-width"},{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:t[4]||(t[4]=e=>n.eventBus.emit("toggleMasterDrawer","config"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fa-light fa-folder-gear"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("isite.cms.label.setting")),1)])),_:1})])),_:1})),[[y]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:t[5]||(t[5]=e=>n.eventBus.emit("toggleMasterDrawer","offline"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fa-light fa-wifi-slash"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("isite.cms.label.offlineRequests")),1)])),_:1})])),_:1})),[[y]]),e.$hasAccess("ichat.conversations.index")?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:0,clickable:"",onClick:t[6]||(t[6]=e=>n.eventBus.emit("toggleMasterDrawer","chat"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fa-light fa-message"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)("Chat")])),_:1})])),_:1})),[[y]]):(0,a.Q3)("",!0),e.$hasAccess("icheckin.shifts.create")?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:1,clickable:"",onClick:t[7]||(t[7]=e=>n.eventBus.emit("toggleMasterDrawer","checkin"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fas fa-stopwatch"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("icheckin.cms.sidebar.checkin")),1)])),_:1})])),_:1})),[[y]]):(0,a.Q3)("",!0),!r.params.recommendations?(0,a.Q3)("",!0):(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:2,clickable:"",onClick:t[8]||(t[8]=e=>n.eventBus.emit("toggleMasterDrawer","recommendation"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fas fa-hat-wizard"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$trp("isite.cms.label.recommendation")),1)])),_:1})])),_:1})),[[y]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:t[9]||(t[9]=e=>n.eventBus.emit("toggleMasterDrawer","notification"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fa-light fa-bell"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$trp("isite.cms.label.notification")),1)])),_:1})])),_:1})),[[y]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:t[10]||(t[10]=t=>e.$router.push({name:"auth.logout"}))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fa-light fa-right-from-bracket"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("isite.cms.configList.signOut")),1)])),_:1})])),_:1})),[[y]])])),_:1})),[[A]])])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,a.Q3)("",!0)])}var fa=i(99526)["A"];const ga={beforeUnmount(){C.Bt.off("setMobileMainAction")},props:{},components:{},watch:{$route:{deep:!0,handler:function(e){this.mainAction=fa("app.mobilMainAction")}}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{mainAction:fa("app.mobilMainAction"),appConfig:fa("app"),loadFooterIpanel:!1,modal:{show:!1},eventBus:C.Bt}},computed:{quserState(){return this.$store.state.quserAuth},routeSubHeader(){return this.$route.meta.subHeader||{}},currentRoute(){return this.$route},params(){return this.currentRoute.meta.subHeader||{}}},methods:{init(){C.Bt.on("setMobileMainAction",(e=>{this.mainAction={...this.mainAction,...e}}))},doMainAction(){this.mainAction.callBack?this.mainAction.callBack():this.mainAction.route&&this.$route.name!=this.mainAction.route&&this.$router.push({name:this.mainAction.route})}}},ba=(0,Q.A)(ga,[["render",pa]]),va=ba;N()(ga,"components",{QFooter:sa.A,QIcon:X.A,QBtn:I.A,QAvatar:R.A,QDialog:ut.A,QCard:ht.A,QToolbar:J.A,QToolbarTitle:Y.A,QSeparator:W.A,QCardSection:oa.A,QList:E.A,QItem:B.A,QItemSection:T.A}),N()(ga,"directives",{ClosePopup:V.A,Ripple:P.A});const ka={id:"masterPanelHeader"},wa={id:"breadCrumbContent",class:"q-hide q-md-show"};function Aa(e,t,i,s,o,n){const r=(0,a.g2)("q-btn"),l=(0,a.g2)("q-breadcrumbs-el"),c=(0,a.g2)("q-breadcrumbs"),d=(0,a.g2)("q-toolbar-title"),m=(0,a.g2)("site-actions"),u=(0,a.g2)("q-toolbar"),h=(0,a.g2)("q-header");return(0,a.uX)(),(0,a.CE)("div",ka,[(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(u,{id:"toolbarTop"},{default:(0,a.k6)((()=>[(0,a.bF)(r,{id:"buttonToogleMenu",icon:"fas fa-bars",unelevated:"",color:"primary",onClick:t[0]||(t[0]=e=>o.eventBus.emit("toggleMasterDrawer","menu"))}),(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",wa,[(0,a.bF)(c,{class:"text-blue-grey",gutter:"none"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.breadcrumbs,((e,t)=>((0,a.uX)(),(0,a.Wv)(l,{key:t,label:e.label,to:!!e.to&&{name:e.to}},null,8,["label","to"])))),128))])),_:1})])])),_:1}),(0,a.bF)(m)])),_:1})])),_:1})])}var ya=i(99526)["A"];const qa={beforeUnmount(){C.Bt.off("header.badge.manage")},components:{siteActions:O},mounted(){this.$nextTick((function(){this.init()}))},data(){return{projectName:this.$getSetting("core::site-name"),logo:this.$store.state.qsiteApp.logo,appConfig:ya("app"),badge:{chat:!1,notification:!1},loadHeaderIpanel:!1,eventBus:C.Bt}},computed:{currentRoute(){return this.$route},params(){return this.currentRoute.meta.subHeader||{}},breadcrumbs(){let e=[],t=this.params.breadcrumb?this.$clone(this.params.breadcrumb):[];t=this.$clone(t.reverse());let i=-1==this.currentRoute.name.indexOf("app.home")?[ya("pages.mainqsite.home"),this.currentRoute.meta]:[ya("pages.mainqsite.home")];return t.forEach((e=>i.splice(1,0,ya(`pages.${e}`)))),i.forEach((t=>{t&&t.activated&&this.$hasAccess(t.permission)&&e.push({label:this.$tr(t.headerTitle||t.title),icon:t.icon,to:t.name})})),e}},methods:{init(){C.Bt.on("header.badge.manage",(e=>{Object.keys(e).forEach((t=>this.badge[t]=e[t]))}))}}};var $a=i(35389),xa=i(7e3);const _a=(0,Q.A)(qa,[["render",Aa]]),Fa=_a;N()(qa,"components",{QHeader:G.A,QToolbar:J.A,QBtn:I.A,QToolbarTitle:Y.A,QBreadcrumbs:$a.A,QBreadcrumbsEl:xa.A,QIcon:X.A});const Ca={id:"masterDrawers"},La={key:0,class:"q-pa-md logo-bg-primary text-center"},Sa={key:0,id:"btnProfile"},Qa={class:"row items-center justify-between"},Ia={class:"row items-center"},Ma={key:0,class:"q-ml-xs"},Wa={key:0,class:"q-pr-md"},Ea={class:"row no-wrap q-pa-md"},Ba={class:"column"},Ta={style:{"max-width":"110px"}},Xa={class:"text-center"},Da=["src"],za={class:"text-subtitle1 ellipsis q-mt-md"},Ra={class:"ellipsis text-caption"},Pa={class:"column"},Va={class:"text-h6 q-mb-xs text-blue-grey"},Ha={class:"row items-center text-blue-grey text-right"},Na={class:"row items-center text-blue-grey"};function Ua(e,t,i,o,n,r){const l=(0,a.g2)("q-img"),c=(0,a.g2)("menu-list"),d=(0,a.g2)("q-scroll-area"),m=(0,a.g2)("q-icon"),u=(0,a.g2)("q-avatar"),h=(0,a.g2)("q-separator"),p=(0,a.g2)("q-item-section"),f=(0,a.g2)("q-item"),g=(0,a.g2)("q-list"),b=(0,a.g2)("q-menu"),v=(0,a.g2)("q-no-ssr"),k=(0,a.g2)("q-drawer"),w=(0,a.g2)("checkin"),A=(0,a.g2)("master-recommendation"),y=(0,a.g2)("master-notifications"),q=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",Ca,[(0,a.bF)(k,{id:"menuMaster",class:"no-shadow",modelValue:n.drawer.menu,"onUpdate:modelValue":t[0]||(t[0]=e=>n.drawer.menu=e),ref:"menuMaster",mini:n.miniState,onClickCapture:t[1]||(t[1]=e=>n.miniState?n.eventBus.emit("toggleMasterDrawer","menu"):null)},{default:(0,a.k6)((()=>[!n.miniState&&n.drawer.menu?((0,a.uX)(),(0,a.CE)("div",La,[(0,a.bF)(l,{fit:"contain",src:n.logo,style:{height:"120px","min-height":"120px","max-width":"80%"}},null,8,["src"])])):(0,a.Q3)("",!0),(0,a.bF)(d,{style:(0,s.Tr)(`height: calc(100vh - ${n.miniState?"50":"202"}px`)},{default:(0,a.k6)((()=>[(0,a.bF)(c,{ref:"menuList",group:"",translatable:e.menuTranslatable,menu:e.menuSelect,"with-tooltip":n.miniState},null,8,["translatable","menu","with-tooltip"])])),_:1},8,["style"]),(0,a.bF)(v,null,{default:(0,a.k6)((()=>[r.quserState.authenticated?((0,a.uX)(),(0,a.CE)("div",Sa,[(0,a.Lk)("div",Qa,[(0,a.Lk)("div",Ia,[(0,a.Lk)("div",{id:"profileImage",class:"img-as-bg q-mr-sm items-center",style:(0,s.Tr)(`background-image: url('${r.profileImage.smallThumb}')`)},null,4),n.miniState?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",Ma,(0,s.v_)(r.quserState.userData.firstName),1))]),n.miniState?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",Wa,[(0,a.bF)(m,{name:"fas fa-chevron-up"})]))]),(0,a.bF)(b,{anchor:"bottom right",self:"top right"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",Ea,[(0,a.Lk)("div",Ba,[(0,a.Lk)("div",Ta,[(0,a.Lk)("div",Xa,[(0,a.bF)(u,{size:"72px",class:"q-mx-auto"},{default:(0,a.k6)((()=>[(0,a.Lk)("img",{src:r.profileImage.mediumThumb},null,8,Da)])),_:1})]),(0,a.Lk)("div",za,(0,s.v_)(r.quserState.userData.fullName),1),(0,a.Lk)("div",Ra,(0,s.v_)(r.quserState.userData.roles.map((e=>e.name)).join(", ")),1)])]),(0,a.bF)(h,{vertical:"",inset:"",class:"q-mx-lg"}),(0,a.Lk)("div",Pa,[(0,a.Lk)("div",Va,(0,s.v_)(e.$tr("isite.cms.label.profile")),1),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(f,{clickable:"",to:{name:"user.profile.me"},style:{padding:"0","min-width":"130px"}},{default:(0,a.k6)((()=>[(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",Ha,[(0,a.bF)(m,{name:"fas fa-user-circle",color:"green",size:"16px",class:"q-mr-sm"}),(0,a.eW)(" "+(0,s.v_)(e.$tr("iprofile.cms.sidebar.panelProfile")),1)])])),_:1})])),_:1},8,["to"])),[[q]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(f,{clickable:"",to:{name:"auth.logout"},style:{padding:"0","min-width":"130px"}},{default:(0,a.k6)((()=>[(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",Na,[(0,a.bF)(m,{name:"fas fa-sign-out-alt",color:"red",size:"16px",class:"q-mr-sm"}),(0,a.eW)(" "+(0,s.v_)(e.$t("isite.cms.configList.signOut")),1)])])),_:1})])),_:1},8,["to"])),[[q]])])),_:1})])])])),_:1})])):(0,a.Q3)("",!0)])),_:1})])),_:1},8,["modelValue","mini"]),"ipanel"==n.appConfig.mode&&e.$hasAccess("icheckin.shifts.create")?((0,a.uX)(),(0,a.Wv)(k,{key:0,id:"drawerCheckinMaster",modelValue:n.drawer.checkin,"onUpdate:modelValue":t[2]||(t[2]=e=>n.drawer.checkin=e),side:"right",bordered:""},{default:(0,a.k6)((()=>[(0,a.bF)(w)])),_:1},8,["modelValue"])):(0,a.Q3)("",!0),!r.routeSubHeader.recommendations?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(k,{key:1,id:"drawerRecommendationMaster",modelValue:n.drawer.recommendation,"onUpdate:modelValue":t[3]||(t[3]=e=>n.drawer.recommendation=e),side:"right"},{default:(0,a.k6)((()=>[(0,a.bF)(A)])),_:1},8,["modelValue"])),(0,a.bF)(y,{"is-open":n.drawer.notification,isMobile:"mobile"==this.windowSize},null,8,["is-open","isMobile"])])}var Oa=i(99526)["A"];const ja={beforeUnmount(){C.Bt.off("toggleMasterDrawer"),C.Bt.off("openMasterDrawer")},mixins:[ue.A],props:{},components:{menuList:_t,configList:Ge,chatList:wt,checkin:jt,masterRecommendation:di,masterNotifications:$i},mounted(){this.$nextTick((function(){this.init()}))},data(){return{windowHeight:window.innerHeight,windowWith:window.innerWidth,projectName:this.$getSetting("core::site-name"),logo:this.$store.state.qsiteApp.logo,miniState:"mobile"!=this.windowSize,drawer:{menu:"mobile"!=this.windowSize,config:!1,chat:!1,filter:!1,checkin:!1,recommendation:!1,notification:!1},appConfig:Oa("app"),filter:this.$filter,eventBus:C.Bt}},computed:{quserState(){return this.$store.state.quserAuth},windowSize(){return this.windowWith>="992"?"desktop":"mobile"},routeSubHeader(){return this.drawer.recommendation=!1,this.$route.meta.subHeader||{}},profileImage(){return this.$store.getters["quserAuth/profileImage"]}},methods:{init(){this.handlerEvent(),window.addEventListener("resize",(()=>{this.windowHeight=window.innerHeight,this.windowWith=window.innerWidth}))},handlerEvent(){C.Bt.on("toggleMasterDrawer",(e=>this.toggleDrawer(e))),C.Bt.on("openMasterDrawer",(e=>this.drawer[e]=!0))},toggleDrawer(e){for(var t in this.drawer)t!=e&&("menu"==t&&"mobile"!=this.windowSize?this.miniState=!0:this.drawer[t]=!1);"menu"==e?"mobile"==this.windowSize?(this.miniState=!1,this.drawer.menu=!this.drawer.menu):(this.drawer.menu=!0,this.miniState=!this.miniState):this.drawer[e]=!this.drawer[e]}}};var Ka=i(83333);const Ga=(0,Q.A)(ja,[["render",Ua]]),Ja=Ga;N()(ja,"components",{QDrawer:Bi.A,QImg:Ti.A,QScrollArea:li.A,QNoSsr:Ue.A,QIcon:X.A,QMenu:M.A,QAvatar:R.A,QSeparator:W.A,QList:E.A,QItem:B.A,QItemSection:T.A,QLayout:Ka.A,QExpansionItem:$t.A}),N()(ja,"directives",{ClosePopup:V.A});const Ya={id:"masterFooter"},Za={key:0,id:"panelFooterContent",class:"row q-md-hide items-center"},es=(0,a.Lk)("div",null,"Menu",-1),ts={class:"item-footer col cursor-pointer"},is=["src"];function as(e,t,i,o,n,r){const l=(0,a.g2)("q-icon"),c=(0,a.g2)("q-avatar"),d=(0,a.g2)("q-btn"),m=(0,a.g2)("q-footer"),u=(0,a.g2)("q-toolbar-title"),h=(0,a.g2)("q-toolbar"),p=(0,a.g2)("q-separator"),f=(0,a.g2)("q-item-section"),g=(0,a.g2)("q-item"),b=(0,a.g2)("q-list"),v=(0,a.g2)("q-card-section"),k=(0,a.g2)("q-card"),w=(0,a.g2)("q-dialog"),A=(0,a.gN)("close-popup"),y=(0,a.gN)("ripple");return(0,a.uX)(),(0,a.CE)("div",Ya,[(0,a.bF)(m,{class:"bg-white"},{default:(0,a.k6)((()=>["iadmin"==n.appConfig.mode?((0,a.uX)(),(0,a.CE)("div",Za,[(0,a.Lk)("div",{class:"item-footer col cursor-pointer",onClick:t[0]||(t[0]=e=>n.eventBus.emit("toggleMasterDrawer","menu"))},[(0,a.bF)(l,{class:"item-icon",name:"fas fa-bars"}),es]),(0,a.Lk)("div",ts,[r.quserState.authenticated?((0,a.uX)(),(0,a.Wv)(d,{key:0,to:{name:"user.profile.me"},flat:"","no-caps":"",class:"item-icon",padding:"none"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{size:"20px"},{default:(0,a.k6)((()=>[(0,a.Lk)("img",{src:r.profileImage.smallThumb},null,8,is)])),_:1})])),_:1},8,["to"])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,(0,s.v_)(e.$tr("isite.cms.label.profile")),1)]),(0,a.Lk)("div",{class:"col",onClick:t[1]||(t[1]=e=>r.doMainAction())},[(0,a.Lk)("div",{id:"item-main",class:(0,s.C4)(`cursor-pointer row items-center justify-center bg-${n.mainAction.color}`)},[(0,a.bF)(l,{class:"item-icon",name:n.mainAction.icon},null,8,["name"])],2)]),(0,a.Lk)("div",{class:"item-footer col cursor-pointer",onClick:t[2]||(t[2]=e=>n.eventBus.emit("toggleMasterDrawer","config"))},[(0,a.bF)(l,{class:"item-icon",name:"fas fa-cog"}),(0,a.Lk)("div",null,(0,s.v_)(e.$tr("isite.cms.label.setting")),1)]),(0,a.Lk)("div",{class:"item-footer col cursor-pointer",onClick:t[3]||(t[3]=e=>n.modal.show=!0)},[(0,a.bF)(l,{class:"item-icon",name:"fas fa-ellipsis-h"}),(0,a.Lk)("div",null,(0,s.v_)(e.$trp("isite.cms.label.other")),1)])])):(0,a.Q3)("",!0)])),_:1}),"iadmin"==n.appConfig.mode?((0,a.uX)(),(0,a.Wv)(w,{key:0,modelValue:n.modal.show,"onUpdate:modelValue":t[9]||(t[9]=e=>n.modal.show=e),position:"bottom"},{default:(0,a.k6)((()=>[(0,a.bF)(k,{style:{width:"350px"}},{default:(0,a.k6)((()=>[(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(l,{class:"item-icon",name:"fas fa-ellipsis-v"}),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$trp("isite.cms.label.other")),1)])),_:1}),(0,a.bo)((0,a.bF)(d,{flat:"",round:"",dense:"",icon:"fa fa-close"},null,512),[[A]])])),_:1}),(0,a.bF)(p),(0,a.bF)(v,{class:"row items-center no-wrap q-pa-none"},{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(b,{separator:"",class:"full-width"},{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:t[4]||(t[4]=t=>e.$helper.openExternalURL(e.$store.state.qsiteApp.baseUrl))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"far fa-eye"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("isite.cms.configList.goToSite")),1)])),_:1})])),_:1})),[[y]]),e.$hasAccess("ichat.conversations.index")?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:0,clickable:"",onClick:t[5]||(t[5]=e=>n.eventBus.emit("toggleMasterDrawer","chat"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fa-light fa-message"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)("Chat")])),_:1})])),_:1})),[[y]]):(0,a.Q3)("",!0),e.$hasAccess("icheckin.shifts.create")?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:1,clickable:"",onClick:t[6]||(t[6]=e=>n.eventBus.emit("toggleMasterDrawer","checkin"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fas fa-stopwatch"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$tr("icheckin.cms.sidebar.checkin")),1)])),_:1})])),_:1})),[[y]]):(0,a.Q3)("",!0),!r.params.recommendations?(0,a.Q3)("",!0):(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:2,clickable:"",onClick:t[7]||(t[7]=e=>n.eventBus.emit("toggleMasterDrawer","recommendation"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fas fa-hat-wizard"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$trp("isite.cms.label.recommendation")),1)])),_:1})])),_:1})),[[y]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:t[8]||(t[8]=e=>n.eventBus.emit("toggleMasterDrawer","notification"))},{default:(0,a.k6)((()=>[(0,a.bF)(f,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(l,{color:"primary",name:"fas fa-bell"})])),_:1}),(0,a.bF)(f,{class:"ellipsis"},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(e.$trp("isite.cms.label.notification")),1)])),_:1})])),_:1})),[[y]])])),_:1})),[[A]])])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,a.Q3)("",!0)])}var ss=i(99526)["A"];const os={beforeUnmount(){C.Bt.off("setMobileMainAction")},props:{},components:{},watch:{$route:{deep:!0,handler:function(e){this.mainAction=ss("app.mobilMainAction")}}},mounted(){this.$nextTick((function(){this.init()}))},data(){return{mainAction:ss("app.mobilMainAction"),appConfig:ss("app"),loadFooterIpanel:!1,modal:{show:!1},eventBus:C.Bt}},computed:{quserState(){return this.$store.state.quserAuth},routeSubHeader(){return this.$route.meta.subHeader||{}},currentRoute(){return this.$route},params(){return this.currentRoute.meta.subHeader||{}},profileImage(){return this.$store.getters["quserAuth/profileImage"]}},methods:{init(){C.Bt.on("setMobileMainAction",(e=>{this.mainAction={...this.mainAction,...e}}))},doMainAction(){this.mainAction.callBack?this.mainAction.callBack():this.mainAction.route&&this.$route.name!=this.mainAction.route&&this.$router.push({name:this.mainAction.route})}}},ns=(0,Q.A)(os,[["render",as]]),rs=ns;N()(os,"components",{QFooter:sa.A,QIcon:X.A,QBtn:I.A,QAvatar:R.A,QDialog:ut.A,QCard:ht.A,QToolbar:J.A,QToolbarTitle:Y.A,QSeparator:W.A,QCardSection:oa.A,QList:E.A,QItem:B.A,QItemSection:T.A}),N()(os,"directives",{ClosePopup:V.A,Ripple:P.A});var ls=i(60149);const cs={id:"actionsGamification"},ds={id:"content-script-modal"},ms=["innerHTML"],us=["innerHTML"];function hs(e,t,i,s,o,n){const r=(0,a.g2)("dynamic-form"),l=(0,a.g2)("master-modal");return(0,a.uX)(),(0,a.CE)("div",cs,[(0,a.bF)(l,{modelValue:o.modal.form.show,"onUpdate:modelValue":t[1]||(t[1]=e=>o.modal.form.show=e),title:o.modal.form.title,customPosition:!0},{default:(0,a.k6)((()=>[o.modal.form.blocks?((0,a.uX)(),(0,a.Wv)(r,{key:0,loading:o.modal.form.loading,blocks:o.modal.form.blocks,onSubmit:t[0]||(t[0]=e=>n.sendFormData(e)),description:o.modal.form.description},null,8,["loading","blocks","description"])):(0,a.Q3)("",!0)])),_:1},8,["modelValue","title"]),(0,a.bF)(l,{modelValue:o.modal.script.show,"onUpdate:modelValue":t[2]||(t[2]=e=>o.modal.script.show=e),title:o.modal.script.title,customPosition:!0},{default:(0,a.k6)((()=>[(0,a.Lk)("div",ds,[(0,a.Lk)("p",{innerHTML:o.modal.script.description},null,8,ms)])])),_:1},8,["modelValue","title"]),(0,a.bF)(l,{id:"iframeModalActivity",modelValue:o.modal.iframe.show,"onUpdate:modelValue":t[3]||(t[3]=e=>o.modal.iframe.show=e),title:o.category?o.category.title:"",customPosition:!0},{default:(0,a.k6)((()=>[(0,a.Lk)("div",{id:"iframeActivity",innerHTML:o.modal.iframe.iframe},null,8,us)])),_:1},8,["modelValue","title"])])}var ps=i(99526)["A"];const fs={beforeUnmount(){C.Bt.off("open.gamification.activity")},props:{},components:{},watch:{"modal.script.show":e=>{if(!e){const e=document.getElementsByClassName("b24-window-mounts")[0],t=document.body.getElementsByTagName("script"),i=t[t.length-1];e?.remove(),i?.remove()}}},mounted(){this.$nextTick((function(){C.Bt.on("open.gamification.activity",this.openActivity)}))},data(){return{category:null,modal:{form:{show:!1,loading:!1,formId:void 0,sent:!1,title:"",description:"",blocks:[]},script:{show:!1,loading:!0,title:"",description:""},iframe:{show:!1,iframe:null}}}},computed:{},methods:{openActivity(e){switch(e.type){case 2:this.$helper.openExternalURL(`${e.url}`,!0);break;case 3:const t=e.form.fields,i=t.map(((e,t)=>e.dynamicField)),a=[{name:"block1",fields:i}];this.modal.form.show=!0,this.modal.form.title=e.title,this.modal.form.description=e.description,this.modal.form.blocks=a,this.modal.form.formId=e.formId;break;case 4:const s=document.createRange().createContextualFragment(e.options.externalScript);this.modal.script.show=!0,this.modal.script.title=e.title,this.modal.script.description=e.description,this.modal.script.loading=!0,setTimeout((()=>{const e=document.getElementById("content-script-modal");e.appendChild(s),this.modal.script.loading=!1}),1e3);break;case 5:this.modal.iframe={show:!0,iframe:e.options.iframe};break;default:let o=this.$store.state.qsiteApp.baseUrl;this.$helper.openExternalURL(`${o}/${e.url}`,!1);break}},sendFormData(e){const t={...e,form_id:this.modal.form.formId};this.modal.form.loading=!0,this.$axios.post(`${this.baseUrl}${ps("apiRoutes.qform.leads")}`,t).then((e=>{200===e.status&&(this.modal.form.loading=!1,this.modal.form.show=!1,this.$alert.info({message:`${this.$tr("isite.cms.message.recordCreated")}`}))})).catch((e=>{this.modal.form.loading=!1,this.modal.form.show=!1,this.$alert.error({message:`${this.$tr("isite.cms.message.recordNoCreated")}`}),console.error(e)}))}}},gs=(0,Q.A)(fs,[["render",hs]]),bs=gs;function vs(e,t,i,a,s,o){return null}const ks={name:"Alert",beforeUnmount(){window.removeEventListener("online",this.connectionSwitch),window.removeEventListener("offline",this.connectionSwitch)},mounted(){window.addEventListener("online",this.connectionSwitch),window.addEventListener("offline",this.connectionSwitch),this.connectionSwitch()},methods:{connectionSwitch(){navigator.onLine?this.$store.dispatch("qofflineMaster/APP_ONLINE"):this.$store.dispatch("qofflineMaster/APP_OFFLINE")}}},ws=(0,Q.A)(ks,[["render",vs]]),As=ws,ys={class:"banner-wrapper"},qs={key:2};function $s(e,t,i,o,n,r){const l=(0,a.g2)("q-icon"),c=(0,a.g2)("marquee");return(0,a.uX)(),(0,a.CE)("div",ys,[(0,a.Lk)("div",{class:(0,s.C4)([i.classWrapper,"banner"]),onClick:t[0]||(t[0]=(...e)=>i.action&&i.action(...e))},[i.icon&&i.icon.name?((0,a.uX)(),(0,a.Wv)(l,{key:0,size:i.icon.size,name:i.icon.name,class:(0,s.C4)([i.icon.class,"q-mr-sm"])},null,8,["size","name","class"])):(0,a.Q3)("",!0),i.marquee?((0,a.uX)(),(0,a.Wv)(c,{key:1},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(i.message),1)])),_:1})):i.marquee?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("span",qs,(0,s.v_)(i.message),1))],2)])}const xs={name:"bannerAlert",data:()=>({eventBus:C.Bt}),props:{classWrapper:{type:String,default:""},marquee:{type:Boolean,default:!1},icon:{type:Object,default:()=>({})},message:{type:String,default:""},action:{type:Function,default:()=>{}}}},_s=(0,Q.A)(xs,[["render",$s]]),Fs=_s;N()(xs,"components",{QIcon:X.A});var Cs=i(46107),Ls=i(43436),Ss=i.n(Ls),Qs={class:"row justify-between items-center"},Is={class:"text-subtitle1 row items-center"},Ms={class:"text-grey-9 text-weight-bold"},Ws={class:"container-section-dialog q-pb-md"},Es={class:"scrollable-section-dialog"},Bs={class:"tw-text-[#555555] tw-text-sm text-weight-bold"},Ts=["innerHTML"],Xs={class:"text-caption text-grey-6"};function Ds(e,t,i,o,n,r){var l=(0,a.g2)("q-icon"),c=(0,a.g2)("q-card-section"),d=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-tooltip"),h=(0,a.g2)("q-item"),p=(0,a.g2)("q-img"),f=(0,a.g2)("q-btn"),g=(0,a.g2)("q-card-actions"),b=(0,a.g2)("q-card"),v=(0,a.g2)("q-dialog");return(0,a.uX)(),(0,a.Wv)(v,{modelValue:e.dialog,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.dialog=t})},{default:(0,a.k6)((function(){return[(0,a.bF)(b,{style:{width:"100%","max-width":"700px","max-height":"90vh","border-radius":"15px"}},{default:(0,a.k6)((function(){return[(0,a.bF)(c,{class:"tw-p-6"},{default:(0,a.k6)((function(){return[(0,a.Lk)("div",Qs,[(0,a.Lk)("div",Is,[(0,a.bF)(l,{name:"fa-solid fa-bell",color:"grey-9",size:"22px",class:"q-mr-sm"}),(0,a.Lk)("label",Ms,(0,s.v_)(e.$tr("isite.cms.label.notification",{capitalize:!0})),1)]),(0,a.bF)(l,{name:"fa-light fa-times",color:"grey-7",size:"20px",class:"cursor-pointer",onClick:t[0]||(t[0]=function(t){return e.closeModal()})})])]})),_:1}),(0,a.Lk)("div",Ws,[(0,a.Lk)("div",Es,[(0,a.bF)(c,{class:"tw-p-6 tw-pt-0"},{default:(0,a.k6)((function(){return[(0,a.bF)(h,{class:"no-margin no-padding"},{default:(0,a.k6)((function(){return[(0,a.bF)(d,{avatar:"",top:""},{default:(0,a.k6)((function(){return[(0,a.Lk)("div",{class:"flex flex-center tw-w-[70px] tw-h-[70px] tw-rounded-lg notification-notification-icon-big",style:(0,s.Tr)({backgroundColor:e.sourceData.backgroundColor})},[(0,a.bF)(l,{name:e.sourceData.icon,style:(0,s.Tr)({color:e.sourceData.color,fontSize:"48px"})},null,8,["name","style"])],4)]})),_:1}),(0,a.bF)(d,{top:""},{default:(0,a.k6)((function(){return[(0,a.bF)(m,null,{default:(0,a.k6)((function(){return[(0,a.Lk)("span",Bs,(0,s.v_)(e.notification.title),1)]})),_:1}),(0,a.bF)(m,null,{default:(0,a.k6)((function(){return[(0,a.Lk)("div",{class:"tw-text-[#555555] tw-text-sm",innerHTML:e.notification.message},null,8,Ts)]})),_:1}),(0,a.bF)(m,{lines:"1"},{default:(0,a.k6)((function(){return[(0,a.Lk)("span",Xs,[(0,a.eW)((0,s.v_)(e.notification.timeAgo)+" ",1),(0,a.bF)(u,{anchor:"bottom end",self:"center right"},{default:(0,a.k6)((function(){return[(0,a.eW)((0,s.v_)(e.notification.createdAt),1)]})),_:1})])]})),_:1})]})),_:1})]})),_:1})]})),_:1}),e.imageUrl?((0,a.uX)(),(0,a.Wv)(c,{key:0,class:"tw-p-6 tw-py-0"},{default:(0,a.k6)((function(){return[(0,a.bF)(p,{class:"tw-rounded-2xl",src:e.imageUrl,ratio:16/9},null,8,["src"])]})),_:1})):(0,a.Q3)("",!0)])]),e.notification.link?((0,a.uX)(),(0,a.Wv)(g,{key:0,align:"right",class:"q-px-md q-pb-md"},{default:(0,a.k6)((function(){return[(0,a.bF)(f,{label:e.$tr("notification.cms.cancel"),rounded:"","no-caps":"",unelevated:"",color:"grey-3","text-color":"grey-8",onClick:t[1]||(t[1]=function(t){return e.closeModal()}),class:"q-px-md tw-w-[90px]"},null,8,["label"]),(0,a.bF)(f,{rounded:"","no-caps":"",unelevated:"",color:"green-5",onClick:t[2]||(t[2]=function(t){return e.goToLink()}),class:"q-px-md tw-w-[124px]"},{default:(0,a.k6)((function(){return[(0,a.Lk)("span",null,(0,s.v_)(e.linkLabel),1),(0,a.bF)(l,{name:"fa-light fa-arrow-up-right-from-square",color:"white",size:"14px",class:"cursor-pointer q-ml-sm"})]})),_:1})]})),_:1})):(0,a.Q3)("",!0)]})),_:1})]})),_:1},8,["modelValue"])}var zs=i(38734),Rs=function(){return Rs=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var s in t=arguments[i],t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},Rs.apply(this,arguments)};function Ps(e,t){var i=(0,zs.Kh)({dialog:!1,notification:null}),s={imageUrl:(0,a.EW)((function(){var e,t,a;return!!(null===(a=null===(t=null===(e=i.notification)||void 0===e?void 0:e.mediaFiles)||void 0===t?void 0:t.mainimage)||void 0===a?void 0:a.id)&&i.notification.mediaFiles.mainimage.mediumThumb})),linkLabel:(0,a.EW)((function(){var e,t;return(null===(t=null===(e=i.notification)||void 0===e?void 0:e.options)||void 0===t?void 0:t.linkLabel)?i.notification.options.linkLabel:C.Ru.tr("notification.cms.openLink")})),sourceData:(0,a.EW)((function(){var e;return Rs({backgroundColor:"#D9D9D9",color:"#2196f3",icon:"fa-light fa-bell"},(null===(e=i.notification)||void 0===e?void 0:e.sourceData)||{})}))},o={init:function(){C.Bt.on("imagina.notification.open",(function(e){i.notification=e,i.dialog=!0}))},goToLink:function(){C.dw.openExternalURL(i.notification.link,!0)},closeModal:function(){i.dialog=!1,t("update:modelValue",!1)}};return(0,a.sV)((function(){o.init()})),(0,a.xo)((function(){C.Bt.off("imagina.notification.open")})),Rs(Rs(Rs({},(0,zs.QW)(i)),s),o)}const Vs=(0,a.pM)({props:{notification:{default:{}},sourceSettings:{default:[]}},components:{},setup:function(e,t){var i=t.emit;return Ps(e,i)}});var Hs=i(16334);const Ns=(0,Q.A)(Vs,[["render",Ds]]),Us=Ns;N()(Vs,"components",{QDialog:ut.A,QCard:ht.A,QCardSection:oa.A,QIcon:X.A,QItem:B.A,QItemSection:T.A,QItemLabel:Qi.A,QTooltip:D.A,QImg:Ti.A,QCardActions:Hs.A,QBtn:I.A});var Os=i(99526)["A"];const js={name:"MasterLayout",mixins:[d.A],components:{cropperComponent:ls.A,activitiesActions:bs,headerAdminTheme1:ee,headerAdminTheme2:re,drawersAdminTheme1:Di,drawersAdminTheme2:ji,footerAdminTheme1:ra,footerAdminTheme2:va,headerPanel:Fa,drawersPanel:Ja,footerPanel:rs,Alert:As,bannerAlert:Fs,notificationDialog:Us},watch:{shouldChangePassword(e){e&&e.shouldChangePassword&&e.messages.forEach((e=>{this.$alert[e.type||"info"](e)}))}},mounted(){this.$nextTick((async function(){this.init()}))},data(){return{appConfig:Os("app"),homePage:"isite_cms_main_home",modalForce:{shouldChangePassword:!1},bannerType:{offline:{icon:{name:"fa-regular fa-wifi-slash"},message:this.$tr("isite.cms.message.appOffline"),classWrapper:"tw-text-white tw-bg-gray-900",action:()=>C.Bt.emit("toggleMasterDrawer","offline")},notification:{marquee:!0,message:this.$store.getters["qsiteApp/getSettingValueByName"]("isite::globalWarningMessage"),classWrapper:"tw-bg-yellow-400 tw-text-black tw-font-semibold"}}}},computed:{isAppOffline(){return this.$store.state.qofflineMaster.isAppOffline},appState(){return this.$store.state.qsiteApp},iadminTheme(){return this.$getSetting("isite::iadminTheme")||1},components(){if("iadmin"==this.appConfig.mode){const e={theme1:{header:ee,drawer:Di,footer:ra},theme2:{header:re,drawer:ji,footer:va}};return e[`theme${this.iadminTheme}`]}return{header:Fa,drawer:Ja,footer:rs}},pagesConfig(){return this.$store.state.qsiteApp.pages},breadcrumbs(){let e=[],t=(this.$route.meta?.subHeader?.breadcrumb||[]).reverse();const i=Cs.A.mainapp.home,a=-1==this.$route.name.indexOf("app.home")?[i,this.$route.meta]:[i];return t.forEach((e=>{a.splice(1,0,Ss().get(Cs.A,e))})),a.forEach((t=>{if(!t)return;const i=t.options?t.options.activated:t.activated;t&&i&&this.$hasAccess(t.permission)&&e.push({label:this.$tr(t.title),icon:t.icon,to:t.name})})),e},shouldChangePassword(){return this.$store.state.quserAuth.shouldChangePassword},globalActivities(){return{helpCenter:{systemName:"help_center",view:"button",vIf:this.$q.platform.is.desktop,btnProps:{color:"info",flat:!0}},adminPopup:{systemName:"admin_popup",view:"popup"}}},isWarning(){return this.$store.getters["qsiteApp/getSettingValueByName"]("isite::globalWarningMessage")}},methods:{init(){this.idlTime()},idlTime(){const e=parseInt(this.$getSetting("iprofile::logoutIdlTime")||0);if(e){var t;const i=()=>{clearTimeout(t),this.$store.state.quserAuth.authenticated&&(t=setTimeout((async()=>{this.$store.dispatch("quserAuth/AUTH_LOGOUT"),this.$alert.warning({mode:"modal",title:this.$tr("iprofile.cms.message.logout"),message:this.$tr("iprofile.cms.message.logoutIdlTime"),actions:[{label:this.$tr("iprofile.cms.label.login"),handler:async()=>{clearTimeout(t),this.$router.push({name:"auth.login",query:this.$route.query})}}]})}),60*e*1e3))};i(),document.onmousemove=i,document.onkeydown=i}},configBanner(){return this.isAppOffline?this.bannerType.offline:this.isWarning?this.bannerType.notification:void 0}}};var Ks=i(71102);const Gs=(0,Q.A)(js,[["render",c]]),Js=Gs;N()(js,"components",{QLayout:Ka.A,QPageContainer:Ks.A,QBtn:I.A,QTooltip:D.A,QBreadcrumbs:$a.A,QBreadcrumbsEl:xa.A})}}]);