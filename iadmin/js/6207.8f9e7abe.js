"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[6207],{76207:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Q});a(10239);var l=a(61758),s=a(58790);const o={id:"pageId",class:"q-layout-page layout-padding"},i={key:0,class:"relative-position q-mb-lg backend-page"},r={class:"box"},d={class:"col-12"},c={class:"input-title"},m={class:"row"},n={class:"col-12 text-right q-py-sm"},u={key:0,class:"col-12 q-py-xs"},p={class:"row q-col-gutter-sm"},h={class:"col-4"},g={class:"col-4"},f={class:"col-2 col-sm-3"},$={class:"col-2 col-sm-1 text-right"};function b(e,t,b,v,k,y){const q=(0,l.g2)("locales"),F=(0,l.g2)("q-input"),V=(0,l.g2)("q-editor"),R=(0,l.g2)("q-field"),C=(0,l.g2)("q-tooltip"),I=(0,l.g2)("q-btn"),T=(0,l.g2)("crud"),x=(0,l.g2)("q-select"),w=(0,l.g2)("q-page-sticky"),L=(0,l.g2)("q-form"),A=(0,l.g2)("inner-loading");return(0,l.uX)(),(0,l.CE)("div",o,[k.success?((0,l.uX)(),(0,l.CE)("div",i,[(0,l.Lk)("div",r,[(0,l.Lk)("div",d,[(0,l.bF)(q,{modelValue:k.locale,"onUpdate:modelValue":t[0]||(t[0]=e=>k.locale=e),ref:"localeComponent",form:e.$refs.formContent},null,8,["modelValue","form"])]),k.locale.success?((0,l.uX)(),(0,l.Wv)(L,{key:0,autocorrect:"off",autocomplete:"off",ref:"formContent",class:"full-width q-my-sm",onSubmit:t[5]||(t[5]=e=>k.itemId?y.updateItem():y.createItem()),onValidationError:t[6]||(t[6]=t=>e.$alert.error(e.$tr("isite.cms.message.formInvalid")))},{default:(0,l.k6)((()=>[(0,l.bF)(F,{outlined:"",dense:"",modelValue:k.locale.formTemplate.name,"onUpdate:modelValue":t[1]||(t[1]=e=>k.locale.formTemplate.name=e),label:`${e.$tr("isite.cms.form.name")} (${k.locale.language})*`,rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","label","rules"]),(0,l.Lk)("div",c,(0,s.v_)(`${e.$tr("isite.cms.form.description")} (${k.locale.language})*`),1),(0,l.bF)(R,{borderless:"",modelValue:k.locale.formTemplate.description,"onUpdate:modelValue":t[3]||(t[3]=e=>k.locale.formTemplate.description=e),rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},{default:(0,l.k6)((()=>[(0,l.bF)(V,{class:"full-width",modelValue:k.locale.formTemplate.description,"onUpdate:modelValue":t[2]||(t[2]=e=>k.locale.formTemplate.description=e)},null,8,["modelValue"])])),_:1},8,["modelValue","rules"]),(0,l.Lk)("div",m,[(0,l.Lk)("div",n,[(0,l.bF)(I,{color:"green",loading:k.loading,onClick:t[4]||(t[4]=e=>k.locale.formTemplate.rates.push(y.defaultRate)),icon:"fas fa-plus"},{default:(0,l.k6)((()=>[(0,l.bF)(C,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.$tr("icommerce.cms.newTaxRate")),1)])),_:1})])),_:1},8,["loading"])]),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(k.locale.formTemplate.rates,((t,s)=>((0,l.uX)(),(0,l.CE)(l.FK,{key:s},[k.locale.formTemplate.rates?((0,l.uX)(),(0,l.CE)("div",u,[(0,l.Lk)("div",p,[(0,l.Lk)("div",h,[(0,l.bF)(T,{"crud-data":a.e(9982).then(a.bind(a,69982)),type:"select","crud-props":{label:`${e.$tr("icommerce.cms.form.taxRate")}*`},modelValue:t.taxRateId,"onUpdate:modelValue":e=>t.taxRateId=e,config:{options:{label:"name",value:"id"}}},null,8,["crud-data","crud-props","modelValue","onUpdate:modelValue"])]),(0,l.Lk)("div",g,[(0,l.bF)(x,{outlined:"",dense:"","bg-color":"white",modelValue:t.based,"onUpdate:modelValue":e=>t.based=e,rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")],label:`${e.$tr("icommerce.cms.form.taxBased")}*`,style:{width:"100%"},"emit-value":"","map-options":"",options:k.optionsBased},null,8,["modelValue","onUpdate:modelValue","rules","label","options"])]),(0,l.Lk)("div",f,[(0,l.bF)(F,{type:"number",outlined:"",dense:"",modelValue:t.priority,"onUpdate:modelValue":e=>t.priority=e,label:`${e.$tr("icommerce.cms.form.priority")}`,rules:[t=>!!t||e.$tr("isite.cms.message.fieldRequired")]},null,8,["modelValue","onUpdate:modelValue","label","rules"])]),(0,l.Lk)("div",$,[(0,l.bF)(I,{color:"red",loading:k.loading,onClick:e=>y.deleteRateItem(s),icon:"fas fa-trash"},null,8,["loading","onClick"])])])])):(0,l.Q3)("",!0)],64)))),128))]),(0,l.bF)(w,{position:"bottom-right",offset:[18,18]},{default:(0,l.k6)((()=>[e.$route.params.id?((0,l.uX)(),(0,l.Wv)(I,{key:0,color:"green",loading:k.loading,icon:"fas fa-edit",label:e.$tr("isite.cms.label.update"),type:"submit"},null,8,["loading","label"])):((0,l.uX)(),(0,l.Wv)(I,{key:1,color:"green",loading:k.loading,icon:"fas fa-edit",label:e.$tr("isite.cms.label.create"),type:"submit"},null,8,["loading","label"]))])),_:1})])),_:1},512)):(0,l.Q3)("",!0)])])):(0,l.Q3)("",!0),(0,l.bF)(A,{visible:k.loading},null,8,["visible"])])}var v=a(71915);const k={components:{},watch:{$route(e,t){this.initForm()}},mounted(){this.$nextTick((function(){this.initForm(),v.Bt.on("page.data.refresh",(()=>this.initForm()))}))},data(){return{locale:{},loading:!1,success:!1,itemId:!1,optionsRate:[],optionsBased:[{value:"1",label:this.$tr("icommerce.cms.options.taxRateBased.shippingAddress")},{value:"2",label:this.$tr("icommerce.cms.options.taxRateBased.paymentAddress")},{value:"3",label:this.$tr("icommerce.cms.options.taxRateBased.storeAddress")}]}},computed:{dataLocale(){return{fields:{rates:[]},fieldsTranslatable:{description:"",name:""}}},defaultRate(){return{taxRateId:"",based:"2",priority:"0"}}},methods:{async initForm(){this.loading=!0,this.success=!1,this.locale=this.$clone(this.dataLocale),this.itemId=this.$route.params.id,this.locale.success&&this.$refs.localeComponent.vReset(),await this.getData(),this.success=!0,this.loading=!1},async getData(){return new Promise(((e,t)=>{const a=this.$clone(this.itemId);if(a){let l="apiRoutes.qcommerce.taxClasses",s={refresh:!0,params:{include:"rates",filter:{allTranslations:!0}}};this.$crud.show(l,a,s).then((t=>{this.orderDataItemToLocale(t.data),e(!0)})).catch((e=>{this.$apiResponse.handleError(e,(()=>{this.$alert.error({message:this.$tr("isite.cms.message.errorRequest")}),this.loading=!1,t(!1)}))}))}else e(!0)}))},deleteRateItem(e){this.locale.formTemplate.rates.splice(e,1)},orderDataItemToLocale(e){let t=this.$clone(e);this.locale.form=this.$clone(t),setTimeout((()=>{this.locale.form.rates=t.rates}),1e3)},async updateItem(){if(await this.$refs.localeComponent.validateForm()){this.loading=!0;let e="apiRoutes.qcommerce.taxClasses";this.$crud.update(e,this.itemId,this.getDataForm()).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordUpdated")}`}),this.$router.push({name:"qcommerce.admin.taxClasses"}),this.loading=!1})).catch((e=>{this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated")})}))}},async createItem(){if(await this.$refs.localeComponent.validateForm()){this.loading=!0;let e="apiRoutes.qcommerce.taxClasses";this.$crud.create(e,this.getDataForm()).then((e=>{this.$alert.success({message:`${this.$tr("isite.cms.message.recordCreated")}`}),this.$router.push({name:"qcommerce.admin.taxClasses"}),this.loading=!1})).catch((e=>{this.loading=!1,this.$alert.error({message:this.$tr("isite.cms.message.recordNoUpdated")})}))}},getDataForm(){let e=this.locale.form;for(var t in e){let a=e[t];null!=a&&void 0!=a&&0!==a.length||delete e[t]}return e}}};var y=a(12807),q=a(83333),F=a(21565),V=a(78020),R=a(51225),C=a(94192),I=a(69001),T=a(78151),x=a(833),w=a(70918),L=a(98582),A=a.n(L);const U=(0,y.A)(k,[["render",b]]),Q=U;A()(k,"components",{QLayout:q.A,QForm:F.A,QInput:V.A,QField:R.A,QEditor:C.A,QBtn:I.A,QTooltip:T.A,QSelect:x.A,QPageSticky:w.A})}}]);